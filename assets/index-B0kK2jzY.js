(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))A(P);new MutationObserver(P=>{for(const D of P)if(D.type==="childList")for(const E of D.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&A(E)}).observe(document,{childList:!0,subtree:!0});function w(P){const D={};return P.integrity&&(D.integrity=P.integrity),P.referrerPolicy&&(D.referrerPolicy=P.referrerPolicy),P.crossOrigin==="use-credentials"?D.credentials="include":P.crossOrigin==="anonymous"?D.credentials="omit":D.credentials="same-origin",D}function A(P){if(P.ep)return;P.ep=!0;const D=w(P);fetch(P.href,D)}})();function Ey(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var pg={exports:{}},yp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e_;function Ay(){if(e_)return yp;e_=1;var h=Symbol.for("react.transitional.element"),y=Symbol.for("react.fragment");function w(A,P,D){var E=null;if(D!==void 0&&(E=""+D),P.key!==void 0&&(E=""+P.key),"key"in P){D={};for(var l in P)l!=="key"&&(D[l]=P[l])}else D=P;return P=D.ref,{$$typeof:h,type:A,key:E,ref:P!==void 0?P:null,props:D}}return yp.Fragment=y,yp.jsx=w,yp.jsxs=w,yp}var t_;function Cy(){return t_||(t_=1,pg.exports=Ay()),pg.exports}var oe=Cy(),mg={exports:{}},vp={},gg={exports:{}},_g={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i_;function Py(){return i_||(i_=1,(function(h){function y(Xe,gt){var Nt=Xe.length;Xe.push(gt);e:for(;0<Nt;){var Lt=Nt-1>>>1,Si=Xe[Lt];if(0<P(Si,gt))Xe[Lt]=gt,Xe[Nt]=Si,Nt=Lt;else break e}}function w(Xe){return Xe.length===0?null:Xe[0]}function A(Xe){if(Xe.length===0)return null;var gt=Xe[0],Nt=Xe.pop();if(Nt!==gt){Xe[0]=Nt;e:for(var Lt=0,Si=Xe.length,be=Si>>>1;Lt<be;){var Ke=2*(Lt+1)-1,pt=Xe[Ke],Et=Ke+1,$t=Xe[Et];if(0>P(pt,Nt))Et<Si&&0>P($t,pt)?(Xe[Lt]=$t,Xe[Et]=Nt,Lt=Et):(Xe[Lt]=pt,Xe[Ke]=Nt,Lt=Ke);else if(Et<Si&&0>P($t,Nt))Xe[Lt]=$t,Xe[Et]=Nt,Lt=Et;else break e}}return gt}function P(Xe,gt){var Nt=Xe.sortIndex-gt.sortIndex;return Nt!==0?Nt:Xe.id-gt.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var D=performance;h.unstable_now=function(){return D.now()}}else{var E=Date,l=E.now();h.unstable_now=function(){return E.now()-l}}var B=[],U=[],ee=1,J=null,W=3,K=!1,ve=!1,Ce=!1,Pe=!1,Fe=typeof setTimeout=="function"?setTimeout:null,Ue=typeof clearTimeout=="function"?clearTimeout:null,He=typeof setImmediate<"u"?setImmediate:null;function mt(Xe){for(var gt=w(U);gt!==null;){if(gt.callback===null)A(U);else if(gt.startTime<=Xe)A(U),gt.sortIndex=gt.expirationTime,y(B,gt);else break;gt=w(U)}}function Mt(Xe){if(Ce=!1,mt(Xe),!ve)if(w(B)!==null)ve=!0,Pt||(Pt=!0,Di());else{var gt=w(U);gt!==null&&sn(Mt,gt.startTime-Xe)}}var Pt=!1,_t=-1,ei=5,Vt=-1;function mi(){return Pe?!0:!(h.unstable_now()-Vt<ei)}function wi(){if(Pe=!1,Pt){var Xe=h.unstable_now();Vt=Xe;var gt=!0;try{e:{ve=!1,Ce&&(Ce=!1,Ue(_t),_t=-1),K=!0;var Nt=W;try{t:{for(mt(Xe),J=w(B);J!==null&&!(J.expirationTime>Xe&&mi());){var Lt=J.callback;if(typeof Lt=="function"){J.callback=null,W=J.priorityLevel;var Si=Lt(J.expirationTime<=Xe);if(Xe=h.unstable_now(),typeof Si=="function"){J.callback=Si,mt(Xe),gt=!0;break t}J===w(B)&&A(B),mt(Xe)}else A(B);J=w(B)}if(J!==null)gt=!0;else{var be=w(U);be!==null&&sn(Mt,be.startTime-Xe),gt=!1}}break e}finally{J=null,W=Nt,K=!1}gt=void 0}}finally{gt?Di():Pt=!1}}}var Di;if(typeof He=="function")Di=function(){He(wi)};else if(typeof MessageChannel<"u"){var Ma=new MessageChannel,In=Ma.port2;Ma.port1.onmessage=wi,Di=function(){In.postMessage(null)}}else Di=function(){Fe(wi,0)};function sn(Xe,gt){_t=Fe(function(){Xe(h.unstable_now())},gt)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(Xe){Xe.callback=null},h.unstable_forceFrameRate=function(Xe){0>Xe||125<Xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ei=0<Xe?Math.floor(1e3/Xe):5},h.unstable_getCurrentPriorityLevel=function(){return W},h.unstable_next=function(Xe){switch(W){case 1:case 2:case 3:var gt=3;break;default:gt=W}var Nt=W;W=gt;try{return Xe()}finally{W=Nt}},h.unstable_requestPaint=function(){Pe=!0},h.unstable_runWithPriority=function(Xe,gt){switch(Xe){case 1:case 2:case 3:case 4:case 5:break;default:Xe=3}var Nt=W;W=Xe;try{return gt()}finally{W=Nt}},h.unstable_scheduleCallback=function(Xe,gt,Nt){var Lt=h.unstable_now();switch(typeof Nt=="object"&&Nt!==null?(Nt=Nt.delay,Nt=typeof Nt=="number"&&0<Nt?Lt+Nt:Lt):Nt=Lt,Xe){case 1:var Si=-1;break;case 2:Si=250;break;case 5:Si=1073741823;break;case 4:Si=1e4;break;default:Si=5e3}return Si=Nt+Si,Xe={id:ee++,callback:gt,priorityLevel:Xe,startTime:Nt,expirationTime:Si,sortIndex:-1},Nt>Lt?(Xe.sortIndex=Nt,y(U,Xe),w(B)===null&&Xe===w(U)&&(Ce?(Ue(_t),_t=-1):Ce=!0,sn(Mt,Nt-Lt))):(Xe.sortIndex=Si,y(B,Xe),ve||K||(ve=!0,Pt||(Pt=!0,Di()))),Xe},h.unstable_shouldYield=mi,h.unstable_wrapCallback=function(Xe){var gt=W;return function(){var Nt=W;W=gt;try{return Xe.apply(this,arguments)}finally{W=Nt}}}})(_g)),_g}var a_;function zy(){return a_||(a_=1,gg.exports=Py()),gg.exports}var yg={exports:{}},oi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n_;function Iy(){if(n_)return oi;n_=1;var h=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),E=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),U=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),J=Symbol.for("react.activity"),W=Symbol.iterator;function K(be){return be===null||typeof be!="object"?null:(be=W&&be[W]||be["@@iterator"],typeof be=="function"?be:null)}var ve={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ce=Object.assign,Pe={};function Fe(be,Ke,pt){this.props=be,this.context=Ke,this.refs=Pe,this.updater=pt||ve}Fe.prototype.isReactComponent={},Fe.prototype.setState=function(be,Ke){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Ke,"setState")},Fe.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function Ue(){}Ue.prototype=Fe.prototype;function He(be,Ke,pt){this.props=be,this.context=Ke,this.refs=Pe,this.updater=pt||ve}var mt=He.prototype=new Ue;mt.constructor=He,Ce(mt,Fe.prototype),mt.isPureReactComponent=!0;var Mt=Array.isArray;function Pt(){}var _t={H:null,A:null,T:null,S:null},ei=Object.prototype.hasOwnProperty;function Vt(be,Ke,pt){var Et=pt.ref;return{$$typeof:h,type:be,key:Ke,ref:Et!==void 0?Et:null,props:pt}}function mi(be,Ke){return Vt(be.type,Ke,be.props)}function wi(be){return typeof be=="object"&&be!==null&&be.$$typeof===h}function Di(be){var Ke={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(pt){return Ke[pt]})}var Ma=/\/+/g;function In(be,Ke){return typeof be=="object"&&be!==null&&be.key!=null?Di(""+be.key):Ke.toString(36)}function sn(be){switch(be.status){case"fulfilled":return be.value;case"rejected":throw be.reason;default:switch(typeof be.status=="string"?be.then(Pt,Pt):(be.status="pending",be.then(function(Ke){be.status==="pending"&&(be.status="fulfilled",be.value=Ke)},function(Ke){be.status==="pending"&&(be.status="rejected",be.reason=Ke)})),be.status){case"fulfilled":return be.value;case"rejected":throw be.reason}}throw be}function Xe(be,Ke,pt,Et,$t){var Ft=typeof be;(Ft==="undefined"||Ft==="boolean")&&(be=null);var gi=!1;if(be===null)gi=!0;else switch(Ft){case"bigint":case"string":case"number":gi=!0;break;case"object":switch(be.$$typeof){case h:case y:gi=!0;break;case ee:return gi=be._init,Xe(gi(be._payload),Ke,pt,Et,$t)}}if(gi)return $t=$t(be),gi=Et===""?"."+In(be,0):Et,Mt($t)?(pt="",gi!=null&&(pt=gi.replace(Ma,"$&/")+"/"),Xe($t,Ke,pt,"",function(Qr){return Qr})):$t!=null&&(wi($t)&&($t=mi($t,pt+($t.key==null||be&&be.key===$t.key?"":(""+$t.key).replace(Ma,"$&/")+"/")+gi)),Ke.push($t)),1;gi=0;var Qi=Et===""?".":Et+":";if(Mt(be))for(var Pi=0;Pi<be.length;Pi++)Et=be[Pi],Ft=Qi+In(Et,Pi),gi+=Xe(Et,Ke,pt,Ft,$t);else if(Pi=K(be),typeof Pi=="function")for(be=Pi.call(be),Pi=0;!(Et=be.next()).done;)Et=Et.value,Ft=Qi+In(Et,Pi++),gi+=Xe(Et,Ke,pt,Ft,$t);else if(Ft==="object"){if(typeof be.then=="function")return Xe(sn(be),Ke,pt,Et,$t);throw Ke=String(be),Error("Objects are not valid as a React child (found: "+(Ke==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Ke)+"). If you meant to render a collection of children, use an array instead.")}return gi}function gt(be,Ke,pt){if(be==null)return be;var Et=[],$t=0;return Xe(be,Et,"","",function(Ft){return Ke.call(pt,Ft,$t++)}),Et}function Nt(be){if(be._status===-1){var Ke=be._result;Ke=Ke(),Ke.then(function(pt){(be._status===0||be._status===-1)&&(be._status=1,be._result=pt)},function(pt){(be._status===0||be._status===-1)&&(be._status=2,be._result=pt)}),be._status===-1&&(be._status=0,be._result=Ke)}if(be._status===1)return be._result.default;throw be._result}var Lt=typeof reportError=="function"?reportError:function(be){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ke=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof be=="object"&&be!==null&&typeof be.message=="string"?String(be.message):String(be),error:be});if(!window.dispatchEvent(Ke))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",be);return}console.error(be)},Si={map:gt,forEach:function(be,Ke,pt){gt(be,function(){Ke.apply(this,arguments)},pt)},count:function(be){var Ke=0;return gt(be,function(){Ke++}),Ke},toArray:function(be){return gt(be,function(Ke){return Ke})||[]},only:function(be){if(!wi(be))throw Error("React.Children.only expected to receive a single React element child.");return be}};return oi.Activity=J,oi.Children=Si,oi.Component=Fe,oi.Fragment=w,oi.Profiler=P,oi.PureComponent=He,oi.StrictMode=A,oi.Suspense=B,oi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_t,oi.__COMPILER_RUNTIME={__proto__:null,c:function(be){return _t.H.useMemoCache(be)}},oi.cache=function(be){return function(){return be.apply(null,arguments)}},oi.cacheSignal=function(){return null},oi.cloneElement=function(be,Ke,pt){if(be==null)throw Error("The argument must be a React element, but you passed "+be+".");var Et=Ce({},be.props),$t=be.key;if(Ke!=null)for(Ft in Ke.key!==void 0&&($t=""+Ke.key),Ke)!ei.call(Ke,Ft)||Ft==="key"||Ft==="__self"||Ft==="__source"||Ft==="ref"&&Ke.ref===void 0||(Et[Ft]=Ke[Ft]);var Ft=arguments.length-2;if(Ft===1)Et.children=pt;else if(1<Ft){for(var gi=Array(Ft),Qi=0;Qi<Ft;Qi++)gi[Qi]=arguments[Qi+2];Et.children=gi}return Vt(be.type,$t,Et)},oi.createContext=function(be){return be={$$typeof:E,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null},be.Provider=be,be.Consumer={$$typeof:D,_context:be},be},oi.createElement=function(be,Ke,pt){var Et,$t={},Ft=null;if(Ke!=null)for(Et in Ke.key!==void 0&&(Ft=""+Ke.key),Ke)ei.call(Ke,Et)&&Et!=="key"&&Et!=="__self"&&Et!=="__source"&&($t[Et]=Ke[Et]);var gi=arguments.length-2;if(gi===1)$t.children=pt;else if(1<gi){for(var Qi=Array(gi),Pi=0;Pi<gi;Pi++)Qi[Pi]=arguments[Pi+2];$t.children=Qi}if(be&&be.defaultProps)for(Et in gi=be.defaultProps,gi)$t[Et]===void 0&&($t[Et]=gi[Et]);return Vt(be,Ft,$t)},oi.createRef=function(){return{current:null}},oi.forwardRef=function(be){return{$$typeof:l,render:be}},oi.isValidElement=wi,oi.lazy=function(be){return{$$typeof:ee,_payload:{_status:-1,_result:be},_init:Nt}},oi.memo=function(be,Ke){return{$$typeof:U,type:be,compare:Ke===void 0?null:Ke}},oi.startTransition=function(be){var Ke=_t.T,pt={};_t.T=pt;try{var Et=be(),$t=_t.S;$t!==null&&$t(pt,Et),typeof Et=="object"&&Et!==null&&typeof Et.then=="function"&&Et.then(Pt,Lt)}catch(Ft){Lt(Ft)}finally{Ke!==null&&pt.types!==null&&(Ke.types=pt.types),_t.T=Ke}},oi.unstable_useCacheRefresh=function(){return _t.H.useCacheRefresh()},oi.use=function(be){return _t.H.use(be)},oi.useActionState=function(be,Ke,pt){return _t.H.useActionState(be,Ke,pt)},oi.useCallback=function(be,Ke){return _t.H.useCallback(be,Ke)},oi.useContext=function(be){return _t.H.useContext(be)},oi.useDebugValue=function(){},oi.useDeferredValue=function(be,Ke){return _t.H.useDeferredValue(be,Ke)},oi.useEffect=function(be,Ke){return _t.H.useEffect(be,Ke)},oi.useEffectEvent=function(be){return _t.H.useEffectEvent(be)},oi.useId=function(){return _t.H.useId()},oi.useImperativeHandle=function(be,Ke,pt){return _t.H.useImperativeHandle(be,Ke,pt)},oi.useInsertionEffect=function(be,Ke){return _t.H.useInsertionEffect(be,Ke)},oi.useLayoutEffect=function(be,Ke){return _t.H.useLayoutEffect(be,Ke)},oi.useMemo=function(be,Ke){return _t.H.useMemo(be,Ke)},oi.useOptimistic=function(be,Ke){return _t.H.useOptimistic(be,Ke)},oi.useReducer=function(be,Ke,pt){return _t.H.useReducer(be,Ke,pt)},oi.useRef=function(be){return _t.H.useRef(be)},oi.useState=function(be){return _t.H.useState(be)},oi.useSyncExternalStore=function(be,Ke,pt){return _t.H.useSyncExternalStore(be,Ke,pt)},oi.useTransition=function(){return _t.H.useTransition()},oi.version="19.2.0",oi}var r_;function Og(){return r_||(r_=1,yg.exports=Iy()),yg.exports}var vg={exports:{}},Pr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s_;function Ry(){if(s_)return Pr;s_=1;var h=Og();function y(B){var U="https://react.dev/errors/"+B;if(1<arguments.length){U+="?args[]="+encodeURIComponent(arguments[1]);for(var ee=2;ee<arguments.length;ee++)U+="&args[]="+encodeURIComponent(arguments[ee])}return"Minified React error #"+B+"; visit "+U+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function w(){}var A={d:{f:w,r:function(){throw Error(y(522))},D:w,C:w,L:w,m:w,X:w,S:w,M:w},p:0,findDOMNode:null},P=Symbol.for("react.portal");function D(B,U,ee){var J=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:J==null?null:""+J,children:B,containerInfo:U,implementation:ee}}var E=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(B,U){if(B==="font")return"";if(typeof U=="string")return U==="use-credentials"?U:""}return Pr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Pr.createPortal=function(B,U){var ee=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!U||U.nodeType!==1&&U.nodeType!==9&&U.nodeType!==11)throw Error(y(299));return D(B,U,null,ee)},Pr.flushSync=function(B){var U=E.T,ee=A.p;try{if(E.T=null,A.p=2,B)return B()}finally{E.T=U,A.p=ee,A.d.f()}},Pr.preconnect=function(B,U){typeof B=="string"&&(U?(U=U.crossOrigin,U=typeof U=="string"?U==="use-credentials"?U:"":void 0):U=null,A.d.C(B,U))},Pr.prefetchDNS=function(B){typeof B=="string"&&A.d.D(B)},Pr.preinit=function(B,U){if(typeof B=="string"&&U&&typeof U.as=="string"){var ee=U.as,J=l(ee,U.crossOrigin),W=typeof U.integrity=="string"?U.integrity:void 0,K=typeof U.fetchPriority=="string"?U.fetchPriority:void 0;ee==="style"?A.d.S(B,typeof U.precedence=="string"?U.precedence:void 0,{crossOrigin:J,integrity:W,fetchPriority:K}):ee==="script"&&A.d.X(B,{crossOrigin:J,integrity:W,fetchPriority:K,nonce:typeof U.nonce=="string"?U.nonce:void 0})}},Pr.preinitModule=function(B,U){if(typeof B=="string")if(typeof U=="object"&&U!==null){if(U.as==null||U.as==="script"){var ee=l(U.as,U.crossOrigin);A.d.M(B,{crossOrigin:ee,integrity:typeof U.integrity=="string"?U.integrity:void 0,nonce:typeof U.nonce=="string"?U.nonce:void 0})}}else U==null&&A.d.M(B)},Pr.preload=function(B,U){if(typeof B=="string"&&typeof U=="object"&&U!==null&&typeof U.as=="string"){var ee=U.as,J=l(ee,U.crossOrigin);A.d.L(B,ee,{crossOrigin:J,integrity:typeof U.integrity=="string"?U.integrity:void 0,nonce:typeof U.nonce=="string"?U.nonce:void 0,type:typeof U.type=="string"?U.type:void 0,fetchPriority:typeof U.fetchPriority=="string"?U.fetchPriority:void 0,referrerPolicy:typeof U.referrerPolicy=="string"?U.referrerPolicy:void 0,imageSrcSet:typeof U.imageSrcSet=="string"?U.imageSrcSet:void 0,imageSizes:typeof U.imageSizes=="string"?U.imageSizes:void 0,media:typeof U.media=="string"?U.media:void 0})}},Pr.preloadModule=function(B,U){if(typeof B=="string")if(U){var ee=l(U.as,U.crossOrigin);A.d.m(B,{as:typeof U.as=="string"&&U.as!=="script"?U.as:void 0,crossOrigin:ee,integrity:typeof U.integrity=="string"?U.integrity:void 0})}else A.d.m(B)},Pr.requestFormReset=function(B){A.d.r(B)},Pr.unstable_batchedUpdates=function(B,U){return B(U)},Pr.useFormState=function(B,U,ee){return E.H.useFormState(B,U,ee)},Pr.useFormStatus=function(){return E.H.useHostTransitionStatus()},Pr.version="19.2.0",Pr}var o_;function Dy(){if(o_)return vg.exports;o_=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(y){console.error(y)}}return h(),vg.exports=Ry(),vg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l_;function ky(){if(l_)return vp;l_=1;var h=zy(),y=Og(),w=Dy();function A(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function P(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function D(i){var s=i,u=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(u=s.return),i=s.return;while(i)}return s.tag===3?u:null}function E(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function l(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function B(i){if(D(i)!==i)throw Error(A(188))}function U(i){var s=i.alternate;if(!s){if(s=D(i),s===null)throw Error(A(188));return s!==i?null:i}for(var u=i,g=s;;){var M=u.return;if(M===null)break;var z=M.alternate;if(z===null){if(g=M.return,g!==null){u=g;continue}break}if(M.child===z.child){for(z=M.child;z;){if(z===u)return B(M),i;if(z===g)return B(M),s;z=z.sibling}throw Error(A(188))}if(u.return!==g.return)u=M,g=z;else{for(var G=!1,Q=M.child;Q;){if(Q===u){G=!0,u=M,g=z;break}if(Q===g){G=!0,g=M,u=z;break}Q=Q.sibling}if(!G){for(Q=z.child;Q;){if(Q===u){G=!0,u=z,g=M;break}if(Q===g){G=!0,g=z,u=M;break}Q=Q.sibling}if(!G)throw Error(A(189))}}if(u.alternate!==g)throw Error(A(190))}if(u.tag!==3)throw Error(A(188));return u.stateNode.current===u?i:s}function ee(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=ee(i),s!==null)return s;i=i.sibling}return null}var J=Object.assign,W=Symbol.for("react.element"),K=Symbol.for("react.transitional.element"),ve=Symbol.for("react.portal"),Ce=Symbol.for("react.fragment"),Pe=Symbol.for("react.strict_mode"),Fe=Symbol.for("react.profiler"),Ue=Symbol.for("react.consumer"),He=Symbol.for("react.context"),mt=Symbol.for("react.forward_ref"),Mt=Symbol.for("react.suspense"),Pt=Symbol.for("react.suspense_list"),_t=Symbol.for("react.memo"),ei=Symbol.for("react.lazy"),Vt=Symbol.for("react.activity"),mi=Symbol.for("react.memo_cache_sentinel"),wi=Symbol.iterator;function Di(i){return i===null||typeof i!="object"?null:(i=wi&&i[wi]||i["@@iterator"],typeof i=="function"?i:null)}var Ma=Symbol.for("react.client.reference");function In(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Ma?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Ce:return"Fragment";case Fe:return"Profiler";case Pe:return"StrictMode";case Mt:return"Suspense";case Pt:return"SuspenseList";case Vt:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case ve:return"Portal";case He:return i.displayName||"Context";case Ue:return(i._context.displayName||"Context")+".Consumer";case mt:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case _t:return s=i.displayName||null,s!==null?s:In(i.type)||"Memo";case ei:s=i._payload,i=i._init;try{return In(i(s))}catch{}}return null}var sn=Array.isArray,Xe=y.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gt=w.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Nt={pending:!1,data:null,method:null,action:null},Lt=[],Si=-1;function be(i){return{current:i}}function Ke(i){0>Si||(i.current=Lt[Si],Lt[Si]=null,Si--)}function pt(i,s){Si++,Lt[Si]=i.current,i.current=s}var Et=be(null),$t=be(null),Ft=be(null),gi=be(null);function Qi(i,s){switch(pt(Ft,s),pt($t,i),pt(Et,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?lp(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=lp(s),i=bl(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Ke(Et),pt(Et,i)}function Pi(){Ke(Et),Ke($t),Ke(Ft)}function Qr(i){i.memoizedState!==null&&pt(gi,i);var s=Et.current,u=bl(s,i.type);s!==u&&(pt($t,i),pt(Et,u))}function bs(i){$t.current===i&&(Ke(Et),Ke($t)),gi.current===i&&(Ke(gi),je._currentValue=Nt)}var bn,fa;function qi(i){if(bn===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);bn=s&&s[1]||"",fa=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bn+i+fa}var qn=!1;function fr(i,s){if(!i||qn)return"";qn=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(s){var it=function(){throw Error()};if(Object.defineProperty(it.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(it,[])}catch(qe){var Ge=qe}Reflect.construct(i,[],it)}else{try{it.call()}catch(qe){Ge=qe}i.call(it.prototype)}}else{try{throw Error()}catch(qe){Ge=qe}(it=i())&&typeof it.catch=="function"&&it.catch(function(){})}}catch(qe){if(qe&&Ge&&typeof qe.stack=="string")return[qe.stack,Ge.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=g.DetermineComponentFrameRoot(),G=z[0],Q=z[1];if(G&&Q){var _e=G.split(`
`),Ne=Q.split(`
`);for(M=g=0;g<_e.length&&!_e[g].includes("DetermineComponentFrameRoot");)g++;for(;M<Ne.length&&!Ne[M].includes("DetermineComponentFrameRoot");)M++;if(g===_e.length||M===Ne.length)for(g=_e.length-1,M=Ne.length-1;1<=g&&0<=M&&_e[g]!==Ne[M];)M--;for(;1<=g&&0<=M;g--,M--)if(_e[g]!==Ne[M]){if(g!==1||M!==1)do if(g--,M--,0>M||_e[g]!==Ne[M]){var We=`
`+_e[g].replace(" at new "," at ");return i.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",i.displayName)),We}while(1<=g&&0<=M);break}}}finally{qn=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?qi(u):""}function jo(i,s){switch(i.tag){case 26:case 27:case 5:return qi(i.type);case 16:return qi("Lazy");case 13:return i.child!==s&&s!==null?qi("Suspense Fallback"):qi("Suspense");case 19:return qi("SuspenseList");case 0:case 15:return fr(i.type,!1);case 11:return fr(i.type.render,!1);case 1:return fr(i.type,!0);case 31:return qi("Activity");default:return""}}function Ks(i){try{var s="",u=null;do s+=jo(i,u),u=i,i=i.return;while(i);return s}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var wn=Object.prototype.hasOwnProperty,Js=h.unstable_scheduleCallback,Go=h.unstable_cancelCallback,eo=h.unstable_shouldYield,Kr=h.unstable_requestPaint,Na=h.unstable_now,dc=h.unstable_getCurrentPriorityLevel,Zn=h.unstable_ImmediatePriority,ws=h.unstable_UserBlockingPriority,Sn=h.unstable_NormalPriority,we=h.unstable_LowPriority,$=h.unstable_IdlePriority,H=h.log,ie=h.unstable_setDisableYieldValue,fe=null,pe=null;function xe(i){if(typeof H=="function"&&ie(i),pe&&typeof pe.setStrictMode=="function")try{pe.setStrictMode(fe,i)}catch{}}var Ie=Math.clz32?Math.clz32:at,Ee=Math.log,Ve=Math.LN2;function at(i){return i>>>=0,i===0?32:31-(Ee(i)/Ve|0)|0}var $e=256,xt=262144,It=4194304;function Ae(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ii(i,s,u){var g=i.pendingLanes;if(g===0)return 0;var M=0,z=i.suspendedLanes,G=i.pingedLanes;i=i.warmLanes;var Q=g&134217727;return Q!==0?(g=Q&~z,g!==0?M=Ae(g):(G&=Q,G!==0?M=Ae(G):u||(u=Q&~i,u!==0&&(M=Ae(u))))):(Q=g&~z,Q!==0?M=Ae(Q):G!==0?M=Ae(G):u||(u=g&~i,u!==0&&(M=Ae(u)))),M===0?0:s!==0&&s!==M&&(s&z)===0&&(z=M&-M,u=s&-s,z>=u||z===32&&(u&4194048)!==0)?s:M}function fi(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Tt(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ui(){var i=It;return It<<=1,(It&62914560)===0&&(It=4194304),i}function Ta(i){for(var s=[],u=0;31>u;u++)s.push(i);return s}function pa(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Pa(i,s,u,g,M,z){var G=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var Q=i.entanglements,_e=i.expirationTimes,Ne=i.hiddenUpdates;for(u=G&~u;0<u;){var We=31-Ie(u),it=1<<We;Q[We]=0,_e[We]=-1;var Ge=Ne[We];if(Ge!==null)for(Ne[We]=null,We=0;We<Ge.length;We++){var qe=Ge[We];qe!==null&&(qe.lane&=-536870913)}u&=~it}g!==0&&Ya(i,g,0),z!==0&&M===0&&i.tag!==0&&(i.suspendedLanes|=z&~(G&~s))}function Ya(i,s,u){i.pendingLanes|=s,i.suspendedLanes&=~s;var g=31-Ie(s);i.entangledLanes|=s,i.entanglements[g]=i.entanglements[g]|1073741824|u&261930}function Ni(i,s){var u=i.entangledLanes|=s;for(i=i.entanglements;u;){var g=31-Ie(u),M=1<<g;M&s|i[g]&s&&(i[g]|=s),u&=~M}}function za(i,s){var u=s&-s;return u=(u&42)!==0?1:Mi(u),(u&(i.suspendedLanes|s))!==0?0:u}function Mi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function tt(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ir(){var i=gt.p;return i!==0?i:(i=window.event,i===void 0?32:dn(i.type))}function Rn(i,s){var u=gt.p;try{return gt.p=i,s()}finally{gt.p=u}}var Ia=Math.random().toString(36).slice(2),_i="__reactFiber$"+Ia,nt="__reactProps$"+Ia,Xt="__reactContainer$"+Ia,Wt="__reactEvents$"+Ia,$n="__reactListeners$"+Ia,Jr="__reactHandles$"+Ia,Rr="__reactResources$"+Ia,Ht="__reactMarker$"+Ia;function to(i){delete i[_i],delete i[nt],delete i[Wt],delete i[$n],delete i[Jr]}function es(i){var s=i[_i];if(s)return s;for(var u=i.parentNode;u;){if(s=u[Xt]||u[_i]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(i=nf(i);i!==null;){if(u=i[_i])return u;i=nf(i)}return s}i=u,u=i.parentNode}return null}function pr(i){if(i=i[_i]||i[Xt]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function Ss(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(A(33))}function Dn(i){var s=i[Rr];return s||(s=i[Rr]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function oa(i){i[Ht]=!0}var ga=new Set,kn={};function zi(i,s){ts(i,s),ts(i+"Capture",s)}function ts(i,s){for(kn[i]=s,i=0;i<s.length;i++)ga.add(s[i])}var El=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hu={},io={};function Ms(i){return wn.call(io,i)?!0:wn.call(hu,i)?!1:El.test(i)?io[i]=!0:(hu[i]=!0,!1)}function fc(i,s,u){if(Ms(s))if(u===null)i.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var g=s.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+u)}}function Al(i,s,u){if(u===null)i.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+u)}}function is(i,s,u,g){if(g===null)i.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(s,u,""+g)}}function on(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ah(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function yf(i,s,u){var g=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var M=g.get,z=g.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return M.call(this)},set:function(G){u=""+G,z.call(this,G)}}),Object.defineProperty(i,s,{enumerable:g.enumerable}),{getValue:function(){return u},setValue:function(G){u=""+G},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function nh(i){if(!i._valueTracker){var s=ah(i)?"checked":"value";i._valueTracker=yf(i,s,""+i[s])}}function ud(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var u=s.getValue(),g="";return i&&(g=ah(i)?i.checked?"true":"false":i.value),i=g,i!==u?(s.setValue(i),!0):!1}function pc(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var rh=/[\n"\\]/g;function Wa(i){return i.replace(rh,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function mc(i,s,u,g,M,z,G,Q){i.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?i.type=G:i.removeAttribute("type"),s!=null?G==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+on(s)):i.value!==""+on(s)&&(i.value=""+on(s)):G!=="submit"&&G!=="reset"||i.removeAttribute("value"),s!=null?Ts(i,G,on(s)):u!=null?Ts(i,G,on(u)):g!=null&&i.removeAttribute("value"),M==null&&z!=null&&(i.defaultChecked=!!z),M!=null&&(i.checked=M&&typeof M!="function"&&typeof M!="symbol"),Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?i.name=""+on(Q):i.removeAttribute("name")}function sh(i,s,u,g,M,z,G,Q){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(i.type=z),s!=null||u!=null){if(!(z!=="submit"&&z!=="reset"||s!=null)){nh(i);return}u=u!=null?""+on(u):"",s=s!=null?""+on(s):u,Q||s===i.value||(i.value=s),i.defaultValue=s}g=g??M,g=typeof g!="function"&&typeof g!="symbol"&&!!g,i.checked=Q?i.checked:!!g,i.defaultChecked=!!g,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(i.name=G),nh(i)}function Ts(i,s,u){s==="number"&&pc(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function ao(i,s,u,g){if(i=i.options,s){s={};for(var M=0;M<u.length;M++)s["$"+u[M]]=!0;for(u=0;u<i.length;u++)M=s.hasOwnProperty("$"+i[u].value),i[u].selected!==M&&(i[u].selected=M),M&&g&&(i[u].defaultSelected=!0)}else{for(u=""+on(u),s=null,M=0;M<i.length;M++){if(i[M].value===u){i[M].selected=!0,g&&(i[M].defaultSelected=!0);return}s!==null||i[M].disabled||(s=i[M])}s!==null&&(s.selected=!0)}}function hd(i,s,u){if(s!=null&&(s=""+on(s),s!==i.value&&(i.value=s),u==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=u!=null?""+on(u):""}function Cl(i,s,u,g){if(s==null){if(g!=null){if(u!=null)throw Error(A(92));if(sn(g)){if(1<g.length)throw Error(A(93));g=g[0]}u=g}u==null&&(u=""),s=u}u=on(s),i.defaultValue=u,g=i.textContent,g===u&&g!==""&&g!==null&&(i.value=g),nh(i)}function as(i,s){if(s){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=s;return}}i.textContent=s}var oh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function pn(i,s,u){var g=s.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?g?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":g?i.setProperty(s,u):typeof u!="number"||u===0||oh.has(s)?s==="float"?i.cssFloat=u:i[s]=(""+u).trim():i[s]=u+"px"}function li(i,s,u){if(s!=null&&typeof s!="object")throw Error(A(62));if(i=i.style,u!=null){for(var g in u)!u.hasOwnProperty(g)||s!=null&&s.hasOwnProperty(g)||(g.indexOf("--")===0?i.setProperty(g,""):g==="float"?i.cssFloat="":i[g]="");for(var M in s)g=s[M],s.hasOwnProperty(M)&&u[M]!==g&&pn(i,M,g)}else for(var z in s)s.hasOwnProperty(z)&&pn(i,z,s[z])}function no(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jt(i){return Fo.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Hn(){}var Uo=null;function ro(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ja=null,_a=null;function Ga(i){var s=pr(i);if(s&&(i=s.stateNode)){var u=i[nt]||null;e:switch(i=s.stateNode,s.type){case"input":if(mc(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),s=u.name,u.type==="radio"&&s!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Wa(""+s)+'"][type="radio"]'),s=0;s<u.length;s++){var g=u[s];if(g!==i&&g.form===i.form){var M=g[nt]||null;if(!M)throw Error(A(90));mc(g,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(s=0;s<u.length;s++)g=u[s],g.form===i.form&&ud(g)}break e;case"textarea":hd(i,u.value,u.defaultValue);break e;case"select":s=u.value,s!=null&&ao(i,!!u.multiple,s,!1)}}}var Fa=!1;function Zi(i,s,u){if(Fa)return i(s,u);Fa=!0;try{var g=i(s);return g}finally{if(Fa=!1,(ja!==null||_a!==null)&&(jd(),ja&&(s=ja,i=_a,_a=ja=null,Ga(s),i)))for(s=0;s<i.length;s++)Ga(i[s])}}function ns(i,s){var u=i.stateNode;if(u===null)return null;var g=u[nt]||null;if(g===null)return null;u=g[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(i=i.type,g=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!g;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(A(231,s,typeof u));return u}var ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tn=!1;if(ma)try{var Qa={};Object.defineProperty(Qa,"passive",{get:function(){Tn=!0}}),window.addEventListener("test",Qa,Qa),window.removeEventListener("test",Qa,Qa)}catch{Tn=!1}var mr=null,Ii=null,Ki=null;function ai(){if(Ki)return Ki;var i,s=Ii,u=s.length,g,M="value"in mr?mr.value:mr.textContent,z=M.length;for(i=0;i<u&&s[i]===M[i];i++);var G=u-i;for(g=1;g<=G&&s[u-g]===M[z-g];g++);return Ki=M.slice(i,1<g?1-g:void 0)}function Bt(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Es(){return!0}function Qt(){return!1}function ln(i){function s(u,g,M,z,G){this._reactName=u,this._targetInst=M,this.type=g,this.nativeEvent=z,this.target=G,this.currentTarget=null;for(var Q in i)i.hasOwnProperty(Q)&&(u=i[Q],this[Q]=u?u(z):z[Q]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Es:Qt,this.isPropagationStopped=Qt,this}return J(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Es)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Es)},persist:function(){},isPersistent:Es}),s}var ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pl=ln(ya),As=J({},ya,{view:0,detail:0}),gc=ln(As),so,Vo,qo,Zo=J({},As,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_c,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==qo&&(qo&&i.type==="mousemove"?(so=i.screenX-qo.screenX,Vo=i.screenY-qo.screenY):Vo=so=0,qo=i),so)},movementY:function(i){return"movementY"in i?i.movementY:Vo}}),zl=ln(Zo),rs=J({},Zo,{dataTransfer:0}),Ka=ln(rs),$o=J({},As,{relatedTarget:0}),Ho=ln($o),oo=J({},ya,{animationName:0,elapsedTime:0,pseudoElement:0}),Ja=ln(oo),du=J({},ya,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),fu=ln(du),dd=J({},ya,{data:0}),fd=ln(dd),Ua={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Il={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pu(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=gr[i])?!!s[i]:!1}function _c(){return pu}var yc=J({},As,{key:function(i){if(i.key){var s=Ua[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Bt(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Il[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_c,charCode:function(i){return i.type==="keypress"?Bt(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Bt(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Cs=ln(yc),Dr=J({},Zo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lh=ln(Dr),mu=J({},As,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_c}),vf=ln(mu),ch=J({},ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),xf=ln(ch),gu=J({},Zo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),uh=ln(gu),_u=J({},ya,{newState:0,oldState:0}),Rl=ln(_u),hh=[9,13,27,32],Xn=ma&&"CompositionEvent"in window,Dl=null;ma&&"documentMode"in document&&(Dl=document.documentMode);var dh=ma&&"TextEvent"in window&&!Dl,Xo=ma&&(!Xn||Dl&&8<Dl&&11>=Dl),kl=" ",pd=!1;function vc(i,s){switch(i){case"keyup":return hh.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function md(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var kr=!1;function gd(i,s){switch(i){case"compositionend":return md(s);case"keypress":return s.which!==32?null:(pd=!0,kl);case"textInput":return i=s.data,i===kl&&pd?null:i;default:return null}}function fh(i,s){if(kr)return i==="compositionend"||!Xn&&vc(i,s)?(i=ai(),Ki=Ii=mr=null,kr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Xo&&s.locale!=="ko"?null:s.data;default:return null}}var _d={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ph(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!_d[i.type]:s==="textarea"}function yu(i,s,u,g){ja?_a?_a.push(g):_a=[g]:ja=g,s=td(s,"onChange"),0<s.length&&(u=new Pl("onChange","change",null,u,g),i.push({event:u,listeners:s}))}var Ll=null,Ol=null;function xc(i){gm(i,0)}function bc(i){var s=Ss(i);if(ud(s))return i}function lo(i,s){if(i==="change")return s}var mh=!1;if(ma){var vu;if(ma){var Ps="oninput"in document;if(!Ps){var gh=document.createElement("div");gh.setAttribute("oninput","return;"),Ps=typeof gh.oninput=="function"}vu=Ps}else vu=!1;mh=vu&&(!document.documentMode||9<document.documentMode)}function wc(){Ll&&(Ll.detachEvent("onpropertychange",yd),Ol=Ll=null)}function yd(i){if(i.propertyName==="value"&&bc(Ol)){var s=[];yu(s,Ol,i,ro(i)),Zi(xc,s)}}function vd(i,s,u){i==="focusin"?(wc(),Ll=s,Ol=u,Ll.attachEvent("onpropertychange",yd)):i==="focusout"&&wc()}function _h(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return bc(Ol)}function xd(i,s){if(i==="click")return bc(s)}function bd(i,s){if(i==="input"||i==="change")return bc(s)}function yh(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var En=typeof Object.is=="function"?Object.is:yh;function co(i,s){if(En(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var u=Object.keys(i),g=Object.keys(s);if(u.length!==g.length)return!1;for(g=0;g<u.length;g++){var M=u[g];if(!wn.call(s,M)||!En(i[M],s[M]))return!1}return!0}function ss(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function xu(i,s){var u=ss(i);i=0;for(var g;u;){if(u.nodeType===3){if(g=i+u.textContent.length,i<=s&&g>=s)return{node:u,offset:s-i};i=g}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=ss(u)}}function bu(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?bu(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function yi(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=pc(i.document);s instanceof i.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)i=s.contentWindow;else break;s=pc(i.document)}return s}function wu(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var vh=ma&&"documentMode"in document&&11>=document.documentMode,_r=null,Sc=null,Mc=null,xh=!1;function wd(i,s,u){var g=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;xh||_r==null||_r!==pc(g)||(g=_r,"selectionStart"in g&&wu(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Mc&&co(Mc,g)||(Mc=g,g=td(Sc,"onSelect"),0<g.length&&(s=new Pl("onSelect","select",null,s,u),i.push({event:s,listeners:g}),s.target=_r)))}function Yo(i,s){var u={};return u[i.toLowerCase()]=s.toLowerCase(),u["Webkit"+i]="webkit"+s,u["Moz"+i]="moz"+s,u}var Wo={animationend:Yo("Animation","AnimationEnd"),animationiteration:Yo("Animation","AnimationIteration"),animationstart:Yo("Animation","AnimationStart"),transitionrun:Yo("Transition","TransitionRun"),transitionstart:Yo("Transition","TransitionStart"),transitioncancel:Yo("Transition","TransitionCancel"),transitionend:Yo("Transition","TransitionEnd")},bh={},wh={};ma&&(wh=document.createElement("div").style,"AnimationEvent"in window||(delete Wo.animationend.animation,delete Wo.animationiteration.animation,delete Wo.animationstart.animation),"TransitionEvent"in window||delete Wo.transitionend.transition);function os(i){if(bh[i])return bh[i];if(!Wo[i])return i;var s=Wo[i],u;for(u in s)if(s.hasOwnProperty(u)&&u in wh)return bh[i]=s[u];return i}var Tc=os("animationend"),Ec=os("animationiteration"),Su=os("animationstart"),Qo=os("transitionrun"),Ac=os("transitionstart"),Bl=os("transitioncancel"),Yn=os("transitionend"),Sh=new Map,Mu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Mu.push("scrollEnd");function Wn(i,s){Sh.set(i,s),zi(s,[i])}var ls=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},An=[],zs=0,Ko=0;function Jo(){for(var i=zs,s=Ko=zs=0;s<i;){var u=An[s];An[s++]=null;var g=An[s];An[s++]=null;var M=An[s];An[s++]=null;var z=An[s];if(An[s++]=null,g!==null&&M!==null){var G=g.pending;G===null?M.next=M:(M.next=G.next,G.next=M),g.pending=M}z!==0&&Mh(u,M,z)}}function Cc(i,s,u,g){An[zs++]=i,An[zs++]=s,An[zs++]=u,An[zs++]=g,Ko|=g,i.lanes|=g,i=i.alternate,i!==null&&(i.lanes|=g)}function uo(i,s,u,g){return Cc(i,s,u,g),ho(i)}function yr(i,s){return Cc(i,null,null,s),ho(i)}function Mh(i,s,u){i.lanes|=u;var g=i.alternate;g!==null&&(g.lanes|=u);for(var M=!1,z=i.return;z!==null;)z.childLanes|=u,g=z.alternate,g!==null&&(g.childLanes|=u),z.tag===22&&(i=z.stateNode,i===null||i._visibility&1||(M=!0)),i=z,z=z.return;return i.tag===3?(z=i.stateNode,M&&s!==null&&(M=31-Ie(u),i=z.hiddenUpdates,g=i[M],g===null?i[M]=[s]:g.push(s),s.lane=u|536870912),z):null}function ho(i){if(50<ba)throw ba=0,Hh=null,Error(A(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Kt={};function Tu(i,s,u,g){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(i,s,u,g){return new Tu(i,s,u,g)}function Pc(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Kn(i,s){var u=i.alternate;return u===null?(u=Qn(i.tag,s,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=s,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,s=i.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function Sd(i,s){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,s=u.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function el(i,s,u,g,M,z){var G=0;if(g=i,typeof i=="function")Pc(i)&&(G=1);else if(typeof i=="string")G=V(i,u,Et.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case Vt:return i=Qn(31,u,s,M),i.elementType=Vt,i.lanes=z,i;case Ce:return Is(u.children,M,z,s);case Pe:G=8,M|=24;break;case Fe:return i=Qn(12,u,s,M|2),i.elementType=Fe,i.lanes=z,i;case Mt:return i=Qn(13,u,s,M),i.elementType=Mt,i.lanes=z,i;case Pt:return i=Qn(19,u,s,M),i.elementType=Pt,i.lanes=z,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case He:G=10;break e;case Ue:G=9;break e;case mt:G=11;break e;case _t:G=14;break e;case ei:G=16,g=null;break e}G=29,u=Error(A(130,i===null?"null":typeof i,"")),g=null}return s=Qn(G,u,s,M),s.elementType=i,s.type=g,s.lanes=z,s}function Is(i,s,u,g){return i=Qn(7,i,g,s),i.lanes=u,i}function Th(i,s,u){return i=Qn(6,i,null,s),i.lanes=u,i}function Eu(i){var s=Qn(18,null,null,0);return s.stateNode=i,s}function Nl(i,s,u){return s=Qn(4,i.children!==null?i.children:[],i.key,s),s.lanes=u,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var zc=new WeakMap;function Cn(i,s){if(typeof i=="object"&&i!==null){var u=zc.get(i);return u!==void 0?u:(s={value:i,source:s,stack:Ks(s)},zc.set(i,s),s)}return{value:i,source:s,stack:Ks(s)}}var Rs=[],fo=0,tl=null,po=0,mn=[],en=0,Lr=null,cs=1,Ln="";function Ds(i,s){Rs[fo++]=po,Rs[fo++]=tl,tl=i,po=s}function Eh(i,s,u){mn[en++]=cs,mn[en++]=Ln,mn[en++]=Lr,Lr=i;var g=cs;i=Ln;var M=32-Ie(g)-1;g&=~(1<<M),u+=1;var z=32-Ie(s)+M;if(30<z){var G=M-M%5;z=(g&(1<<G)-1).toString(32),g>>=G,M-=G,cs=1<<32-Ie(s)+M|u<<M|g,Ln=z+i}else cs=1<<z|u<<M|g,Ln=i}function il(i){i.return!==null&&(Ds(i,1),Eh(i,1,0))}function jl(i){for(;i===tl;)tl=Rs[--fo],Rs[fo]=null,po=Rs[--fo],Rs[fo]=null;for(;i===Lr;)Lr=mn[--en],mn[en]=null,Ln=mn[--en],mn[en]=null,cs=mn[--en],mn[en]=null}function Ic(i,s){mn[en++]=cs,mn[en++]=Ln,mn[en++]=Lr,cs=s.id,Ln=s.overflow,Lr=i}var Ra=null,ki=null,ci=!1,Or=null,Jn=!1,la=Error(A(519));function On(i){var s=Error(A(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw us(Cn(s,i)),la}function er(i){var s=i.stateNode,u=i.type,g=i.memoizedProps;switch(s[_i]=i,s[nt]=g,u){case"dialog":xi("cancel",s),xi("close",s);break;case"iframe":case"object":case"embed":xi("load",s);break;case"video":case"audio":for(u=0;u<Jh.length;u++)xi(Jh[u],s);break;case"source":xi("error",s);break;case"img":case"image":case"link":xi("error",s),xi("load",s);break;case"details":xi("toggle",s);break;case"input":xi("invalid",s),sh(s,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":xi("invalid",s);break;case"textarea":xi("invalid",s),Cl(s,g.value,g.defaultValue,g.children)}u=g.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||s.textContent===""+u||g.suppressHydrationWarning===!0||sp(s.textContent,u)?(g.popover!=null&&(xi("beforetoggle",s),xi("toggle",s)),g.onScroll!=null&&xi("scroll",s),g.onScrollEnd!=null&&xi("scrollend",s),g.onClick!=null&&(s.onclick=Hn),s=!0):s=!1,s||On(i,!0)}function Au(i){for(Ra=i.return;Ra;)switch(Ra.tag){case 5:case 31:case 13:Jn=!1;return;case 27:case 3:Jn=!0;return;default:Ra=Ra.return}}function ks(i){if(i!==Ra)return!1;if(!ci)return Au(i),ci=!0,!1;var s=i.tag,u;if((u=s!==3&&s!==27)&&((u=s===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||Jd(i.type,i.memoizedProps)),u=!u),u&&ki&&On(i),Au(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(A(317));ki=dp(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(A(317));ki=dp(i)}else s===27?(s=ki,Ws(i.type)?(i=af,af=null,ki=i):ki=s):ki=Ra?Tr(i.stateNode.nextSibling):null;return!0}function Ls(){ki=Ra=null,ci=!1}function Os(){var i=Or;return i!==null&&(lr===null?lr=i:lr.push.apply(lr,i),Or=null),i}function us(i){Or===null?Or=[i]:Or.push(i)}var al=be(null),hs=null,Br=null;function Bs(i,s,u){pt(al,s._currentValue),s._currentValue=u}function Nr(i){i._currentValue=al.current,Ke(al)}function Rc(i,s,u){for(;i!==null;){var g=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,g!==null&&(g.childLanes|=s)):g!==null&&(g.childLanes&s)!==s&&(g.childLanes|=s),i===u)break;i=i.return}}function mo(i,s,u,g){var M=i.child;for(M!==null&&(M.return=i);M!==null;){var z=M.dependencies;if(z!==null){var G=M.child;z=z.firstContext;e:for(;z!==null;){var Q=z;z=M;for(var _e=0;_e<s.length;_e++)if(Q.context===s[_e]){z.lanes|=u,Q=z.alternate,Q!==null&&(Q.lanes|=u),Rc(z.return,u,i),g||(G=null);break e}z=Q.next}}else if(M.tag===18){if(G=M.return,G===null)throw Error(A(341));G.lanes|=u,z=G.alternate,z!==null&&(z.lanes|=u),Rc(G,u,i),G=null}else G=M.child;if(G!==null)G.return=M;else for(G=M;G!==null;){if(G===i){G=null;break}if(M=G.sibling,M!==null){M.return=G.return,G=M;break}G=G.return}M=G}}function vr(i,s,u,g){i=null;for(var M=s,z=!1;M!==null;){if(!z){if((M.flags&524288)!==0)z=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var G=M.alternate;if(G===null)throw Error(A(387));if(G=G.memoizedProps,G!==null){var Q=M.type;En(M.pendingProps.value,G.value)||(i!==null?i.push(Q):i=[Q])}}else if(M===gi.current){if(G=M.alternate,G===null)throw Error(A(387));G.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(i!==null?i.push(je):i=[je])}M=M.return}i!==null&&mo(s,i,u,g),s.flags|=262144}function Dc(i){for(i=i.firstContext;i!==null;){if(!En(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function go(i){hs=i,Br=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function tn(i){return Ah(hs,i)}function kc(i,s){return hs===null&&go(i),Ah(i,s)}function Ah(i,s){var u=s._currentValue;if(s={context:s,memoizedValue:u,next:null},Br===null){if(i===null)throw Error(A(308));Br=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Br=Br.next=s;return u}var Gl=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(u,g){i.push(g)}};this.abort=function(){s.aborted=!0,i.forEach(function(u){return u()})}},Fl=h.unstable_scheduleCallback,Bn=h.unstable_NormalPriority,$i={$$typeof:He,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lc(){return{controller:new Gl,data:new Map,refCount:0}}function gn(i){i.refCount--,i.refCount===0&&Fl(Bn,function(){i.controller.abort()})}var Pn=null,_o=0,cn=0,tr=null;function bf(i,s){if(Pn===null){var u=Pn=[];_o=0,cn=nc(),tr={status:"pending",value:void 0,then:function(g){u.push(g)}}}return _o++,s.then(Cu,Cu),s}function Cu(){if(--_o===0&&Pn!==null){tr!==null&&(tr.status="fulfilled");var i=Pn;Pn=null,cn=0,tr=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function wf(i,s){var u=[],g={status:"pending",value:null,reason:null,then:function(M){u.push(M)}};return i.then(function(){g.status="fulfilled",g.value=s;for(var M=0;M<u.length;M++)(0,u[M])(s)},function(M){for(g.status="rejected",g.reason=M,M=0;M<u.length;M++)(0,u[M])(void 0)}),g}var Ul=Xe.S;Xe.S=function(i,s){sm=Na(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&bf(i,s),Ul!==null&&Ul(i,s)};var yo=be(null);function nl(){var i=yo.current;return i!==null?i:Wi.pooledCache}function xr(i,s){s===null?pt(yo,yo.current):pt(yo,s.pool)}function ft(){var i=nl();return i===null?null:{parent:$i._currentValue,pool:i}}var rl=Error(A(460)),Oc=Error(A(474)),vo=Error(A(542)),xo={then:function(){}};function bo(i){return i=i.status,i==="fulfilled"||i==="rejected"}function sl(i,s,u){switch(u=i[u],u===void 0?i.push(s):u!==s&&(s.then(Hn,Hn),s=u),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Bc(i),i;default:if(typeof s.status=="string")s.then(Hn,Hn);else{if(i=Wi,i!==null&&100<i.shellSuspendCounter)throw Error(A(482));i=s,i.status="pending",i.then(function(g){if(s.status==="pending"){var M=s;M.status="fulfilled",M.value=g}},function(g){if(s.status==="pending"){var M=s;M.status="rejected",M.reason=g}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Bc(i),i}throw ds=s,rl}}function Yt(i){try{var s=i._init;return s(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(ds=u,rl):u}}var ds=null;function Ch(){if(ds===null)throw Error(A(459));var i=ds;return ds=null,i}function Bc(i){if(i===rl||i===vo)throw Error(A(483))}var wo=null,Vl=0;function Nc(i){var s=Vl;return Vl+=1,wo===null&&(wo=[]),sl(wo,i,s)}function So(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function jc(i,s){throw s.$$typeof===W?Error(A(525)):(i=Object.prototype.toString.call(s),Error(A(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Ph(i){function s(ze,Me){if(i){var Be=ze.deletions;Be===null?(ze.deletions=[Me],ze.flags|=16):Be.push(Me)}}function u(ze,Me){if(!i)return null;for(;Me!==null;)s(ze,Me),Me=Me.sibling;return null}function g(ze){for(var Me=new Map;ze!==null;)ze.key!==null?Me.set(ze.key,ze):Me.set(ze.index,ze),ze=ze.sibling;return Me}function M(ze,Me){return ze=Kn(ze,Me),ze.index=0,ze.sibling=null,ze}function z(ze,Me,Be){return ze.index=Be,i?(Be=ze.alternate,Be!==null?(Be=Be.index,Be<Me?(ze.flags|=67108866,Me):Be):(ze.flags|=67108866,Me)):(ze.flags|=1048576,Me)}function G(ze){return i&&ze.alternate===null&&(ze.flags|=67108866),ze}function Q(ze,Me,Be,Je){return Me===null||Me.tag!==6?(Me=Th(Be,ze.mode,Je),Me.return=ze,Me):(Me=M(Me,Be),Me.return=ze,Me)}function _e(ze,Me,Be,Je){var Ot=Be.type;return Ot===Ce?We(ze,Me,Be.props.children,Je,Be.key):Me!==null&&(Me.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===ei&&Yt(Ot)===Me.type)?(Me=M(Me,Be.props),So(Me,Be),Me.return=ze,Me):(Me=el(Be.type,Be.key,Be.props,null,ze.mode,Je),So(Me,Be),Me.return=ze,Me)}function Ne(ze,Me,Be,Je){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==Be.containerInfo||Me.stateNode.implementation!==Be.implementation?(Me=Nl(Be,ze.mode,Je),Me.return=ze,Me):(Me=M(Me,Be.children||[]),Me.return=ze,Me)}function We(ze,Me,Be,Je,Ot){return Me===null||Me.tag!==7?(Me=Is(Be,ze.mode,Je,Ot),Me.return=ze,Me):(Me=M(Me,Be),Me.return=ze,Me)}function it(ze,Me,Be){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=Th(""+Me,ze.mode,Be),Me.return=ze,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case K:return Be=el(Me.type,Me.key,Me.props,null,ze.mode,Be),So(Be,Me),Be.return=ze,Be;case ve:return Me=Nl(Me,ze.mode,Be),Me.return=ze,Me;case ei:return Me=Yt(Me),it(ze,Me,Be)}if(sn(Me)||Di(Me))return Me=Is(Me,ze.mode,Be,null),Me.return=ze,Me;if(typeof Me.then=="function")return it(ze,Nc(Me),Be);if(Me.$$typeof===He)return it(ze,kc(ze,Me),Be);jc(ze,Me)}return null}function Ge(ze,Me,Be,Je){var Ot=Me!==null?Me.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return Ot!==null?null:Q(ze,Me,""+Be,Je);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case K:return Be.key===Ot?_e(ze,Me,Be,Je):null;case ve:return Be.key===Ot?Ne(ze,Me,Be,Je):null;case ei:return Be=Yt(Be),Ge(ze,Me,Be,Je)}if(sn(Be)||Di(Be))return Ot!==null?null:We(ze,Me,Be,Je,null);if(typeof Be.then=="function")return Ge(ze,Me,Nc(Be),Je);if(Be.$$typeof===He)return Ge(ze,Me,kc(ze,Be),Je);jc(ze,Be)}return null}function qe(ze,Me,Be,Je,Ot){if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return ze=ze.get(Be)||null,Q(Me,ze,""+Je,Ot);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case K:return ze=ze.get(Je.key===null?Be:Je.key)||null,_e(Me,ze,Je,Ot);case ve:return ze=ze.get(Je.key===null?Be:Je.key)||null,Ne(Me,ze,Je,Ot);case ei:return Je=Yt(Je),qe(ze,Me,Be,Je,Ot)}if(sn(Je)||Di(Je))return ze=ze.get(Be)||null,We(Me,ze,Je,Ot,null);if(typeof Je.then=="function")return qe(ze,Me,Be,Nc(Je),Ot);if(Je.$$typeof===He)return qe(ze,Me,Be,kc(Me,Je),Ot);jc(Me,Je)}return null}function zt(ze,Me,Be,Je){for(var Ot=null,Bi=null,yt=Me,Gt=Me=0,ri=null;yt!==null&&Gt<Be.length;Gt++){yt.index>Gt?(ri=yt,yt=null):ri=yt.sibling;var si=Ge(ze,yt,Be[Gt],Je);if(si===null){yt===null&&(yt=ri);break}i&&yt&&si.alternate===null&&s(ze,yt),Me=z(si,Me,Gt),Bi===null?Ot=si:Bi.sibling=si,Bi=si,yt=ri}if(Gt===Be.length)return u(ze,yt),ci&&Ds(ze,Gt),Ot;if(yt===null){for(;Gt<Be.length;Gt++)yt=it(ze,Be[Gt],Je),yt!==null&&(Me=z(yt,Me,Gt),Bi===null?Ot=yt:Bi.sibling=yt,Bi=yt);return ci&&Ds(ze,Gt),Ot}for(yt=g(yt);Gt<Be.length;Gt++)ri=qe(yt,ze,Gt,Be[Gt],Je),ri!==null&&(i&&ri.alternate!==null&&yt.delete(ri.key===null?Gt:ri.key),Me=z(ri,Me,Gt),Bi===null?Ot=ri:Bi.sibling=ri,Bi=ri);return i&&yt.forEach(function(Cr){return s(ze,Cr)}),ci&&Ds(ze,Gt),Ot}function Zt(ze,Me,Be,Je){if(Be==null)throw Error(A(151));for(var Ot=null,Bi=null,yt=Me,Gt=Me=0,ri=null,si=Be.next();yt!==null&&!si.done;Gt++,si=Be.next()){yt.index>Gt?(ri=yt,yt=null):ri=yt.sibling;var Cr=Ge(ze,yt,si.value,Je);if(Cr===null){yt===null&&(yt=ri);break}i&&yt&&Cr.alternate===null&&s(ze,yt),Me=z(Cr,Me,Gt),Bi===null?Ot=Cr:Bi.sibling=Cr,Bi=Cr,yt=ri}if(si.done)return u(ze,yt),ci&&Ds(ze,Gt),Ot;if(yt===null){for(;!si.done;Gt++,si=Be.next())si=it(ze,si.value,Je),si!==null&&(Me=z(si,Me,Gt),Bi===null?Ot=si:Bi.sibling=si,Bi=si);return ci&&Ds(ze,Gt),Ot}for(yt=g(yt);!si.done;Gt++,si=Be.next())si=qe(yt,ze,Gt,si.value,Je),si!==null&&(i&&si.alternate!==null&&yt.delete(si.key===null?Gt:si.key),Me=z(si,Me,Gt),Bi===null?Ot=si:Bi.sibling=si,Bi=si);return i&&yt.forEach(function(Bo){return s(ze,Bo)}),ci&&Ds(ze,Gt),Ot}function ta(ze,Me,Be,Je){if(typeof Be=="object"&&Be!==null&&Be.type===Ce&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case K:e:{for(var Ot=Be.key;Me!==null;){if(Me.key===Ot){if(Ot=Be.type,Ot===Ce){if(Me.tag===7){u(ze,Me.sibling),Je=M(Me,Be.props.children),Je.return=ze,ze=Je;break e}}else if(Me.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===ei&&Yt(Ot)===Me.type){u(ze,Me.sibling),Je=M(Me,Be.props),So(Je,Be),Je.return=ze,ze=Je;break e}u(ze,Me);break}else s(ze,Me);Me=Me.sibling}Be.type===Ce?(Je=Is(Be.props.children,ze.mode,Je,Be.key),Je.return=ze,ze=Je):(Je=el(Be.type,Be.key,Be.props,null,ze.mode,Je),So(Je,Be),Je.return=ze,ze=Je)}return G(ze);case ve:e:{for(Ot=Be.key;Me!==null;){if(Me.key===Ot)if(Me.tag===4&&Me.stateNode.containerInfo===Be.containerInfo&&Me.stateNode.implementation===Be.implementation){u(ze,Me.sibling),Je=M(Me,Be.children||[]),Je.return=ze,ze=Je;break e}else{u(ze,Me);break}else s(ze,Me);Me=Me.sibling}Je=Nl(Be,ze.mode,Je),Je.return=ze,ze=Je}return G(ze);case ei:return Be=Yt(Be),ta(ze,Me,Be,Je)}if(sn(Be))return zt(ze,Me,Be,Je);if(Di(Be)){if(Ot=Di(Be),typeof Ot!="function")throw Error(A(150));return Be=Ot.call(Be),Zt(ze,Me,Be,Je)}if(typeof Be.then=="function")return ta(ze,Me,Nc(Be),Je);if(Be.$$typeof===He)return ta(ze,Me,kc(ze,Be),Je);jc(ze,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint"?(Be=""+Be,Me!==null&&Me.tag===6?(u(ze,Me.sibling),Je=M(Me,Be),Je.return=ze,ze=Je):(u(ze,Me),Je=Th(Be,ze.mode,Je),Je.return=ze,ze=Je),G(ze)):u(ze,Me)}return function(ze,Me,Be,Je){try{Vl=0;var Ot=ta(ze,Me,Be,Je);return wo=null,Ot}catch(yt){if(yt===rl||yt===vo)throw yt;var Bi=Qn(29,yt,null,ze.mode);return Bi.lanes=Je,Bi.return=ze,Bi}finally{}}}var Mo=Ph(!0),zh=Ph(!1),Ns=!1;function fs(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Li(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function js(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function br(i,s,u){var g=i.updateQueue;if(g===null)return null;if(g=g.shared,(Ei&2)!==0){var M=g.pending;return M===null?s.next=s:(s.next=M.next,M.next=s),g.pending=s,s=ho(i),Mh(i,null,u),s}return Cc(i,g,s,u),ho(i)}function To(i,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194048)!==0)){var g=s.lanes;g&=i.pendingLanes,u|=g,s.lanes=u,Ni(i,u)}}function Gc(i,s){var u=i.updateQueue,g=i.alternate;if(g!==null&&(g=g.updateQueue,u===g)){var M=null,z=null;if(u=u.firstBaseUpdate,u!==null){do{var G={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};z===null?M=z=G:z=z.next=G,u=u.next}while(u!==null);z===null?M=z=s:z=z.next=s}else M=z=s;u={baseState:g.baseState,firstBaseUpdate:M,lastBaseUpdate:z,shared:g.shared,callbacks:g.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=s:i.next=s,u.lastBaseUpdate=s}var ol=!1;function ql(){if(ol){var i=tr;if(i!==null)throw i}}function ll(i,s,u,g){ol=!1;var M=i.updateQueue;Ns=!1;var z=M.firstBaseUpdate,G=M.lastBaseUpdate,Q=M.shared.pending;if(Q!==null){M.shared.pending=null;var _e=Q,Ne=_e.next;_e.next=null,G===null?z=Ne:G.next=Ne,G=_e;var We=i.alternate;We!==null&&(We=We.updateQueue,Q=We.lastBaseUpdate,Q!==G&&(Q===null?We.firstBaseUpdate=Ne:Q.next=Ne,We.lastBaseUpdate=_e))}if(z!==null){var it=M.baseState;G=0,We=Ne=_e=null,Q=z;do{var Ge=Q.lane&-536870913,qe=Ge!==Q.lane;if(qe?(bi&Ge)===Ge:(g&Ge)===Ge){Ge!==0&&Ge===cn&&(ol=!0),We!==null&&(We=We.next={lane:0,tag:Q.tag,payload:Q.payload,callback:null,next:null});e:{var zt=i,Zt=Q;Ge=s;var ta=u;switch(Zt.tag){case 1:if(zt=Zt.payload,typeof zt=="function"){it=zt.call(ta,it,Ge);break e}it=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=Zt.payload,Ge=typeof zt=="function"?zt.call(ta,it,Ge):zt,Ge==null)break e;it=J({},it,Ge);break e;case 2:Ns=!0}}Ge=Q.callback,Ge!==null&&(i.flags|=64,qe&&(i.flags|=8192),qe=M.callbacks,qe===null?M.callbacks=[Ge]:qe.push(Ge))}else qe={lane:Ge,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},We===null?(Ne=We=qe,_e=it):We=We.next=qe,G|=Ge;if(Q=Q.next,Q===null){if(Q=M.shared.pending,Q===null)break;qe=Q,Q=qe.next,qe.next=null,M.lastBaseUpdate=qe,M.shared.pending=null}}while(!0);We===null&&(_e=it),M.baseState=_e,M.firstBaseUpdate=Ne,M.lastBaseUpdate=We,z===null&&(M.shared.lanes=0),tc|=G,i.lanes=G,i.memoizedState=it}}function jr(i,s){if(typeof i!="function")throw Error(A(191,i));i.call(s)}function Fc(i,s){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)jr(u[i],s)}var vt=be(null),Rt=be(0);function cl(i,s){i=Ro,pt(Rt,i),pt(vt,s),Ro=i|s.baseLanes}function Pu(){pt(Rt,Ro),pt(vt,vt.current)}function Zl(){Ro=Rt.current,Ke(vt),Ke(Rt)}var Hi=be(null),ir=null;function an(i){var s=i.alternate;pt(Ji,Ji.current&1),pt(Hi,i),ir===null&&(s===null||vt.current!==null||s.memoizedState!==null)&&(ir=i)}function Gs(i){pt(Ji,Ji.current),pt(Hi,i),ir===null&&(ir=i)}function Md(i){i.tag===22?(pt(Ji,Ji.current),pt(Hi,i),ir===null&&(ir=i)):Eo()}function Eo(){pt(Ji,Ji.current),pt(Hi,Hi.current)}function ar(i){Ke(Hi),ir===i&&(ir=null),Ke(Ji)}var Ji=be(0);function Xi(i){for(var s=i;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||hp(u)||sc(u)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Oi=0,qt=null,Ti=null,na=null,ul=!1,ps=!1,Fs=!1,Gr=0,Fr=0,Ao=null,zu=0;function Fi(){throw Error(A(321))}function Uc(i,s){if(s===null)return!1;for(var u=0;u<s.length&&u<i.length;u++)if(!En(i[u],s[u]))return!1;return!0}function Vc(i,s,u,g,M,z){return Oi=z,qt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Xe.H=i===null||i.memoizedState===null?Ru:gs,Fs=!1,z=u(g,M),Fs=!1,ps&&(z=Iu(s,u,g,M)),qc(i),z}function qc(i){Xe.H=dl;var s=Ti!==null&&Ti.next!==null;if(Oi=0,na=Ti=qt=null,ul=!1,Fr=0,Ao=null,s)throw Error(A(300));i===null||Va||(i=i.dependencies,i!==null&&Dc(i)&&(Va=!0))}function Iu(i,s,u,g){qt=i;var M=0;do{if(ps&&(Ao=null),Fr=0,ps=!1,25<=M)throw Error(A(301));if(M+=1,na=Ti=null,i.updateQueue!=null){var z=i.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}Xe.H=Du,z=s(u,g)}while(ps);return z}function p(){var i=Xe.H,s=i.useState()[0];return s=typeof s.then=="function"?T(s):s,i=i.useState()[0],(Ti!==null?Ti.memoizedState:null)!==i&&(qt.flags|=1024),s}function e(){var i=Gr!==0;return Gr=0,i}function r(i,s,u){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~u}function c(i){if(ul){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}ul=!1}Oi=0,na=Ti=qt=null,ps=!1,Fr=Gr=0,Ao=null}function f(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return na===null?qt.memoizedState=na=i:na=na.next=i,na}function m(){if(Ti===null){var i=qt.alternate;i=i!==null?i.memoizedState:null}else i=Ti.next;var s=na===null?qt.memoizedState:na.next;if(s!==null)na=s,Ti=i;else{if(i===null)throw qt.alternate===null?Error(A(467)):Error(A(310));Ti=i,i={memoizedState:Ti.memoizedState,baseState:Ti.baseState,baseQueue:Ti.baseQueue,queue:Ti.queue,next:null},na===null?qt.memoizedState=na=i:na=na.next=i}return na}function x(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function T(i){var s=Fr;return Fr+=1,Ao===null&&(Ao=[]),i=sl(Ao,i,s),s=qt,(na===null?s.memoizedState:na.next)===null&&(s=s.alternate,Xe.H=s===null||s.memoizedState===null?Ru:gs),i}function C(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return T(i);if(i.$$typeof===He)return tn(i)}throw Error(A(438,String(i)))}function k(i){var s=null,u=qt.updateQueue;if(u!==null&&(s=u.memoCache),s==null){var g=qt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(s={data:g.data.map(function(M){return M.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),u===null&&(u=x(),qt.updateQueue=u),u.memoCache=s,u=s.data[s.index],u===void 0)for(u=s.data[s.index]=Array(i),g=0;g<i;g++)u[g]=mi;return s.index++,u}function L(i,s){return typeof s=="function"?s(i):s}function j(i){var s=m();return N(s,Ti,i)}function N(i,s,u){var g=i.queue;if(g===null)throw Error(A(311));g.lastRenderedReducer=u;var M=i.baseQueue,z=g.pending;if(z!==null){if(M!==null){var G=M.next;M.next=z.next,z.next=G}s.baseQueue=M=z,g.pending=null}if(z=i.baseState,M===null)i.memoizedState=z;else{s=M.next;var Q=G=null,_e=null,Ne=s,We=!1;do{var it=Ne.lane&-536870913;if(it!==Ne.lane?(bi&it)===it:(Oi&it)===it){var Ge=Ne.revertLane;if(Ge===0)_e!==null&&(_e=_e.next={lane:0,revertLane:0,gesture:null,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),it===cn&&(We=!0);else if((Oi&Ge)===Ge){Ne=Ne.next,Ge===cn&&(We=!0);continue}else it={lane:0,revertLane:Ne.revertLane,gesture:null,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},_e===null?(Q=_e=it,G=z):_e=_e.next=it,qt.lanes|=Ge,tc|=Ge;it=Ne.action,Fs&&u(z,it),z=Ne.hasEagerState?Ne.eagerState:u(z,it)}else Ge={lane:it,revertLane:Ne.revertLane,gesture:Ne.gesture,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},_e===null?(Q=_e=Ge,G=z):_e=_e.next=Ge,qt.lanes|=it,tc|=it;Ne=Ne.next}while(Ne!==null&&Ne!==s);if(_e===null?G=z:_e.next=Q,!En(z,i.memoizedState)&&(Va=!0,We&&(u=tr,u!==null)))throw u;i.memoizedState=z,i.baseState=G,i.baseQueue=_e,g.lastRenderedState=z}return M===null&&(g.lanes=0),[i.memoizedState,g.dispatch]}function q(i){var s=m(),u=s.queue;if(u===null)throw Error(A(311));u.lastRenderedReducer=i;var g=u.dispatch,M=u.pending,z=s.memoizedState;if(M!==null){u.pending=null;var G=M=M.next;do z=i(z,G.action),G=G.next;while(G!==M);En(z,s.memoizedState)||(Va=!0),s.memoizedState=z,s.baseQueue===null&&(s.baseState=z),u.lastRenderedState=z}return[z,g]}function X(i,s,u){var g=qt,M=m(),z=ci;if(z){if(u===void 0)throw Error(A(407));u=u()}else u=s();var G=!En((Ti||M).memoizedState,u);if(G&&(M.memoizedState=u,Va=!0),M=M.queue,ni(re.bind(null,g,M,i),[i]),M.getSnapshot!==s||G||na!==null&&na.memoizedState.tag&1){if(g.flags|=2048,pi(9,{destroy:void 0},ne.bind(null,g,M,u,s),null),Wi===null)throw Error(A(349));z||(Oi&127)!==0||ae(g,s,u)}return u}function ae(i,s,u){i.flags|=16384,i={getSnapshot:s,value:u},s=qt.updateQueue,s===null?(s=x(),qt.updateQueue=s,s.stores=[i]):(u=s.stores,u===null?s.stores=[i]:u.push(i))}function ne(i,s,u,g){s.value=u,s.getSnapshot=g,le(s)&&ue(i)}function re(i,s,u){return u(function(){le(s)&&ue(i)})}function le(i){var s=i.getSnapshot;i=i.value;try{var u=s();return!En(i,u)}catch{return!0}}function ue(i){var s=yr(i,2);s!==null&&Fn(s,i,2)}function ce(i){var s=f();if(typeof i=="function"){var u=i;if(i=u(),Fs){xe(!0);try{u()}finally{xe(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:L,lastRenderedState:i},s}function me(i,s,u,g){return i.baseState=u,N(i,Ti,typeof g=="function"?g:L)}function ye(i,s,u,g,M){if(Gn(i))throw Error(A(485));if(i=s.action,i!==null){var z={payload:M,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){z.listeners.push(G)}};Xe.T!==null?u(!0):z.isTransition=!1,g(z),u=s.pending,u===null?(z.next=s.pending=z,he(s,z)):(z.next=u.next,s.pending=u.next=z)}}function he(i,s){var u=s.action,g=s.payload,M=i.state;if(s.isTransition){var z=Xe.T,G={};Xe.T=G;try{var Q=u(M,g),_e=Xe.S;_e!==null&&_e(G,Q),Se(i,s,Q)}catch(Ne){Re(i,s,Ne)}finally{z!==null&&G.types!==null&&(z.types=G.types),Xe.T=z}}else try{z=u(M,g),Se(i,s,z)}catch(Ne){Re(i,s,Ne)}}function Se(i,s,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(g){Oe(i,s,g)},function(g){return Re(i,s,g)}):Oe(i,s,u)}function Oe(i,s,u){s.status="fulfilled",s.value=u,ke(s),i.state=u,s=i.pending,s!==null&&(u=s.next,u===s?i.pending=null:(u=u.next,s.next=u,he(i,u)))}function Re(i,s,u){var g=i.pending;if(i.pending=null,g!==null){g=g.next;do s.status="rejected",s.reason=u,ke(s),s=s.next;while(s!==g)}i.action=null}function ke(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function Le(i,s){return s}function rt(i,s){if(ci){var u=Wi.formState;if(u!==null){e:{var g=qt;if(ci){if(ki){t:{for(var M=ki,z=Jn;M.nodeType!==8;){if(!z){M=null;break t}if(M=Tr(M.nextSibling),M===null){M=null;break t}}z=M.data,M=z==="F!"||z==="F"?M:null}if(M){ki=Tr(M.nextSibling),g=M.data==="F!";break e}}On(g)}g=!1}g&&(s=u[0])}}return u=f(),u.memoizedState=u.baseState=s,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Le,lastRenderedState:s},u.queue=g,u=Hl.bind(null,qt,g),g.dispatch=u,g=ce(!1),z=qr.bind(null,qt,!1,g.queue),g=f(),M={state:s,dispatch:null,action:i,pending:null},g.queue=M,u=ye.bind(null,qt,M,z,u),M.dispatch=u,g.memoizedState=i,[s,u,!1]}function st(i){var s=m();return Qe(s,Ti,i)}function Qe(i,s,u){if(s=N(i,s,Le)[0],i=j(L)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var g=T(s)}catch(G){throw G===rl?vo:G}else g=s;s=m();var M=s.queue,z=M.dispatch;return u!==s.memoizedState&&(qt.flags|=2048,pi(9,{destroy:void 0},wt.bind(null,M,u),null)),[g,z,i]}function wt(i,s){i.action=s}function Ut(i){var s=m(),u=Ti;if(u!==null)return Qe(s,u,i);m(),s=s.memoizedState,u=m();var g=u.queue.dispatch;return u.memoizedState=i,[s,g,!1]}function pi(i,s,u,g){return i={tag:i,create:u,deps:g,inst:s,next:null},s=qt.updateQueue,s===null&&(s=x(),qt.updateQueue=s),u=s.lastEffect,u===null?s.lastEffect=i.next=i:(g=u.next,u.next=i,i.next=g,s.lastEffect=i),i}function Ai(){return m().memoizedState}function Ci(i,s,u,g){var M=f();qt.flags|=i,M.memoizedState=pi(1|s,{destroy:void 0},u,g===void 0?null:g)}function Yi(i,s,u,g){var M=m();g=g===void 0?null:g;var z=M.memoizedState.inst;Ti!==null&&g!==null&&Uc(g,Ti.memoizedState.deps)?M.memoizedState=pi(s,z,u,g):(qt.flags|=i,M.memoizedState=pi(1|s,z,u,g))}function Ui(i,s){Ci(8390656,8,i,s)}function ni(i,s){Yi(2048,8,i,s)}function ra(i){qt.flags|=4;var s=qt.updateQueue;if(s===null)s=x(),qt.updateQueue=s,s.events=[i];else{var u=s.events;u===null?s.events=[i]:u.push(i)}}function nn(i){var s=m().memoizedState;return ra({ref:s,nextImpl:i}),function(){if((Ei&2)!==0)throw Error(A(440));return s.impl.apply(void 0,arguments)}}function va(i,s){return Yi(4,2,i,s)}function xa(i,s){return Yi(4,4,i,s)}function _n(i,s){if(typeof s=="function"){i=i();var u=s(i);return function(){typeof u=="function"?u():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Us(i,s,u){u=u!=null?u.concat([i]):null,Yi(4,4,_n.bind(null,s,i),u)}function nr(){}function Vs(i,s){var u=m();s=s===void 0?null:s;var g=u.memoizedState;return s!==null&&Uc(s,g[1])?g[0]:(u.memoizedState=[i,s],i)}function Co(i,s){var u=m();s=s===void 0?null:s;var g=u.memoizedState;if(s!==null&&Uc(s,g[1]))return g[0];if(g=i(),Fs){xe(!0);try{i()}finally{xe(!1)}}return u.memoizedState=[g,s],g}function $l(i,s,u){return u===void 0||(Oi&1073741824)!==0&&(bi&261930)===0?i.memoizedState=s:(i.memoizedState=u,i=Uf(),qt.lanes|=i,tc|=i,u)}function hl(i,s,u,g){return En(u,s)?u:vt.current!==null?(i=$l(i,u,g),En(i,s)||(Va=!0),i):(Oi&42)===0||(Oi&1073741824)!==0&&(bi&261930)===0?(Va=!0,i.memoizedState=u):(i=Uf(),qt.lanes|=i,tc|=i,s)}function ms(i,s,u,g,M){var z=gt.p;gt.p=z!==0&&8>z?z:8;var G=Xe.T,Q={};Xe.T=Q,qr(i,!1,s,u);try{var _e=M(),Ne=Xe.S;if(Ne!==null&&Ne(Q,_e),_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var We=wf(_e,g);Vr(i,s,We,Mr(i))}else Vr(i,s,g,Mr(i))}catch(it){Vr(i,s,{then:function(){},status:"rejected",reason:it},Mr())}finally{gt.p=z,G!==null&&Q.types!==null&&(G.types=Q.types),Xe.T=G}}function rr(){}function wr(i,s,u,g){if(i.tag!==5)throw Error(A(476));var M=Ur(i).queue;ms(i,M,s,Nt,u===null?rr:function(){return Nn(i),u(g)})}function Ur(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Nt,baseState:Nt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:L,lastRenderedState:Nt},next:null};var u={};return s.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:L,lastRenderedState:u},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Nn(i){var s=Ur(i);s.next===null&&(s=i.alternate.memoizedState),Vr(i,s.next.queue,{},Mr())}function ca(){return tn(je)}function Da(){return m().memoizedState}function jn(){return m().memoizedState}function rn(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var u=Mr();i=js(u);var g=br(s,i,u);g!==null&&(Fn(g,s,u),To(g,s,u)),s={cache:Lc()},i.payload=s;return}s=s.return}}function Ih(i,s,u){var g=Mr();u={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Gn(i)?qs(s,u):(u=uo(i,s,u,g),u!==null&&(Fn(u,i,g),Zs(u,s,g)))}function Hl(i,s,u){var g=Mr();Vr(i,s,u,g)}function Vr(i,s,u,g){var M={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Gn(i))qs(s,M);else{var z=i.alternate;if(i.lanes===0&&(z===null||z.lanes===0)&&(z=s.lastRenderedReducer,z!==null))try{var G=s.lastRenderedState,Q=z(G,u);if(M.hasEagerState=!0,M.eagerState=Q,En(Q,G))return Cc(i,s,M,0),Wi===null&&Jo(),!1}catch{}finally{}if(u=uo(i,s,M,g),u!==null)return Fn(u,i,g),Zs(u,s,g),!0}return!1}function qr(i,s,u,g){if(g={lane:2,revertLane:nc(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Gn(i)){if(s)throw Error(A(479))}else s=uo(i,u,g,2),s!==null&&Fn(s,i,2)}function Gn(i){var s=i.alternate;return i===qt||s!==null&&s===qt}function qs(i,s){ps=ul=!0;var u=i.pending;u===null?s.next=s:(s.next=u.next,u.next=s),i.pending=s}function Zs(i,s,u){if((u&4194048)!==0){var g=s.lanes;g&=i.pendingLanes,u|=g,s.lanes=u,Ni(i,u)}}var dl={readContext:tn,use:C,useCallback:Fi,useContext:Fi,useEffect:Fi,useImperativeHandle:Fi,useLayoutEffect:Fi,useInsertionEffect:Fi,useMemo:Fi,useReducer:Fi,useRef:Fi,useState:Fi,useDebugValue:Fi,useDeferredValue:Fi,useTransition:Fi,useSyncExternalStore:Fi,useId:Fi,useHostTransitionStatus:Fi,useFormState:Fi,useActionState:Fi,useOptimistic:Fi,useMemoCache:Fi,useCacheRefresh:Fi};dl.useEffectEvent=Fi;var Ru={readContext:tn,use:C,useCallback:function(i,s){return f().memoizedState=[i,s===void 0?null:s],i},useContext:tn,useEffect:Ui,useImperativeHandle:function(i,s,u){u=u!=null?u.concat([i]):null,Ci(4194308,4,_n.bind(null,s,i),u)},useLayoutEffect:function(i,s){return Ci(4194308,4,i,s)},useInsertionEffect:function(i,s){Ci(4,2,i,s)},useMemo:function(i,s){var u=f();s=s===void 0?null:s;var g=i();if(Fs){xe(!0);try{i()}finally{xe(!1)}}return u.memoizedState=[g,s],g},useReducer:function(i,s,u){var g=f();if(u!==void 0){var M=u(s);if(Fs){xe(!0);try{u(s)}finally{xe(!1)}}}else M=s;return g.memoizedState=g.baseState=M,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:M},g.queue=i,i=i.dispatch=Ih.bind(null,qt,i),[g.memoizedState,i]},useRef:function(i){var s=f();return i={current:i},s.memoizedState=i},useState:function(i){i=ce(i);var s=i.queue,u=Hl.bind(null,qt,s);return s.dispatch=u,[i.memoizedState,u]},useDebugValue:nr,useDeferredValue:function(i,s){var u=f();return $l(u,i,s)},useTransition:function(){var i=ce(!1);return i=ms.bind(null,qt,i.queue,!0,!1),f().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,u){var g=qt,M=f();if(ci){if(u===void 0)throw Error(A(407));u=u()}else{if(u=s(),Wi===null)throw Error(A(349));(bi&127)!==0||ae(g,s,u)}M.memoizedState=u;var z={value:u,getSnapshot:s};return M.queue=z,Ui(re.bind(null,g,z,i),[i]),g.flags|=2048,pi(9,{destroy:void 0},ne.bind(null,g,z,u,s),null),u},useId:function(){var i=f(),s=Wi.identifierPrefix;if(ci){var u=Ln,g=cs;u=(g&~(1<<32-Ie(g)-1)).toString(32)+u,s="_"+s+"R_"+u,u=Gr++,0<u&&(s+="H"+u.toString(32)),s+="_"}else u=zu++,s="_"+s+"r_"+u.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:ca,useFormState:rt,useActionState:rt,useOptimistic:function(i){var s=f();s.memoizedState=s.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=u,s=qr.bind(null,qt,!0,u),u.dispatch=s,[i,s]},useMemoCache:k,useCacheRefresh:function(){return f().memoizedState=rn.bind(null,qt)},useEffectEvent:function(i){var s=f(),u={impl:i};return s.memoizedState=u,function(){if((Ei&2)!==0)throw Error(A(440));return u.impl.apply(void 0,arguments)}}},gs={readContext:tn,use:C,useCallback:Vs,useContext:tn,useEffect:ni,useImperativeHandle:Us,useInsertionEffect:va,useLayoutEffect:xa,useMemo:Co,useReducer:j,useRef:Ai,useState:function(){return j(L)},useDebugValue:nr,useDeferredValue:function(i,s){var u=m();return hl(u,Ti.memoizedState,i,s)},useTransition:function(){var i=j(L)[0],s=m().memoizedState;return[typeof i=="boolean"?i:T(i),s]},useSyncExternalStore:X,useId:Da,useHostTransitionStatus:ca,useFormState:st,useActionState:st,useOptimistic:function(i,s){var u=m();return me(u,Ti,i,s)},useMemoCache:k,useCacheRefresh:jn};gs.useEffectEvent=nn;var Du={readContext:tn,use:C,useCallback:Vs,useContext:tn,useEffect:ni,useImperativeHandle:Us,useInsertionEffect:va,useLayoutEffect:xa,useMemo:Co,useReducer:q,useRef:Ai,useState:function(){return q(L)},useDebugValue:nr,useDeferredValue:function(i,s){var u=m();return Ti===null?$l(u,i,s):hl(u,Ti.memoizedState,i,s)},useTransition:function(){var i=q(L)[0],s=m().memoizedState;return[typeof i=="boolean"?i:T(i),s]},useSyncExternalStore:X,useId:Da,useHostTransitionStatus:ca,useFormState:Ut,useActionState:Ut,useOptimistic:function(i,s){var u=m();return Ti!==null?me(u,Ti,i,s):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:k,useCacheRefresh:jn};Du.useEffectEvent=nn;function Zc(i,s,u,g){s=i.memoizedState,u=u(g,s),u=u==null?s:J({},s,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var fl={enqueueSetState:function(i,s,u){i=i._reactInternals;var g=Mr(),M=js(g);M.payload=s,u!=null&&(M.callback=u),s=br(i,M,g),s!==null&&(Fn(s,i,g),To(s,i,g))},enqueueReplaceState:function(i,s,u){i=i._reactInternals;var g=Mr(),M=js(g);M.tag=1,M.payload=s,u!=null&&(M.callback=u),s=br(i,M,g),s!==null&&(Fn(s,i,g),To(s,i,g))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var u=Mr(),g=js(u);g.tag=2,s!=null&&(g.callback=s),s=br(i,g,u),s!==null&&(Fn(s,i,u),To(s,i,u))}};function Sf(i,s,u,g,M,z,G){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(g,z,G):s.prototype&&s.prototype.isPureReactComponent?!co(u,g)||!co(M,z):!0}function Xl(i,s,u,g){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,g),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,g),s.state!==i&&fl.enqueueReplaceState(s,s.state,null)}function Zr(i,s){var u=s;if("ref"in s){u={};for(var g in s)g!=="ref"&&(u[g]=s[g])}if(i=i.defaultProps){u===s&&(u=J({},u));for(var M in i)u[M]===void 0&&(u[M]=i[M])}return u}function Mf(i){ls(i)}function Vp(i){console.error(i)}function Td(i){ls(i)}function Rh(i,s){try{var u=i.onUncaughtError;u(s.value,{componentStack:s.stack})}catch(g){setTimeout(function(){throw g})}}function Dh(i,s,u){try{var g=i.onCaughtError;g(u.value,{componentStack:u.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Ed(i,s,u){return u=js(u),u.tag=3,u.payload={element:null},u.callback=function(){Rh(i,s)},u}function qp(i){return i=js(i),i.tag=3,i}function Ad(i,s,u,g){var M=u.type.getDerivedStateFromError;if(typeof M=="function"){var z=g.value;i.payload=function(){return M(z)},i.callback=function(){Dh(s,u,g)}}var G=u.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(i.callback=function(){Dh(s,u,g),typeof M!="function"&&(yl===null?yl=new Set([this]):yl.add(this));var Q=g.stack;this.componentDidCatch(g.value,{componentStack:Q!==null?Q:""})})}function Km(i,s,u,g,M){if(u.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(s=u.alternate,s!==null&&vr(s,u,M,!0),u=Hi.current,u!==null){switch(u.tag){case 31:case 13:return ir===null?Gd():u.alternate===null&&ka===0&&(ka=3),u.flags&=-257,u.flags|=65536,u.lanes=M,g===xo?u.flags|=16384:(s=u.updateQueue,s===null?u.updateQueue=new Set([g]):s.add(g),Wh(i,g,M)),!1;case 22:return u.flags|=65536,g===xo?u.flags|=16384:(s=u.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([g])},u.updateQueue=s):(u=s.retryQueue,u===null?s.retryQueue=new Set([g]):u.add(g)),Wh(i,g,M)),!1}throw Error(A(435,u.tag))}return Wh(i,g,M),Gd(),!1}if(ci)return s=Hi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=M,g!==la&&(i=Error(A(422),{cause:g}),us(Cn(i,u)))):(g!==la&&(s=Error(A(423),{cause:g}),us(Cn(s,u))),i=i.current.alternate,i.flags|=65536,M&=-M,i.lanes|=M,g=Cn(g,u),M=Ed(i.stateNode,g,M),Gc(i,M),ka!==4&&(ka=2)),!1;var z=Error(A(520),{cause:g});if(z=Cn(z,u),eu===null?eu=[z]:eu.push(z),ka!==4&&(ka=2),s===null)return!0;g=Cn(g,u),u=s;do{switch(u.tag){case 3:return u.flags|=65536,i=M&-M,u.lanes|=i,i=Ed(u.stateNode,g,i),Gc(u,i),!1;case 1:if(s=u.type,z=u.stateNode,(u.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(yl===null||!yl.has(z))))return u.flags|=65536,M&=-M,u.lanes|=M,M=qp(M),Ad(M,i,u,g),Gc(u,M),!1}u=u.return}while(u!==null);return!1}var kh=Error(A(461)),Va=!1;function yn(i,s,u,g){s.child=i===null?zh(s,null,u,g):Mo(s,i.child,u,g)}function $c(i,s,u,g,M){u=u.render;var z=s.ref;if("ref"in g){var G={};for(var Q in g)Q!=="ref"&&(G[Q]=g[Q])}else G=g;return go(s),g=Vc(i,s,u,G,z,M),Q=e(),i!==null&&!Va?(r(i,s,M),$s(i,s,M)):(ci&&Q&&il(s),s.flags|=1,yn(i,s,g,M),s.child)}function Zp(i,s,u,g,M){if(i===null){var z=u.type;return typeof z=="function"&&!Pc(z)&&z.defaultProps===void 0&&u.compare===null?(s.tag=15,s.type=z,Hc(i,s,z,g,M)):(i=el(u.type,null,g,s,s.mode,M),i.ref=s.ref,i.return=s,s.child=i)}if(z=i.child,!Pf(i,M)){var G=z.memoizedProps;if(u=u.compare,u=u!==null?u:co,u(G,g)&&i.ref===s.ref)return $s(i,s,M)}return s.flags|=1,i=Kn(z,g),i.ref=s.ref,i.return=s,s.child=i}function Hc(i,s,u,g,M){if(i!==null){var z=i.memoizedProps;if(co(z,g)&&i.ref===s.ref)if(Va=!1,s.pendingProps=g=z,Pf(i,M))(i.flags&131072)!==0&&(Va=!0);else return s.lanes=i.lanes,$s(i,s,M)}return Bh(i,s,u,g,M)}function Lh(i,s,u,g){var M=g.children,z=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((s.flags&128)!==0){if(z=z!==null?z.baseLanes|u:u,i!==null){for(g=s.child=i.child,M=0;g!==null;)M=M|g.lanes|g.childLanes,g=g.sibling;g=M&~z}else g=0,s.child=null;return $p(i,s,z,u,g)}if((u&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&xr(s,z!==null?z.cachePool:null),z!==null?cl(s,z):Pu(),Md(s);else return g=s.lanes=536870912,$p(i,s,z!==null?z.baseLanes|u:u,u,g)}else z!==null?(xr(s,z.cachePool),cl(s,z),Eo(),s.memoizedState=null):(i!==null&&xr(s,null),Pu(),Eo());return yn(i,s,M,u),s.child}function Yl(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function $p(i,s,u,g,M){var z=nl();return z=z===null?null:{parent:$i._currentValue,pool:z},s.memoizedState={baseLanes:u,cachePool:z},i!==null&&xr(s,null),Pu(),Md(s),i!==null&&vr(i,s,g,!0),s.childLanes=M,null}function Cd(i,s){return s=jh({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function Hp(i,s,u){return Mo(s,i.child,null,u),i=Cd(s,s.pendingProps),i.flags|=2,ar(s),s.memoizedState=null,i}function Jm(i,s,u){var g=s.pendingProps,M=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(ci){if(g.mode==="hidden")return i=Cd(s,g),s.lanes=536870912,Yl(null,i);if(Gs(s),(i=ki)?(i=Sm(i,Jn),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Lr!==null?{id:cs,overflow:Ln}:null,retryLane:536870912,hydrationErrors:null},u=Eu(i),u.return=s,s.child=u,Ra=s,ki=null)):i=null,i===null)throw On(s);return s.lanes=536870912,null}return Cd(s,g)}var z=i.memoizedState;if(z!==null){var G=z.dehydrated;if(Gs(s),M)if(s.flags&256)s.flags&=-257,s=Hp(i,s,u);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(A(558));else if(Va||vr(i,s,u,!1),M=(u&i.childLanes)!==0,Va||M){if(g=Wi,g!==null&&(G=za(g,u),G!==0&&G!==z.retryLane))throw z.retryLane=G,yr(i,G),Fn(g,i,G),kh;Gd(),s=Hp(i,s,u)}else i=z.treeContext,ki=Tr(G.nextSibling),Ra=s,ci=!0,Or=null,Jn=!1,i!==null&&Ic(s,i),s=Cd(s,g),s.flags|=4096;return s}return i=Kn(i.child,{mode:g.mode,children:g.children}),i.ref=s.ref,s.child=i,i.return=s,i}function Oh(i,s){var u=s.ref;if(u===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(A(284));(i===null||i.ref!==u)&&(s.flags|=4194816)}}function Bh(i,s,u,g,M){return go(s),u=Vc(i,s,u,g,void 0,M),g=e(),i!==null&&!Va?(r(i,s,M),$s(i,s,M)):(ci&&g&&il(s),s.flags|=1,yn(i,s,u,M),s.child)}function Tf(i,s,u,g,M,z){return go(s),s.updateQueue=null,u=Iu(s,g,u,M),qc(i),g=e(),i!==null&&!Va?(r(i,s,z),$s(i,s,z)):(ci&&g&&il(s),s.flags|=1,yn(i,s,u,z),s.child)}function Ef(i,s,u,g,M){if(go(s),s.stateNode===null){var z=Kt,G=u.contextType;typeof G=="object"&&G!==null&&(z=tn(G)),z=new u(g,z),s.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=fl,s.stateNode=z,z._reactInternals=s,z=s.stateNode,z.props=g,z.state=s.memoizedState,z.refs={},fs(s),G=u.contextType,z.context=typeof G=="object"&&G!==null?tn(G):Kt,z.state=s.memoizedState,G=u.getDerivedStateFromProps,typeof G=="function"&&(Zc(s,u,G,g),z.state=s.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(G=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),G!==z.state&&fl.enqueueReplaceState(z,z.state,null),ll(s,g,z,M),ql(),z.state=s.memoizedState),typeof z.componentDidMount=="function"&&(s.flags|=4194308),g=!0}else if(i===null){z=s.stateNode;var Q=s.memoizedProps,_e=Zr(u,Q);z.props=_e;var Ne=z.context,We=u.contextType;G=Kt,typeof We=="object"&&We!==null&&(G=tn(We));var it=u.getDerivedStateFromProps;We=typeof it=="function"||typeof z.getSnapshotBeforeUpdate=="function",Q=s.pendingProps!==Q,We||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(Q||Ne!==G)&&Xl(s,z,g,G),Ns=!1;var Ge=s.memoizedState;z.state=Ge,ll(s,g,z,M),ql(),Ne=s.memoizedState,Q||Ge!==Ne||Ns?(typeof it=="function"&&(Zc(s,u,it,g),Ne=s.memoizedState),(_e=Ns||Sf(s,u,_e,g,Ge,Ne,G))?(We||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(s.flags|=4194308)):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=g,s.memoizedState=Ne),z.props=g,z.state=Ne,z.context=G,g=_e):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),g=!1)}else{z=s.stateNode,Li(i,s),G=s.memoizedProps,We=Zr(u,G),z.props=We,it=s.pendingProps,Ge=z.context,Ne=u.contextType,_e=Kt,typeof Ne=="object"&&Ne!==null&&(_e=tn(Ne)),Q=u.getDerivedStateFromProps,(Ne=typeof Q=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(G!==it||Ge!==_e)&&Xl(s,z,g,_e),Ns=!1,Ge=s.memoizedState,z.state=Ge,ll(s,g,z,M),ql();var qe=s.memoizedState;G!==it||Ge!==qe||Ns||i!==null&&i.dependencies!==null&&Dc(i.dependencies)?(typeof Q=="function"&&(Zc(s,u,Q,g),qe=s.memoizedState),(We=Ns||Sf(s,u,We,g,Ge,qe,_e)||i!==null&&i.dependencies!==null&&Dc(i.dependencies))?(Ne||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(g,qe,_e),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(g,qe,_e)),typeof z.componentDidUpdate=="function"&&(s.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof z.componentDidUpdate!="function"||G===i.memoizedProps&&Ge===i.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||G===i.memoizedProps&&Ge===i.memoizedState||(s.flags|=1024),s.memoizedProps=g,s.memoizedState=qe),z.props=g,z.state=qe,z.context=_e,g=We):(typeof z.componentDidUpdate!="function"||G===i.memoizedProps&&Ge===i.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||G===i.memoizedProps&&Ge===i.memoizedState||(s.flags|=1024),g=!1)}return z=g,Oh(i,s),g=(s.flags&128)!==0,z||g?(z=s.stateNode,u=g&&typeof u.getDerivedStateFromError!="function"?null:z.render(),s.flags|=1,i!==null&&g?(s.child=Mo(s,i.child,null,M),s.child=Mo(s,null,u,M)):yn(i,s,u,M),s.memoizedState=z.state,i=s.child):i=$s(i,s,M),i}function Xp(i,s,u,g){return Ls(),s.flags|=256,yn(i,s,u,g),s.child}var Af={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pd(i){return{baseLanes:i,cachePool:ft()}}function zd(i,s,u){return i=i!==null?i.childLanes&~u:0,s&&(i|=Hr),i}function Yp(i,s,u){var g=s.pendingProps,M=!1,z=(s.flags&128)!==0,G;if((G=z)||(G=i!==null&&i.memoizedState===null?!1:(Ji.current&2)!==0),G&&(M=!0,s.flags&=-129),G=(s.flags&32)!==0,s.flags&=-33,i===null){if(ci){if(M?an(s):Eo(),(i=ki)?(i=Sm(i,Jn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Lr!==null?{id:cs,overflow:Ln}:null,retryLane:536870912,hydrationErrors:null},u=Eu(i),u.return=s,s.child=u,Ra=s,ki=null)):i=null,i===null)throw On(s);return sc(i)?s.lanes=32:s.lanes=536870912,null}var Q=g.children;return g=g.fallback,M?(Eo(),M=s.mode,Q=jh({mode:"hidden",children:Q},M),g=Is(g,M,u,null),Q.return=s,g.return=s,Q.sibling=g,s.child=Q,g=s.child,g.memoizedState=Pd(u),g.childLanes=zd(i,G,u),s.memoizedState=Af,Yl(null,g)):(an(s),Nh(s,Q))}var _e=i.memoizedState;if(_e!==null&&(Q=_e.dehydrated,Q!==null)){if(z)s.flags&256?(an(s),s.flags&=-257,s=Gh(i,s,u)):s.memoizedState!==null?(Eo(),s.child=i.child,s.flags|=128,s=null):(Eo(),Q=g.fallback,M=s.mode,g=jh({mode:"visible",children:g.children},M),Q=Is(Q,M,u,null),Q.flags|=2,g.return=s,Q.return=s,g.sibling=Q,s.child=g,Mo(s,i.child,null,u),g=s.child,g.memoizedState=Pd(u),g.childLanes=zd(i,G,u),s.memoizedState=Af,s=Yl(null,g));else if(an(s),sc(Q)){if(G=Q.nextSibling&&Q.nextSibling.dataset,G)var Ne=G.dgst;G=Ne,g=Error(A(419)),g.stack="",g.digest=G,us({value:g,source:null,stack:null}),s=Gh(i,s,u)}else if(Va||vr(i,s,u,!1),G=(u&i.childLanes)!==0,Va||G){if(G=Wi,G!==null&&(g=za(G,u),g!==0&&g!==_e.retryLane))throw _e.retryLane=g,yr(i,g),Fn(G,i,g),kh;hp(Q)||Gd(),s=Gh(i,s,u)}else hp(Q)?(s.flags|=192,s.child=i.child,s=null):(i=_e.treeContext,ki=Tr(Q.nextSibling),Ra=s,ci=!0,Or=null,Jn=!1,i!==null&&Ic(s,i),s=Nh(s,g.children),s.flags|=4096);return s}return M?(Eo(),Q=g.fallback,M=s.mode,_e=i.child,Ne=_e.sibling,g=Kn(_e,{mode:"hidden",children:g.children}),g.subtreeFlags=_e.subtreeFlags&65011712,Ne!==null?Q=Kn(Ne,Q):(Q=Is(Q,M,u,null),Q.flags|=2),Q.return=s,g.return=s,g.sibling=Q,s.child=g,Yl(null,g),g=s.child,Q=i.child.memoizedState,Q===null?Q=Pd(u):(M=Q.cachePool,M!==null?(_e=$i._currentValue,M=M.parent!==_e?{parent:_e,pool:_e}:M):M=ft(),Q={baseLanes:Q.baseLanes|u,cachePool:M}),g.memoizedState=Q,g.childLanes=zd(i,G,u),s.memoizedState=Af,Yl(i.child,g)):(an(s),u=i.child,i=u.sibling,u=Kn(u,{mode:"visible",children:g.children}),u.return=s,u.sibling=null,i!==null&&(G=s.deletions,G===null?(s.deletions=[i],s.flags|=16):G.push(i)),s.child=u,s.memoizedState=null,u)}function Nh(i,s){return s=jh({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function jh(i,s){return i=Qn(22,i,null,s),i.lanes=0,i}function Gh(i,s,u){return Mo(s,i.child,null,u),i=Nh(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function ku(i,s,u){i.lanes|=s;var g=i.alternate;g!==null&&(g.lanes|=s),Rc(i.return,s,u)}function zn(i,s,u,g,M,z){var G=i.memoizedState;G===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:g,tail:u,tailMode:M,treeForkCount:z}:(G.isBackwards=s,G.rendering=null,G.renderingStartTime=0,G.last=g,G.tail=u,G.tailMode=M,G.treeForkCount=z)}function Cf(i,s,u){var g=s.pendingProps,M=g.revealOrder,z=g.tail;g=g.children;var G=Ji.current,Q=(G&2)!==0;if(Q?(G=G&1|2,s.flags|=128):G&=1,pt(Ji,G),yn(i,s,g,u),g=ci?po:0,!Q&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&ku(i,u,s);else if(i.tag===19)ku(i,u,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(M){case"forwards":for(u=s.child,M=null;u!==null;)i=u.alternate,i!==null&&Xi(i)===null&&(M=u),u=u.sibling;u=M,u===null?(M=s.child,s.child=null):(M=u.sibling,u.sibling=null),zn(s,!1,M,u,z,g);break;case"backwards":case"unstable_legacy-backwards":for(u=null,M=s.child,s.child=null;M!==null;){if(i=M.alternate,i!==null&&Xi(i)===null){s.child=M;break}i=M.sibling,M.sibling=u,u=M,M=i}zn(s,!0,u,null,z,g);break;case"together":zn(s,!1,null,null,void 0,g);break;default:s.memoizedState=null}return s.child}function $s(i,s,u){if(i!==null&&(s.dependencies=i.dependencies),tc|=s.lanes,(u&s.childLanes)===0)if(i!==null){if(vr(i,s,u,!1),(u&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(A(153));if(s.child!==null){for(i=s.child,u=Kn(i,i.pendingProps),s.child=u,u.return=s;i.sibling!==null;)i=i.sibling,u=u.sibling=Kn(i,i.pendingProps),u.return=s;u.sibling=null}return s.child}function Pf(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Dc(i)))}function Wp(i,s,u){switch(s.tag){case 3:Qi(s,s.stateNode.containerInfo),Bs(s,$i,i.memoizedState.cache),Ls();break;case 27:case 5:Qr(s);break;case 4:Qi(s,s.stateNode.containerInfo);break;case 10:Bs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Gs(s),null;break;case 13:var g=s.memoizedState;if(g!==null)return g.dehydrated!==null?(an(s),s.flags|=128,null):(u&s.child.childLanes)!==0?Yp(i,s,u):(an(s),i=$s(i,s,u),i!==null?i.sibling:null);an(s);break;case 19:var M=(i.flags&128)!==0;if(g=(u&s.childLanes)!==0,g||(vr(i,s,u,!1),g=(u&s.childLanes)!==0),M){if(g)return Cf(i,s,u);s.flags|=128}if(M=s.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),pt(Ji,Ji.current),g)break;return null;case 22:return s.lanes=0,Lh(i,s,u,s.pendingProps);case 24:Bs(s,$i,i.memoizedState.cache)}return $s(i,s,u)}function Qp(i,s,u){if(i!==null)if(i.memoizedProps!==s.pendingProps)Va=!0;else{if(!Pf(i,u)&&(s.flags&128)===0)return Va=!1,Wp(i,s,u);Va=(i.flags&131072)!==0}else Va=!1,ci&&(s.flags&1048576)!==0&&Eh(s,po,s.index);switch(s.lanes=0,s.tag){case 16:e:{var g=s.pendingProps;if(i=Yt(s.elementType),s.type=i,typeof i=="function")Pc(i)?(g=Zr(i,g),s.tag=1,s=Ef(null,s,i,g,u)):(s.tag=0,s=Bh(null,s,i,g,u));else{if(i!=null){var M=i.$$typeof;if(M===mt){s.tag=11,s=$c(null,s,i,g,u);break e}else if(M===_t){s.tag=14,s=Zp(null,s,i,g,u);break e}}throw s=In(i)||i,Error(A(306,s,""))}}return s;case 0:return Bh(i,s,s.type,s.pendingProps,u);case 1:return g=s.type,M=Zr(g,s.pendingProps),Ef(i,s,g,M,u);case 3:e:{if(Qi(s,s.stateNode.containerInfo),i===null)throw Error(A(387));g=s.pendingProps;var z=s.memoizedState;M=z.element,Li(i,s),ll(s,g,null,u);var G=s.memoizedState;if(g=G.cache,Bs(s,$i,g),g!==z.cache&&mo(s,[$i],u,!0),ql(),g=G.element,z.isDehydrated)if(z={element:g,isDehydrated:!1,cache:G.cache},s.updateQueue.baseState=z,s.memoizedState=z,s.flags&256){s=Xp(i,s,g,u);break e}else if(g!==M){M=Cn(Error(A(424)),s),us(M),s=Xp(i,s,g,u);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(ki=Tr(i.firstChild),Ra=s,ci=!0,Or=null,Jn=!0,u=zh(s,null,g,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ls(),g===M){s=$s(i,s,u);break e}yn(i,s,g,u)}s=s.child}return s;case 26:return Oh(i,s),i===null?(u=Cm(s.type,null,s.pendingProps,null))?s.memoizedState=u:ci||(u=s.type,i=s.pendingProps,g=Kd(Ft.current).createElement(u),g[_i]=s,g[nt]=i,Za(g,u,i),oa(g),s.stateNode=g):s.memoizedState=Cm(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Qr(s),i===null&&ci&&(g=s.stateNode=Mm(s.type,s.pendingProps,Ft.current),Ra=s,Jn=!0,M=ki,Ws(s.type)?(af=M,ki=Tr(g.firstChild)):ki=M),yn(i,s,s.pendingProps.children,u),Oh(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&ci&&((M=g=ki)&&(g=tf(g,s.type,s.pendingProps,Jn),g!==null?(s.stateNode=g,Ra=s,ki=Tr(g.firstChild),Jn=!1,M=!0):M=!1),M||On(s)),Qr(s),M=s.type,z=s.pendingProps,G=i!==null?i.memoizedProps:null,g=z.children,Jd(M,z)?g=null:G!==null&&Jd(M,G)&&(s.flags|=32),s.memoizedState!==null&&(M=Vc(i,s,p,null,null,u),je._currentValue=M),Oh(i,s),yn(i,s,g,u),s.child;case 6:return i===null&&ci&&((i=u=ki)&&(u=fg(u,s.pendingProps,Jn),u!==null?(s.stateNode=u,Ra=s,ki=null,i=!0):i=!1),i||On(s)),null;case 13:return Yp(i,s,u);case 4:return Qi(s,s.stateNode.containerInfo),g=s.pendingProps,i===null?s.child=Mo(s,null,g,u):yn(i,s,g,u),s.child;case 11:return $c(i,s,s.type,s.pendingProps,u);case 7:return yn(i,s,s.pendingProps,u),s.child;case 8:return yn(i,s,s.pendingProps.children,u),s.child;case 12:return yn(i,s,s.pendingProps.children,u),s.child;case 10:return g=s.pendingProps,Bs(s,s.type,g.value),yn(i,s,g.children,u),s.child;case 9:return M=s.type._context,g=s.pendingProps.children,go(s),M=tn(M),g=g(M),s.flags|=1,yn(i,s,g,u),s.child;case 14:return Zp(i,s,s.type,s.pendingProps,u);case 15:return Hc(i,s,s.type,s.pendingProps,u);case 19:return Cf(i,s,u);case 31:return Jm(i,s,u);case 22:return Lh(i,s,u,s.pendingProps);case 24:return go(s),g=tn($i),i===null?(M=nl(),M===null&&(M=Wi,z=Lc(),M.pooledCache=z,z.refCount++,z!==null&&(M.pooledCacheLanes|=u),M=z),s.memoizedState={parent:g,cache:M},fs(s),Bs(s,$i,M)):((i.lanes&u)!==0&&(Li(i,s),ll(s,null,null,u),ql()),M=i.memoizedState,z=s.memoizedState,M.parent!==g?(M={parent:g,cache:g},s.memoizedState=M,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=M),Bs(s,$i,g)):(g=z.cache,Bs(s,$i,g),g!==M.cache&&mo(s,[$i],u,!0))),yn(i,s,s.pendingProps.children,u),s.child;case 29:throw s.pendingProps}throw Error(A(156,s.tag))}function pl(i){i.flags|=4}function Id(i,s,u,g,M){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(M&335544128)===M)if(i.stateNode.complete)i.flags|=8192;else if(lm())i.flags|=8192;else throw ds=xo,Oc}else i.flags&=-16777217}function Kp(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Z(s))if(lm())i.flags|=8192;else throw ds=xo,Oc}function Lu(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?ui():536870912,i.lanes|=s,Jc|=s)}function Ou(i,s){if(!ci)switch(i.tailMode){case"hidden":s=i.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:g.sibling=null}}function ua(i){var s=i.alternate!==null&&i.alternate.child===i.child,u=0,g=0;if(s)for(var M=i.child;M!==null;)u|=M.lanes|M.childLanes,g|=M.subtreeFlags&65011712,g|=M.flags&65011712,M.return=i,M=M.sibling;else for(M=i.child;M!==null;)u|=M.lanes|M.childLanes,g|=M.subtreeFlags,g|=M.flags,M.return=i,M=M.sibling;return i.subtreeFlags|=g,i.childLanes=u,s}function eg(i,s,u){var g=s.pendingProps;switch(jl(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ua(s),null;case 1:return ua(s),null;case 3:return u=s.stateNode,g=null,i!==null&&(g=i.memoizedState.cache),s.memoizedState.cache!==g&&(s.flags|=2048),Nr($i),Pi(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(ks(s)?pl(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Os())),ua(s),null;case 26:var M=s.type,z=s.memoizedState;return i===null?(pl(s),z!==null?(ua(s),Kp(s,z)):(ua(s),Id(s,M,null,g,u))):z?z!==i.memoizedState?(pl(s),ua(s),Kp(s,z)):(ua(s),s.flags&=-16777217):(i=i.memoizedProps,i!==g&&pl(s),ua(s),Id(s,M,i,g,u)),null;case 27:if(bs(s),u=Ft.current,M=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==g&&pl(s);else{if(!g){if(s.stateNode===null)throw Error(A(166));return ua(s),null}i=Et.current,ks(s)?er(s):(i=Mm(M,g,u),s.stateNode=i,pl(s))}return ua(s),null;case 5:if(bs(s),M=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==g&&pl(s);else{if(!g){if(s.stateNode===null)throw Error(A(166));return ua(s),null}if(z=Et.current,ks(s))er(s);else{var G=Kd(Ft.current);switch(z){case 1:z=G.createElementNS("http://www.w3.org/2000/svg",M);break;case 2:z=G.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;default:switch(M){case"svg":z=G.createElementNS("http://www.w3.org/2000/svg",M);break;case"math":z=G.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;case"script":z=G.createElement("div"),z.innerHTML="<script><\/script>",z=z.removeChild(z.firstChild);break;case"select":z=typeof g.is=="string"?G.createElement("select",{is:g.is}):G.createElement("select"),g.multiple?z.multiple=!0:g.size&&(z.size=g.size);break;default:z=typeof g.is=="string"?G.createElement(M,{is:g.is}):G.createElement(M)}}z[_i]=s,z[nt]=g;e:for(G=s.child;G!==null;){if(G.tag===5||G.tag===6)z.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===s)break e;for(;G.sibling===null;){if(G.return===null||G.return===s)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}s.stateNode=z;e:switch(Za(z,M,g),M){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&pl(s)}}return ua(s),Id(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,u),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==g&&pl(s);else{if(typeof g!="string"&&s.stateNode===null)throw Error(A(166));if(i=Ft.current,ks(s)){if(i=s.stateNode,u=s.memoizedProps,g=null,M=Ra,M!==null)switch(M.tag){case 27:case 5:g=M.memoizedProps}i[_i]=s,i=!!(i.nodeValue===u||g!==null&&g.suppressHydrationWarning===!0||sp(i.nodeValue,u)),i||On(s,!0)}else i=Kd(i).createTextNode(g),i[_i]=s,s.stateNode=i}return ua(s),null;case 31:if(u=s.memoizedState,i===null||i.memoizedState!==null){if(g=ks(s),u!==null){if(i===null){if(!g)throw Error(A(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(A(557));i[_i]=s}else Ls(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;ua(s),i=!1}else u=Os(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return s.flags&256?(ar(s),s):(ar(s),null);if((s.flags&128)!==0)throw Error(A(558))}return ua(s),null;case 13:if(g=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(M=ks(s),g!==null&&g.dehydrated!==null){if(i===null){if(!M)throw Error(A(318));if(M=s.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(A(317));M[_i]=s}else Ls(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;ua(s),M=!1}else M=Os(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=M),M=!0;if(!M)return s.flags&256?(ar(s),s):(ar(s),null)}return ar(s),(s.flags&128)!==0?(s.lanes=u,s):(u=g!==null,i=i!==null&&i.memoizedState!==null,u&&(g=s.child,M=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(M=g.alternate.memoizedState.cachePool.pool),z=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(z=g.memoizedState.cachePool.pool),z!==M&&(g.flags|=2048)),u!==i&&u&&(s.child.flags|=8192),Lu(s,s.updateQueue),ua(s),null);case 4:return Pi(),i===null&&Hd(s.stateNode.containerInfo),ua(s),null;case 10:return Nr(s.type),ua(s),null;case 19:if(Ke(Ji),g=s.memoizedState,g===null)return ua(s),null;if(M=(s.flags&128)!==0,z=g.rendering,z===null)if(M)Ou(g,!1);else{if(ka!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(z=Xi(i),z!==null){for(s.flags|=128,Ou(g,!1),i=z.updateQueue,s.updateQueue=i,Lu(s,i),s.subtreeFlags=0,i=u,u=s.child;u!==null;)Sd(u,i),u=u.sibling;return pt(Ji,Ji.current&1|2),ci&&Ds(s,g.treeForkCount),s.child}i=i.sibling}g.tail!==null&&Na()>tu&&(s.flags|=128,M=!0,Ou(g,!1),s.lanes=4194304)}else{if(!M)if(i=Xi(z),i!==null){if(s.flags|=128,M=!0,i=i.updateQueue,s.updateQueue=i,Lu(s,i),Ou(g,!0),g.tail===null&&g.tailMode==="hidden"&&!z.alternate&&!ci)return ua(s),null}else 2*Na()-g.renderingStartTime>tu&&u!==536870912&&(s.flags|=128,M=!0,Ou(g,!1),s.lanes=4194304);g.isBackwards?(z.sibling=s.child,s.child=z):(i=g.last,i!==null?i.sibling=z:s.child=z,g.last=z)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=Na(),i.sibling=null,u=Ji.current,pt(Ji,M?u&1|2:u&1),ci&&Ds(s,g.treeForkCount),i):(ua(s),null);case 22:case 23:return ar(s),Zl(),g=s.memoizedState!==null,i!==null?i.memoizedState!==null!==g&&(s.flags|=8192):g&&(s.flags|=8192),g?(u&536870912)!==0&&(s.flags&128)===0&&(ua(s),s.subtreeFlags&6&&(s.flags|=8192)):ua(s),u=s.updateQueue,u!==null&&Lu(s,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),g=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(g=s.memoizedState.cachePool.pool),g!==u&&(s.flags|=2048),i!==null&&Ke(yo),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Nr($i),ua(s),null;case 25:return null;case 30:return null}throw Error(A(156,s.tag))}function tg(i,s){switch(jl(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Nr($i),Pi(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return bs(s),null;case 31:if(s.memoizedState!==null){if(ar(s),s.alternate===null)throw Error(A(340));Ls()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(ar(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(A(340));Ls()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return Ke(Ji),null;case 4:return Pi(),null;case 10:return Nr(s.type),null;case 22:case 23:return ar(s),Zl(),i!==null&&Ke(yo),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Nr($i),null;case 25:return null;default:return null}}function Jp(i,s){switch(jl(s),s.tag){case 3:Nr($i),Pi();break;case 26:case 27:case 5:bs(s);break;case 4:Pi();break;case 31:s.memoizedState!==null&&ar(s);break;case 13:ar(s);break;case 19:Ke(Ji);break;case 10:Nr(s.type);break;case 22:case 23:ar(s),Zl(),i!==null&&Ke(yo);break;case 24:Nr($i)}}function Wl(i,s){try{var u=s.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var M=g.next;u=M;do{if((u.tag&i)===i){g=void 0;var z=u.create,G=u.inst;g=z(),G.destroy=g}u=u.next}while(u!==M)}}catch(Q){ji(s,s.return,Q)}}function Po(i,s,u){try{var g=s.updateQueue,M=g!==null?g.lastEffect:null;if(M!==null){var z=M.next;g=z;do{if((g.tag&i)===i){var G=g.inst,Q=G.destroy;if(Q!==void 0){G.destroy=void 0,M=s;var _e=u,Ne=Q;try{Ne()}catch(We){ji(M,_e,We)}}}g=g.next}while(g!==z)}}catch(We){ji(s,s.return,We)}}function zf(i){var s=i.updateQueue;if(s!==null){var u=i.stateNode;try{Fc(s,u)}catch(g){ji(i,i.return,g)}}}function Ql(i,s,u){u.props=Zr(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(g){ji(i,s,g)}}function ml(i,s){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var g=i.stateNode;break;case 30:g=i.stateNode;break;default:g=i.stateNode}typeof u=="function"?i.refCleanup=u(g):u.current=g}}catch(M){ji(i,s,M)}}function zo(i,s){var u=i.ref,g=i.refCleanup;if(u!==null)if(typeof g=="function")try{g()}catch(M){ji(i,s,M)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(M){ji(i,s,M)}else u.current=null}function em(i){var s=i.type,u=i.memoizedProps,g=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":u.autoFocus&&g.focus();break e;case"img":u.src?g.src=u.src:u.srcSet&&(g.srcset=u.srcSet)}}catch(M){ji(i,i.return,M)}}function If(i,s,u){try{var g=i.stateNode;nu(g,i.type,u,s),g[nt]=s}catch(M){ji(i,i.return,M)}}function tm(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ws(i.type)||i.tag===4}function Rf(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||tm(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ws(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Df(i,s,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,s?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,s):(s=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,s.appendChild(i),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=Hn));else if(g!==4&&(g===27&&Ws(i.type)&&(u=i.stateNode,s=null),i=i.child,i!==null))for(Df(i,s,u),i=i.sibling;i!==null;)Df(i,s,u),i=i.sibling}function Rd(i,s,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,s?u.insertBefore(i,s):u.appendChild(i);else if(g!==4&&(g===27&&Ws(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Rd(i,s,u),i=i.sibling;i!==null;)Rd(i,s,u),i=i.sibling}function Dd(i){var s=i.stateNode,u=i.memoizedProps;try{for(var g=i.type,M=s.attributes;M.length;)s.removeAttributeNode(M[0]);Za(s,g,u),s[_i]=i,s[nt]=u}catch(z){ji(i,i.return,z)}}var gl=!1,qa=!1,Xc=!1,im=typeof WeakSet=="function"?WeakSet:Set,hi=null;function Bu(i,s){if(i=i.containerInfo,Wd=kt,i=yi(i),wu(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var g=u.getSelection&&u.getSelection();if(g&&g.rangeCount!==0){u=g.anchorNode;var M=g.anchorOffset,z=g.focusNode;g=g.focusOffset;try{u.nodeType,z.nodeType}catch{u=null;break e}var G=0,Q=-1,_e=-1,Ne=0,We=0,it=i,Ge=null;t:for(;;){for(var qe;it!==u||M!==0&&it.nodeType!==3||(Q=G+M),it!==z||g!==0&&it.nodeType!==3||(_e=G+g),it.nodeType===3&&(G+=it.nodeValue.length),(qe=it.firstChild)!==null;)Ge=it,it=qe;for(;;){if(it===i)break t;if(Ge===u&&++Ne===M&&(Q=G),Ge===z&&++We===g&&(_e=G),(qe=it.nextSibling)!==null)break;it=Ge,Ge=it.parentNode}it=qe}u=Q===-1||_e===-1?null:{start:Q,end:_e}}else u=null}u=u||{start:0,end:0}}else u=null;for(Qd={focusedElem:i,selectionRange:u},kt=!1,hi=s;hi!==null;)if(s=hi,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,hi=i;else for(;hi!==null;){switch(s=hi,z=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)M=i[u],M.ref.impl=M.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&z!==null){i=void 0,u=s,M=z.memoizedProps,z=z.memoizedState,g=u.stateNode;try{var zt=Zr(u.type,M);i=g.getSnapshotBeforeUpdate(zt,z),g.__reactInternalSnapshotBeforeUpdate=i}catch(Zt){ji(u,u.return,Zt)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,u=i.nodeType,u===9)Yu(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Yu(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(A(163))}if(i=s.sibling,i!==null){i.return=s.return,hi=i;break}hi=s.return}}function kf(i,s,u){var g=u.flags;switch(u.tag){case 0:case 11:case 15:_l(i,u),g&4&&Wl(5,u);break;case 1:if(_l(i,u),g&4)if(i=u.stateNode,s===null)try{i.componentDidMount()}catch(G){ji(u,u.return,G)}else{var M=Zr(u.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(M,s,i.__reactInternalSnapshotBeforeUpdate)}catch(G){ji(u,u.return,G)}}g&64&&zf(u),g&512&&ml(u,u.return);break;case 3:if(_l(i,u),g&64&&(i=u.updateQueue,i!==null)){if(s=null,u.child!==null)switch(u.child.tag){case 27:case 5:s=u.child.stateNode;break;case 1:s=u.child.stateNode}try{Fc(i,s)}catch(G){ji(u,u.return,G)}}break;case 27:s===null&&g&4&&Dd(u);case 26:case 5:_l(i,u),s===null&&g&4&&em(u),g&512&&ml(u,u.return);break;case 12:_l(i,u);break;case 31:_l(i,u),g&4&&Nu(i,u);break;case 13:_l(i,u),g&4&&kd(i,u),g&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=sg.bind(null,u),xn(i,u))));break;case 22:if(g=u.memoizedState!==null||gl,!g){s=s!==null&&s.memoizedState!==null||qa,M=gl;var z=qa;gl=g,(qa=s)&&!z?$r(i,u,(u.subtreeFlags&8772)!==0):_l(i,u),gl=M,qa=z}break;case 30:break;default:_l(i,u)}}function Fh(i){var s=i.alternate;s!==null&&(i.alternate=null,Fh(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&to(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var sa=null,vn=!1;function Io(i,s,u){for(u=u.child;u!==null;)Lf(i,s,u),u=u.sibling}function Lf(i,s,u){if(pe&&typeof pe.onCommitFiberUnmount=="function")try{pe.onCommitFiberUnmount(fe,u)}catch{}switch(u.tag){case 26:qa||zo(u,s),Io(i,s,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:qa||zo(u,s);var g=sa,M=vn;Ws(u.type)&&(sa=u.stateNode,vn=!1),Io(i,s,u),Wu(u.stateNode),sa=g,vn=M;break;case 5:qa||zo(u,s);case 6:if(g=sa,M=vn,sa=null,Io(i,s,u),sa=g,vn=M,sa!==null)if(vn)try{(sa.nodeType===9?sa.body:sa.nodeName==="HTML"?sa.ownerDocument.body:sa).removeChild(u.stateNode)}catch(z){ji(u,s,z)}else try{sa.removeChild(u.stateNode)}catch(z){ji(u,s,z)}break;case 18:sa!==null&&(vn?(i=sa,up(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),Vn(i)):up(sa,u.stateNode));break;case 4:g=sa,M=vn,sa=u.stateNode.containerInfo,vn=!0,Io(i,s,u),sa=g,vn=M;break;case 0:case 11:case 14:case 15:Po(2,u,s),qa||Po(4,u,s),Io(i,s,u);break;case 1:qa||(zo(u,s),g=u.stateNode,typeof g.componentWillUnmount=="function"&&Ql(u,s,g)),Io(i,s,u);break;case 21:Io(i,s,u);break;case 22:qa=(g=qa)||u.memoizedState!==null,Io(i,s,u),qa=g;break;default:Io(i,s,u)}}function Nu(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Vn(i)}catch(u){ji(s,s.return,u)}}}function kd(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Vn(i)}catch(u){ji(s,s.return,u)}}function ju(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new im),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new im),s;default:throw Error(A(435,i.tag))}}function Yc(i,s){var u=ju(i);s.forEach(function(g){if(!u.has(g)){u.add(g);var M=og.bind(null,i,g);g.then(M,M)}})}function un(i,s){var u=s.deletions;if(u!==null)for(var g=0;g<u.length;g++){var M=u[g],z=i,G=s,Q=G;e:for(;Q!==null;){switch(Q.tag){case 27:if(Ws(Q.type)){sa=Q.stateNode,vn=!1;break e}break;case 5:sa=Q.stateNode,vn=!1;break e;case 3:case 4:sa=Q.stateNode.containerInfo,vn=!0;break e}Q=Q.return}if(sa===null)throw Error(A(160));Lf(z,G,M),sa=null,vn=!1,z=M.alternate,z!==null&&(z.return=null),M.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)am(s,i),s=s.sibling}var sr=null;function am(i,s){var u=i.alternate,g=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:un(s,i),or(i),g&4&&(Po(3,i,i.return),Wl(3,i),Po(5,i,i.return));break;case 1:un(s,i),or(i),g&512&&(qa||u===null||zo(u,u.return)),g&64&&gl&&(i=i.updateQueue,i!==null&&(g=i.callbacks,g!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?g:u.concat(g))));break;case 26:var M=sr;if(un(s,i),or(i),g&512&&(qa||u===null||zo(u,u.return)),g&4){var z=u!==null?u.memoizedState:null;if(g=i.memoizedState,u===null)if(g===null)if(i.stateNode===null){e:{g=i.type,u=i.memoizedProps,M=M.ownerDocument||M;t:switch(g){case"title":z=M.getElementsByTagName("title")[0],(!z||z[Ht]||z[_i]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=M.createElement(g),M.head.insertBefore(z,M.querySelector("head > title"))),Za(z,g,u),z[_i]=i,oa(z),g=z;break e;case"link":var G=O("link","href",M).get(g+(u.href||""));if(G){for(var Q=0;Q<G.length;Q++)if(z=G[Q],z.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&z.getAttribute("rel")===(u.rel==null?null:u.rel)&&z.getAttribute("title")===(u.title==null?null:u.title)&&z.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){G.splice(Q,1);break t}}z=M.createElement(g),Za(z,g,u),M.head.appendChild(z);break;case"meta":if(G=O("meta","content",M).get(g+(u.content||""))){for(Q=0;Q<G.length;Q++)if(z=G[Q],z.getAttribute("content")===(u.content==null?null:""+u.content)&&z.getAttribute("name")===(u.name==null?null:u.name)&&z.getAttribute("property")===(u.property==null?null:u.property)&&z.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&z.getAttribute("charset")===(u.charSet==null?null:u.charSet)){G.splice(Q,1);break t}}z=M.createElement(g),Za(z,g,u),M.head.appendChild(z);break;default:throw Error(A(468,g))}z[_i]=i,oa(z),g=z}i.stateNode=g}else F(M,i.type,i.stateNode);else i.stateNode=v(M,g,i.memoizedProps);else z!==g?(z===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):z.count--,g===null?F(M,i.type,i.stateNode):v(M,g,i.memoizedProps)):g===null&&i.stateNode!==null&&If(i,i.memoizedProps,u.memoizedProps)}break;case 27:un(s,i),or(i),g&512&&(qa||u===null||zo(u,u.return)),u!==null&&g&4&&If(i,i.memoizedProps,u.memoizedProps);break;case 5:if(un(s,i),or(i),g&512&&(qa||u===null||zo(u,u.return)),i.flags&32){M=i.stateNode;try{as(M,"")}catch(zt){ji(i,i.return,zt)}}g&4&&i.stateNode!=null&&(M=i.memoizedProps,If(i,M,u!==null?u.memoizedProps:M)),g&1024&&(Xc=!0);break;case 6:if(un(s,i),or(i),g&4){if(i.stateNode===null)throw Error(A(162));g=i.memoizedProps,u=i.stateNode;try{u.nodeValue=g}catch(zt){ji(i,i.return,zt)}}break;case 3:if(R=null,M=sr,sr=nd(s.containerInfo),un(s,i),sr=M,or(i),g&4&&u!==null&&u.memoizedState.isDehydrated)try{Vn(s.containerInfo)}catch(zt){ji(i,i.return,zt)}Xc&&(Xc=!1,Kl(i));break;case 4:g=sr,sr=nd(i.stateNode.containerInfo),un(s,i),or(i),sr=g;break;case 12:un(s,i),or(i);break;case 31:un(s,i),or(i),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,Yc(i,g)));break;case 13:un(s,i),or(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&($h=Na()),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,Yc(i,g)));break;case 22:M=i.memoizedState!==null;var _e=u!==null&&u.memoizedState!==null,Ne=gl,We=qa;if(gl=Ne||M,qa=We||_e,un(s,i),qa=We,gl=Ne,or(i),g&8192)e:for(s=i.stateNode,s._visibility=M?s._visibility&-2:s._visibility|1,M&&(u===null||_e||gl||qa||Jl(i)),u=null,s=i;;){if(s.tag===5||s.tag===26){if(u===null){_e=u=s;try{if(z=_e.stateNode,M)G=z.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{Q=_e.stateNode;var it=_e.memoizedProps.style,Ge=it!=null&&it.hasOwnProperty("display")?it.display:null;Q.style.display=Ge==null||typeof Ge=="boolean"?"":(""+Ge).trim()}}catch(zt){ji(_e,_e.return,zt)}}}else if(s.tag===6){if(u===null){_e=s;try{_e.stateNode.nodeValue=M?"":_e.memoizedProps}catch(zt){ji(_e,_e.return,zt)}}}else if(s.tag===18){if(u===null){_e=s;try{var qe=_e.stateNode;M?ad(qe,!0):ad(_e.stateNode,!1)}catch(zt){ji(_e,_e.return,zt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;u===s&&(u=null),s=s.return}u===s&&(u=null),s.sibling.return=s.return,s=s.sibling}g&4&&(g=i.updateQueue,g!==null&&(u=g.retryQueue,u!==null&&(g.retryQueue=null,Yc(i,u))));break;case 19:un(s,i),or(i),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,Yc(i,g)));break;case 30:break;case 21:break;default:un(s,i),or(i)}}function or(i){var s=i.flags;if(s&2){try{for(var u,g=i.return;g!==null;){if(tm(g)){u=g;break}g=g.return}if(u==null)throw Error(A(160));switch(u.tag){case 27:var M=u.stateNode,z=Rf(i);Rd(i,z,M);break;case 5:var G=u.stateNode;u.flags&32&&(as(G,""),u.flags&=-33);var Q=Rf(i);Rd(i,Q,G);break;case 3:case 4:var _e=u.stateNode.containerInfo,Ne=Rf(i);Df(i,Ne,_e);break;default:throw Error(A(161))}}catch(We){ji(i,i.return,We)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Kl(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Kl(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function _l(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)kf(i,s.alternate,s),s=s.sibling}function Jl(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Po(4,s,s.return),Jl(s);break;case 1:zo(s,s.return);var u=s.stateNode;typeof u.componentWillUnmount=="function"&&Ql(s,s.return,u),Jl(s);break;case 27:Wu(s.stateNode);case 26:case 5:zo(s,s.return),Jl(s);break;case 22:s.memoizedState===null&&Jl(s);break;case 30:Jl(s);break;default:Jl(s)}i=i.sibling}}function $r(i,s,u){for(u=u&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var g=s.alternate,M=i,z=s,G=z.flags;switch(z.tag){case 0:case 11:case 15:$r(M,z,u),Wl(4,z);break;case 1:if($r(M,z,u),g=z,M=g.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Ne){ji(g,g.return,Ne)}if(g=z,M=g.updateQueue,M!==null){var Q=g.stateNode;try{var _e=M.shared.hiddenCallbacks;if(_e!==null)for(M.shared.hiddenCallbacks=null,M=0;M<_e.length;M++)jr(_e[M],Q)}catch(Ne){ji(g,g.return,Ne)}}u&&G&64&&zf(z),ml(z,z.return);break;case 27:Dd(z);case 26:case 5:$r(M,z,u),u&&g===null&&G&4&&em(z),ml(z,z.return);break;case 12:$r(M,z,u);break;case 31:$r(M,z,u),u&&G&4&&Nu(M,z);break;case 13:$r(M,z,u),u&&G&4&&kd(M,z);break;case 22:z.memoizedState===null&&$r(M,z,u),ml(z,z.return);break;case 30:break;default:$r(M,z,u)}s=s.sibling}}function Uh(i,s){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&gn(u))}function Ld(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&gn(i))}function _s(i,s,u,g){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)nm(i,s,u,g),s=s.sibling}function nm(i,s,u,g){var M=s.flags;switch(s.tag){case 0:case 11:case 15:_s(i,s,u,g),M&2048&&Wl(9,s);break;case 1:_s(i,s,u,g);break;case 3:_s(i,s,u,g),M&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&gn(i)));break;case 12:if(M&2048){_s(i,s,u,g),i=s.stateNode;try{var z=s.memoizedProps,G=z.id,Q=z.onPostCommit;typeof Q=="function"&&Q(G,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(_e){ji(s,s.return,_e)}}else _s(i,s,u,g);break;case 31:_s(i,s,u,g);break;case 13:_s(i,s,u,g);break;case 23:break;case 22:z=s.stateNode,G=s.alternate,s.memoizedState!==null?z._visibility&2?_s(i,s,u,g):Vh(i,s):z._visibility&2?_s(i,s,u,g):(z._visibility|=2,Gu(i,s,u,g,(s.subtreeFlags&10256)!==0||!1)),M&2048&&Uh(G,s);break;case 24:_s(i,s,u,g),M&2048&&Ld(s.alternate,s);break;default:_s(i,s,u,g)}}function Gu(i,s,u,g,M){for(M=M&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var z=i,G=s,Q=u,_e=g,Ne=G.flags;switch(G.tag){case 0:case 11:case 15:Gu(z,G,Q,_e,M),Wl(8,G);break;case 23:break;case 22:var We=G.stateNode;G.memoizedState!==null?We._visibility&2?Gu(z,G,Q,_e,M):Vh(z,G):(We._visibility|=2,Gu(z,G,Q,_e,M)),M&&Ne&2048&&Uh(G.alternate,G);break;case 24:Gu(z,G,Q,_e,M),M&&Ne&2048&&Ld(G.alternate,G);break;default:Gu(z,G,Q,_e,M)}s=s.sibling}}function Vh(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var u=i,g=s,M=g.flags;switch(g.tag){case 22:Vh(u,g),M&2048&&Uh(g.alternate,g);break;case 24:Vh(u,g),M&2048&&Ld(g.alternate,g);break;default:Vh(u,g)}s=s.sibling}}var qh=8192;function Fu(i,s,u){if(i.subtreeFlags&qh)for(i=i.child;i!==null;)Wc(i,s,u),i=i.sibling}function Wc(i,s,u){switch(i.tag){case 26:Fu(i,s,u),i.flags&qh&&i.memoizedState!==null&&Y(u,sr,i.memoizedState,i.memoizedProps);break;case 5:Fu(i,s,u);break;case 3:case 4:var g=sr;sr=nd(i.stateNode.containerInfo),Fu(i,s,u),sr=g;break;case 22:i.memoizedState===null&&(g=i.alternate,g!==null&&g.memoizedState!==null?(g=qh,qh=16777216,Fu(i,s,u),qh=g):Fu(i,s,u));break;default:Fu(i,s,u)}}function rm(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Zh(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var g=s[u];hi=g,Bf(g,i)}rm(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Of(i),i=i.sibling}function Of(i){switch(i.tag){case 0:case 11:case 15:Zh(i),i.flags&2048&&Po(9,i,i.return);break;case 3:Zh(i);break;case 12:Zh(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Od(i)):Zh(i);break;default:Zh(i)}}function Od(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var g=s[u];hi=g,Bf(g,i)}rm(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Po(8,s,s.return),Od(s);break;case 22:u=s.stateNode,u._visibility&2&&(u._visibility&=-3,Od(s));break;default:Od(s)}i=i.sibling}}function Bf(i,s){for(;hi!==null;){var u=hi;switch(u.tag){case 0:case 11:case 15:Po(8,u,s);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var g=u.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:gn(u.memoizedState.cache)}if(g=u.child,g!==null)g.return=u,hi=g;else e:for(u=i;hi!==null;){g=hi;var M=g.sibling,z=g.return;if(Fh(g),g===u){hi=null;break e}if(M!==null){M.return=z,hi=M;break e}hi=z}}}var ig={getCacheForType:function(i){var s=tn($i),u=s.data.get(i);return u===void 0&&(u=i(),s.data.set(i,u)),u},cacheSignal:function(){return tn($i).controller.signal}},Nf=typeof WeakMap=="function"?WeakMap:Map,Ei=0,Wi=null,vi=null,bi=0,Vi=0,Sr=null,ec=!1,Uu=!1,Qc=!1,Ro=0,ka=0,tc=0,Kc=0,jf=0,Hr=0,Jc=0,eu=null,lr=null,Bd=!1,$h=0,sm=0,tu=1/0,Nd=null,yl=null,hn=0,ic=null,Vu=null,Do=0,Gf=0,Ff=null,qu=null,ba=0,Hh=null;function Mr(){return(Ei&2)!==0&&bi!==0?bi&-bi:Xe.T!==null?nc():Ir()}function Uf(){if(Hr===0)if((bi&536870912)===0||ci){var i=xt;xt<<=1,(xt&3932160)===0&&(xt=262144),Hr=i}else Hr=536870912;return i=Hi.current,i!==null&&(i.flags|=32),Hr}function Fn(i,s,u){(i===Wi&&(Vi===2||Vi===9)||i.cancelPendingCommit!==null)&&(Zu(i,0),ac(i,bi,Hr,!1)),pa(i,u),((Ei&2)===0||i!==Wi)&&(i===Wi&&((Ei&2)===0&&(Kc|=u),ka===4&&ac(i,bi,Hr,!1)),Xs(i))}function iu(i,s,u){if((Ei&6)!==0)throw Error(A(327));var g=!u&&(s&127)===0&&(s&i.expiredLanes)===0||fi(i,s),M=g?hm(i,s):Zf(i,s,!0),z=g;do{if(M===0){Uu&&!g&&ac(i,s,0,!1);break}else{if(u=i.current.alternate,z&&!ag(u)){M=Zf(i,s,!1),z=!1;continue}if(M===2){if(z=s,i.errorRecoveryDisabledLanes&z)var G=0;else G=i.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){s=G;e:{var Q=i;M=eu;var _e=Q.current.memoizedState.isDehydrated;if(_e&&(Zu(Q,G).flags|=256),G=Zf(Q,G,!1),G!==2){if(Qc&&!_e){Q.errorRecoveryDisabledLanes|=z,Kc|=z,M=4;break e}z=lr,lr=M,z!==null&&(lr===null?lr=z:lr.push.apply(lr,z))}M=G}if(z=!1,M!==2)continue}}if(M===1){Zu(i,0),ac(i,s,0,!0);break}e:{switch(g=i,z=M,z){case 0:case 1:throw Error(A(345));case 4:if((s&4194048)!==s)break;case 6:ac(g,s,Hr,!ec);break e;case 2:lr=null;break;case 3:case 5:break;default:throw Error(A(329))}if((s&62914560)===s&&(M=$h+300-Na(),10<M)){if(ac(g,s,Hr,!ec),ii(g,0,!0)!==0)break e;Do=s,g.timeoutHandle=cp(Vf.bind(null,g,u,lr,Nd,Bd,s,Hr,Kc,Jc,ec,z,"Throttled",-0,0),M);break e}Vf(g,u,lr,Nd,Bd,s,Hr,Kc,Jc,ec,z,null,-0,0)}}break}while(!0);Xs(i)}function Vf(i,s,u,g,M,z,G,Q,_e,Ne,We,it,Ge,qe){if(i.timeoutHandle=-1,it=s.subtreeFlags,it&8192||(it&16785408)===16785408){it={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hn},Wc(s,z,it);var zt=(z&62914560)===z?$h-Na():(z&4194048)===z?sm-Na():0;if(zt=se(it,zt),zt!==null){Do=z,i.cancelPendingCommit=zt(Yh.bind(null,i,s,z,u,g,M,G,Q,_e,We,it,null,Ge,qe)),ac(i,z,G,!Ne);return}}Yh(i,s,z,u,g,M,G,Q,_e)}function ag(i){for(var s=i;;){var u=s.tag;if((u===0||u===11||u===15)&&s.flags&16384&&(u=s.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var g=0;g<u.length;g++){var M=u[g],z=M.getSnapshot;M=M.value;try{if(!En(z(),M))return!1}catch{return!1}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ac(i,s,u,g){s&=~jf,s&=~Kc,i.suspendedLanes|=s,i.pingedLanes&=~s,g&&(i.warmLanes|=s),g=i.expirationTimes;for(var M=s;0<M;){var z=31-Ie(M),G=1<<z;g[z]=-1,M&=~G}u!==0&&Ya(i,u,s)}function jd(){return(Ei&6)===0?(au(0),!1):!0}function qf(){if(vi!==null){if(Vi===0)var i=vi.return;else i=vi,Br=hs=null,c(i),wo=null,Vl=0,i=vi;for(;i!==null;)Jp(i.alternate,i),i=i.return;vi=null}}function Zu(i,s){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,dg(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Do=0,qf(),Wi=i,vi=u=Kn(i.current,null),bi=s,Vi=0,Sr=null,ec=!1,Uu=fi(i,s),Qc=!1,Jc=Hr=jf=Kc=tc=ka=0,lr=eu=null,Bd=!1,(s&8)!==0&&(s|=s&32);var g=i.entangledLanes;if(g!==0)for(i=i.entanglements,g&=s;0<g;){var M=31-Ie(g),z=1<<M;s|=i[M],g&=~z}return Ro=s,Jo(),u}function om(i,s){qt=null,Xe.H=dl,s===rl||s===vo?(s=Ch(),Vi=3):s===Oc?(s=Ch(),Vi=4):Vi=s===kh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Sr=s,vi===null&&(ka=1,Rh(i,Cn(s,i.current)))}function lm(){var i=Hi.current;return i===null?!0:(bi&4194048)===bi?ir===null:(bi&62914560)===bi||(bi&536870912)!==0?i===ir:!1}function cm(){var i=Xe.H;return Xe.H=dl,i===null?dl:i}function um(){var i=Xe.A;return Xe.A=ig,i}function Gd(){ka=4,ec||(bi&4194048)!==bi&&Hi.current!==null||(Uu=!0),(tc&134217727)===0&&(Kc&134217727)===0||Wi===null||ac(Wi,bi,Hr,!1)}function Zf(i,s,u){var g=Ei;Ei|=2;var M=cm(),z=um();(Wi!==i||bi!==s)&&(Nd=null,Zu(i,s)),s=!1;var G=ka;e:do try{if(Vi!==0&&vi!==null){var Q=vi,_e=Sr;switch(Vi){case 8:qf(),G=6;break e;case 3:case 2:case 9:case 6:Hi.current===null&&(s=!0);var Ne=Vi;if(Vi=0,Sr=null,ko(i,Q,_e,Ne),u&&Uu){G=0;break e}break;default:Ne=Vi,Vi=0,Sr=null,ko(i,Q,_e,Ne)}}ng(),G=ka;break}catch(We){om(i,We)}while(!0);return s&&i.shellSuspendCounter++,Br=hs=null,Ei=g,Xe.H=M,Xe.A=z,vi===null&&(Wi=null,bi=0,Jo()),G}function ng(){for(;vi!==null;)Hf(vi)}function hm(i,s){var u=Ei;Ei|=2;var g=cm(),M=um();Wi!==i||bi!==s?(Nd=null,tu=Na()+500,Zu(i,s)):Uu=fi(i,s);e:do try{if(Vi!==0&&vi!==null){s=vi;var z=Sr;t:switch(Vi){case 1:Vi=0,Sr=null,ko(i,s,z,1);break;case 2:case 9:if(bo(z)){Vi=0,Sr=null,vl(s);break}s=function(){Vi!==2&&Vi!==9||Wi!==i||(Vi=7),Xs(i)},z.then(s,s);break e;case 3:Vi=7;break e;case 4:Vi=5;break e;case 7:bo(z)?(Vi=0,Sr=null,vl(s)):(Vi=0,Sr=null,ko(i,s,z,7));break;case 5:var G=null;switch(vi.tag){case 26:G=vi.memoizedState;case 5:case 27:var Q=vi;if(G?Z(G):Q.stateNode.complete){Vi=0,Sr=null;var _e=Q.sibling;if(_e!==null)vi=_e;else{var Ne=Q.return;Ne!==null?(vi=Ne,xl(Ne)):vi=null}break t}}Vi=0,Sr=null,ko(i,s,z,5);break;case 6:Vi=0,Sr=null,ko(i,s,z,6);break;case 8:qf(),ka=6;break e;default:throw Error(A(462))}}$f();break}catch(We){om(i,We)}while(!0);return Br=hs=null,Xe.H=g,Xe.A=M,Ei=u,vi!==null?0:(Wi=null,bi=0,Jo(),ka)}function $f(){for(;vi!==null&&!eo();)Hf(vi)}function Hf(i){var s=Qp(i.alternate,i,Ro);i.memoizedProps=i.pendingProps,s===null?xl(i):vi=s}function vl(i){var s=i,u=s.alternate;switch(s.tag){case 15:case 0:s=Tf(u,s,s.pendingProps,s.type,void 0,bi);break;case 11:s=Tf(u,s,s.pendingProps,s.type.render,s.ref,bi);break;case 5:c(s);default:Jp(u,s),s=vi=Sd(s,Ro),s=Qp(u,s,Ro)}i.memoizedProps=i.pendingProps,s===null?xl(i):vi=s}function ko(i,s,u,g){Br=hs=null,c(s),wo=null,Vl=0;var M=s.return;try{if(Km(i,M,s,u,bi)){ka=1,Rh(i,Cn(u,i.current)),vi=null;return}}catch(z){if(M!==null)throw vi=M,z;ka=1,Rh(i,Cn(u,i.current)),vi=null;return}s.flags&32768?(ci||g===1?i=!0:Uu||(bi&536870912)!==0?i=!1:(ec=i=!0,(g===2||g===9||g===3||g===6)&&(g=Hi.current,g!==null&&g.tag===13&&(g.flags|=16384))),Xh(s,i)):xl(s)}function xl(i){var s=i;do{if((s.flags&32768)!==0){Xh(s,ec);return}i=s.return;var u=eg(s.alternate,s,Ro);if(u!==null){vi=u;return}if(s=s.sibling,s!==null){vi=s;return}vi=s=i}while(s!==null);ka===0&&(ka=5)}function Xh(i,s){do{var u=tg(i.alternate,i);if(u!==null){u.flags&=32767,vi=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!s&&(i=i.sibling,i!==null)){vi=i;return}vi=i=u}while(i!==null);ka=6,vi=null}function Yh(i,s,u,g,M,z,G,Q,_e){i.cancelPendingCommit=null;do Fd();while(hn!==0);if((Ei&6)!==0)throw Error(A(327));if(s!==null){if(s===i.current)throw Error(A(177));if(z=s.lanes|s.childLanes,z|=Ko,Pa(i,u,z,G,Q,_e),i===Wi&&(vi=Wi=null,bi=0),Vu=s,ic=i,Do=u,Gf=z,Ff=M,qu=g,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,lg(Sn,function(){return Wf(),null})):(i.callbackNode=null,i.callbackPriority=0),g=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||g){g=Xe.T,Xe.T=null,M=gt.p,gt.p=2,G=Ei,Ei|=4;try{Bu(i,s,u)}finally{Ei=G,gt.p=M,Xe.T=g}}hn=1,dm(),fm(),Xf()}}function dm(){if(hn===1){hn=0;var i=ic,s=Vu,u=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||u){u=Xe.T,Xe.T=null;var g=gt.p;gt.p=2;var M=Ei;Ei|=4;try{am(s,i);var z=Qd,G=yi(i.containerInfo),Q=z.focusedElem,_e=z.selectionRange;if(G!==Q&&Q&&Q.ownerDocument&&bu(Q.ownerDocument.documentElement,Q)){if(_e!==null&&wu(Q)){var Ne=_e.start,We=_e.end;if(We===void 0&&(We=Ne),"selectionStart"in Q)Q.selectionStart=Ne,Q.selectionEnd=Math.min(We,Q.value.length);else{var it=Q.ownerDocument||document,Ge=it&&it.defaultView||window;if(Ge.getSelection){var qe=Ge.getSelection(),zt=Q.textContent.length,Zt=Math.min(_e.start,zt),ta=_e.end===void 0?Zt:Math.min(_e.end,zt);!qe.extend&&Zt>ta&&(G=ta,ta=Zt,Zt=G);var ze=xu(Q,Zt),Me=xu(Q,ta);if(ze&&Me&&(qe.rangeCount!==1||qe.anchorNode!==ze.node||qe.anchorOffset!==ze.offset||qe.focusNode!==Me.node||qe.focusOffset!==Me.offset)){var Be=it.createRange();Be.setStart(ze.node,ze.offset),qe.removeAllRanges(),Zt>ta?(qe.addRange(Be),qe.extend(Me.node,Me.offset)):(Be.setEnd(Me.node,Me.offset),qe.addRange(Be))}}}}for(it=[],qe=Q;qe=qe.parentNode;)qe.nodeType===1&&it.push({element:qe,left:qe.scrollLeft,top:qe.scrollTop});for(typeof Q.focus=="function"&&Q.focus(),Q=0;Q<it.length;Q++){var Je=it[Q];Je.element.scrollLeft=Je.left,Je.element.scrollTop=Je.top}}kt=!!Wd,Qd=Wd=null}finally{Ei=M,gt.p=g,Xe.T=u}}i.current=s,hn=2}}function fm(){if(hn===2){hn=0;var i=ic,s=Vu,u=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||u){u=Xe.T,Xe.T=null;var g=gt.p;gt.p=2;var M=Ei;Ei|=4;try{kf(i,s.alternate,s)}finally{Ei=M,gt.p=g,Xe.T=u}}hn=3}}function Xf(){if(hn===4||hn===3){hn=0,Kr();var i=ic,s=Vu,u=Do,g=qu;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?hn=5:(hn=0,Vu=ic=null,Yf(i,i.pendingLanes));var M=i.pendingLanes;if(M===0&&(yl=null),tt(u),s=s.stateNode,pe&&typeof pe.onCommitFiberRoot=="function")try{pe.onCommitFiberRoot(fe,s,void 0,(s.current.flags&128)===128)}catch{}if(g!==null){s=Xe.T,M=gt.p,gt.p=2,Xe.T=null;try{for(var z=i.onRecoverableError,G=0;G<g.length;G++){var Q=g[G];z(Q.value,{componentStack:Q.stack})}}finally{Xe.T=s,gt.p=M}}(Do&3)!==0&&Fd(),Xs(i),M=i.pendingLanes,(u&261930)!==0&&(M&42)!==0?i===Hh?ba++:(ba=0,Hh=i):ba=0,au(0)}}function Yf(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,gn(s)))}function Fd(){return dm(),fm(),Xf(),Wf()}function Wf(){if(hn!==5)return!1;var i=ic,s=Gf;Gf=0;var u=tt(Do),g=Xe.T,M=gt.p;try{gt.p=32>u?32:u,Xe.T=null,u=Ff,Ff=null;var z=ic,G=Do;if(hn=0,Vu=ic=null,Do=0,(Ei&6)!==0)throw Error(A(331));var Q=Ei;if(Ei|=4,Of(z.current),nm(z,z.current,G,u),Ei=Q,au(0,!1),pe&&typeof pe.onPostCommitFiberRoot=="function")try{pe.onPostCommitFiberRoot(fe,z)}catch{}return!0}finally{gt.p=M,Xe.T=g,Yf(i,s)}}function Qf(i,s,u){s=Cn(u,s),s=Ed(i.stateNode,s,2),i=br(i,s,2),i!==null&&(pa(i,2),Xs(i))}function ji(i,s,u){if(i.tag===3)Qf(i,i,u);else for(;s!==null;){if(s.tag===3){Qf(s,i,u);break}else if(s.tag===1){var g=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(yl===null||!yl.has(g))){i=Cn(u,i),u=qp(2),g=br(s,u,2),g!==null&&(Ad(u,g,s,i),pa(g,2),Xs(g));break}}s=s.return}}function Wh(i,s,u){var g=i.pingCache;if(g===null){g=i.pingCache=new Nf;var M=new Set;g.set(s,M)}else M=g.get(s),M===void 0&&(M=new Set,g.set(s,M));M.has(u)||(Qc=!0,M.add(u),i=rg.bind(null,i,s,u),s.then(i,i))}function rg(i,s,u){var g=i.pingCache;g!==null&&g.delete(s),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,Wi===i&&(bi&u)===u&&(ka===4||ka===3&&(bi&62914560)===bi&&300>Na()-$h?(Ei&2)===0&&Zu(i,0):jf|=u,Jc===bi&&(Jc=0)),Xs(i)}function Kf(i,s){s===0&&(s=ui()),i=yr(i,s),i!==null&&(pa(i,s),Xs(i))}function sg(i){var s=i.memoizedState,u=0;s!==null&&(u=s.retryLane),Kf(i,u)}function og(i,s){var u=0;switch(i.tag){case 31:case 13:var g=i.stateNode,M=i.memoizedState;M!==null&&(u=M.retryLane);break;case 19:g=i.stateNode;break;case 22:g=i.stateNode._retryCache;break;default:throw Error(A(314))}g!==null&&g.delete(s),Kf(i,u)}function lg(i,s){return Js(i,s)}var Ud=null,$u=null,Vd=!1,Qh=!1,Hs=!1,cr=0;function Xs(i){i!==$u&&i.next===null&&($u===null?Ud=$u=i:$u=$u.next=i),Qh=!0,Vd||(Vd=!0,Jf())}function au(i,s){if(!Hs&&Qh){Hs=!0;do for(var u=!1,g=Ud;g!==null;){if(i!==0){var M=g.pendingLanes;if(M===0)var z=0;else{var G=g.suspendedLanes,Q=g.pingedLanes;z=(1<<31-Ie(42|i)+1)-1,z&=M&~(G&~Q),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(u=!0,Zd(g,z))}else z=bi,z=ii(g,g===Wi?z:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(z&3)===0||fi(g,z)||(u=!0,Zd(g,z));g=g.next}while(u);Hs=!1}}function cg(){Kh()}function Kh(){Qh=Vd=!1;var i=0;cr!==0&&vm()&&(i=cr);for(var s=Na(),u=null,g=Ud;g!==null;){var M=g.next,z=qd(g,s);z===0?(g.next=null,u===null?Ud=M:u.next=M,M===null&&($u=u)):(u=g,(i!==0||(z&3)!==0)&&(Qh=!0)),g=M}hn!==0&&hn!==5||au(i),cr!==0&&(cr=0)}function qd(i,s){for(var u=i.suspendedLanes,g=i.pingedLanes,M=i.expirationTimes,z=i.pendingLanes&-62914561;0<z;){var G=31-Ie(z),Q=1<<G,_e=M[G];_e===-1?((Q&u)===0||(Q&g)!==0)&&(M[G]=Tt(Q,s)):_e<=s&&(i.expiredLanes|=Q),z&=~Q}if(s=Wi,u=bi,u=ii(i,i===s?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),g=i.callbackNode,u===0||i===s&&(Vi===2||Vi===9)||i.cancelPendingCommit!==null)return g!==null&&g!==null&&Go(g),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||fi(i,u)){if(s=u&-u,s===i.callbackPriority)return s;switch(g!==null&&Go(g),tt(u)){case 2:case 8:u=ws;break;case 32:u=Sn;break;case 268435456:u=$;break;default:u=Sn}return g=pm.bind(null,i),u=Js(u,g),i.callbackPriority=s,i.callbackNode=u,s}return g!==null&&g!==null&&Go(g),i.callbackPriority=2,i.callbackNode=null,2}function pm(i,s){if(hn!==0&&hn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Fd()&&i.callbackNode!==u)return null;var g=bi;return g=ii(i,i===Wi?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),g===0?null:(iu(i,g,s),qd(i,Na()),i.callbackNode!=null&&i.callbackNode===u?pm.bind(null,i):null)}function Zd(i,s){if(Fd())return null;iu(i,s,!0)}function Jf(){bm(function(){(Ei&6)!==0?Js(Zn,cg):Kh()})}function nc(){if(cr===0){var i=cn;i===0&&(i=$e,$e<<=1,($e&261888)===0&&($e=256)),cr=i}return cr}function ep(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Jt(""+i)}function tp(i,s){var u=s.ownerDocument.createElement("input");return u.name=s.name,u.value=s.value,i.id&&u.setAttribute("form",i.id),s.parentNode.insertBefore(u,s),i=new FormData(i),u.parentNode.removeChild(u),i}function ip(i,s,u,g,M){if(s==="submit"&&u&&u.stateNode===M){var z=ep((M[nt]||null).action),G=g.submitter;G&&(s=(s=G[nt]||null)?ep(s.formAction):G.getAttribute("formAction"),s!==null&&(z=s,G=null));var Q=new Pl("action","action",null,g,M);i.push({event:Q,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(cr!==0){var _e=G?tp(M,G):new FormData(M);wr(u,{pending:!0,data:_e,method:M.method,action:z},null,_e)}}else typeof z=="function"&&(Q.preventDefault(),_e=G?tp(M,G):new FormData(M),wr(u,{pending:!0,data:_e,method:M.method,action:z},z,_e))},currentTarget:M}]})}}for(var $d=0;$d<Mu.length;$d++){var Hu=Mu[$d],mm=Hu.toLowerCase(),ug=Hu[0].toUpperCase()+Hu.slice(1);Wn(mm,"on"+ug)}Wn(Tc,"onAnimationEnd"),Wn(Ec,"onAnimationIteration"),Wn(Su,"onAnimationStart"),Wn("dblclick","onDoubleClick"),Wn("focusin","onFocus"),Wn("focusout","onBlur"),Wn(Qo,"onTransitionRun"),Wn(Ac,"onTransitionStart"),Wn(Bl,"onTransitionCancel"),Wn(Yn,"onTransitionEnd"),ts("onMouseEnter",["mouseout","mouseover"]),ts("onMouseLeave",["mouseout","mouseover"]),ts("onPointerEnter",["pointerout","pointerover"]),ts("onPointerLeave",["pointerout","pointerover"]),zi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),zi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),zi("onBeforeInput",["compositionend","keypress","textInput","paste"]),zi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),zi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),zi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jh));function gm(i,s){s=(s&4)!==0;for(var u=0;u<i.length;u++){var g=i[u],M=g.event;g=g.listeners;e:{var z=void 0;if(s)for(var G=g.length-1;0<=G;G--){var Q=g[G],_e=Q.instance,Ne=Q.currentTarget;if(Q=Q.listener,_e!==z&&M.isPropagationStopped())break e;z=Q,M.currentTarget=Ne;try{z(M)}catch(We){ls(We)}M.currentTarget=null,z=_e}else for(G=0;G<g.length;G++){if(Q=g[G],_e=Q.instance,Ne=Q.currentTarget,Q=Q.listener,_e!==z&&M.isPropagationStopped())break e;z=Q,M.currentTarget=Ne;try{z(M)}catch(We){ls(We)}M.currentTarget=null,z=_e}}}}function xi(i,s){var u=s[Wt];u===void 0&&(u=s[Wt]=new Set);var g=i+"__bubble";u.has(g)||(ap(s,i,2,!1),u.add(g))}function ed(i,s,u){var g=0;s&&(g|=4),ap(u,i,g,s)}var Ys="_reactListening"+Math.random().toString(36).slice(2);function Hd(i){if(!i[Ys]){i[Ys]=!0,ga.forEach(function(u){u!=="selectionchange"&&(hg.has(u)||ed(u,!1,i),ed(u,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Ys]||(s[Ys]=!0,ed("selectionchange",!1,s))}}function ap(i,s,u,g){switch(dn(s)){case 2:var M=jt;break;case 8:M=Dt;break;default:M=St}u=M.bind(null,s,u,i),M=void 0,!Tn||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(M=!0),g?M!==void 0?i.addEventListener(s,u,{capture:!0,passive:M}):i.addEventListener(s,u,!0):M!==void 0?i.addEventListener(s,u,{passive:M}):i.addEventListener(s,u,!1)}function Xd(i,s,u,g,M){var z=g;if((s&1)===0&&(s&2)===0&&g!==null)e:for(;;){if(g===null)return;var G=g.tag;if(G===3||G===4){var Q=g.stateNode.containerInfo;if(Q===M)break;if(G===4)for(G=g.return;G!==null;){var _e=G.tag;if((_e===3||_e===4)&&G.stateNode.containerInfo===M)return;G=G.return}for(;Q!==null;){if(G=es(Q),G===null)return;if(_e=G.tag,_e===5||_e===6||_e===26||_e===27){g=z=G;continue e}Q=Q.parentNode}}g=g.return}Zi(function(){var Ne=z,We=ro(u),it=[];e:{var Ge=Sh.get(i);if(Ge!==void 0){var qe=Pl,zt=i;switch(i){case"keypress":if(Bt(u)===0)break e;case"keydown":case"keyup":qe=Cs;break;case"focusin":zt="focus",qe=Ho;break;case"focusout":zt="blur",qe=Ho;break;case"beforeblur":case"afterblur":qe=Ho;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=zl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=Ka;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=vf;break;case Tc:case Ec:case Su:qe=Ja;break;case Yn:qe=xf;break;case"scroll":case"scrollend":qe=gc;break;case"wheel":qe=uh;break;case"copy":case"cut":case"paste":qe=fu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=lh;break;case"toggle":case"beforetoggle":qe=Rl}var Zt=(s&4)!==0,ta=!Zt&&(i==="scroll"||i==="scrollend"),ze=Zt?Ge!==null?Ge+"Capture":null:Ge;Zt=[];for(var Me=Ne,Be;Me!==null;){var Je=Me;if(Be=Je.stateNode,Je=Je.tag,Je!==5&&Je!==26&&Je!==27||Be===null||ze===null||(Je=ns(Me,ze),Je!=null&&Zt.push(Xu(Me,Je,Be))),ta)break;Me=Me.return}0<Zt.length&&(Ge=new qe(Ge,zt,null,u,We),it.push({event:Ge,listeners:Zt}))}}if((s&7)===0){e:{if(Ge=i==="mouseover"||i==="pointerover",qe=i==="mouseout"||i==="pointerout",Ge&&u!==Uo&&(zt=u.relatedTarget||u.fromElement)&&(es(zt)||zt[Xt]))break e;if((qe||Ge)&&(Ge=We.window===We?We:(Ge=We.ownerDocument)?Ge.defaultView||Ge.parentWindow:window,qe?(zt=u.relatedTarget||u.toElement,qe=Ne,zt=zt?es(zt):null,zt!==null&&(ta=D(zt),Zt=zt.tag,zt!==ta||Zt!==5&&Zt!==27&&Zt!==6)&&(zt=null)):(qe=null,zt=Ne),qe!==zt)){if(Zt=zl,Je="onMouseLeave",ze="onMouseEnter",Me="mouse",(i==="pointerout"||i==="pointerover")&&(Zt=lh,Je="onPointerLeave",ze="onPointerEnter",Me="pointer"),ta=qe==null?Ge:Ss(qe),Be=zt==null?Ge:Ss(zt),Ge=new Zt(Je,Me+"leave",qe,u,We),Ge.target=ta,Ge.relatedTarget=Be,Je=null,es(We)===Ne&&(Zt=new Zt(ze,Me+"enter",zt,u,We),Zt.target=Be,Zt.relatedTarget=ta,Je=Zt),ta=Je,qe&&zt)t:{for(Zt=np,ze=qe,Me=zt,Be=0,Je=ze;Je;Je=Zt(Je))Be++;Je=0;for(var Ot=Me;Ot;Ot=Zt(Ot))Je++;for(;0<Be-Je;)ze=Zt(ze),Be--;for(;0<Je-Be;)Me=Zt(Me),Je--;for(;Be--;){if(ze===Me||Me!==null&&ze===Me.alternate){Zt=ze;break t}ze=Zt(ze),Me=Zt(Me)}Zt=null}else Zt=null;qe!==null&&rp(it,Ge,qe,Zt,!1),zt!==null&&ta!==null&&rp(it,ta,zt,Zt,!0)}}e:{if(Ge=Ne?Ss(Ne):window,qe=Ge.nodeName&&Ge.nodeName.toLowerCase(),qe==="select"||qe==="input"&&Ge.type==="file")var Bi=lo;else if(ph(Ge))if(mh)Bi=bd;else{Bi=_h;var yt=vd}else qe=Ge.nodeName,!qe||qe.toLowerCase()!=="input"||Ge.type!=="checkbox"&&Ge.type!=="radio"?Ne&&no(Ne.elementType)&&(Bi=lo):Bi=xd;if(Bi&&(Bi=Bi(i,Ne))){yu(it,Bi,u,We);break e}yt&&yt(i,Ge,Ne),i==="focusout"&&Ne&&Ge.type==="number"&&Ne.memoizedProps.value!=null&&Ts(Ge,"number",Ge.value)}switch(yt=Ne?Ss(Ne):window,i){case"focusin":(ph(yt)||yt.contentEditable==="true")&&(_r=yt,Sc=Ne,Mc=null);break;case"focusout":Mc=Sc=_r=null;break;case"mousedown":xh=!0;break;case"contextmenu":case"mouseup":case"dragend":xh=!1,wd(it,u,We);break;case"selectionchange":if(vh)break;case"keydown":case"keyup":wd(it,u,We)}var Gt;if(Xn)e:{switch(i){case"compositionstart":var ri="onCompositionStart";break e;case"compositionend":ri="onCompositionEnd";break e;case"compositionupdate":ri="onCompositionUpdate";break e}ri=void 0}else kr?vc(i,u)&&(ri="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(ri="onCompositionStart");ri&&(Xo&&u.locale!=="ko"&&(kr||ri!=="onCompositionStart"?ri==="onCompositionEnd"&&kr&&(Gt=ai()):(mr=We,Ii="value"in mr?mr.value:mr.textContent,kr=!0)),yt=td(Ne,ri),0<yt.length&&(ri=new fd(ri,i,null,u,We),it.push({event:ri,listeners:yt}),Gt?ri.data=Gt:(Gt=md(u),Gt!==null&&(ri.data=Gt)))),(Gt=dh?gd(i,u):fh(i,u))&&(ri=td(Ne,"onBeforeInput"),0<ri.length&&(yt=new fd("onBeforeInput","beforeinput",null,u,We),it.push({event:yt,listeners:ri}),yt.data=Gt)),ip(it,i,Ne,u,We)}gm(it,s)})}function Xu(i,s,u){return{instance:i,listener:s,currentTarget:u}}function td(i,s){for(var u=s+"Capture",g=[];i!==null;){var M=i,z=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||z===null||(M=ns(i,u),M!=null&&g.unshift(Xu(i,M,z)),M=ns(i,s),M!=null&&g.push(Xu(i,M,z))),i.tag===3)return g;i=i.return}return[]}function np(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function rp(i,s,u,g,M){for(var z=s._reactName,G=[];u!==null&&u!==g;){var Q=u,_e=Q.alternate,Ne=Q.stateNode;if(Q=Q.tag,_e!==null&&_e===g)break;Q!==5&&Q!==26&&Q!==27||Ne===null||(_e=Ne,M?(Ne=ns(u,z),Ne!=null&&G.unshift(Xu(u,Ne,_e))):M||(Ne=ns(u,z),Ne!=null&&G.push(Xu(u,Ne,_e)))),u=u.return}G.length!==0&&i.push({event:s,listeners:G})}var id=/\r\n?/g,_m=/\u0000|\uFFFD/g;function Yd(i){return(typeof i=="string"?i:""+i).replace(id,`
`).replace(_m,"")}function sp(i,s){return s=Yd(s),Yd(i)===s}function di(i,s,u,g,M,z){switch(u){case"children":typeof g=="string"?s==="body"||s==="textarea"&&g===""||as(i,g):(typeof g=="number"||typeof g=="bigint")&&s!=="body"&&as(i,""+g);break;case"className":Al(i,"class",g);break;case"tabIndex":Al(i,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Al(i,u,g);break;case"style":li(i,g,z);break;case"data":if(s!=="object"){Al(i,"data",g);break}case"src":case"href":if(g===""&&(s!=="a"||u!=="href")){i.removeAttribute(u);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){i.removeAttribute(u);break}g=Jt(""+g),i.setAttribute(u,g);break;case"action":case"formAction":if(typeof g=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(u==="formAction"?(s!=="input"&&di(i,s,"name",M.name,M,null),di(i,s,"formEncType",M.formEncType,M,null),di(i,s,"formMethod",M.formMethod,M,null),di(i,s,"formTarget",M.formTarget,M,null)):(di(i,s,"encType",M.encType,M,null),di(i,s,"method",M.method,M,null),di(i,s,"target",M.target,M,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){i.removeAttribute(u);break}g=Jt(""+g),i.setAttribute(u,g);break;case"onClick":g!=null&&(i.onclick=Hn);break;case"onScroll":g!=null&&xi("scroll",i);break;case"onScrollEnd":g!=null&&xi("scrollend",i);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(A(61));if(u=g.__html,u!=null){if(M.children!=null)throw Error(A(60));i.innerHTML=u}}break;case"multiple":i.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":i.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){i.removeAttribute("xlink:href");break}u=Jt(""+g),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,""+g):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":g===!0?i.setAttribute(u,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,g):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?i.setAttribute(u,g):i.removeAttribute(u);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?i.removeAttribute(u):i.setAttribute(u,g);break;case"popover":xi("beforetoggle",i),xi("toggle",i),fc(i,"popover",g);break;case"xlinkActuate":is(i,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":is(i,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":is(i,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":is(i,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":is(i,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":is(i,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":is(i,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":is(i,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":is(i,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":fc(i,"is",g);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Mn.get(u)||u,fc(i,u,g))}}function rc(i,s,u,g,M,z){switch(u){case"style":li(i,g,z);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(A(61));if(u=g.__html,u!=null){if(M.children!=null)throw Error(A(60));i.innerHTML=u}}break;case"children":typeof g=="string"?as(i,g):(typeof g=="number"||typeof g=="bigint")&&as(i,""+g);break;case"onScroll":g!=null&&xi("scroll",i);break;case"onScrollEnd":g!=null&&xi("scrollend",i);break;case"onClick":g!=null&&(i.onclick=Hn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kn.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(M=u.endsWith("Capture"),s=u.slice(2,M?u.length-7:void 0),z=i[nt]||null,z=z!=null?z[u]:null,typeof z=="function"&&i.removeEventListener(s,z,M),typeof g=="function")){typeof z!="function"&&z!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(s,g,M);break e}u in i?i[u]=g:g===!0?i.setAttribute(u,""):fc(i,u,g)}}}function Za(i,s,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xi("error",i),xi("load",i);var g=!1,M=!1,z;for(z in u)if(u.hasOwnProperty(z)){var G=u[z];if(G!=null)switch(z){case"src":g=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(A(137,s));default:di(i,s,z,G,u,null)}}M&&di(i,s,"srcSet",u.srcSet,u,null),g&&di(i,s,"src",u.src,u,null);return;case"input":xi("invalid",i);var Q=z=G=M=null,_e=null,Ne=null;for(g in u)if(u.hasOwnProperty(g)){var We=u[g];if(We!=null)switch(g){case"name":M=We;break;case"type":G=We;break;case"checked":_e=We;break;case"defaultChecked":Ne=We;break;case"value":z=We;break;case"defaultValue":Q=We;break;case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(A(137,s));break;default:di(i,s,g,We,u,null)}}sh(i,z,Q,_e,Ne,G,M,!1);return;case"select":xi("invalid",i),g=G=z=null;for(M in u)if(u.hasOwnProperty(M)&&(Q=u[M],Q!=null))switch(M){case"value":z=Q;break;case"defaultValue":G=Q;break;case"multiple":g=Q;default:di(i,s,M,Q,u,null)}s=z,u=G,i.multiple=!!g,s!=null?ao(i,!!g,s,!1):u!=null&&ao(i,!!g,u,!0);return;case"textarea":xi("invalid",i),z=M=g=null;for(G in u)if(u.hasOwnProperty(G)&&(Q=u[G],Q!=null))switch(G){case"value":g=Q;break;case"defaultValue":M=Q;break;case"children":z=Q;break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(A(91));break;default:di(i,s,G,Q,u,null)}Cl(i,g,M,z);return;case"option":for(_e in u)if(u.hasOwnProperty(_e)&&(g=u[_e],g!=null))switch(_e){case"selected":i.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:di(i,s,_e,g,u,null)}return;case"dialog":xi("beforetoggle",i),xi("toggle",i),xi("cancel",i),xi("close",i);break;case"iframe":case"object":xi("load",i);break;case"video":case"audio":for(g=0;g<Jh.length;g++)xi(Jh[g],i);break;case"image":xi("error",i),xi("load",i);break;case"details":xi("toggle",i);break;case"embed":case"source":case"link":xi("error",i),xi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in u)if(u.hasOwnProperty(Ne)&&(g=u[Ne],g!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(A(137,s));default:di(i,s,Ne,g,u,null)}return;default:if(no(s)){for(We in u)u.hasOwnProperty(We)&&(g=u[We],g!==void 0&&rc(i,s,We,g,u,void 0));return}}for(Q in u)u.hasOwnProperty(Q)&&(g=u[Q],g!=null&&di(i,s,Q,g,u,null))}function nu(i,s,u,g){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,z=null,G=null,Q=null,_e=null,Ne=null,We=null;for(qe in u){var it=u[qe];if(u.hasOwnProperty(qe)&&it!=null)switch(qe){case"checked":break;case"value":break;case"defaultValue":_e=it;default:g.hasOwnProperty(qe)||di(i,s,qe,null,g,it)}}for(var Ge in g){var qe=g[Ge];if(it=u[Ge],g.hasOwnProperty(Ge)&&(qe!=null||it!=null))switch(Ge){case"type":z=qe;break;case"name":M=qe;break;case"checked":Ne=qe;break;case"defaultChecked":We=qe;break;case"value":G=qe;break;case"defaultValue":Q=qe;break;case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(A(137,s));break;default:qe!==it&&di(i,s,Ge,qe,g,it)}}mc(i,G,Q,_e,Ne,We,z,M);return;case"select":qe=G=Q=Ge=null;for(z in u)if(_e=u[z],u.hasOwnProperty(z)&&_e!=null)switch(z){case"value":break;case"multiple":qe=_e;default:g.hasOwnProperty(z)||di(i,s,z,null,g,_e)}for(M in g)if(z=g[M],_e=u[M],g.hasOwnProperty(M)&&(z!=null||_e!=null))switch(M){case"value":Ge=z;break;case"defaultValue":Q=z;break;case"multiple":G=z;default:z!==_e&&di(i,s,M,z,g,_e)}s=Q,u=G,g=qe,Ge!=null?ao(i,!!u,Ge,!1):!!g!=!!u&&(s!=null?ao(i,!!u,s,!0):ao(i,!!u,u?[]:"",!1));return;case"textarea":qe=Ge=null;for(Q in u)if(M=u[Q],u.hasOwnProperty(Q)&&M!=null&&!g.hasOwnProperty(Q))switch(Q){case"value":break;case"children":break;default:di(i,s,Q,null,g,M)}for(G in g)if(M=g[G],z=u[G],g.hasOwnProperty(G)&&(M!=null||z!=null))switch(G){case"value":Ge=M;break;case"defaultValue":qe=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(A(91));break;default:M!==z&&di(i,s,G,M,g,z)}hd(i,Ge,qe);return;case"option":for(var zt in u)if(Ge=u[zt],u.hasOwnProperty(zt)&&Ge!=null&&!g.hasOwnProperty(zt))switch(zt){case"selected":i.selected=!1;break;default:di(i,s,zt,null,g,Ge)}for(_e in g)if(Ge=g[_e],qe=u[_e],g.hasOwnProperty(_e)&&Ge!==qe&&(Ge!=null||qe!=null))switch(_e){case"selected":i.selected=Ge&&typeof Ge!="function"&&typeof Ge!="symbol";break;default:di(i,s,_e,Ge,g,qe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Zt in u)Ge=u[Zt],u.hasOwnProperty(Zt)&&Ge!=null&&!g.hasOwnProperty(Zt)&&di(i,s,Zt,null,g,Ge);for(Ne in g)if(Ge=g[Ne],qe=u[Ne],g.hasOwnProperty(Ne)&&Ge!==qe&&(Ge!=null||qe!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(Ge!=null)throw Error(A(137,s));break;default:di(i,s,Ne,Ge,g,qe)}return;default:if(no(s)){for(var ta in u)Ge=u[ta],u.hasOwnProperty(ta)&&Ge!==void 0&&!g.hasOwnProperty(ta)&&rc(i,s,ta,void 0,g,Ge);for(We in g)Ge=g[We],qe=u[We],!g.hasOwnProperty(We)||Ge===qe||Ge===void 0&&qe===void 0||rc(i,s,We,Ge,g,qe);return}}for(var ze in u)Ge=u[ze],u.hasOwnProperty(ze)&&Ge!=null&&!g.hasOwnProperty(ze)&&di(i,s,ze,null,g,Ge);for(it in g)Ge=g[it],qe=u[it],!g.hasOwnProperty(it)||Ge===qe||Ge==null&&qe==null||di(i,s,it,Ge,g,qe)}function op(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ym(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,u=performance.getEntriesByType("resource"),g=0;g<u.length;g++){var M=u[g],z=M.transferSize,G=M.initiatorType,Q=M.duration;if(z&&Q&&op(G)){for(G=0,Q=M.responseEnd,g+=1;g<u.length;g++){var _e=u[g],Ne=_e.startTime;if(Ne>Q)break;var We=_e.transferSize,it=_e.initiatorType;We&&op(it)&&(_e=_e.responseEnd,G+=We*(_e<Q?1:(Q-Ne)/(_e-Ne)))}if(--g,s+=8*(z+G)/(M.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Wd=null,Qd=null;function Kd(i){return i.nodeType===9?i:i.ownerDocument}function lp(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bl(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Jd(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ef=null;function vm(){var i=window.event;return i&&i.type==="popstate"?i===ef?!1:(ef=i,!0):(ef=null,!1)}var cp=typeof setTimeout=="function"?setTimeout:void 0,dg=typeof clearTimeout=="function"?clearTimeout:void 0,xm=typeof Promise=="function"?Promise:void 0,bm=typeof queueMicrotask=="function"?queueMicrotask:typeof xm<"u"?function(i){return xm.resolve(null).then(i).catch(wm)}:cp;function wm(i){setTimeout(function(){throw i})}function Ws(i){return i==="head"}function up(i,s){var u=s,g=0;do{var M=u.nextSibling;if(i.removeChild(u),M&&M.nodeType===8)if(u=M.data,u==="/$"||u==="/&"){if(g===0){i.removeChild(M),Vn(s);return}g--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")g++;else if(u==="html")Wu(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Wu(u);for(var z=u.firstChild;z;){var G=z.nextSibling,Q=z.nodeName;z[Ht]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&z.rel.toLowerCase()==="stylesheet"||u.removeChild(z),z=G}}else u==="body"&&Wu(i.ownerDocument.body);u=M}while(u);Vn(s)}function ad(i,s){var u=i;i=0;do{var g=u.nextSibling;if(u.nodeType===1?s?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(s?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),g&&g.nodeType===8)if(u=g.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=g}while(u)}function Yu(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var u=s;switch(s=s.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Yu(u),to(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function tf(i,s,u,g){for(;i.nodeType===1;){var M=u;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!g&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(g){if(!i[Ht])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(z=i.getAttribute("rel"),z==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(z!==M.rel||i.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||i.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||i.getAttribute("title")!==(M.title==null?null:M.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(z=i.getAttribute("src"),(z!==(M.src==null?null:M.src)||i.getAttribute("type")!==(M.type==null?null:M.type)||i.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&z&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var z=M.name==null?null:""+M.name;if(M.type==="hidden"&&i.getAttribute("name")===z)return i}else return i;if(i=Tr(i.nextSibling),i===null)break}return null}function fg(i,s,u){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Tr(i.nextSibling),i===null))return null;return i}function Sm(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=Tr(i.nextSibling),i===null))return null;return i}function hp(i){return i.data==="$?"||i.data==="$~"}function sc(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function xn(i,s){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||u.readyState!=="loading")s();else{var g=function(){s(),u.removeEventListener("DOMContentLoaded",g)};u.addEventListener("DOMContentLoaded",g),i._reactRetry=g}}function Tr(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var af=null;function dp(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(s===0)return Tr(i.nextSibling);s--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||s++}i=i.nextSibling}return null}function nf(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(s===0)return i;s--}else u!=="/$"&&u!=="/&"||s++}i=i.previousSibling}return null}function Mm(i,s,u){switch(s=Kd(u),i){case"html":if(i=s.documentElement,!i)throw Error(A(452));return i;case"head":if(i=s.head,!i)throw Error(A(453));return i;case"body":if(i=s.body,!i)throw Error(A(454));return i;default:throw Error(A(451))}}function Wu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);to(i)}var Xr=new Map,Tm=new Set;function nd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Qs=gt.d;gt.d={f:fp,r:Em,D:Am,C:pp,L:sf,m:rd,X:gp,S:mp,M:_p};function fp(){var i=Qs.f(),s=jd();return i||s}function Em(i){var s=pr(i);s!==null&&s.tag===5&&s.type==="form"?Nn(s):Qs.r(i)}var Lo=typeof document>"u"?null:document;function rf(i,s,u){var g=Lo;if(g&&typeof s=="string"&&s){var M=Wa(s);M='link[rel="'+i+'"][href="'+M+'"]',typeof u=="string"&&(M+='[crossorigin="'+u+'"]'),Tm.has(M)||(Tm.add(M),i={rel:i,crossOrigin:u,href:s},g.querySelector(M)===null&&(s=g.createElement("link"),Za(s,"link",i),oa(s),g.head.appendChild(s)))}}function Am(i){Qs.D(i),rf("dns-prefetch",i,null)}function pp(i,s){Qs.C(i,s),rf("preconnect",i,s)}function sf(i,s,u){Qs.L(i,s,u);var g=Lo;if(g&&i&&s){var M='link[rel="preload"][as="'+Wa(s)+'"]';s==="image"&&u&&u.imageSrcSet?(M+='[imagesrcset="'+Wa(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(M+='[imagesizes="'+Wa(u.imageSizes)+'"]')):M+='[href="'+Wa(i)+'"]';var z=M;switch(s){case"style":z=n(i);break;case"script":z=d(i)}Xr.has(z)||(i=J({rel:"preload",href:s==="image"&&u&&u.imageSrcSet?void 0:i,as:s},u),Xr.set(z,i),g.querySelector(M)!==null||s==="style"&&g.querySelector(t(z))||s==="script"&&g.querySelector(_(z))||(s=g.createElement("link"),Za(s,"link",i),oa(s),g.head.appendChild(s)))}}function rd(i,s){Qs.m(i,s);var u=Lo;if(u&&i){var g=s&&typeof s.as=="string"?s.as:"script",M='link[rel="modulepreload"][as="'+Wa(g)+'"][href="'+Wa(i)+'"]',z=M;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=d(i)}if(!Xr.has(z)&&(i=J({rel:"modulepreload",href:i},s),Xr.set(z,i),u.querySelector(M)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(_(z)))return}g=u.createElement("link"),Za(g,"link",i),oa(g),u.head.appendChild(g)}}}function mp(i,s,u){Qs.S(i,s,u);var g=Lo;if(g&&i){var M=Dn(g).hoistableStyles,z=n(i);s=s||"default";var G=M.get(z);if(!G){var Q={loading:0,preload:null};if(G=g.querySelector(t(z)))Q.loading=5;else{i=J({rel:"stylesheet",href:i,"data-precedence":s},u),(u=Xr.get(z))&&S(i,u);var _e=G=g.createElement("link");oa(_e),Za(_e,"link",i),_e._p=new Promise(function(Ne,We){_e.onload=Ne,_e.onerror=We}),_e.addEventListener("load",function(){Q.loading|=1}),_e.addEventListener("error",function(){Q.loading|=2}),Q.loading|=4,b(G,s,g)}G={type:"stylesheet",instance:G,count:1,state:Q},M.set(z,G)}}}function gp(i,s){Qs.X(i,s);var u=Lo;if(u&&i){var g=Dn(u).hoistableScripts,M=d(i),z=g.get(M);z||(z=u.querySelector(_(M)),z||(i=J({src:i,async:!0},s),(s=Xr.get(M))&&I(i,s),z=u.createElement("script"),oa(z),Za(z,"link",i),u.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},g.set(M,z))}}function _p(i,s){Qs.M(i,s);var u=Lo;if(u&&i){var g=Dn(u).hoistableScripts,M=d(i),z=g.get(M);z||(z=u.querySelector(_(M)),z||(i=J({src:i,async:!0,type:"module"},s),(s=Xr.get(M))&&I(i,s),z=u.createElement("script"),oa(z),Za(z,"link",i),u.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},g.set(M,z))}}function Cm(i,s,u,g){var M=(M=Ft.current)?nd(M):null;if(!M)throw Error(A(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(s=n(u.href),u=Dn(M).hoistableStyles,g=u.get(s),g||(g={type:"style",instance:null,count:0,state:null},u.set(s,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=n(u.href);var z=Dn(M).hoistableStyles,G=z.get(i);if(G||(M=M.ownerDocument||M,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(i,G),(z=M.querySelector(t(i)))&&!z._p&&(G.instance=z,G.state.loading=5),Xr.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Xr.set(i,u),z||o(M,i,u,G.state))),s&&g===null)throw Error(A(528,""));return G}if(s&&g!==null)throw Error(A(529,""));return null;case"script":return s=u.async,u=u.src,typeof u=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=d(u),u=Dn(M).hoistableScripts,g=u.get(s),g||(g={type:"script",instance:null,count:0,state:null},u.set(s,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(A(444,i))}}function n(i){return'href="'+Wa(i)+'"'}function t(i){return'link[rel="stylesheet"]['+i+"]"}function a(i){return J({},i,{"data-precedence":i.precedence,precedence:null})}function o(i,s,u,g){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?g.loading=1:(s=i.createElement("link"),g.preload=s,s.addEventListener("load",function(){return g.loading|=1}),s.addEventListener("error",function(){return g.loading|=2}),Za(s,"link",u),oa(s),i.head.appendChild(s))}function d(i){return'[src="'+Wa(i)+'"]'}function _(i){return"script[async]"+i}function v(i,s,u){if(s.count++,s.instance===null)switch(s.type){case"style":var g=i.querySelector('style[data-href~="'+Wa(u.href)+'"]');if(g)return s.instance=g,oa(g),g;var M=J({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return g=(i.ownerDocument||i).createElement("style"),oa(g),Za(g,"style",M),b(g,u.precedence,i),s.instance=g;case"stylesheet":M=n(u.href);var z=i.querySelector(t(M));if(z)return s.state.loading|=4,s.instance=z,oa(z),z;g=a(u),(M=Xr.get(M))&&S(g,M),z=(i.ownerDocument||i).createElement("link"),oa(z);var G=z;return G._p=new Promise(function(Q,_e){G.onload=Q,G.onerror=_e}),Za(z,"link",g),s.state.loading|=4,b(z,u.precedence,i),s.instance=z;case"script":return z=d(u.src),(M=i.querySelector(_(z)))?(s.instance=M,oa(M),M):(g=u,(M=Xr.get(z))&&(g=J({},u),I(g,M)),i=i.ownerDocument||i,M=i.createElement("script"),oa(M),Za(M,"link",g),i.head.appendChild(M),s.instance=M);case"void":return null;default:throw Error(A(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(g=s.instance,s.state.loading|=4,b(g,u.precedence,i));return s.instance}function b(i,s,u){for(var g=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=g.length?g[g.length-1]:null,z=M,G=0;G<g.length;G++){var Q=g[G];if(Q.dataset.precedence===s)z=Q;else if(z!==M)break}z?z.parentNode.insertBefore(i,z.nextSibling):(s=u.nodeType===9?u.head:u,s.insertBefore(i,s.firstChild))}function S(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function I(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var R=null;function O(i,s,u){if(R===null){var g=new Map,M=R=new Map;M.set(u,g)}else M=R,g=M.get(u),g||(g=new Map,M.set(u,g));if(g.has(i))return g;for(g.set(i,null),u=u.getElementsByTagName(i),M=0;M<u.length;M++){var z=u[M];if(!(z[Ht]||z[_i]||i==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var G=z.getAttribute(s)||"";G=i+G;var Q=g.get(G);Q?Q.push(z):g.set(G,[z])}}return g}function F(i,s,u){i=i.ownerDocument||i,i.head.insertBefore(u,s==="title"?i.querySelector("head > title"):null)}function V(i,s,u){if(u===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Z(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Y(i,s,u,g){if(u.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var M=n(g.href),z=s.querySelector(t(M));if(z){s=z._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=Te.bind(i),s.then(i,i)),u.state.loading|=4,u.instance=z,oa(z);return}z=s.ownerDocument||s,g=a(g),(M=Xr.get(M))&&S(g,M),z=z.createElement("link"),oa(z);var G=z;G._p=new Promise(function(Q,_e){G.onload=Q,G.onerror=_e}),Za(z,"link",g),u.instance=z}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,s),(s=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=Te.bind(i),s.addEventListener("load",u),s.addEventListener("error",u))}}var te=0;function se(i,s){return i.stylesheets&&i.count===0&&ge(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var g=setTimeout(function(){if(i.stylesheets&&ge(i,i.stylesheets),i.unsuspend){var z=i.unsuspend;i.unsuspend=null,z()}},6e4+s);0<i.imgBytes&&te===0&&(te=62500*ym());var M=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&ge(i,i.stylesheets),i.unsuspend)){var z=i.unsuspend;i.unsuspend=null,z()}},(i.imgBytes>te?50:800)+s);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(g),clearTimeout(M)}}:null}function Te(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ge(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var de=null;function ge(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,de=new Map,s.forEach(De,i),de=null,Te.call(i))}function De(i,s){if(!(s.state.loading&4)){var u=de.get(i);if(u)var g=u.get(null);else{u=new Map,de.set(i,u);for(var M=i.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<M.length;z++){var G=M[z];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(u.set(G.dataset.precedence,G),g=G)}g&&u.set(null,g)}M=s.instance,G=M.getAttribute("data-precedence"),z=u.get(G)||g,z===g&&u.set(null,M),u.set(G,M),this.count++,g=Te.bind(this),M.addEventListener("load",g),M.addEventListener("error",g),z?z.parentNode.insertBefore(M,z.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(M,i.firstChild)),s.state.loading|=4}}var je={$$typeof:He,Provider:null,Consumer:null,_currentValue:Nt,_currentValue2:Nt,_threadCount:0};function et(i,s,u,g,M,z,G,Q,_e){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ta(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ta(0),this.hiddenUpdates=Ta(null),this.identifierPrefix=g,this.onUncaughtError=M,this.onCaughtError=z,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=_e,this.incompleteTransitions=new Map}function dt(i,s,u,g,M,z,G,Q,_e,Ne,We,it){return i=new et(i,s,u,G,_e,Ne,We,it,Q),s=1,z===!0&&(s|=24),z=Qn(3,null,null,s),i.current=z,z.stateNode=i,s=Lc(),s.refCount++,i.pooledCache=s,s.refCount++,z.memoizedState={element:g,isDehydrated:u,cache:s},fs(z),i}function ot(i){return i?(i=Kt,i):Kt}function ut(i,s,u,g,M,z){M=ot(M),g.context===null?g.context=M:g.pendingContext=M,g=js(s),g.payload={element:u},z=z===void 0?null:z,z!==null&&(g.callback=z),u=br(i,g,s),u!==null&&(Fn(u,i,s),To(u,i,s))}function Ct(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<s?u:s}}function ct(i,s){Ct(i,s),(i=i.alternate)&&Ct(i,s)}function ht(i){if(i.tag===13||i.tag===31){var s=yr(i,67108864);s!==null&&Fn(s,i,67108864),ct(i,67108864)}}function Ye(i){if(i.tag===13||i.tag===31){var s=Mr();s=Mi(s);var u=yr(i,s);u!==null&&Fn(u,i,s),ct(i,s)}}var kt=!0;function jt(i,s,u,g){var M=Xe.T;Xe.T=null;var z=gt.p;try{gt.p=2,St(i,s,u,g)}finally{gt.p=z,Xe.T=M}}function Dt(i,s,u,g){var M=Xe.T;Xe.T=null;var z=gt.p;try{gt.p=8,St(i,s,u,g)}finally{gt.p=z,Xe.T=M}}function St(i,s,u,g){if(kt){var M=ti(g);if(M===null)Xd(i,s,g,ea,u),Er(i,g);else if(hr(M,i,s,u,g))g.stopPropagation();else if(Er(i,g),s&4&&-1<Un.indexOf(i)){for(;M!==null;){var z=pr(M);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var G=Ae(z.pendingLanes);if(G!==0){var Q=z;for(Q.pendingLanes|=2,Q.entangledLanes|=2;G;){var _e=1<<31-Ie(G);Q.entanglements[1]|=_e,G&=~_e}Xs(z),(Ei&6)===0&&(tu=Na()+500,au(0))}}break;case 31:case 13:Q=yr(z,2),Q!==null&&Fn(Q,z,2),jd(),ct(z,2)}if(z=ti(g),z===null&&Xd(i,s,g,ea,u),z===M)break;M=z}M!==null&&g.stopPropagation()}else Xd(i,s,g,null,u)}}function ti(i){return i=ro(i),Ea(i)}var ea=null;function Ea(i){if(ea=null,i=es(i),i!==null){var s=D(i);if(s===null)i=null;else{var u=s.tag;if(u===13){if(i=E(s),i!==null)return i;i=null}else if(u===31){if(i=l(s),i!==null)return i;i=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return ea=i,null}function dn(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(dc()){case Zn:return 2;case ws:return 8;case Sn:case we:return 32;case $:return 268435456;default:return 32}default:return 32}}var ur=!1,La=null,ha=null,Ri=null,wa=new Map,Aa=new Map,da=[],Un="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Er(i,s){switch(i){case"focusin":case"focusout":La=null;break;case"dragenter":case"dragleave":ha=null;break;case"mouseover":case"mouseout":Ri=null;break;case"pointerover":case"pointerout":wa.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Aa.delete(s.pointerId)}}function Sa(i,s,u,g,M,z){return i===null||i.nativeEvent!==z?(i={blockedOn:s,domEventName:u,eventSystemFlags:g,nativeEvent:z,targetContainers:[M]},s!==null&&(s=pr(s),s!==null&&ht(s)),i):(i.eventSystemFlags|=g,s=i.targetContainers,M!==null&&s.indexOf(M)===-1&&s.push(M),i)}function hr(i,s,u,g,M){switch(s){case"focusin":return La=Sa(La,i,s,u,g,M),!0;case"dragenter":return ha=Sa(ha,i,s,u,g,M),!0;case"mouseover":return Ri=Sa(Ri,i,s,u,g,M),!0;case"pointerover":var z=M.pointerId;return wa.set(z,Sa(wa.get(z)||null,i,s,u,g,M)),!0;case"gotpointercapture":return z=M.pointerId,Aa.set(z,Sa(Aa.get(z)||null,i,s,u,g,M)),!0}return!1}function Oa(i){var s=es(i.target);if(s!==null){var u=D(s);if(u!==null){if(s=u.tag,s===13){if(s=E(u),s!==null){i.blockedOn=s,Rn(i.priority,function(){Ye(u)});return}}else if(s===31){if(s=l(u),s!==null){i.blockedOn=s,Rn(i.priority,function(){Ye(u)});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ca(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var u=ti(i.nativeEvent);if(u===null){u=i.nativeEvent;var g=new u.constructor(u.type,u);Uo=g,u.target.dispatchEvent(g),Uo=null}else return s=pr(u),s!==null&&ht(s),i.blockedOn=u,!1;s.shift()}return!0}function $a(i,s,u){Ca(i)&&u.delete(s)}function Ba(){ur=!1,La!==null&&Ca(La)&&(La=null),ha!==null&&Ca(ha)&&(ha=null),Ri!==null&&Ca(Ri)&&(Ri=null),wa.forEach($a),Aa.forEach($a)}function Gi(i,s){i.blockedOn===s&&(i.blockedOn=null,ur||(ur=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,Ba)))}var Ar=null;function ru(i){Ar!==i&&(Ar=i,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){Ar===i&&(Ar=null);for(var s=0;s<i.length;s+=3){var u=i[s],g=i[s+1],M=i[s+2];if(typeof g!="function"){if(Ea(g||u)===null)continue;break}var z=pr(u);z!==null&&(i.splice(s,3),s-=3,wr(z,{pending:!0,data:M,method:u.method,action:g},g,M))}}))}function Vn(i){function s(_e){return Gi(_e,i)}La!==null&&Gi(La,i),ha!==null&&Gi(ha,i),Ri!==null&&Gi(Ri,i),wa.forEach(s),Aa.forEach(s);for(var u=0;u<da.length;u++){var g=da[u];g.blockedOn===i&&(g.blockedOn=null)}for(;0<da.length&&(u=da[0],u.blockedOn===null);)Oa(u),u.blockedOn===null&&da.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(g=0;g<u.length;g+=3){var M=u[g],z=u[g+1],G=M[nt]||null;if(typeof z=="function")G||ru(u);else if(G){var Q=null;if(z&&z.hasAttribute("formAction")){if(M=z,G=z[nt]||null)Q=G.formAction;else if(Ea(M)!==null)continue}else Q=G.action;typeof Q=="function"?u[g+1]=Q:(u.splice(g,3),g-=3),ru(u)}}}function Pm(){function i(z){z.canIntercept&&z.info==="react-transition"&&z.intercept({handler:function(){return new Promise(function(G){return M=G})},focusReset:"manual",scroll:"manual"})}function s(){M!==null&&(M(),M=null),g||setTimeout(u,20)}function u(){if(!g&&!navigation.transition){var z=navigation.currentEntry;z&&z.url!=null&&navigation.navigate(z.url,{state:z.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,M=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(u,100),function(){g=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),M!==null&&(M(),M=null)}}}function oc(i){this._internalRoot=i}Oo.prototype.render=oc.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(A(409));var u=s.current,g=Mr();ut(u,g,i,s,null,null)},Oo.prototype.unmount=oc.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;ut(i.current,2,null,i,null,null),jd(),s[Xt]=null}};function Oo(i){this._internalRoot=i}Oo.prototype.unstable_scheduleHydration=function(i){if(i){var s=Ir();i={blockedOn:null,target:i,priority:s};for(var u=0;u<da.length&&s!==0&&s<da[u].priority;u++);da.splice(u,0,i),u===0&&Oa(i)}};var su=y.version;if(su!=="19.2.0")throw Error(A(527,su,"19.2.0"));gt.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(A(188)):(i=Object.keys(i).join(","),Error(A(268,i)));return i=U(s),i=i!==null?ee(i):null,i=i===null?null:i.stateNode,i};var Qu={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Xe,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{fe=wl.inject(Qu),pe=wl}catch{}}return vp.createRoot=function(i,s){if(!P(i))throw Error(A(299));var u=!1,g="",M=Mf,z=Vp,G=Td;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onUncaughtError!==void 0&&(M=s.onUncaughtError),s.onCaughtError!==void 0&&(z=s.onCaughtError),s.onRecoverableError!==void 0&&(G=s.onRecoverableError)),s=dt(i,1,!1,null,null,u,g,null,M,z,G,Pm),i[Xt]=s.current,Hd(i),new oc(s)},vp.hydrateRoot=function(i,s,u){if(!P(i))throw Error(A(299));var g=!1,M="",z=Mf,G=Vp,Q=Td,_e=null;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(M=u.identifierPrefix),u.onUncaughtError!==void 0&&(z=u.onUncaughtError),u.onCaughtError!==void 0&&(G=u.onCaughtError),u.onRecoverableError!==void 0&&(Q=u.onRecoverableError),u.formState!==void 0&&(_e=u.formState)),s=dt(i,1,!0,s,u??null,g,M,_e,z,G,Q,Pm),s.context=ot(null),u=s.current,g=Mr(),g=Mi(g),M=js(g),M.callback=null,br(u,M,g),u=g,s.current.lanes=u,pa(s,u),Xs(s),i[Xt]=s.current,Hd(i),new Oo(s)},vp.version="19.2.0",vp}var c_;function Ly(){if(c_)return mg.exports;c_=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(y){console.error(y)}}return h(),mg.exports=ky(),mg.exports}var Oy=Ly(),Ze=Og();/**
 * react-router v7.9.4
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var u_="popstate";function By(h={}){function y(A,P){let{pathname:D,search:E,hash:l}=A.location;return Eg("",{pathname:D,search:E,hash:l},P.state&&P.state.usr||null,P.state&&P.state.key||"default")}function w(A,P){return typeof P=="string"?P:zp(P)}return jy(y,w,null,h)}function Xa(h,y){if(h===!1||h===null||typeof h>"u")throw new Error(y)}function cc(h,y){if(!h){typeof console<"u"&&console.warn(y);try{throw new Error(y)}catch{}}}function Ny(){return Math.random().toString(36).substring(2,10)}function h_(h,y){return{usr:h.state,key:h.key,idx:y}}function Eg(h,y,w=null,A){return{pathname:typeof h=="string"?h:h.pathname,search:"",hash:"",...typeof y=="string"?mf(y):y,state:w,key:y&&y.key||A||Ny()}}function zp({pathname:h="/",search:y="",hash:w=""}){return y&&y!=="?"&&(h+=y.charAt(0)==="?"?y:"?"+y),w&&w!=="#"&&(h+=w.charAt(0)==="#"?w:"#"+w),h}function mf(h){let y={};if(h){let w=h.indexOf("#");w>=0&&(y.hash=h.substring(w),h=h.substring(0,w));let A=h.indexOf("?");A>=0&&(y.search=h.substring(A),h=h.substring(0,A)),h&&(y.pathname=h)}return y}function jy(h,y,w,A={}){let{window:P=document.defaultView,v5Compat:D=!1}=A,E=P.history,l="POP",B=null,U=ee();U==null&&(U=0,E.replaceState({...E.state,idx:U},""));function ee(){return(E.state||{idx:null}).idx}function J(){l="POP";let Pe=ee(),Fe=Pe==null?null:Pe-U;U=Pe,B&&B({action:l,location:Ce.location,delta:Fe})}function W(Pe,Fe){l="PUSH";let Ue=Eg(Ce.location,Pe,Fe);U=ee()+1;let He=h_(Ue,U),mt=Ce.createHref(Ue);try{E.pushState(He,"",mt)}catch(Mt){if(Mt instanceof DOMException&&Mt.name==="DataCloneError")throw Mt;P.location.assign(mt)}D&&B&&B({action:l,location:Ce.location,delta:1})}function K(Pe,Fe){l="REPLACE";let Ue=Eg(Ce.location,Pe,Fe);U=ee();let He=h_(Ue,U),mt=Ce.createHref(Ue);E.replaceState(He,"",mt),D&&B&&B({action:l,location:Ce.location,delta:0})}function ve(Pe){return Gy(Pe)}let Ce={get action(){return l},get location(){return h(P,E)},listen(Pe){if(B)throw new Error("A history only accepts one active listener");return P.addEventListener(u_,J),B=Pe,()=>{P.removeEventListener(u_,J),B=null}},createHref(Pe){return y(P,Pe)},createURL:ve,encodeLocation(Pe){let Fe=ve(Pe);return{pathname:Fe.pathname,search:Fe.search,hash:Fe.hash}},push:W,replace:K,go(Pe){return E.go(Pe)}};return Ce}function Gy(h,y=!1){let w="http://localhost";typeof window<"u"&&(w=window.location.origin!=="null"?window.location.origin:window.location.href),Xa(w,"No window.location.(origin|href) available to create URL");let A=typeof h=="string"?h:zp(h);return A=A.replace(/ $/,"%20"),!y&&A.startsWith("//")&&(A=w+A),new URL(A,w)}function N_(h,y,w="/"){return Fy(h,y,w,!1)}function Fy(h,y,w,A){let P=typeof y=="string"?mf(y):y,D=lu(P.pathname||"/",w);if(D==null)return null;let E=j_(h);Uy(E);let l=null;for(let B=0;l==null&&B<E.length;++B){let U=Jy(D);l=Qy(E[B],U,A)}return l}function j_(h,y=[],w=[],A="",P=!1){let D=(E,l,B=P,U)=>{let ee={relativePath:U===void 0?E.path||"":U,caseSensitive:E.caseSensitive===!0,childrenIndex:l,route:E};if(ee.relativePath.startsWith("/")){if(!ee.relativePath.startsWith(A)&&B)return;Xa(ee.relativePath.startsWith(A),`Absolute route path "${ee.relativePath}" nested under path "${A}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),ee.relativePath=ee.relativePath.slice(A.length)}let J=ou([A,ee.relativePath]),W=w.concat(ee);E.children&&E.children.length>0&&(Xa(E.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${J}".`),j_(E.children,y,W,J,B)),!(E.path==null&&!E.index)&&y.push({path:J,score:Yy(J,E.index),routesMeta:W})};return h.forEach((E,l)=>{if(E.path===""||!E.path?.includes("?"))D(E,l);else for(let B of G_(E.path))D(E,l,!0,B)}),y}function G_(h){let y=h.split("/");if(y.length===0)return[];let[w,...A]=y,P=w.endsWith("?"),D=w.replace(/\?$/,"");if(A.length===0)return P?[D,""]:[D];let E=G_(A.join("/")),l=[];return l.push(...E.map(B=>B===""?D:[D,B].join("/"))),P&&l.push(...E),l.map(B=>h.startsWith("/")&&B===""?"/":B)}function Uy(h){h.sort((y,w)=>y.score!==w.score?w.score-y.score:Wy(y.routesMeta.map(A=>A.childrenIndex),w.routesMeta.map(A=>A.childrenIndex)))}var Vy=/^:[\w-]+$/,qy=3,Zy=2,$y=1,Hy=10,Xy=-2,d_=h=>h==="*";function Yy(h,y){let w=h.split("/"),A=w.length;return w.some(d_)&&(A+=Xy),y&&(A+=Zy),w.filter(P=>!d_(P)).reduce((P,D)=>P+(Vy.test(D)?qy:D===""?$y:Hy),A)}function Wy(h,y){return h.length===y.length&&h.slice(0,-1).every((A,P)=>A===y[P])?h[h.length-1]-y[y.length-1]:0}function Qy(h,y,w=!1){let{routesMeta:A}=h,P={},D="/",E=[];for(let l=0;l<A.length;++l){let B=A[l],U=l===A.length-1,ee=D==="/"?y:y.slice(D.length)||"/",J=Um({path:B.relativePath,caseSensitive:B.caseSensitive,end:U},ee),W=B.route;if(!J&&U&&w&&!A[A.length-1].route.index&&(J=Um({path:B.relativePath,caseSensitive:B.caseSensitive,end:!1},ee)),!J)return null;Object.assign(P,J.params),E.push({params:P,pathname:ou([D,J.pathname]),pathnameBase:a0(ou([D,J.pathnameBase])),route:W}),J.pathnameBase!=="/"&&(D=ou([D,J.pathnameBase]))}return E}function Um(h,y){typeof h=="string"&&(h={path:h,caseSensitive:!1,end:!0});let[w,A]=Ky(h.path,h.caseSensitive,h.end),P=y.match(w);if(!P)return null;let D=P[0],E=D.replace(/(.)\/+$/,"$1"),l=P.slice(1);return{params:A.reduce((U,{paramName:ee,isOptional:J},W)=>{if(ee==="*"){let ve=l[W]||"";E=D.slice(0,D.length-ve.length).replace(/(.)\/+$/,"$1")}const K=l[W];return J&&!K?U[ee]=void 0:U[ee]=(K||"").replace(/%2F/g,"/"),U},{}),pathname:D,pathnameBase:E,pattern:h}}function Ky(h,y=!1,w=!0){cc(h==="*"||!h.endsWith("*")||h.endsWith("/*"),`Route path "${h}" will be treated as if it were "${h.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${h.replace(/\*$/,"/*")}".`);let A=[],P="^"+h.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(E,l,B)=>(A.push({paramName:l,isOptional:B!=null}),B?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return h.endsWith("*")?(A.push({paramName:"*"}),P+=h==="*"||h==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):w?P+="\\/*$":h!==""&&h!=="/"&&(P+="(?:(?=\\/|$))"),[new RegExp(P,y?void 0:"i"),A]}function Jy(h){try{return h.split("/").map(y=>decodeURIComponent(y).replace(/\//g,"%2F")).join("/")}catch(y){return cc(!1,`The URL path "${h}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${y}).`),h}}function lu(h,y){if(y==="/")return h;if(!h.toLowerCase().startsWith(y.toLowerCase()))return null;let w=y.endsWith("/")?y.length-1:y.length,A=h.charAt(w);return A&&A!=="/"?null:h.slice(w)||"/"}function e0(h,y="/"){let{pathname:w,search:A="",hash:P=""}=typeof h=="string"?mf(h):h;return{pathname:w?w.startsWith("/")?w:t0(w,y):y,search:n0(A),hash:r0(P)}}function t0(h,y){let w=y.replace(/\/+$/,"").split("/");return h.split("/").forEach(P=>{P===".."?w.length>1&&w.pop():P!=="."&&w.push(P)}),w.length>1?w.join("/"):"/"}function xg(h,y,w,A){return`Cannot include a '${h}' character in a manually specified \`to.${y}\` field [${JSON.stringify(A)}].  Please separate it out to the \`to.${w}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function i0(h){return h.filter((y,w)=>w===0||y.route.path&&y.route.path.length>0)}function F_(h){let y=i0(h);return y.map((w,A)=>A===y.length-1?w.pathname:w.pathnameBase)}function U_(h,y,w,A=!1){let P;typeof h=="string"?P=mf(h):(P={...h},Xa(!P.pathname||!P.pathname.includes("?"),xg("?","pathname","search",P)),Xa(!P.pathname||!P.pathname.includes("#"),xg("#","pathname","hash",P)),Xa(!P.search||!P.search.includes("#"),xg("#","search","hash",P)));let D=h===""||P.pathname==="",E=D?"/":P.pathname,l;if(E==null)l=w;else{let J=y.length-1;if(!A&&E.startsWith("..")){let W=E.split("/");for(;W[0]==="..";)W.shift(),J-=1;P.pathname=W.join("/")}l=J>=0?y[J]:"/"}let B=e0(P,l),U=E&&E!=="/"&&E.endsWith("/"),ee=(D||E===".")&&w.endsWith("/");return!B.pathname.endsWith("/")&&(U||ee)&&(B.pathname+="/"),B}var ou=h=>h.join("/").replace(/\/\/+/g,"/"),a0=h=>h.replace(/\/+$/,"").replace(/^\/*/,"/"),n0=h=>!h||h==="?"?"":h.startsWith("?")?h:"?"+h,r0=h=>!h||h==="#"?"":h.startsWith("#")?h:"#"+h;function s0(h){return h!=null&&typeof h.status=="number"&&typeof h.statusText=="string"&&typeof h.internal=="boolean"&&"data"in h}var V_=["POST","PUT","PATCH","DELETE"];new Set(V_);var o0=["GET",...V_];new Set(o0);var gf=Ze.createContext(null);gf.displayName="DataRouter";var Ym=Ze.createContext(null);Ym.displayName="DataRouterState";Ze.createContext(!1);var q_=Ze.createContext({isTransitioning:!1});q_.displayName="ViewTransition";var l0=Ze.createContext(new Map);l0.displayName="Fetchers";var c0=Ze.createContext(null);c0.displayName="Await";var hc=Ze.createContext(null);hc.displayName="Navigation";var Lp=Ze.createContext(null);Lp.displayName="Location";var cu=Ze.createContext({outlet:null,matches:[],isDataRoute:!1});cu.displayName="Route";var Bg=Ze.createContext(null);Bg.displayName="RouteError";function u0(h,{relative:y}={}){Xa(Op(),"useHref() may be used only in the context of a <Router> component.");let{basename:w,navigator:A}=Ze.useContext(hc),{hash:P,pathname:D,search:E}=Bp(h,{relative:y}),l=D;return w!=="/"&&(l=D==="/"?w:ou([w,D])),A.createHref({pathname:l,search:E,hash:P})}function Op(){return Ze.useContext(Lp)!=null}function cd(){return Xa(Op(),"useLocation() may be used only in the context of a <Router> component."),Ze.useContext(Lp).location}var Z_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $_(h){Ze.useContext(hc).static||Ze.useLayoutEffect(h)}function h0(){let{isDataRoute:h}=Ze.useContext(cu);return h?M0():d0()}function d0(){Xa(Op(),"useNavigate() may be used only in the context of a <Router> component.");let h=Ze.useContext(gf),{basename:y,navigator:w}=Ze.useContext(hc),{matches:A}=Ze.useContext(cu),{pathname:P}=cd(),D=JSON.stringify(F_(A)),E=Ze.useRef(!1);return $_(()=>{E.current=!0}),Ze.useCallback((B,U={})=>{if(cc(E.current,Z_),!E.current)return;if(typeof B=="number"){w.go(B);return}let ee=U_(B,JSON.parse(D),P,U.relative==="path");h==null&&y!=="/"&&(ee.pathname=ee.pathname==="/"?y:ou([y,ee.pathname])),(U.replace?w.replace:w.push)(ee,U.state,U)},[y,w,D,P,h])}Ze.createContext(null);function Bp(h,{relative:y}={}){let{matches:w}=Ze.useContext(cu),{pathname:A}=cd(),P=JSON.stringify(F_(w));return Ze.useMemo(()=>U_(h,JSON.parse(P),A,y==="path"),[h,P,A,y])}function f0(h,y){return H_(h,y)}function H_(h,y,w,A,P){Xa(Op(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:D}=Ze.useContext(hc),{matches:E}=Ze.useContext(cu),l=E[E.length-1],B=l?l.params:{},U=l?l.pathname:"/",ee=l?l.pathnameBase:"/",J=l&&l.route;{let Ue=J&&J.path||"";X_(U,!J||Ue.endsWith("*")||Ue.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${U}" (under <Route path="${Ue}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Ue}"> to <Route path="${Ue==="/"?"*":`${Ue}/*`}">.`)}let W=cd(),K;if(y){let Ue=typeof y=="string"?mf(y):y;Xa(ee==="/"||Ue.pathname?.startsWith(ee),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${ee}" but pathname "${Ue.pathname}" was given in the \`location\` prop.`),K=Ue}else K=W;let ve=K.pathname||"/",Ce=ve;if(ee!=="/"){let Ue=ee.replace(/^\//,"").split("/");Ce="/"+ve.replace(/^\//,"").split("/").slice(Ue.length).join("/")}let Pe=N_(h,{pathname:Ce});cc(J||Pe!=null,`No routes matched location "${K.pathname}${K.search}${K.hash}" `),cc(Pe==null||Pe[Pe.length-1].route.element!==void 0||Pe[Pe.length-1].route.Component!==void 0||Pe[Pe.length-1].route.lazy!==void 0,`Matched leaf route at location "${K.pathname}${K.search}${K.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Fe=y0(Pe&&Pe.map(Ue=>Object.assign({},Ue,{params:Object.assign({},B,Ue.params),pathname:ou([ee,D.encodeLocation?D.encodeLocation(Ue.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Ue.pathname]),pathnameBase:Ue.pathnameBase==="/"?ee:ou([ee,D.encodeLocation?D.encodeLocation(Ue.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Ue.pathnameBase])})),E,w,A,P);return y&&Fe?Ze.createElement(Lp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...K},navigationType:"POP"}},Fe):Fe}function p0(){let h=S0(),y=s0(h)?`${h.status} ${h.statusText}`:h instanceof Error?h.message:JSON.stringify(h),w=h instanceof Error?h.stack:null,A="rgba(200,200,200, 0.5)",P={padding:"0.5rem",backgroundColor:A},D={padding:"2px 4px",backgroundColor:A},E=null;return console.error("Error handled by React Router default ErrorBoundary:",h),E=Ze.createElement(Ze.Fragment,null,Ze.createElement("p",null," Hey developer "),Ze.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ze.createElement("code",{style:D},"ErrorBoundary")," or"," ",Ze.createElement("code",{style:D},"errorElement")," prop on your route.")),Ze.createElement(Ze.Fragment,null,Ze.createElement("h2",null,"Unexpected Application Error!"),Ze.createElement("h3",{style:{fontStyle:"italic"}},y),w?Ze.createElement("pre",{style:P},w):null,E)}var m0=Ze.createElement(p0,null),g0=class extends Ze.Component{constructor(h){super(h),this.state={location:h.location,revalidation:h.revalidation,error:h.error}}static getDerivedStateFromError(h){return{error:h}}static getDerivedStateFromProps(h,y){return y.location!==h.location||y.revalidation!=="idle"&&h.revalidation==="idle"?{error:h.error,location:h.location,revalidation:h.revalidation}:{error:h.error!==void 0?h.error:y.error,location:y.location,revalidation:h.revalidation||y.revalidation}}componentDidCatch(h,y){this.props.unstable_onError?this.props.unstable_onError(h,y):console.error("React Router caught the following error during render",h)}render(){return this.state.error!==void 0?Ze.createElement(cu.Provider,{value:this.props.routeContext},Ze.createElement(Bg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function _0({routeContext:h,match:y,children:w}){let A=Ze.useContext(gf);return A&&A.static&&A.staticContext&&(y.route.errorElement||y.route.ErrorBoundary)&&(A.staticContext._deepestRenderedBoundaryId=y.route.id),Ze.createElement(cu.Provider,{value:h},w)}function y0(h,y=[],w=null,A=null,P=null){if(h==null){if(!w)return null;if(w.errors)h=w.matches;else if(y.length===0&&!w.initialized&&w.matches.length>0)h=w.matches;else return null}let D=h,E=w?.errors;if(E!=null){let U=D.findIndex(ee=>ee.route.id&&E?.[ee.route.id]!==void 0);Xa(U>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(E).join(",")}`),D=D.slice(0,Math.min(D.length,U+1))}let l=!1,B=-1;if(w)for(let U=0;U<D.length;U++){let ee=D[U];if((ee.route.HydrateFallback||ee.route.hydrateFallbackElement)&&(B=U),ee.route.id){let{loaderData:J,errors:W}=w,K=ee.route.loader&&!J.hasOwnProperty(ee.route.id)&&(!W||W[ee.route.id]===void 0);if(ee.route.lazy||K){l=!0,B>=0?D=D.slice(0,B+1):D=[D[0]];break}}}return D.reduceRight((U,ee,J)=>{let W,K=!1,ve=null,Ce=null;w&&(W=E&&ee.route.id?E[ee.route.id]:void 0,ve=ee.route.errorElement||m0,l&&(B<0&&J===0?(X_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),K=!0,Ce=null):B===J&&(K=!0,Ce=ee.route.hydrateFallbackElement||null)));let Pe=y.concat(D.slice(0,J+1)),Fe=()=>{let Ue;return W?Ue=ve:K?Ue=Ce:ee.route.Component?Ue=Ze.createElement(ee.route.Component,null):ee.route.element?Ue=ee.route.element:Ue=U,Ze.createElement(_0,{match:ee,routeContext:{outlet:U,matches:Pe,isDataRoute:w!=null},children:Ue})};return w&&(ee.route.ErrorBoundary||ee.route.errorElement||J===0)?Ze.createElement(g0,{location:w.location,revalidation:w.revalidation,component:ve,error:W,children:Fe(),routeContext:{outlet:null,matches:Pe,isDataRoute:!0},unstable_onError:A}):Fe()},null)}function Ng(h){return`${h} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function v0(h){let y=Ze.useContext(gf);return Xa(y,Ng(h)),y}function x0(h){let y=Ze.useContext(Ym);return Xa(y,Ng(h)),y}function b0(h){let y=Ze.useContext(cu);return Xa(y,Ng(h)),y}function jg(h){let y=b0(h),w=y.matches[y.matches.length-1];return Xa(w.route.id,`${h} can only be used on routes that contain a unique "id"`),w.route.id}function w0(){return jg("useRouteId")}function S0(){let h=Ze.useContext(Bg),y=x0("useRouteError"),w=jg("useRouteError");return h!==void 0?h:y.errors?.[w]}function M0(){let{router:h}=v0("useNavigate"),y=jg("useNavigate"),w=Ze.useRef(!1);return $_(()=>{w.current=!0}),Ze.useCallback(async(P,D={})=>{cc(w.current,Z_),w.current&&(typeof P=="number"?h.navigate(P):await h.navigate(P,{fromRouteId:y,...D}))},[h,y])}var f_={};function X_(h,y,w){!y&&!f_[h]&&(f_[h]=!0,cc(!1,w))}Ze.memo(T0);function T0({routes:h,future:y,state:w,unstable_onError:A}){return H_(h,void 0,w,A,y)}function km(h){Xa(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function E0({basename:h="/",children:y=null,location:w,navigationType:A="POP",navigator:P,static:D=!1}){Xa(!Op(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let E=h.replace(/^\/*/,"/"),l=Ze.useMemo(()=>({basename:E,navigator:P,static:D,future:{}}),[E,P,D]);typeof w=="string"&&(w=mf(w));let{pathname:B="/",search:U="",hash:ee="",state:J=null,key:W="default"}=w,K=Ze.useMemo(()=>{let ve=lu(B,E);return ve==null?null:{location:{pathname:ve,search:U,hash:ee,state:J,key:W},navigationType:A}},[E,B,U,ee,J,W,A]);return cc(K!=null,`<Router basename="${E}"> is not able to match the URL "${B}${U}${ee}" because it does not start with the basename, so the <Router> won't render anything.`),K==null?null:Ze.createElement(hc.Provider,{value:l},Ze.createElement(Lp.Provider,{children:y,value:K}))}function A0({children:h,location:y}){return f0(Ag(h),y)}function Ag(h,y=[]){let w=[];return Ze.Children.forEach(h,(A,P)=>{if(!Ze.isValidElement(A))return;let D=[...y,P];if(A.type===Ze.Fragment){w.push.apply(w,Ag(A.props.children,D));return}Xa(A.type===km,`[${typeof A.type=="string"?A.type:A.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xa(!A.props.index||!A.props.children,"An index route cannot have child routes.");let E={id:A.props.id||D.join("-"),caseSensitive:A.props.caseSensitive,element:A.props.element,Component:A.props.Component,index:A.props.index,path:A.props.path,middleware:A.props.middleware,loader:A.props.loader,action:A.props.action,hydrateFallbackElement:A.props.hydrateFallbackElement,HydrateFallback:A.props.HydrateFallback,errorElement:A.props.errorElement,ErrorBoundary:A.props.ErrorBoundary,hasErrorBoundary:A.props.hasErrorBoundary===!0||A.props.ErrorBoundary!=null||A.props.errorElement!=null,shouldRevalidate:A.props.shouldRevalidate,handle:A.props.handle,lazy:A.props.lazy};A.props.children&&(E.children=Ag(A.props.children,D)),w.push(E)}),w}var Lm="get",Om="application/x-www-form-urlencoded";function Wm(h){return h!=null&&typeof h.tagName=="string"}function C0(h){return Wm(h)&&h.tagName.toLowerCase()==="button"}function P0(h){return Wm(h)&&h.tagName.toLowerCase()==="form"}function z0(h){return Wm(h)&&h.tagName.toLowerCase()==="input"}function I0(h){return!!(h.metaKey||h.altKey||h.ctrlKey||h.shiftKey)}function R0(h,y){return h.button===0&&(!y||y==="_self")&&!I0(h)}var zm=null;function D0(){if(zm===null)try{new FormData(document.createElement("form"),0),zm=!1}catch{zm=!0}return zm}var k0=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bg(h){return h!=null&&!k0.has(h)?(cc(!1,`"${h}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Om}"`),null):h}function L0(h,y){let w,A,P,D,E;if(P0(h)){let l=h.getAttribute("action");A=l?lu(l,y):null,w=h.getAttribute("method")||Lm,P=bg(h.getAttribute("enctype"))||Om,D=new FormData(h)}else if(C0(h)||z0(h)&&(h.type==="submit"||h.type==="image")){let l=h.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let B=h.getAttribute("formaction")||l.getAttribute("action");if(A=B?lu(B,y):null,w=h.getAttribute("formmethod")||l.getAttribute("method")||Lm,P=bg(h.getAttribute("formenctype"))||bg(l.getAttribute("enctype"))||Om,D=new FormData(l,h),!D0()){let{name:U,type:ee,value:J}=h;if(ee==="image"){let W=U?`${U}.`:"";D.append(`${W}x`,"0"),D.append(`${W}y`,"0")}else U&&D.append(U,J)}}else{if(Wm(h))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');w=Lm,A=null,P=Om,E=h}return D&&P==="text/plain"&&(E=D,D=void 0),{action:A,method:w.toLowerCase(),encType:P,formData:D,body:E}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Gg(h,y){if(h===!1||h===null||typeof h>"u")throw new Error(y)}function O0(h,y,w){let A=typeof h=="string"?new URL(h,typeof window>"u"?"server://singlefetch/":window.location.origin):h;return A.pathname==="/"?A.pathname=`_root.${w}`:y&&lu(A.pathname,y)==="/"?A.pathname=`${y.replace(/\/$/,"")}/_root.${w}`:A.pathname=`${A.pathname.replace(/\/$/,"")}.${w}`,A}async function B0(h,y){if(h.id in y)return y[h.id];try{let w=await import(h.module);return y[h.id]=w,w}catch(w){return console.error(`Error loading route module \`${h.module}\`, reloading page...`),console.error(w),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function N0(h){return h==null?!1:h.href==null?h.rel==="preload"&&typeof h.imageSrcSet=="string"&&typeof h.imageSizes=="string":typeof h.rel=="string"&&typeof h.href=="string"}async function j0(h,y,w){let A=await Promise.all(h.map(async P=>{let D=y.routes[P.route.id];if(D){let E=await B0(D,w);return E.links?E.links():[]}return[]}));return V0(A.flat(1).filter(N0).filter(P=>P.rel==="stylesheet"||P.rel==="preload").map(P=>P.rel==="stylesheet"?{...P,rel:"prefetch",as:"style"}:{...P,rel:"prefetch"}))}function p_(h,y,w,A,P,D){let E=(B,U)=>w[U]?B.route.id!==w[U].route.id:!0,l=(B,U)=>w[U].pathname!==B.pathname||w[U].route.path?.endsWith("*")&&w[U].params["*"]!==B.params["*"];return D==="assets"?y.filter((B,U)=>E(B,U)||l(B,U)):D==="data"?y.filter((B,U)=>{let ee=A.routes[B.route.id];if(!ee||!ee.hasLoader)return!1;if(E(B,U)||l(B,U))return!0;if(B.route.shouldRevalidate){let J=B.route.shouldRevalidate({currentUrl:new URL(P.pathname+P.search+P.hash,window.origin),currentParams:w[0]?.params||{},nextUrl:new URL(h,window.origin),nextParams:B.params,defaultShouldRevalidate:!0});if(typeof J=="boolean")return J}return!0}):[]}function G0(h,y,{includeHydrateFallback:w}={}){return F0(h.map(A=>{let P=y.routes[A.route.id];if(!P)return[];let D=[P.module];return P.clientActionModule&&(D=D.concat(P.clientActionModule)),P.clientLoaderModule&&(D=D.concat(P.clientLoaderModule)),w&&P.hydrateFallbackModule&&(D=D.concat(P.hydrateFallbackModule)),P.imports&&(D=D.concat(P.imports)),D}).flat(1))}function F0(h){return[...new Set(h)]}function U0(h){let y={},w=Object.keys(h).sort();for(let A of w)y[A]=h[A];return y}function V0(h,y){let w=new Set;return new Set(y),h.reduce((A,P)=>{let D=JSON.stringify(U0(P));return w.has(D)||(w.add(D),A.push({key:D,link:P})),A},[])}function Y_(){let h=Ze.useContext(gf);return Gg(h,"You must render this element inside a <DataRouterContext.Provider> element"),h}function q0(){let h=Ze.useContext(Ym);return Gg(h,"You must render this element inside a <DataRouterStateContext.Provider> element"),h}var Fg=Ze.createContext(void 0);Fg.displayName="FrameworkContext";function W_(){let h=Ze.useContext(Fg);return Gg(h,"You must render this element inside a <HydratedRouter> element"),h}function Z0(h,y){let w=Ze.useContext(Fg),[A,P]=Ze.useState(!1),[D,E]=Ze.useState(!1),{onFocus:l,onBlur:B,onMouseEnter:U,onMouseLeave:ee,onTouchStart:J}=y,W=Ze.useRef(null);Ze.useEffect(()=>{if(h==="render"&&E(!0),h==="viewport"){let Ce=Fe=>{Fe.forEach(Ue=>{E(Ue.isIntersecting)})},Pe=new IntersectionObserver(Ce,{threshold:.5});return W.current&&Pe.observe(W.current),()=>{Pe.disconnect()}}},[h]),Ze.useEffect(()=>{if(A){let Ce=setTimeout(()=>{E(!0)},100);return()=>{clearTimeout(Ce)}}},[A]);let K=()=>{P(!0)},ve=()=>{P(!1),E(!1)};return w?h!=="intent"?[D,W,{}]:[D,W,{onFocus:xp(l,K),onBlur:xp(B,ve),onMouseEnter:xp(U,K),onMouseLeave:xp(ee,ve),onTouchStart:xp(J,K)}]:[!1,W,{}]}function xp(h,y){return w=>{h&&h(w),w.defaultPrevented||y(w)}}function $0({page:h,...y}){let{router:w}=Y_(),A=Ze.useMemo(()=>N_(w.routes,h,w.basename),[w.routes,h,w.basename]);return A?Ze.createElement(X0,{page:h,matches:A,...y}):null}function H0(h){let{manifest:y,routeModules:w}=W_(),[A,P]=Ze.useState([]);return Ze.useEffect(()=>{let D=!1;return j0(h,y,w).then(E=>{D||P(E)}),()=>{D=!0}},[h,y,w]),A}function X0({page:h,matches:y,...w}){let A=cd(),{manifest:P,routeModules:D}=W_(),{basename:E}=Y_(),{loaderData:l,matches:B}=q0(),U=Ze.useMemo(()=>p_(h,y,B,P,A,"data"),[h,y,B,P,A]),ee=Ze.useMemo(()=>p_(h,y,B,P,A,"assets"),[h,y,B,P,A]),J=Ze.useMemo(()=>{if(h===A.pathname+A.search+A.hash)return[];let ve=new Set,Ce=!1;if(y.forEach(Fe=>{let Ue=P.routes[Fe.route.id];!Ue||!Ue.hasLoader||(!U.some(He=>He.route.id===Fe.route.id)&&Fe.route.id in l&&D[Fe.route.id]?.shouldRevalidate||Ue.hasClientLoader?Ce=!0:ve.add(Fe.route.id))}),ve.size===0)return[];let Pe=O0(h,E,"data");return Ce&&ve.size>0&&Pe.searchParams.set("_routes",y.filter(Fe=>ve.has(Fe.route.id)).map(Fe=>Fe.route.id).join(",")),[Pe.pathname+Pe.search]},[E,l,A,P,U,y,h,D]),W=Ze.useMemo(()=>G0(ee,P),[ee,P]),K=H0(ee);return Ze.createElement(Ze.Fragment,null,J.map(ve=>Ze.createElement("link",{key:ve,rel:"prefetch",as:"fetch",href:ve,...w})),W.map(ve=>Ze.createElement("link",{key:ve,rel:"modulepreload",href:ve,...w})),K.map(({key:ve,link:Ce})=>Ze.createElement("link",{key:ve,nonce:w.nonce,...Ce})))}function Y0(...h){return y=>{h.forEach(w=>{typeof w=="function"?w(y):w!=null&&(w.current=y)})}}var Q_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Q_&&(window.__reactRouterVersion="7.9.4")}catch{}function W0({basename:h,children:y,window:w}){let A=Ze.useRef();A.current==null&&(A.current=By({window:w,v5Compat:!0}));let P=A.current,[D,E]=Ze.useState({action:P.action,location:P.location}),l=Ze.useCallback(B=>{Ze.startTransition(()=>E(B))},[E]);return Ze.useLayoutEffect(()=>P.listen(l),[P,l]),Ze.createElement(E0,{basename:h,children:y,location:D.location,navigationType:D.action,navigator:P})}var K_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ug=Ze.forwardRef(function({onClick:y,discover:w="render",prefetch:A="none",relative:P,reloadDocument:D,replace:E,state:l,target:B,to:U,preventScrollReset:ee,viewTransition:J,...W},K){let{basename:ve}=Ze.useContext(hc),Ce=typeof U=="string"&&K_.test(U),Pe,Fe=!1;if(typeof U=="string"&&Ce&&(Pe=U,Q_))try{let Vt=new URL(window.location.href),mi=U.startsWith("//")?new URL(Vt.protocol+U):new URL(U),wi=lu(mi.pathname,ve);mi.origin===Vt.origin&&wi!=null?U=wi+mi.search+mi.hash:Fe=!0}catch{cc(!1,`<Link to="${U}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Ue=u0(U,{relative:P}),[He,mt,Mt]=Z0(A,W),Pt=ev(U,{replace:E,state:l,target:B,preventScrollReset:ee,relative:P,viewTransition:J});function _t(Vt){y&&y(Vt),Vt.defaultPrevented||Pt(Vt)}let ei=Ze.createElement("a",{...W,...Mt,href:Pe||Ue,onClick:Fe||D?y:_t,ref:Y0(K,mt),target:B,"data-discover":!Ce&&w==="render"?"true":void 0});return He&&!Ce?Ze.createElement(Ze.Fragment,null,ei,Ze.createElement($0,{page:Ue})):ei});Ug.displayName="Link";var Q0=Ze.forwardRef(function({"aria-current":y="page",caseSensitive:w=!1,className:A="",end:P=!1,style:D,to:E,viewTransition:l,children:B,...U},ee){let J=Bp(E,{relative:U.relative}),W=cd(),K=Ze.useContext(Ym),{navigator:ve,basename:Ce}=Ze.useContext(hc),Pe=K!=null&&rv(J)&&l===!0,Fe=ve.encodeLocation?ve.encodeLocation(J).pathname:J.pathname,Ue=W.pathname,He=K&&K.navigation&&K.navigation.location?K.navigation.location.pathname:null;w||(Ue=Ue.toLowerCase(),He=He?He.toLowerCase():null,Fe=Fe.toLowerCase()),He&&Ce&&(He=lu(He,Ce)||He);const mt=Fe!=="/"&&Fe.endsWith("/")?Fe.length-1:Fe.length;let Mt=Ue===Fe||!P&&Ue.startsWith(Fe)&&Ue.charAt(mt)==="/",Pt=He!=null&&(He===Fe||!P&&He.startsWith(Fe)&&He.charAt(Fe.length)==="/"),_t={isActive:Mt,isPending:Pt,isTransitioning:Pe},ei=Mt?y:void 0,Vt;typeof A=="function"?Vt=A(_t):Vt=[A,Mt?"active":null,Pt?"pending":null,Pe?"transitioning":null].filter(Boolean).join(" ");let mi=typeof D=="function"?D(_t):D;return Ze.createElement(Ug,{...U,"aria-current":ei,className:Vt,ref:ee,style:mi,to:E,viewTransition:l},typeof B=="function"?B(_t):B)});Q0.displayName="NavLink";var K0=Ze.forwardRef(({discover:h="render",fetcherKey:y,navigate:w,reloadDocument:A,replace:P,state:D,method:E=Lm,action:l,onSubmit:B,relative:U,preventScrollReset:ee,viewTransition:J,...W},K)=>{let ve=av(),Ce=nv(l,{relative:U}),Pe=E.toLowerCase()==="get"?"get":"post",Fe=typeof l=="string"&&K_.test(l),Ue=He=>{if(B&&B(He),He.defaultPrevented)return;He.preventDefault();let mt=He.nativeEvent.submitter,Mt=mt?.getAttribute("formmethod")||E;ve(mt||He.currentTarget,{fetcherKey:y,method:Mt,navigate:w,replace:P,state:D,relative:U,preventScrollReset:ee,viewTransition:J})};return Ze.createElement("form",{ref:K,method:Pe,action:Ce,onSubmit:A?B:Ue,...W,"data-discover":!Fe&&h==="render"?"true":void 0})});K0.displayName="Form";function J0(h){return`${h} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function J_(h){let y=Ze.useContext(gf);return Xa(y,J0(h)),y}function ev(h,{target:y,replace:w,state:A,preventScrollReset:P,relative:D,viewTransition:E}={}){let l=h0(),B=cd(),U=Bp(h,{relative:D});return Ze.useCallback(ee=>{if(R0(ee,y)){ee.preventDefault();let J=w!==void 0?w:zp(B)===zp(U);l(h,{replace:J,state:A,preventScrollReset:P,relative:D,viewTransition:E})}},[B,l,U,w,A,y,h,P,D,E])}var tv=0,iv=()=>`__${String(++tv)}__`;function av(){let{router:h}=J_("useSubmit"),{basename:y}=Ze.useContext(hc),w=w0();return Ze.useCallback(async(A,P={})=>{let{action:D,method:E,encType:l,formData:B,body:U}=L0(A,y);if(P.navigate===!1){let ee=P.fetcherKey||iv();await h.fetch(ee,w,P.action||D,{preventScrollReset:P.preventScrollReset,formData:B,body:U,formMethod:P.method||E,formEncType:P.encType||l,flushSync:P.flushSync})}else await h.navigate(P.action||D,{preventScrollReset:P.preventScrollReset,formData:B,body:U,formMethod:P.method||E,formEncType:P.encType||l,replace:P.replace,state:P.state,fromRouteId:w,flushSync:P.flushSync,viewTransition:P.viewTransition})},[h,y,w])}function nv(h,{relative:y}={}){let{basename:w}=Ze.useContext(hc),A=Ze.useContext(cu);Xa(A,"useFormAction must be used inside a RouteContext");let[P]=A.matches.slice(-1),D={...Bp(h||".",{relative:y})},E=cd();if(h==null){D.search=E.search;let l=new URLSearchParams(D.search),B=l.getAll("index");if(B.some(ee=>ee==="")){l.delete("index"),B.filter(J=>J).forEach(J=>l.append("index",J));let ee=l.toString();D.search=ee?`?${ee}`:""}}return(!h||h===".")&&P.route.index&&(D.search=D.search?D.search.replace(/^\?/,"?index&"):"?index"),w!=="/"&&(D.pathname=D.pathname==="/"?w:ou([w,D.pathname])),zp(D)}function rv(h,{relative:y}={}){let w=Ze.useContext(q_);Xa(w!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:A}=J_("useViewTransitionState"),P=Bp(h,{relative:y});if(!w.isTransitioning)return!1;let D=lu(w.currentLocation.pathname,A)||w.currentLocation.pathname,E=lu(w.nextLocation.pathname,A)||w.nextLocation.pathname;return Um(P.pathname,E)!=null||Um(P.pathname,D)!=null}var Bm={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.9.0/LICENSE.txt
 */var sv=Bm.exports,m_;function ov(){return m_||(m_=1,(function(h,y){(function(w,A){h.exports=A()})(sv,(function(){var w={},A={};function P(E,l,B){if(A[E]=B,E==="index"){var U="var sharedModule = {}; ("+A.shared+")(sharedModule); ("+A.worker+")(sharedModule);",ee={};return A.shared(ee),A.index(w,ee),typeof window<"u"&&w.setWorkerUrl(window.URL.createObjectURL(new Blob([U],{type:"text/javascript"}))),w}}P("shared",["exports"],(function(E){function l(n,t,a,o){return new(a||(a=Promise))((function(d,_){function v(I){try{S(o.next(I))}catch(R){_(R)}}function b(I){try{S(o.throw(I))}catch(R){_(R)}}function S(I){var R;I.done?d(I.value):(R=I.value,R instanceof a?R:new a((function(O){O(R)}))).then(v,b)}S((o=o.apply(n,t||[])).next())}))}function B(n,t){this.x=n,this.y=t}function U(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ee,J;typeof SuppressedError=="function"&&SuppressedError,B.prototype={clone(){return new B(this.x,this.y)},add(n){return this.clone()._add(n)},sub(n){return this.clone()._sub(n)},multByPoint(n){return this.clone()._multByPoint(n)},divByPoint(n){return this.clone()._divByPoint(n)},mult(n){return this.clone()._mult(n)},div(n){return this.clone()._div(n)},rotate(n){return this.clone()._rotate(n)},rotateAround(n,t){return this.clone()._rotateAround(n,t)},matMult(n){return this.clone()._matMult(n)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(n){return this.x===n.x&&this.y===n.y},dist(n){return Math.sqrt(this.distSqr(n))},distSqr(n){const t=n.x-this.x,a=n.y-this.y;return t*t+a*a},angle(){return Math.atan2(this.y,this.x)},angleTo(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith(n){return this.angleWithSep(n.x,n.y)},angleWithSep(n,t){return Math.atan2(this.x*t-this.y*n,this.x*n+this.y*t)},_matMult(n){const t=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=t,this},_add(n){return this.x+=n.x,this.y+=n.y,this},_sub(n){return this.x-=n.x,this.y-=n.y,this},_mult(n){return this.x*=n,this.y*=n,this},_div(n){return this.x/=n,this.y/=n,this},_multByPoint(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint(n){return this.x/=n.x,this.y/=n.y,this},_unit(){return this._div(this.mag()),this},_perp(){const n=this.y;return this.y=this.x,this.x=-n,this},_rotate(n){const t=Math.cos(n),a=Math.sin(n),o=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=o,this},_rotateAround(n,t){const a=Math.cos(n),o=Math.sin(n),d=t.y+o*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-o*(this.y-t.y),this.y=d,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:B},B.convert=function(n){if(n instanceof B)return n;if(Array.isArray(n))return new B(+n[0],+n[1]);if(n.x!==void 0&&n.y!==void 0)return new B(+n.x,+n.y);throw new Error("Expected [x, y] or {x, y} point format")};var W=(function(){if(J)return ee;function n(t,a,o,d){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(d-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=o,this.p2y=d}return J=1,ee=n,n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,d=0;d<8;d++){var _=this.sampleCurveX(o)-t;if(Math.abs(_)<a)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=_/v}var b=0,S=1;for(o=t,d=0;d<20&&(_=this.sampleCurveX(o),!(Math.abs(_-t)<a));d++)t>_?b=o:S=o,o=.5*(S-b)+b;return o},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},ee})(),K=U(W);let ve,Ce;function Pe(){return ve==null&&(ve=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ve}function Fe(){if(Ce==null&&(Ce=!1,Pe())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let o=0;o<25;o++){const d=4*o;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(o%5,Math.floor(o/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let o=0;o<100;o++)if(o%4!=3&&a[o]!==o){Ce=!0;break}}}return Ce||!1}var Ue=1e-6,He=typeof Float32Array<"u"?Float32Array:Array;function mt(){var n=new He(9);return He!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Mt(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Pt(){var n=new He(3);return He!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function _t(n){var t=n[0],a=n[1],o=n[2];return Math.sqrt(t*t+a*a+o*o)}function ei(n,t,a){var o=new He(3);return o[0]=n,o[1]=t,o[2]=a,o}function Vt(n,t,a){return n[0]=t[0]+a[0],n[1]=t[1]+a[1],n[2]=t[2]+a[2],n}function mi(n,t,a){return n[0]=t[0]*a,n[1]=t[1]*a,n[2]=t[2]*a,n}function wi(n,t,a){var o=t[0],d=t[1],_=t[2],v=a[0],b=a[1],S=a[2];return n[0]=d*S-_*b,n[1]=_*v-o*S,n[2]=o*b-d*v,n}var Di,Ma=_t;function In(n,t,a){var o=t[0],d=t[1],_=t[2],v=t[3];return n[0]=a[0]*o+a[4]*d+a[8]*_+a[12]*v,n[1]=a[1]*o+a[5]*d+a[9]*_+a[13]*v,n[2]=a[2]*o+a[6]*d+a[10]*_+a[14]*v,n[3]=a[3]*o+a[7]*d+a[11]*_+a[15]*v,n}function sn(){var n=new He(4);return He!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Xe(n,t,a,o){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",_=Math.PI/360;t*=_,o*=_,a*=_;var v=Math.sin(t),b=Math.cos(t),S=Math.sin(a),I=Math.cos(a),R=Math.sin(o),O=Math.cos(o);switch(d){case"xyz":n[0]=v*I*O+b*S*R,n[1]=b*S*O-v*I*R,n[2]=b*I*R+v*S*O,n[3]=b*I*O-v*S*R;break;case"xzy":n[0]=v*I*O-b*S*R,n[1]=b*S*O-v*I*R,n[2]=b*I*R+v*S*O,n[3]=b*I*O+v*S*R;break;case"yxz":n[0]=v*I*O+b*S*R,n[1]=b*S*O-v*I*R,n[2]=b*I*R-v*S*O,n[3]=b*I*O+v*S*R;break;case"yzx":n[0]=v*I*O+b*S*R,n[1]=b*S*O+v*I*R,n[2]=b*I*R-v*S*O,n[3]=b*I*O-v*S*R;break;case"zxy":n[0]=v*I*O-b*S*R,n[1]=b*S*O+v*I*R,n[2]=b*I*R+v*S*O,n[3]=b*I*O-v*S*R;break;case"zyx":n[0]=v*I*O-b*S*R,n[1]=b*S*O+v*I*R,n[2]=b*I*R-v*S*O,n[3]=b*I*O+v*S*R;break;default:throw new Error("Unknown angle order "+d)}return n}function gt(){var n=new He(2);return He!=Float32Array&&(n[0]=0,n[1]=0),n}function Nt(n,t){var a=new He(2);return a[0]=n,a[1]=t,a}Pt(),Di=new He(4),He!=Float32Array&&(Di[0]=0,Di[1]=0,Di[2]=0,Di[3]=0),Pt(),ei(1,0,0),ei(0,1,0),sn(),sn(),mt(),gt();const Lt=8192;function Si(n,t,a){return t*(Lt/(n.tileSize*Math.pow(2,a-n.tileID.overscaledZ)))}function be(n,t){return(n%t+t)%t}function Ke(n,t,a){return n*(1-a)+t*a}function pt(n){if(n<=0)return 0;if(n>=1)return 1;const t=n*n,a=t*n;return 4*(n<.5?a:3*(n-t)+a-.75)}function Et(n,t,a,o){const d=new K(n,t,a,o);return _=>d.solve(_)}const $t=Et(.25,.1,.25,1);function Ft(n,t,a){return Math.min(a,Math.max(t,n))}function gi(n,t,a){const o=a-t,d=((n-t)%o+o)%o+t;return d===t?a:d}function Qi(n,...t){for(const a of t)for(const o in a)n[o]=a[o];return n}let Pi=1;function Qr(n,t,a){const o={};for(const d in n)o[d]=t.call(this,n[d],d,n);return o}function bs(n,t,a){const o={};for(const d in n)t.call(this,n[d],d,n)&&(o[d]=n[d]);return o}function bn(n){return Array.isArray(n)?n.map(bn):typeof n=="object"&&n?Qr(n,bn):n}const fa={};function qi(n){fa[n]||(typeof console<"u"&&console.warn(n),fa[n]=!0)}function qn(n,t,a){return(a.y-n.y)*(t.x-n.x)>(t.y-n.y)*(a.x-n.x)}function fr(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let jo=null;function Ks(n){if(jo==null){const t=n.navigator?n.navigator.userAgent:null;jo=!!n.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return jo}function wn(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const Js="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Go(n,t,a,o,d){return l(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(n,{timestamp:0});try{const v=_?.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const b=v.startsWith("BGR"),S=new Uint8ClampedArray(o*d*4);if(yield _.copyTo(S,(function(I,R,O,F,V){const Z=4*Math.max(-R,0),Y=(Math.max(0,O)-O)*F*4+Z,te=4*F,se=Math.max(0,R),Te=Math.max(0,O);return{rect:{x:se,y:Te,width:Math.min(I.width,R+F)-se,height:Math.min(I.height,O+V)-Te},layout:[{offset:Y,stride:te}]}})(n,t,a,o,d)),b)for(let I=0;I<S.length;I+=4){const R=S[I];S[I]=S[I+2],S[I+2]=R}return S}finally{_.close()}}))}let eo,Kr;function Na(n,t,a,o){return n.addEventListener(t,a,o),{unsubscribe:()=>{n.removeEventListener(t,a,o)}}}function dc(n){return n*Math.PI/180}function Zn(n){return n/Math.PI*180}const ws={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Sn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},we="AbortError";function $(){return new Error(we)}const H={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ie(n){return H.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const fe="global-dispatcher";class pe extends Error{constructor(t,a,o,d){super(`AJAXError: ${a} (${t}): ${o}`),this.status=t,this.statusText=a,this.url=o,this.body=d}}const xe=()=>fr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ie=function(n,t){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const o=ie(n.url);if(o)return o(n,t);if(fr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:fe},t)}if(!(/^file:/.test(a=n.url)||/^file:/.test(xe())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(o,d){return l(this,void 0,void 0,(function*(){const _=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:xe(),signal:d.signal});let v,b;o.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{v=yield fetch(_)}catch(I){throw new pe(0,I.message,o.url,new Blob)}if(!v.ok){const I=yield v.blob();throw new pe(v.status,v.statusText,o.url,I)}b=o.type==="arrayBuffer"||o.type==="image"?v.arrayBuffer():o.type==="json"?v.json():v.text();const S=yield b;if(d.signal.aborted)throw $();return{data:S,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}}))})(n,t);if(fr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:fe},t)}var a;return(function(o,d){return new Promise(((_,v)=>{var b;const S=new XMLHttpRequest;S.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(S.responseType="arraybuffer");for(const I in o.headers)S.setRequestHeader(I,o.headers[I]);o.type==="json"&&(S.responseType="text",!((b=o.headers)===null||b===void 0)&&b.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=o.credentials==="include",S.onerror=()=>{v(new Error(S.statusText))},S.onload=()=>{if(!d.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let I=S.response;if(o.type==="json")try{I=JSON.parse(S.response)}catch(R){return void v(R)}_({data:I,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const I=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});v(new pe(S.status,S.statusText,o.url,I))}},d.signal.addEventListener("abort",(()=>{S.abort(),v($())})),S.send(o.body)}))})(n,t)};function Ee(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const t=new URL(n),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function Ve(n,t,a){a[n]&&a[n].indexOf(t)!==-1||(a[n]=a[n]||[],a[n].push(t))}function at(n,t,a){if(a&&a[n]){const o=a[n].indexOf(t);o!==-1&&a[n].splice(o,1)}}class $e{constructor(t,a={}){Qi(this,a),this.type=t}}class xt extends $e{constructor(t,a={}){super("error",Qi({error:t},a))}}class It{on(t,a){return this._listeners=this._listeners||{},Ve(t,a,this._listeners),{unsubscribe:()=>{this.off(t,a)}}}off(t,a){return at(t,a,this._listeners),at(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ve(t,a,this._oneTimeListeners),this):new Promise((o=>this.once(t,o)))}fire(t,a){typeof t=="string"&&(t=new $e(t,a||{}));const o=t.type;if(this.listens(o)){t.target=this;const d=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const b of d)b.call(this,t);const _=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const b of _)at(o,b,this._oneTimeListeners),b.call(this,t);const v=this._eventedParent;v&&(Qi(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof xt&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ii=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function fi(n,t){const a={};for(const o in n)o!=="ref"&&(a[o]=n[o]);return ii.forEach((o=>{o in t&&(a[o]=t[o])})),a}function Tt(n,t){if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let a=0;a<n.length;a++)if(!Tt(n[a],t[a]))return!1;return!0}if(typeof n=="object"&&n!==null&&t!==null){if(typeof t!="object"||Object.keys(n).length!==Object.keys(t).length)return!1;for(const a in n)if(!Tt(n[a],t[a]))return!1;return!0}return n===t}function ui(n,t){n.push(t)}function Ta(n,t,a){ui(a,{command:"addSource",args:[n,t[n]]})}function pa(n,t,a){ui(t,{command:"removeSource",args:[n]}),a[n]=!0}function Pa(n,t,a,o){pa(n,a,o),Ta(n,t,a)}function Ya(n,t,a){let o;for(o in n[a])if(Object.prototype.hasOwnProperty.call(n[a],o)&&o!=="data"&&!Tt(n[a][o],t[a][o]))return!1;for(o in t[a])if(Object.prototype.hasOwnProperty.call(t[a],o)&&o!=="data"&&!Tt(n[a][o],t[a][o]))return!1;return!0}function Ni(n,t,a,o,d,_){n=n||{},t=t||{};for(const v in n)Object.prototype.hasOwnProperty.call(n,v)&&(Tt(n[v],t[v])||a.push({command:_,args:[o,v,t[v],d]}));for(const v in t)Object.prototype.hasOwnProperty.call(t,v)&&!Object.prototype.hasOwnProperty.call(n,v)&&(Tt(n[v],t[v])||a.push({command:_,args:[o,v,t[v],d]}))}function za(n){return n.id}function Mi(n,t){return n[t.id]=t,n}class tt{constructor(t,a,o,d){this.message=(t?`${t}: `:"")+o,d&&(this.identifier=d),a!=null&&a.__line__&&(this.line=a.__line__)}}function Ir(n,...t){for(const a of t)for(const o in a)n[o]=a[o];return n}class Rn extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class Ia{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[o,d]of a)this.bindings[o]=d}concat(t){return new Ia(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const _i={kind:"null"},nt={kind:"number"},Xt={kind:"string"},Wt={kind:"boolean"},$n={kind:"color"},Jr={kind:"projectionDefinition"},Rr={kind:"object"},Ht={kind:"value"},to={kind:"collator"},es={kind:"formatted"},pr={kind:"padding"},Ss={kind:"colorArray"},Dn={kind:"numberArray"},oa={kind:"resolvedImage"},ga={kind:"variableAnchorOffsetCollection"};function kn(n,t){return{kind:"array",itemType:n,N:t}}function zi(n){if(n.kind==="array"){const t=zi(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const ts=[_i,nt,Xt,Wt,$n,Jr,es,Rr,kn(Ht),pr,Dn,Ss,oa,ga];function El(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!El(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const a of ts)if(!El(a,t))return null}}return`Expected ${zi(n)} but found ${zi(t)} instead.`}function hu(n,t){return t.some((a=>a.kind===n.kind))}function io(n,t){return t.some((a=>a==="null"?n===null:a==="array"?Array.isArray(n):a==="object"?n&&!Array.isArray(n)&&typeof n=="object":a===typeof n))}function Ms(n,t){return n.kind==="array"&&t.kind==="array"?n.itemType.kind===t.itemType.kind&&typeof n.N=="number":n.kind===t.kind}const fc=.96422,Al=.82521,is=4/29,on=6/29,ah=3*on*on,yf=on*on*on,nh=Math.PI/180,ud=180/Math.PI;function pc(n){return(n%=360)<0&&(n+=360),n}function rh([n,t,a,o]){let d,_;const v=mc((.2225045*(n=Wa(n))+.7168786*(t=Wa(t))+.0606169*(a=Wa(a)))/1);n===t&&t===a?d=_=v:(d=mc((.4360747*n+.3850649*t+.1430804*a)/fc),_=mc((.0139322*n+.0971045*t+.7141733*a)/Al));const b=116*v-16;return[b<0?0:b,500*(d-v),200*(v-_),o]}function Wa(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function mc(n){return n>yf?Math.pow(n,1/3):n/ah+is}function sh([n,t,a,o]){let d=(n+16)/116,_=isNaN(t)?d:d+t/500,v=isNaN(a)?d:d-a/200;return d=1*ao(d),_=fc*ao(_),v=Al*ao(v),[Ts(3.1338561*_-1.6168667*d-.4906146*v),Ts(-.9787684*_+1.9161415*d+.033454*v),Ts(.0719453*_-.2289914*d+1.4052427*v),o]}function Ts(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function ao(n){return n>on?n*n*n:ah*(n-is)}const hd=Object.hasOwn||function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};function Cl(n,t){return hd(n,t)?n[t]:void 0}function as(n){return parseInt(n.padEnd(2,n),16)/255}function oh(n,t){return pn(t?n/100:n,0,1)}function pn(n,t,a){return Math.min(Math.max(t,n),a)}function li(n){return!n.some(Number.isNaN)}const no={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Mn(n,t,a){return n+a*(t-n)}function Fo(n,t,a){return n.map(((o,d)=>Mn(o,t[d],a)))}class Jt{constructor(t,a,o,d=1,_=!0){this.r=t,this.g=a,this.b=o,this.a=d,_||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,a,o,d]))}static parse(t){if(t instanceof Jt)return t;if(typeof t!="string")return;const a=(function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Cl(no,o);if(d){const[v,b,S]=d;return[v/255,b/255,S/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const v=o.length<6?1:2;let b=1;return[as(o.slice(b,b+=v)),as(o.slice(b,b+=v)),as(o.slice(b,b+=v)),as(o.slice(b,b+v)||"ff")]}if(o.startsWith("rgb")){const v=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[b,S,I,R,O,F,V,Z,Y,te,se,Te]=v,de=[R||" ",V||" ",te].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const ge=[I,F,Y].join(""),De=ge==="%%%"?100:ge===""?255:0;if(De){const je=[pn(+S/De,0,1),pn(+O/De,0,1),pn(+Z/De,0,1),se?oh(+se,Te):1];if(li(je))return je}}return}}const _=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,b,S,I,R,O,F,V,Z]=_,Y=[S||" ",R||" ",F].join("");if(Y==="  "||Y==="  /"||Y===",,"||Y===",,,"){const te=[+b,pn(+I,0,100),pn(+O,0,100),V?oh(+V,Z):1];if(li(te))return(function([se,Te,de,ge]){function De(je){const et=(je+se/30)%12,dt=Te*Math.min(de,1-de);return de-dt*Math.max(-1,Math.min(et-3,9-et,1))}return se=pc(se),Te/=100,de/=100,[De(0),De(8),De(4),ge]})(te)}}})(t);return a?new Jt(...a,!1):void 0}get rgb(){const{r:t,g:a,b:o,a:d}=this,_=d||1/0;return this.overwriteGetter("rgb",[t/_,a/_,o/_,d])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[a,o,d,_]=rh(t),v=Math.sqrt(o*o+d*d);return[Math.round(1e4*v)?pc(Math.atan2(d,o)*ud):NaN,v,a,_]})(this.rgb))}get lab(){return this.overwriteGetter("lab",rh(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,o,d]=this.rgb;return`rgba(${[t,a,o].map((_=>Math.round(255*_))).join(",")},${d})`}static interpolate(t,a,o,d="rgb"){switch(d){case"rgb":{const[_,v,b,S]=Fo(t.rgb,a.rgb,o);return new Jt(_,v,b,S,!1)}case"hcl":{const[_,v,b,S]=t.hcl,[I,R,O,F]=a.hcl;let V,Z;if(isNaN(_)||isNaN(I))isNaN(_)?isNaN(I)?V=NaN:(V=I,b!==1&&b!==0||(Z=R)):(V=_,O!==1&&O!==0||(Z=v));else{let de=I-_;I>_&&de>180?de-=360:I<_&&_-I>180&&(de+=360),V=_+o*de}const[Y,te,se,Te]=(function([de,ge,De,je]){return de=isNaN(de)?0:de*nh,sh([De,Math.cos(de)*ge,Math.sin(de)*ge,je])})([V,Z??Mn(v,R,o),Mn(b,O,o),Mn(S,F,o)]);return new Jt(Y,te,se,Te,!1)}case"lab":{const[_,v,b,S]=sh(Fo(t.lab,a.lab,o));return new Jt(_,v,b,S,!1)}}}}Jt.black=new Jt(0,0,0,1),Jt.white=new Jt(1,1,1,1),Jt.transparent=new Jt(0,0,0,0),Jt.red=new Jt(1,0,0,1);class Hn{constructor(t,a,o){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Uo=["bottom","center","top"];class ro{constructor(t,a,o,d,_,v){this.text=t,this.image=a,this.scale=o,this.fontStack=d,this.textColor=_,this.verticalAlign=v}}class ja{constructor(t){this.sections=t}static fromString(t){return new ja([new ro(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof ja?t:ja.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class _a{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof _a)return t;if(typeof t=="number")return new _a([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new _a(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o){return new _a(Fo(t.values,a.values,o))}}class Ga{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ga)return t;if(typeof t=="number")return new Ga([t]);if(Array.isArray(t)){for(const a of t)if(typeof a!="number")return;return new Ga(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o){return new Ga(Fo(t.values,a.values,o))}}class Fa{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Fa)return t;if(typeof t=="string"){const o=Jt.parse(t);return o?new Fa([o]):void 0}if(!Array.isArray(t))return;const a=[];for(const o of t){if(typeof o!="string")return;const d=Jt.parse(o);if(!d)return;a.push(d)}return new Fa(a)}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o,d="rgb"){const _=[];if(t.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let v=0;v<t.values.length;v++)_.push(Jt.interpolate(t.values[v],a.values[v],o,d));return new Fa(_)}}class Zi extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const ns=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ma{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ma)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const o=t[a],d=t[a+1];if(typeof o!="string"||!ns.has(o)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new ma(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o){const d=t.values,_=a.values;if(d.length!==_.length)throw new Zi(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${a.toString()}`);const v=[];for(let b=0;b<d.length;b+=2){if(d[b]!==_[b])throw new Zi(`Cannot interpolate values containing mismatched anchors. from[${b}]: ${d[b]}, to[${b}]: ${_[b]}`);v.push(d[b]);const[S,I]=d[b+1],[R,O]=_[b+1];v.push([Mn(S,R,o),Mn(I,O,o)])}return new ma(v)}}class Tn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Tn({name:t,available:!1}):null}}class Qa{constructor(t,a,o){this.from=t,this.to=a,this.transition=o}static interpolate(t,a,o){return new Qa(t,a,o)}static parse(t){return t instanceof Qa?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Qa(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Qa(t.from,t.to,t.transition):typeof t=="string"?new Qa(t,t,1):void 0}}function mr(n,t,a,o){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[n,t,a,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[n,t,a,o]:[n,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ii(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Qa||n instanceof Jt||n instanceof Hn||n instanceof ja||n instanceof _a||n instanceof Ga||n instanceof Fa||n instanceof ma||n instanceof Tn)return!0;if(Array.isArray(n)){for(const t of n)if(!Ii(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Ii(n[t]))return!1;return!0}return!1}function Ki(n){if(n===null)return _i;if(typeof n=="string")return Xt;if(typeof n=="boolean")return Wt;if(typeof n=="number")return nt;if(n instanceof Jt)return $n;if(n instanceof Qa)return Jr;if(n instanceof Hn)return to;if(n instanceof ja)return es;if(n instanceof _a)return pr;if(n instanceof Ga)return Dn;if(n instanceof Fa)return Ss;if(n instanceof ma)return ga;if(n instanceof Tn)return oa;if(Array.isArray(n)){const t=n.length;let a;for(const o of n){const d=Ki(o);if(a){if(a===d)continue;a=Ht;break}a=d}return kn(a||Ht,t)}return Rr}function ai(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof Jt||n instanceof Qa||n instanceof ja||n instanceof _a||n instanceof Ga||n instanceof Fa||n instanceof ma||n instanceof Tn?n.toString():JSON.stringify(n)}class Bt{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ii(t[1]))return a.error("invalid value");const o=t[1];let d=Ki(o);const _=a.expectedType;return d.kind!=="array"||d.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(d=_),new Bt(d,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Es={string:Xt,number:nt,boolean:Wt,object:Rr};class Qt{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let o,d=1;const _=t[0];if(_==="array"){let b,S;if(t.length>2){const I=t[1];if(typeof I!="string"||!(I in Es)||I==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);b=Es[I],d++}else b=Ht;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);S=t[2],d++}o=kn(b,S)}else{if(!Es[_])throw new Error(`Types doesn't contain name = ${_}`);o=Es[_]}const v=[];for(;d<t.length;d++){const b=a.parse(t[d],d,Ht);if(!b)return null;v.push(b)}return new Qt(o,v)}evaluate(t){for(let a=0;a<this.args.length;a++){const o=this.args[a].evaluate(t);if(!El(this.type,Ki(o)))return o;if(a===this.args.length-1)throw new Zi(`Expected value to be of type ${zi(this.type)}, but found ${zi(Ki(o))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const ln={"to-boolean":Wt,"to-color":$n,"to-number":nt,"to-string":Xt};class ya{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const o=t[0];if(!ln[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&t.length!==2)return a.error("Expected one argument.");const d=ln[o],_=[];for(let v=1;v<t.length;v++){const b=a.parse(t[v],v,Ht);if(!b)return null;_.push(b)}return new ya(d,_)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,o;for(const d of this.args){if(a=d.evaluate(t),o=null,a instanceof Jt)return a;if(typeof a=="string"){const _=t.parseColor(a);if(_)return _}else if(Array.isArray(a)&&(o=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:mr(a[0],a[1],a[2],a[3]),!o))return new Jt(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Zi(o||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const o of this.args){a=o.evaluate(t);const d=_a.parse(a);if(d)return d}throw new Zi(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const o of this.args){a=o.evaluate(t);const d=Ga.parse(a);if(d)return d}throw new Zi(`Could not parse numberArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const o of this.args){a=o.evaluate(t);const d=Fa.parse(a);if(d)return d}throw new Zi(`Could not parse colorArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const o of this.args){a=o.evaluate(t);const d=ma.parse(a);if(d)return d}throw new Zi(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const o of this.args){if(a=o.evaluate(t),a===null)return 0;const d=Number(a);if(!isNaN(d))return d}throw new Zi(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return ja.fromString(ai(this.args[0].evaluate(t)));case"resolvedImage":return Tn.fromString(ai(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ai(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Pl=["Unknown","Point","LineString","Polygon"];class As{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Pl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache.get(t);return a||(a=Jt.parse(t),this._parseColorCache.set(t,a)),a}}class gc{constructor(t,a,o=[],d,_=new Ia,v=[]){this.registry=t,this.path=o,this.key=o.map((b=>`[${b}]`)).join(""),this.scope=_,this.errors=v,this.expectedType=d,this._isConstant=a}parse(t,a,o,d,_={}){return a?this.concat(a,o,d)._parse(t,_):this._parse(t,_)}_parse(t,a){function o(d,_,v){return v==="assert"?new Qt(_,[d]):v==="coerce"?new ya(_,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[d];if(_){let v=_.parse(t,this);if(!v)return null;if(this.expectedType){const b=this.expectedType,S=v.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value"){if(b.kind==="projectionDefinition"&&["string","array"].includes(S.kind)||["color","formatted","resolvedImage"].includes(b.kind)&&["value","string"].includes(S.kind)||["padding","numberArray"].includes(b.kind)&&["value","number","array"].includes(S.kind)||b.kind==="colorArray"&&["value","string","array"].includes(S.kind)||b.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(S.kind))v=o(v,b,a.typeAnnotation||"coerce");else if(this.checkSubtype(b,S))return null}else v=o(v,b,a.typeAnnotation||"assert")}if(!(v instanceof Bt)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const b=new As;try{v=new Bt(v.type,v.evaluate(b))}catch(S){return this.error(S.message),null}}return v}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,o){const d=typeof t=="number"?this.path.concat(t):this.path,_=o?this.scope.concat(o):this.scope;return new gc(this.registry,this._isConstant,d,a||null,_,this.errors)}error(t,...a){const o=`${this.key}${a.map((d=>`[${d}]`)).join("")}`;this.errors.push(new Rn(o,t))}checkSubtype(t,a){const o=El(t,a);return o&&this.error(o),o}}class so{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let _=1;_<t.length-1;_+=2){const v=t[_];if(typeof v!="string")return a.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",_);const b=a.parse(t[_+1],_+1);if(!b)return null;o.push([v,b])}const d=a.parse(t[t.length-1],t.length-1,a.expectedType,o);return d?new so(o,d):null}outputDefined(){return this.result.outputDefined()}}class Vo{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const o=t[1];return a.scope.has(o)?new Vo(o,a.scope.get(o)):a.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class qo{constructor(t,a,o){this.type=t,this.index=a,this.input=o}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,nt),d=a.parse(t[2],2,kn(a.expectedType||Ht));return o&&d?new qo(d.type.itemType,o,d):null}evaluate(t){const a=this.index.evaluate(t),o=this.input.evaluate(t);if(a<0)throw new Zi(`Array index out of bounds: ${a} < 0.`);if(a>=o.length)throw new Zi(`Array index out of bounds: ${a} > ${o.length-1}.`);if(a!==Math.floor(a))throw new Zi(`Array index must be an integer, but found ${a} instead.`);return o[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Zo{constructor(t,a){this.type=Wt,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,Ht),d=a.parse(t[2],2,Ht);return o&&d?hu(o.type,[Wt,Xt,nt,_i,Ht])?new Zo(o,d):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(o.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!o)return!1;if(!io(a,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Ki(a))} instead.`);if(!io(o,["string","array"]))throw new Zi(`Expected second argument to be of type array or string, but found ${zi(Ki(o))} instead.`);return o.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class zl{constructor(t,a,o){this.type=nt,this.needle=t,this.haystack=a,this.fromIndex=o}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,Ht),d=a.parse(t[2],2,Ht);if(!o||!d)return null;if(!hu(o.type,[Wt,Xt,nt,_i,Ht]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(o.type)} instead`);if(t.length===4){const _=a.parse(t[3],3,nt);return _?new zl(o,d,_):null}return new zl(o,d)}evaluate(t){const a=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!io(a,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Ki(a))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),io(o,["string"])){const _=o.indexOf(a,d);return _===-1?-1:[...o.slice(0,_)].length}if(io(o,["array"]))return o.indexOf(a,d);throw new Zi(`Expected second argument to be of type array or string, but found ${zi(Ki(o))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class rs{constructor(t,a,o,d,_,v){this.inputType=t,this.type=a,this.input=o,this.cases=d,this.outputs=_,this.otherwise=v}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let o,d;a.expectedType&&a.expectedType.kind!=="value"&&(d=a.expectedType);const _={},v=[];for(let I=2;I<t.length-1;I+=2){let R=t[I];const O=t[I+1];Array.isArray(R)||(R=[R]);const F=a.concat(I);if(R.length===0)return F.error("Expected at least one branch label.");for(const Z of R){if(typeof Z!="number"&&typeof Z!="string")return F.error("Branch labels must be numbers or strings.");if(typeof Z=="number"&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Z=="number"&&Math.floor(Z)!==Z)return F.error("Numeric branch labels must be integer values.");if(o){if(F.checkSubtype(o,Ki(Z)))return null}else o=Ki(Z);if(_[String(Z)]!==void 0)return F.error("Branch labels must be unique.");_[String(Z)]=v.length}const V=a.parse(O,I,d);if(!V)return null;d=d||V.type,v.push(V)}const b=a.parse(t[1],1,Ht);if(!b)return null;const S=a.parse(t[t.length-1],t.length-1,d);return S?b.type.kind!=="value"&&a.concat(1).checkSubtype(o,b.type)?null:new rs(o,d,b,_,v,S):null}evaluate(t){const a=this.input.evaluate(t);return(Ki(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class Ka{constructor(t,a,o){this.type=t,this.branches=a,this.otherwise=o}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let o;a.expectedType&&a.expectedType.kind!=="value"&&(o=a.expectedType);const d=[];for(let v=1;v<t.length-1;v+=2){const b=a.parse(t[v],v,Wt);if(!b)return null;const S=a.parse(t[v+1],v+1,o);if(!S)return null;d.push([b,S]),o=o||S.type}const _=a.parse(t[t.length-1],t.length-1,o);if(!_)return null;if(!o)throw new Error("Can't infer output type");return new Ka(o,d,_)}evaluate(t){for(const[a,o]of this.branches)if(a.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,o]of this.branches)t(a),t(o);t(this.otherwise)}outputDefined(){return this.branches.every((([t,a])=>a.outputDefined()))&&this.otherwise.outputDefined()}}class $o{constructor(t,a,o,d){this.type=t,this.input=a,this.beginIndex=o,this.endIndex=d}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,Ht),d=a.parse(t[2],2,nt);if(!o||!d)return null;if(!hu(o.type,[kn(Ht),Xt,Ht]))return a.error(`Expected first argument to be of type array or string, but found ${zi(o.type)} instead`);if(t.length===4){const _=a.parse(t[3],3,nt);return _?new $o(o.type,o,d,_):null}return new $o(o.type,o,d)}evaluate(t){const a=this.input.evaluate(t),o=this.beginIndex.evaluate(t);let d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),io(a,["string"]))return[...a].slice(o,d).join("");if(io(a,["array"]))return a.slice(o,d);throw new Zi(`Expected first argument to be of type array or string, but found ${zi(Ki(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Ho(n,t){const a=n.length-1;let o,d,_=0,v=a,b=0;for(;_<=v;)if(b=Math.floor((_+v)/2),o=n[b],d=n[b+1],o<=t){if(b===a||t<d)return b;_=b+1}else{if(!(o>t))throw new Zi("Input is not a number.");v=b-1}return 0}class oo{constructor(t,a,o){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[d,_]of o)this.labels.push(d),this.outputs.push(_)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const o=a.parse(t[1],1,nt);if(!o)return null;const d=[];let _=null;a.expectedType&&a.expectedType.kind!=="value"&&(_=a.expectedType);for(let v=1;v<t.length;v+=2){const b=v===1?-1/0:t[v],S=t[v+1],I=v,R=v+1;if(typeof b!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(d.length&&d[d.length-1][0]>=b)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const O=a.parse(S,R,_);if(!O)return null;_=_||O.type,d.push([b,O])}return new oo(_,o,d)}evaluate(t){const a=this.labels,o=this.outputs;if(a.length===1)return o[0].evaluate(t);const d=this.input.evaluate(t);if(d<=a[0])return o[0].evaluate(t);const _=a.length;return d>=a[_-1]?o[_-1].evaluate(t):o[Ho(a,d)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Ja(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var du,fu,dd=(function(){if(fu)return du;function n(t,a,o,d){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(d-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=o,this.p2y=d}return fu=1,du=n,n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,d=0;d<8;d++){var _=this.sampleCurveX(o)-t;if(Math.abs(_)<a)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=_/v}var b=0,S=1;for(o=t,d=0;d<20&&(_=this.sampleCurveX(o),!(Math.abs(_-t)<a));d++)t>_?b=o:S=o,o=.5*(S-b)+b;return o},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},du})(),fd=Ja(dd);class Ua{constructor(t,a,o,d,_){this.type=t,this.operator=a,this.interpolation=o,this.input=d,this.labels=[],this.outputs=[];for(const[v,b]of _)this.labels.push(v),this.outputs.push(b)}static interpolationFactor(t,a,o,d){let _=0;if(t.name==="exponential")_=Il(a,t.base,o,d);else if(t.name==="linear")_=Il(a,1,o,d);else if(t.name==="cubic-bezier"){const v=t.controlPoints;_=new fd(v[0],v[1],v[2],v[3]).solve(Il(a,1,o,d))}return _}static parse(t,a){let[o,d,_,...v]=t;if(!Array.isArray(d)||d.length===0)return a.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const I=d[1];if(typeof I!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:I}}else{if(d[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const I=d.slice(1);if(I.length!==4||I.some((R=>typeof R!="number"||R<0||R>1)))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:I}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(_=a.parse(_,2,nt),!_)return null;const b=[];let S=null;o!=="interpolate-hcl"&&o!=="interpolate-lab"||a.expectedType==Ss?a.expectedType&&a.expectedType.kind!=="value"&&(S=a.expectedType):S=$n;for(let I=0;I<v.length;I+=2){const R=v[I],O=v[I+1],F=I+3,V=I+4;if(typeof R!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(b.length&&b[b.length-1][0]>=R)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const Z=a.parse(O,V,S);if(!Z)return null;S=S||Z.type,b.push([R,Z])}return Ms(S,nt)||Ms(S,Jr)||Ms(S,$n)||Ms(S,pr)||Ms(S,Dn)||Ms(S,Ss)||Ms(S,ga)||Ms(S,kn(nt))?new Ua(S,o,d,_,b):a.error(`Type ${zi(S)} is not interpolatable.`)}evaluate(t){const a=this.labels,o=this.outputs;if(a.length===1)return o[0].evaluate(t);const d=this.input.evaluate(t);if(d<=a[0])return o[0].evaluate(t);const _=a.length;if(d>=a[_-1])return o[_-1].evaluate(t);const v=Ho(a,d),b=Ua.interpolationFactor(this.interpolation,d,a[v],a[v+1]),S=o[v].evaluate(t),I=o[v+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Mn(S,I,b);case"color":return Jt.interpolate(S,I,b);case"padding":return _a.interpolate(S,I,b);case"colorArray":return Fa.interpolate(S,I,b);case"numberArray":return Ga.interpolate(S,I,b);case"variableAnchorOffsetCollection":return ma.interpolate(S,I,b);case"array":return Fo(S,I,b);case"projectionDefinition":return Qa.interpolate(S,I,b)}case"interpolate-hcl":switch(this.type.kind){case"color":return Jt.interpolate(S,I,b,"hcl");case"colorArray":return Fa.interpolate(S,I,b,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Jt.interpolate(S,I,b,"lab");case"colorArray":return Fa.interpolate(S,I,b,"lab")}}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Il(n,t,a,o){const d=o-a,_=n-a;return d===0?0:t===1?_/d:(Math.pow(t,_)-1)/(Math.pow(t,d)-1)}const gr={color:Jt.interpolate,number:Mn,padding:_a.interpolate,numberArray:Ga.interpolate,colorArray:Fa.interpolate,variableAnchorOffsetCollection:ma.interpolate,array:Fo};class pu{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let o=null;const d=a.expectedType;d&&d.kind!=="value"&&(o=d);const _=[];for(const b of t.slice(1)){const S=a.parse(b,1+_.length,o,void 0,{typeAnnotation:"omit"});if(!S)return null;o=o||S.type,_.push(S)}if(!o)throw new Error("No output type");const v=d&&_.some((b=>El(d,b.type)));return new pu(v?Ht:o,_)}evaluate(t){let a,o=null,d=0;for(const _ of this.args)if(d++,o=_.evaluate(t),o&&o instanceof Tn&&!o.available&&(a||(a=o.name),o=null,d===this.args.length&&(o=a)),o!==null)break;return o}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function _c(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function yc(n,t,a,o){return o.compare(t,a)===0}function Cs(n,t,a){const o=n!=="=="&&n!=="!=";return class ey{constructor(_,v,b){this.type=Wt,this.lhs=_,this.rhs=v,this.collator=b,this.hasUntypedArgument=_.type.kind==="value"||v.type.kind==="value"}static parse(_,v){if(_.length!==3&&_.length!==4)return v.error("Expected two or three arguments.");const b=_[0];let S=v.parse(_[1],1,Ht);if(!S)return null;if(!_c(b,S.type))return v.concat(1).error(`"${b}" comparisons are not supported for type '${zi(S.type)}'.`);let I=v.parse(_[2],2,Ht);if(!I)return null;if(!_c(b,I.type))return v.concat(2).error(`"${b}" comparisons are not supported for type '${zi(I.type)}'.`);if(S.type.kind!==I.type.kind&&S.type.kind!=="value"&&I.type.kind!=="value")return v.error(`Cannot compare types '${zi(S.type)}' and '${zi(I.type)}'.`);o&&(S.type.kind==="value"&&I.type.kind!=="value"?S=new Qt(I.type,[S]):S.type.kind!=="value"&&I.type.kind==="value"&&(I=new Qt(S.type,[I])));let R=null;if(_.length===4){if(S.type.kind!=="string"&&I.type.kind!=="string"&&S.type.kind!=="value"&&I.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(R=v.parse(_[3],3,to),!R)return null}return new ey(S,I,R)}evaluate(_){const v=this.lhs.evaluate(_),b=this.rhs.evaluate(_);if(o&&this.hasUntypedArgument){const S=Ki(v),I=Ki(b);if(S.kind!==I.kind||S.kind!=="string"&&S.kind!=="number")throw new Zi(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${S.kind}, ${I.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const S=Ki(v),I=Ki(b);if(S.kind!=="string"||I.kind!=="string")return t(_,v,b)}return this.collator?a(_,v,b,this.collator.evaluate(_)):t(_,v,b)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const Dr=Cs("==",(function(n,t,a){return t===a}),yc),lh=Cs("!=",(function(n,t,a){return t!==a}),(function(n,t,a,o){return!yc(0,t,a,o)})),mu=Cs("<",(function(n,t,a){return t<a}),(function(n,t,a,o){return o.compare(t,a)<0})),vf=Cs(">",(function(n,t,a){return t>a}),(function(n,t,a,o){return o.compare(t,a)>0})),ch=Cs("<=",(function(n,t,a){return t<=a}),(function(n,t,a,o){return o.compare(t,a)<=0})),xf=Cs(">=",(function(n,t,a){return t>=a}),(function(n,t,a,o){return o.compare(t,a)>=0}));class gu{constructor(t,a,o){this.type=to,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return a.error("Collator options argument must be an object.");const d=a.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,Wt);if(!d)return null;const _=a.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,Wt);if(!_)return null;let v=null;return o.locale&&(v=a.parse(o.locale,1,Xt),!v)?null:new gu(d,_,v)}evaluate(t){return new Hn(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class uh{constructor(t,a,o,d,_){this.type=Xt,this.number=t,this.locale=a,this.currency=o,this.minFractionDigits=d,this.maxFractionDigits=_}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const o=a.parse(t[1],1,nt);if(!o)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return a.error("NumberFormat options argument must be an object.");let _=null;if(d.locale&&(_=a.parse(d.locale,1,Xt),!_))return null;let v=null;if(d.currency&&(v=a.parse(d.currency,1,Xt),!v))return null;let b=null;if(d["min-fraction-digits"]&&(b=a.parse(d["min-fraction-digits"],1,nt),!b))return null;let S=null;return d["max-fraction-digits"]&&(S=a.parse(d["max-fraction-digits"],1,nt),!S)?null:new uh(o,_,v,b,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class _u{constructor(t){this.type=es,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return a.error("First argument must be an image or text section.");const d=[];let _=!1;for(let v=1;v<=t.length-1;++v){const b=t[v];if(_&&typeof b=="object"&&!Array.isArray(b)){_=!1;let S=null;if(b["font-scale"]&&(S=a.parse(b["font-scale"],1,nt),!S))return null;let I=null;if(b["text-font"]&&(I=a.parse(b["text-font"],1,kn(Xt)),!I))return null;let R=null;if(b["text-color"]&&(R=a.parse(b["text-color"],1,$n),!R))return null;let O=null;if(b["vertical-align"]){if(typeof b["vertical-align"]=="string"&&!Uo.includes(b["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${b["vertical-align"]}' instead.`);if(O=a.parse(b["vertical-align"],1,Xt),!O)return null}const F=d[d.length-1];F.scale=S,F.font=I,F.textColor=R,F.verticalAlign=O}else{const S=a.parse(t[v],1,Ht);if(!S)return null;const I=S.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,d.push({content:S,scale:null,font:null,textColor:null,verticalAlign:null})}}return new _u(d)}evaluate(t){return new ja(this.sections.map((a=>{const o=a.content.evaluate(t);return Ki(o)===oa?new ro("",o,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(t):null):new ro(ai(o),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null,a.verticalAlign?a.verticalAlign.evaluate(t):null)})))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor),a.verticalAlign&&t(a.verticalAlign)}outputDefined(){return!1}}class Rl{constructor(t){this.type=oa,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const o=a.parse(t[1],1,Xt);return o?new Rl(o):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),o=Tn.fromString(a);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(a)>-1),o}eachChild(t){t(this.input)}outputDefined(){return!1}}class hh{constructor(t){this.type=nt,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=a.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${zi(o.type)} instead.`):new hh(o):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new Zi(`Expected value to be of type string or array, but found ${zi(Ki(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Xn=8192;function Dl(n,t){const a=(180+n[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(a*d*Xn),Math.round(o*d*Xn)]}function dh(n,t){const a=Math.pow(2,t.z);return[(d=(n[0]/Xn+t.x)/a,360*d-180),(o=(n[1]/Xn+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,d}function Xo(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function kl(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function pd(n,t,a){const o=n[0]-t[0],d=n[1]-t[1],_=n[0]-a[0],v=n[1]-a[1];return o*v-_*d==0&&o*_<=0&&d*v<=0}function vc(n,t,a,o){return(d=[o[0]-a[0],o[1]-a[1]])[0]*(_=[t[0]-n[0],t[1]-n[1]])[1]-d[1]*_[0]!=0&&!(!ph(n,t,a,o)||!ph(a,o,n,t));var d,_}function md(n,t,a){for(const o of a)for(let d=0;d<o.length-1;++d)if(vc(n,t,o[d],o[d+1]))return!0;return!1}function kr(n,t,a=!1){let o=!1;for(const b of t)for(let S=0;S<b.length-1;S++){if(pd(n,b[S],b[S+1]))return a;(_=b[S])[1]>(d=n)[1]!=(v=b[S+1])[1]>d[1]&&d[0]<(v[0]-_[0])*(d[1]-_[1])/(v[1]-_[1])+_[0]&&(o=!o)}var d,_,v;return o}function gd(n,t){for(const a of t)if(kr(n,a))return!0;return!1}function fh(n,t){for(const a of n)if(!kr(a,t))return!1;for(let a=0;a<n.length-1;++a)if(md(n[a],n[a+1],t))return!1;return!0}function _d(n,t){for(const a of t)if(fh(n,a))return!0;return!1}function ph(n,t,a,o){const d=o[0]-a[0],_=o[1]-a[1],v=(n[0]-a[0])*_-d*(n[1]-a[1]),b=(t[0]-a[0])*_-d*(t[1]-a[1]);return v>0&&b<0||v<0&&b>0}function yu(n,t,a){const o=[];for(let d=0;d<n.length;d++){const _=[];for(let v=0;v<n[d].length;v++){const b=Dl(n[d][v],a);Xo(t,b),_.push(b)}o.push(_)}return o}function Ll(n,t,a){const o=[];for(let d=0;d<n.length;d++){const _=yu(n[d],t,a);o.push(_)}return o}function Ol(n,t,a,o){if(n[0]<a[0]||n[0]>a[2]){const d=.5*o;let _=n[0]-a[0]>d?-o:a[0]-n[0]>d?o:0;_===0&&(_=n[0]-a[2]>d?-o:a[2]-n[0]>d?o:0),n[0]+=_}Xo(t,n)}function xc(n,t,a,o){const d=Math.pow(2,o.z)*Xn,_=[o.x*Xn,o.y*Xn],v=[];for(const b of n)for(const S of b){const I=[S.x+_[0],S.y+_[1]];Ol(I,t,a,d),v.push(I)}return v}function bc(n,t,a,o){const d=Math.pow(2,o.z)*Xn,_=[o.x*Xn,o.y*Xn],v=[];for(const S of n){const I=[];for(const R of S){const O=[R.x+_[0],R.y+_[1]];Xo(t,O),I.push(O)}v.push(I)}if(t[2]-t[0]<=d/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of v)for(const I of S)Ol(I,t,a,d)}var b;return v}class lo{constructor(t,a){this.type=Wt,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ii(t[1])){const o=t[1];if(o.type==="FeatureCollection"){const d=[];for(const _ of o.features){const{type:v,coordinates:b}=_.geometry;v==="Polygon"&&d.push(b),v==="MultiPolygon"&&d.push(...b)}if(d.length)return new lo(o,{type:"MultiPolygon",coordinates:d})}else if(o.type==="Feature"){const d=o.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new lo(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new lo(o,o)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(a,o){const d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(o.type==="Polygon"){const b=yu(o.coordinates,_,v),S=xc(a.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of S)if(!kr(I,b))return!1}if(o.type==="MultiPolygon"){const b=Ll(o.coordinates,_,v),S=xc(a.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of S)if(!gd(I,b))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(a,o){const d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(o.type==="Polygon"){const b=yu(o.coordinates,_,v),S=bc(a.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of S)if(!fh(I,b))return!1}if(o.type==="MultiPolygon"){const b=Ll(o.coordinates,_,v),S=bc(a.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of S)if(!_d(I,b))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let mh=class{constructor(n=[],t=(a,o)=>a<o?-1:a>o?1:0){if(this.data=n,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:t,compare:a}=this,o=t[n];for(;n>0;){const d=n-1>>1,_=t[d];if(a(o,_)>=0)break;t[n]=_,n=d}t[n]=o}_down(n){const{data:t,compare:a}=this,o=this.length>>1,d=t[n];for(;n<o;){let _=1+(n<<1);const v=_+1;if(v<this.length&&a(t[v],t[_])<0&&(_=v),a(t[_],d)>=0)break;t[n]=t[_],n=_}t[n]=d}};function vu(n,t,a=0,o=n.length-1,d=gh){for(;o>a;){if(o-a>600){const S=o-a+1,I=t-a+1,R=Math.log(S),O=.5*Math.exp(2*R/3),F=.5*Math.sqrt(R*O*(S-O)/S)*(I-S/2<0?-1:1);vu(n,t,Math.max(a,Math.floor(t-I*O/S+F)),Math.min(o,Math.floor(t+(S-I)*O/S+F)),d)}const _=n[t];let v=a,b=o;for(Ps(n,a,t),d(n[o],_)>0&&Ps(n,a,o);v<b;){for(Ps(n,v,b),v++,b--;d(n[v],_)<0;)v++;for(;d(n[b],_)>0;)b--}d(n[a],_)===0?Ps(n,a,b):(b++,Ps(n,b,o)),b<=t&&(a=b+1),t<=b&&(o=b-1)}}function Ps(n,t,a){const o=n[t];n[t]=n[a],n[a]=o}function gh(n,t){return n<t?-1:n>t?1:0}function wc(n,t){if(n.length<=1)return[n];const a=[];let o,d;for(const _ of n){const v=vd(_);v!==0&&(_.area=Math.abs(v),d===void 0&&(d=v<0),d===v<0?(o&&a.push(o),o=[_]):o.push(_))}if(o&&a.push(o),t>1)for(let _=0;_<a.length;_++)a[_].length<=t||(vu(a[_],t,1,a[_].length-1,yd),a[_]=a[_].slice(0,t));return a}function yd(n,t){return t.area-n.area}function vd(n){let t=0;for(let a,o,d=0,_=n.length,v=_-1;d<_;v=d++)a=n[d],o=n[v],t+=(o.x-a.x)*(a.y+o.y);return t}const _h=1/298.257223563,xd=_h*(2-_h),bd=Math.PI/180;class yh{constructor(t){const a=6378.137*bd*1e3,o=Math.cos(t*bd),d=1/(1-xd*(1-o*o)),_=Math.sqrt(d);this.kx=a*_*o,this.ky=a*_*d*(1-xd)}distance(t,a){const o=this.wrap(t[0]-a[0])*this.kx,d=(t[1]-a[1])*this.ky;return Math.sqrt(o*o+d*d)}pointOnLine(t,a){let o,d,_,v,b=1/0;for(let S=0;S<t.length-1;S++){let I=t[S][0],R=t[S][1],O=this.wrap(t[S+1][0]-I)*this.kx,F=(t[S+1][1]-R)*this.ky,V=0;O===0&&F===0||(V=(this.wrap(a[0]-I)*this.kx*O+(a[1]-R)*this.ky*F)/(O*O+F*F),V>1?(I=t[S+1][0],R=t[S+1][1]):V>0&&(I+=O/this.kx*V,R+=F/this.ky*V)),O=this.wrap(a[0]-I)*this.kx,F=(a[1]-R)*this.ky;const Z=O*O+F*F;Z<b&&(b=Z,o=I,d=R,_=S,v=V)}return{point:[o,d],index:_,t:Math.max(0,Math.min(1,v))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function En(n,t){return t[0]-n[0]}function co(n){return n[1]-n[0]+1}function ss(n,t){return n[1]>=n[0]&&n[1]<t}function xu(n,t){if(n[0]>n[1])return[null,null];const a=co(n);if(t){if(a===2)return[n,null];const d=Math.floor(a/2);return[[n[0],n[0]+d],[n[0]+d,n[1]]]}if(a===1)return[n,null];const o=Math.floor(a/2)-1;return[[n[0],n[0]+o],[n[0]+o+1,n[1]]]}function bu(n,t){if(!ss(t,n.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let o=t[0];o<=t[1];++o)Xo(a,n[o]);return a}function yi(n){const t=[1/0,1/0,-1/0,-1/0];for(const a of n)for(const o of a)Xo(t,o);return t}function wu(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function vh(n,t,a){if(!wu(n)||!wu(t))return NaN;let o=0,d=0;return n[2]<t[0]&&(o=t[0]-n[2]),n[0]>t[2]&&(o=n[0]-t[2]),n[1]>t[3]&&(d=n[1]-t[3]),n[3]<t[1]&&(d=t[1]-n[3]),a.distance([0,0],[o,d])}function _r(n,t,a){const o=a.pointOnLine(t,n);return a.distance(n,o.point)}function Sc(n,t,a,o,d){const _=Math.min(_r(n,[a,o],d),_r(t,[a,o],d)),v=Math.min(_r(a,[n,t],d),_r(o,[n,t],d));return Math.min(_,v)}function Mc(n,t,a,o,d){if(!ss(t,n.length)||!ss(o,a.length))return 1/0;let _=1/0;for(let v=t[0];v<t[1];++v){const b=n[v],S=n[v+1];for(let I=o[0];I<o[1];++I){const R=a[I],O=a[I+1];if(vc(b,S,R,O))return 0;_=Math.min(_,Sc(b,S,R,O,d))}}return _}function xh(n,t,a,o,d){if(!ss(t,n.length)||!ss(o,a.length))return NaN;let _=1/0;for(let v=t[0];v<=t[1];++v)for(let b=o[0];b<=o[1];++b)if(_=Math.min(_,d.distance(n[v],a[b])),_===0)return _;return _}function wd(n,t,a){if(kr(n,t,!0))return 0;let o=1/0;for(const d of t){const _=d[0],v=d[d.length-1];if(_!==v&&(o=Math.min(o,_r(n,[v,_],a)),o===0))return o;const b=a.pointOnLine(d,n);if(o=Math.min(o,a.distance(n,b.point)),o===0)return o}return o}function Yo(n,t,a,o){if(!ss(t,n.length))return NaN;for(let _=t[0];_<=t[1];++_)if(kr(n[_],a,!0))return 0;let d=1/0;for(let _=t[0];_<t[1];++_){const v=n[_],b=n[_+1];for(const S of a)for(let I=0,R=S.length,O=R-1;I<R;O=I++){const F=S[O],V=S[I];if(vc(v,b,F,V))return 0;d=Math.min(d,Sc(v,b,F,V,o))}}return d}function Wo(n,t){for(const a of n)for(const o of a)if(kr(o,t,!0))return!0;return!1}function bh(n,t,a,o=1/0){const d=yi(n),_=yi(t);if(o!==1/0&&vh(d,_,a)>=o)return o;if(kl(d,_)){if(Wo(n,t))return 0}else if(Wo(t,n))return 0;let v=1/0;for(const b of n)for(let S=0,I=b.length,R=I-1;S<I;R=S++){const O=b[R],F=b[S];for(const V of t)for(let Z=0,Y=V.length,te=Y-1;Z<Y;te=Z++){const se=V[te],Te=V[Z];if(vc(O,F,se,Te))return 0;v=Math.min(v,Sc(O,F,se,Te,a))}}return v}function wh(n,t,a,o,d,_){if(!_)return;const v=vh(bu(o,_),d,a);v<t&&n.push([v,_,[0,0]])}function os(n,t,a,o,d,_,v){if(!_||!v)return;const b=vh(bu(o,_),bu(d,v),a);b<t&&n.push([b,_,v])}function Tc(n,t,a,o,d=1/0){let _=Math.min(o.distance(n[0],a[0][0]),d);if(_===0)return _;const v=new mh([[0,[0,n.length-1],[0,0]]],En),b=yi(a);for(;v.length>0;){const S=v.pop();if(S[0]>=_)continue;const I=S[1],R=t?50:100;if(co(I)<=R){if(!ss(I,n.length))return NaN;if(t){const O=Yo(n,I,a,o);if(isNaN(O)||O===0)return O;_=Math.min(_,O)}else for(let O=I[0];O<=I[1];++O){const F=wd(n[O],a,o);if(_=Math.min(_,F),_===0)return 0}}else{const O=xu(I,t);wh(v,_,o,n,b,O[0]),wh(v,_,o,n,b,O[1])}}return _}function Ec(n,t,a,o,d,_=1/0){let v=Math.min(_,d.distance(n[0],a[0]));if(v===0)return v;const b=new mh([[0,[0,n.length-1],[0,a.length-1]]],En);for(;b.length>0;){const S=b.pop();if(S[0]>=v)continue;const I=S[1],R=S[2],O=t?50:100,F=o?50:100;if(co(I)<=O&&co(R)<=F){if(!ss(I,n.length)&&ss(R,a.length))return NaN;let V;if(t&&o)V=Mc(n,I,a,R,d),v=Math.min(v,V);else if(t&&!o){const Z=n.slice(I[0],I[1]+1);for(let Y=R[0];Y<=R[1];++Y)if(V=_r(a[Y],Z,d),v=Math.min(v,V),v===0)return v}else if(!t&&o){const Z=a.slice(R[0],R[1]+1);for(let Y=I[0];Y<=I[1];++Y)if(V=_r(n[Y],Z,d),v=Math.min(v,V),v===0)return v}else V=xh(n,I,a,R,d),v=Math.min(v,V)}else{const V=xu(I,t),Z=xu(R,o);os(b,v,d,n,a,V[0],Z[0]),os(b,v,d,n,a,V[0],Z[1]),os(b,v,d,n,a,V[1],Z[0]),os(b,v,d,n,a,V[1],Z[1])}}return v}function Su(n){return n.type==="MultiPolygon"?n.coordinates.map((t=>({type:"Polygon",coordinates:t}))):n.type==="MultiLineString"?n.coordinates.map((t=>({type:"LineString",coordinates:t}))):n.type==="MultiPoint"?n.coordinates.map((t=>({type:"Point",coordinates:t}))):[n]}class Qo{constructor(t,a){this.type=nt,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ii(t[1])){const o=t[1];if(o.type==="FeatureCollection")return new Qo(o,o.features.map((d=>Su(d.geometry))).flat());if(o.type==="Feature")return new Qo(o,Su(o.geometry));if("type"in o&&"coordinates"in o)return new Qo(o,Su(o))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(a,o){const d=a.geometry(),_=d.flat().map((S=>dh([S.x,S.y],a.canonical)));if(d.length===0)return NaN;const v=new yh(_[0][1]);let b=1/0;for(const S of o){switch(S.type){case"Point":b=Math.min(b,Ec(_,!1,[S.coordinates],!1,v,b));break;case"LineString":b=Math.min(b,Ec(_,!1,S.coordinates,!0,v,b));break;case"Polygon":b=Math.min(b,Tc(_,!1,S.coordinates,v,b))}if(b===0)return b}return b})(t,this.geometries);if(t.geometryType()==="LineString")return(function(a,o){const d=a.geometry(),_=d.flat().map((S=>dh([S.x,S.y],a.canonical)));if(d.length===0)return NaN;const v=new yh(_[0][1]);let b=1/0;for(const S of o){switch(S.type){case"Point":b=Math.min(b,Ec(_,!0,[S.coordinates],!1,v,b));break;case"LineString":b=Math.min(b,Ec(_,!0,S.coordinates,!0,v,b));break;case"Polygon":b=Math.min(b,Tc(_,!0,S.coordinates,v,b))}if(b===0)return b}return b})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(a,o){const d=a.geometry();if(d.length===0||d[0].length===0)return NaN;const _=wc(d,0).map((S=>S.map((I=>I.map((R=>dh([R.x,R.y],a.canonical))))))),v=new yh(_[0][0][0][1]);let b=1/0;for(const S of o)for(const I of _){switch(S.type){case"Point":b=Math.min(b,Tc([S.coordinates],!1,I,v,b));break;case"LineString":b=Math.min(b,Tc(S.coordinates,!0,I,v,b));break;case"Polygon":b=Math.min(b,bh(I,S.coordinates,v,b))}if(b===0)return b}return b})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Ac{constructor(t){this.type=Ht,this.key=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=t[1];return o==null?a.error("Global state property must be defined."):typeof o!="string"?a.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new Ac(o)}evaluate(t){var a;const o=(a=t.globals)===null||a===void 0?void 0:a.globalState;return o&&Object.keys(o).length!==0?Cl(o,this.key):null}eachChild(){}outputDefined(){return!1}}const Bl={"==":Dr,"!=":lh,">":vf,"<":mu,">=":xf,"<=":ch,array:Qt,at:qo,boolean:Qt,case:Ka,coalesce:pu,collator:gu,format:_u,image:Rl,in:Zo,"index-of":zl,interpolate:Ua,"interpolate-hcl":Ua,"interpolate-lab":Ua,length:hh,let:so,literal:Bt,match:rs,number:Qt,"number-format":uh,object:Qt,slice:$o,step:oo,string:Qt,"to-boolean":ya,"to-color":ya,"to-number":ya,"to-string":ya,var:Vo,within:lo,distance:Qo,"global-state":Ac};class Yn{constructor(t,a,o,d){this.name=t,this.type=a,this._evaluate=o,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const o=t[0],d=Yn.definitions[o];if(!d)return a.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(d)?d[0]:d.type,v=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,b=v.filter((([I])=>!Array.isArray(I)||I.length===t.length-1));let S=null;for(const[I,R]of b){S=new gc(a.registry,An,a.path,null,a.scope);const O=[];let F=!1;for(let V=1;V<t.length;V++){const Z=t[V],Y=Array.isArray(I)?I[V-1]:I.type,te=S.parse(Z,1+O.length,Y);if(!te){F=!0;break}O.push(te)}if(!F)if(Array.isArray(I)&&I.length!==O.length)S.error(`Expected ${I.length} arguments, but found ${O.length} instead.`);else{for(let V=0;V<O.length;V++){const Z=Array.isArray(I)?I[V]:I.type,Y=O[V];S.concat(V+1).checkSubtype(Z,Y.type)}if(S.errors.length===0)return new Yn(o,_,R,O)}}if(b.length===1)a.errors.push(...S.errors);else{const I=(b.length?b:v).map((([O])=>{return F=O,Array.isArray(F)?`(${F.map(zi).join(", ")})`:`(${zi(F.type)}...)`;var F})).join(" | "),R=[];for(let O=1;O<t.length;O++){const F=a.parse(t[O],1+R.length);if(!F)return null;R.push(zi(F.type))}a.error(`Expected arguments of type ${I}, but found (${R.join(", ")}) instead.`)}return null}static register(t,a){Yn.definitions=a;for(const o in a)t[o]=Yn}}function Sh(n,[t,a,o,d]){t=t.evaluate(n),a=a.evaluate(n),o=o.evaluate(n);const _=d?d.evaluate(n):1,v=mr(t,a,o,_);if(v)throw new Zi(v);return new Jt(t/255,a/255,o/255,_,!1)}function Mu(n,t){return n in t}function Wn(n,t){const a=t[n];return a===void 0?null:a}function ls(n){return{type:n}}function An(n){if(n instanceof Vo)return An(n.boundExpression);if(n instanceof Yn&&n.name==="error"||n instanceof gu||n instanceof lo||n instanceof Qo||n instanceof Ac)return!1;const t=n instanceof ya||n instanceof Qt;let a=!0;return n.eachChild((o=>{a=t?a&&An(o):a&&o instanceof Bt})),!!a&&zs(n)&&Jo(n,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function zs(n){if(n instanceof Yn&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof lo||n instanceof Qo)return!1;let t=!0;return n.eachChild((a=>{t&&!zs(a)&&(t=!1)})),t}function Ko(n){if(n instanceof Yn&&n.name==="feature-state")return!1;let t=!0;return n.eachChild((a=>{t&&!Ko(a)&&(t=!1)})),t}function Jo(n,t){if(n instanceof Yn&&t.indexOf(n.name)>=0)return!1;let a=!0;return n.eachChild((o=>{a&&!Jo(o,t)&&(a=!1)})),a}function Cc(n){return{result:"success",value:n}}function uo(n){return{result:"error",value:n}}function yr(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Mh(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function ho(n){return!!n.expression&&n.expression.interpolated}function Kt(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Tu(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Ki(n)===Rr}function Qn(n){return n}function Pc(n,t){const a=n.stops&&typeof n.stops[0][0]=="object",o=a||!(a||n.property!==void 0),d=n.type||(ho(t)?"exponential":"interval"),_=(function(R){switch(R.type){case"color":return Jt.parse;case"padding":return _a.parse;case"numberArray":return Ga.parse;case"colorArray":return Fa.parse;default:return null}})(t);if(_&&((n=Ir({},n)).stops&&(n.stops=n.stops.map((R=>[R[0],_(R[1])]))),n.default=_(n.default?n.default:t.default)),n.colorSpace&&(v=n.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var v;const b=(function(R){switch(R){case"exponential":return Is;case"interval":return el;case"categorical":return Sd;case"identity":return Th;default:throw new Error(`Unknown function type "${R}"`)}})(d);let S,I;if(d==="categorical"){S=Object.create(null);for(const R of n.stops)S[R[0]]=R[1];I=typeof n.stops[0][0]}if(a){const R={},O=[];for(let Z=0;Z<n.stops.length;Z++){const Y=n.stops[Z],te=Y[0].zoom;R[te]===void 0&&(R[te]={zoom:te,type:n.type,property:n.property,default:n.default,stops:[]},O.push(te)),R[te].stops.push([Y[0].value,Y[1]])}const F=[];for(const Z of O)F.push([R[Z].zoom,Pc(R[Z],t)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:Ua.interpolationFactor.bind(void 0,V),zoomStops:F.map((Z=>Z[0])),evaluate:({zoom:Z},Y)=>Is({stops:F,base:n.base},t,Z).evaluate(Z,Y)}}if(o){const R=d==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Ua.interpolationFactor.bind(void 0,R),zoomStops:n.stops.map((O=>O[0])),evaluate:({zoom:O})=>b(n,t,O,S,I)}}return{kind:"source",evaluate(R,O){const F=O&&O.properties?O.properties[n.property]:void 0;return F===void 0?Kn(n.default,t.default):b(n,t,F,S,I)}}}function Kn(n,t,a){return n!==void 0?n:t!==void 0?t:a!==void 0?a:void 0}function Sd(n,t,a,o,d){return Kn(typeof a===d?o[a]:void 0,n.default,t.default)}function el(n,t,a){if(Kt(a)!=="number")return Kn(n.default,t.default);const o=n.stops.length;if(o===1||a<=n.stops[0][0])return n.stops[0][1];if(a>=n.stops[o-1][0])return n.stops[o-1][1];const d=Ho(n.stops.map((_=>_[0])),a);return n.stops[d][1]}function Is(n,t,a){const o=n.base!==void 0?n.base:1;if(Kt(a)!=="number")return Kn(n.default,t.default);const d=n.stops.length;if(d===1||a<=n.stops[0][0])return n.stops[0][1];if(a>=n.stops[d-1][0])return n.stops[d-1][1];const _=Ho(n.stops.map((R=>R[0])),a),v=(function(R,O,F,V){const Z=V-F,Y=R-F;return Z===0?0:O===1?Y/Z:(Math.pow(O,Y)-1)/(Math.pow(O,Z)-1)})(a,o,n.stops[_][0],n.stops[_+1][0]),b=n.stops[_][1],S=n.stops[_+1][1],I=gr[t.type]||Qn;return typeof b.evaluate=="function"?{evaluate(...R){const O=b.evaluate.apply(void 0,R),F=S.evaluate.apply(void 0,R);if(O!==void 0&&F!==void 0)return I(O,F,v,n.colorSpace)}}:I(b,S,v,n.colorSpace)}function Th(n,t,a){switch(t.type){case"color":a=Jt.parse(a);break;case"formatted":a=ja.fromString(a.toString());break;case"resolvedImage":a=Tn.fromString(a.toString());break;case"padding":a=_a.parse(a);break;case"colorArray":a=Fa.parse(a);break;case"numberArray":a=Ga.parse(a);break;default:Kt(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return Kn(a,n.default,t.default)}Yn.register(Bl,{error:[{kind:"error"},[Xt],(n,[t])=>{throw new Zi(t.evaluate(n))}],typeof:[Xt,[Ht],(n,[t])=>zi(Ki(t.evaluate(n)))],"to-rgba":[kn(nt,4),[$n],(n,[t])=>{const[a,o,d,_]=t.evaluate(n).rgb;return[255*a,255*o,255*d,_]}],rgb:[$n,[nt,nt,nt],Sh],rgba:[$n,[nt,nt,nt,nt],Sh],has:{type:Wt,overloads:[[[Xt],(n,[t])=>Mu(t.evaluate(n),n.properties())],[[Xt,Rr],(n,[t,a])=>Mu(t.evaluate(n),a.evaluate(n))]]},get:{type:Ht,overloads:[[[Xt],(n,[t])=>Wn(t.evaluate(n),n.properties())],[[Xt,Rr],(n,[t,a])=>Wn(t.evaluate(n),a.evaluate(n))]]},"feature-state":[Ht,[Xt],(n,[t])=>Wn(t.evaluate(n),n.featureState||{})],properties:[Rr,[],n=>n.properties()],"geometry-type":[Xt,[],n=>n.geometryType()],id:[Ht,[],n=>n.id()],zoom:[nt,[],n=>n.globals.zoom],"heatmap-density":[nt,[],n=>n.globals.heatmapDensity||0],elevation:[nt,[],n=>n.globals.elevation||0],"line-progress":[nt,[],n=>n.globals.lineProgress||0],accumulated:[Ht,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[nt,ls(nt),(n,t)=>{let a=0;for(const o of t)a+=o.evaluate(n);return a}],"*":[nt,ls(nt),(n,t)=>{let a=1;for(const o of t)a*=o.evaluate(n);return a}],"-":{type:nt,overloads:[[[nt,nt],(n,[t,a])=>t.evaluate(n)-a.evaluate(n)],[[nt],(n,[t])=>-t.evaluate(n)]]},"/":[nt,[nt,nt],(n,[t,a])=>t.evaluate(n)/a.evaluate(n)],"%":[nt,[nt,nt],(n,[t,a])=>t.evaluate(n)%a.evaluate(n)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(n,[t,a])=>Math.pow(t.evaluate(n),a.evaluate(n))],sqrt:[nt,[nt],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[nt,[nt],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[nt,[nt],(n,[t])=>Math.log(t.evaluate(n))],log2:[nt,[nt],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[nt,[nt],(n,[t])=>Math.sin(t.evaluate(n))],cos:[nt,[nt],(n,[t])=>Math.cos(t.evaluate(n))],tan:[nt,[nt],(n,[t])=>Math.tan(t.evaluate(n))],asin:[nt,[nt],(n,[t])=>Math.asin(t.evaluate(n))],acos:[nt,[nt],(n,[t])=>Math.acos(t.evaluate(n))],atan:[nt,[nt],(n,[t])=>Math.atan(t.evaluate(n))],min:[nt,ls(nt),(n,t)=>Math.min(...t.map((a=>a.evaluate(n))))],max:[nt,ls(nt),(n,t)=>Math.max(...t.map((a=>a.evaluate(n))))],abs:[nt,[nt],(n,[t])=>Math.abs(t.evaluate(n))],round:[nt,[nt],(n,[t])=>{const a=t.evaluate(n);return a<0?-Math.round(-a):Math.round(a)}],floor:[nt,[nt],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[nt,[nt],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[Wt,[Xt,Ht],(n,[t,a])=>n.properties()[t.value]===a.value],"filter-id-==":[Wt,[Ht],(n,[t])=>n.id()===t.value],"filter-type-==":[Wt,[Xt],(n,[t])=>n.geometryType()===t.value],"filter-<":[Wt,[Xt,Ht],(n,[t,a])=>{const o=n.properties()[t.value],d=a.value;return typeof o==typeof d&&o<d}],"filter-id-<":[Wt,[Ht],(n,[t])=>{const a=n.id(),o=t.value;return typeof a==typeof o&&a<o}],"filter->":[Wt,[Xt,Ht],(n,[t,a])=>{const o=n.properties()[t.value],d=a.value;return typeof o==typeof d&&o>d}],"filter-id->":[Wt,[Ht],(n,[t])=>{const a=n.id(),o=t.value;return typeof a==typeof o&&a>o}],"filter-<=":[Wt,[Xt,Ht],(n,[t,a])=>{const o=n.properties()[t.value],d=a.value;return typeof o==typeof d&&o<=d}],"filter-id-<=":[Wt,[Ht],(n,[t])=>{const a=n.id(),o=t.value;return typeof a==typeof o&&a<=o}],"filter->=":[Wt,[Xt,Ht],(n,[t,a])=>{const o=n.properties()[t.value],d=a.value;return typeof o==typeof d&&o>=d}],"filter-id->=":[Wt,[Ht],(n,[t])=>{const a=n.id(),o=t.value;return typeof a==typeof o&&a>=o}],"filter-has":[Wt,[Ht],(n,[t])=>t.value in n.properties()],"filter-has-id":[Wt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Wt,[kn(Xt)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[Wt,[kn(Ht)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[Wt,[Xt,kn(Ht)],(n,[t,a])=>a.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[Wt,[Xt,kn(Ht)],(n,[t,a])=>(function(o,d,_,v){for(;_<=v;){const b=_+v>>1;if(d[b]===o)return!0;d[b]>o?v=b-1:_=b+1}return!1})(n.properties()[t.value],a.value,0,a.value.length-1)],all:{type:Wt,overloads:[[[Wt,Wt],(n,[t,a])=>t.evaluate(n)&&a.evaluate(n)],[ls(Wt),(n,t)=>{for(const a of t)if(!a.evaluate(n))return!1;return!0}]]},any:{type:Wt,overloads:[[[Wt,Wt],(n,[t,a])=>t.evaluate(n)||a.evaluate(n)],[ls(Wt),(n,t)=>{for(const a of t)if(a.evaluate(n))return!0;return!1}]]},"!":[Wt,[Wt],(n,[t])=>!t.evaluate(n)],"is-supported-script":[Wt,[Xt],(n,[t])=>{const a=n.globals&&n.globals.isSupportedScript;return!a||a(t.evaluate(n))}],upcase:[Xt,[Xt],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[Xt,[Xt],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[Xt,ls(Ht),(n,t)=>t.map((a=>ai(a.evaluate(n)))).join("")],"resolved-locale":[Xt,[to],(n,[t])=>t.evaluate(n).resolvedLocale()]});class Eu{constructor(t,a,o){this.expression=t,this._warningHistory={},this._evaluator=new As,this._defaultValue=a?(function(d){if(d.type==="color"&&Tu(d.default))return new Jt(0,0,0,0);switch(d.type){case"color":return Jt.parse(d.default)||null;case"padding":return _a.parse(d.default)||null;case"numberArray":return Ga.parse(d.default)||null;case"colorArray":return Fa.parse(d.default)||null;case"variableAnchorOffsetCollection":return ma.parse(d.default)||null;case"projectionDefinition":return Qa.parse(d.default)||null;default:return d.default===void 0?null:d.default}})(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this._globalState=o}evaluateWithoutErrorHandling(t,a,o,d,_,v){return this._globalState&&(t=en(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=o,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(t,a,o,d,_,v){this._globalState&&(t=en(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=o||null,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Zi(`Expected value to be one of ${Object.keys(this._enumValues).map((S=>JSON.stringify(S))).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Nl(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Bl}function zc(n,t,a){const o=new gc(Bl,An,[],t?(function(_){const v={color:$n,string:Xt,number:nt,enum:Xt,boolean:Wt,formatted:es,padding:pr,numberArray:Dn,colorArray:Ss,projectionDefinition:Jr,resolvedImage:oa,variableAnchorOffsetCollection:ga};return _.type==="array"?kn(v[_.value]||Ht,_.length):v[_.type]})(t):void 0),d=o.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Cc(new Eu(d,t,a)):uo(o.errors)}class Cn{constructor(t,a,o){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!Ko(a.expression),this.globalStateRefs=mn(a.expression),this._globalState=o}evaluateWithoutErrorHandling(t,a,o,d,_,v){return this._globalState&&(t=en(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,a,o,d,_,v)}evaluate(t,a,o,d,_,v){return this._globalState&&(t=en(t,this._globalState)),this._styleExpression.evaluate(t,a,o,d,_,v)}}class Rs{constructor(t,a,o,d,_){this.kind=t,this.zoomStops=o,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!Ko(a.expression),this.globalStateRefs=mn(a.expression),this.interpolationType=d,this._globalState=_}evaluateWithoutErrorHandling(t,a,o,d,_,v){return this._globalState&&(t=en(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,a,o,d,_,v)}evaluate(t,a,o,d,_,v){return this._globalState&&(t=en(t,this._globalState)),this._styleExpression.evaluate(t,a,o,d,_,v)}interpolationFactor(t,a,o){return this.interpolationType?Ua.interpolationFactor(this.interpolationType,t,a,o):0}}function fo(n,t,a){const o=zc(n,t,a);if(o.result==="error")return o;const d=o.value.expression,_=zs(d);if(!_&&!yr(t))return uo([new Rn("","data expressions not supported")]);const v=Jo(d,["zoom"]);if(!v&&!Mh(t))return uo([new Rn("","zoom expressions not supported")]);const b=po(d);return b||v?b instanceof Rn?uo([b]):b instanceof Ua&&!ho(t)?uo([new Rn("",'"interpolate" expressions cannot be used with this property')]):Cc(b?new Rs(_?"camera":"composite",o.value,b.labels,b instanceof Ua?b.interpolation:void 0,a):new Cn(_?"constant":"source",o.value,a)):uo([new Rn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class tl{constructor(t,a){this._parameters=t,this._specification=a,Ir(this,Pc(this._parameters,this._specification))}static deserialize(t){return new tl(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function po(n){let t=null;if(n instanceof so)t=po(n.result);else if(n instanceof pu){for(const a of n.args)if(t=po(a),t)break}else(n instanceof oo||n instanceof Ua)&&n.input instanceof Yn&&n.input.name==="zoom"&&(t=n);return t instanceof Rn||n.eachChild((a=>{const o=po(a);o instanceof Rn?t=o:!t&&o?t=new Rn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&o&&t!==o&&(t=new Rn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function mn(n,t=new Set){return n instanceof Ac&&t.add(n.key),n.eachChild((a=>{mn(a,t)})),t}function en(n,t){const{zoom:a,heatmapDensity:o,elevation:d,lineProgress:_,isSupportedScript:v,accumulated:b}=n??{};return{zoom:a,heatmapDensity:o,elevation:d,lineProgress:_,isSupportedScript:v,accumulated:b,globalState:t}}function Lr(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!Lr(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const cs={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ln(n,t){if(n==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Lr(n)||(n=il(n));const a=zc(n,cs,t);if(a.result==="error")throw new Error(a.value.map((o=>`${o.key}: ${o.message}`)).join(", "));return{filter:(o,d,_)=>a.value.evaluate(o,d,{},_),needGeometry:Eh(n),getGlobalStateRefs:()=>mn(a.value.expression)}}function Ds(n,t){return n<t?-1:n>t?1:0}function Eh(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let t=1;t<n.length;t++)if(Eh(n[t]))return!0;return!1}function il(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?jl(n[1],n[2],"=="):t==="!="?ki(jl(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?jl(n[1],n[2],t):t==="any"?(a=n.slice(1),["any"].concat(a.map(il))):t==="all"?["all"].concat(n.slice(1).map(il)):t==="none"?["all"].concat(n.slice(1).map(il).map(ki)):t==="in"?Ic(n[1],n.slice(2)):t==="!in"?ki(Ic(n[1],n.slice(2))):t==="has"?Ra(n[1]):t!=="!has"||ki(Ra(n[1]));var a}function jl(n,t,a){switch(n){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,n,t]}}function Ic(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((a=>typeof a!=typeof t[0]))?["filter-in-large",n,["literal",t.sort(Ds)]]:["filter-in-small",n,["literal",t]]}}function Ra(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function ki(n){return["!",n]}function ci(n){const t=typeof n;if(t==="number"||t==="boolean"||t==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let d="[";for(const _ of n)d+=`${ci(_)},`;return`${d}]`}const a=Object.keys(n).sort();let o="{";for(let d=0;d<a.length;d++)o+=`${JSON.stringify(a[d])}:${ci(n[a[d]])},`;return`${o}}`}function Or(n){let t="";for(const a of ii)t+=`/${ci(n[a])}`;return t}function Jn(n){const t=n.value;return t?[new tt(n.key,t,"constants have been deprecated as of v8")]:[]}function la(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function On(n){if(Array.isArray(n))return n.map(On);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const a in n)t[a]=On(n[a]);return t}return la(n)}function er(n){const t=n.key,a=n.value,o=n.valueSpec||{},d=n.objectElementValidators||{},_=n.style,v=n.styleSpec,b=n.validateSpec;let S=[];const I=Kt(a);if(I!=="object")return[new tt(t,a,`object expected, ${I} found`)];for(const R in a){const O=R.split(".")[0],F=Cl(o,O)||o["*"];let V;if(Cl(d,O))V=d[O];else if(Cl(o,O))V=b;else if(d["*"])V=d["*"];else{if(!o["*"]){S.push(new tt(t,a[R],`unknown property "${R}"`));continue}V=b}S=S.concat(V({key:(t&&`${t}.`)+R,value:a[R],valueSpec:F,style:_,styleSpec:v,object:a,objectKey:R,validateSpec:b},a))}for(const R in o)d[R]||o[R].required&&o[R].default===void 0&&a[R]===void 0&&S.push(new tt(t,a,`missing required property "${R}"`));return S}function Au(n){const t=n.value,a=n.valueSpec,o=n.style,d=n.styleSpec,_=n.key,v=n.arrayElementValidator||n.validateSpec;if(Kt(t)!=="array")return[new tt(_,t,`array expected, ${Kt(t)} found`)];if(a.length&&t.length!==a.length)return[new tt(_,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new tt(_,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let b={type:a.value,values:a.values};d.$version<7&&(b.function=a.function),Kt(a.value)==="object"&&(b=a.value);let S=[];for(let I=0;I<t.length;I++)S=S.concat(v({array:t,arrayIndex:I,value:t[I],valueSpec:b,validateSpec:n.validateSpec,style:o,styleSpec:d,key:`${_}[${I}]`}));return S}function ks(n){const t=n.key,a=n.value,o=n.valueSpec;let d=Kt(a);return d==="number"&&a!=a&&(d="NaN"),d!=="number"?[new tt(t,a,`number expected, ${d} found`)]:"minimum"in o&&a<o.minimum?[new tt(t,a,`${a} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&a>o.maximum?[new tt(t,a,`${a} is greater than the maximum value ${o.maximum}`)]:[]}function Ls(n){const t=n.valueSpec,a=la(n.value.type);let o,d,_,v={};const b=a!=="categorical"&&n.value.property===void 0,S=!b,I=Kt(n.value.stops)==="array"&&Kt(n.value.stops[0])==="array"&&Kt(n.value.stops[0][0])==="object",R=er({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(V){if(a==="identity")return[new tt(V.key,V.value,'identity function may not have a "stops" property')];let Z=[];const Y=V.value;return Z=Z.concat(Au({key:V.key,value:Y,valueSpec:V.valueSpec,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:O})),Kt(Y)==="array"&&Y.length===0&&Z.push(new tt(V.key,Y,"array must have at least one stop")),Z},default:function(V){return V.validateSpec({key:V.key,value:V.value,valueSpec:t,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec})}}});return a==="identity"&&b&&R.push(new tt(n.key,n.value,'missing required property "property"')),a==="identity"||n.value.stops||R.push(new tt(n.key,n.value,'missing required property "stops"')),a==="exponential"&&n.valueSpec.expression&&!ho(n.valueSpec)&&R.push(new tt(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(S&&!yr(n.valueSpec)?R.push(new tt(n.key,n.value,"property functions not supported")):b&&!Mh(n.valueSpec)&&R.push(new tt(n.key,n.value,"zoom functions not supported"))),a!=="categorical"&&!I||n.value.property!==void 0||R.push(new tt(n.key,n.value,'"property" property is required')),R;function O(V){let Z=[];const Y=V.value,te=V.key;if(Kt(Y)!=="array")return[new tt(te,Y,`array expected, ${Kt(Y)} found`)];if(Y.length!==2)return[new tt(te,Y,`array length 2 expected, length ${Y.length} found`)];if(I){if(Kt(Y[0])!=="object")return[new tt(te,Y,`object expected, ${Kt(Y[0])} found`)];if(Y[0].zoom===void 0)return[new tt(te,Y,"object stop key must have zoom")];if(Y[0].value===void 0)return[new tt(te,Y,"object stop key must have value")];if(_&&_>la(Y[0].zoom))return[new tt(te,Y[0].zoom,"stop zoom values must appear in ascending order")];la(Y[0].zoom)!==_&&(_=la(Y[0].zoom),d=void 0,v={}),Z=Z.concat(er({key:`${te}[0]`,value:Y[0],valueSpec:{zoom:{}},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:ks,value:F}}))}else Z=Z.concat(F({key:`${te}[0]`,value:Y[0],validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec},Y));return Nl(On(Y[1]))?Z.concat([new tt(`${te}[1]`,Y[1],"expressions are not allowed in function stops.")]):Z.concat(V.validateSpec({key:`${te}[1]`,value:Y[1],valueSpec:t,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec}))}function F(V,Z){const Y=Kt(V.value),te=la(V.value),se=V.value!==null?V.value:Z;if(o){if(Y!==o)return[new tt(V.key,se,`${Y} stop domain type must match previous stop domain type ${o}`)]}else o=Y;if(Y!=="number"&&Y!=="string"&&Y!=="boolean")return[new tt(V.key,se,"stop domain value must be a number, string, or boolean")];if(Y!=="number"&&a!=="categorical"){let Te=`number expected, ${Y} found`;return yr(t)&&a===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new tt(V.key,se,Te)]}return a!=="categorical"||Y!=="number"||isFinite(te)&&Math.floor(te)===te?a!=="categorical"&&Y==="number"&&d!==void 0&&te<d?[new tt(V.key,se,"stop domain values must appear in ascending order")]:(d=te,a==="categorical"&&te in v?[new tt(V.key,se,"stop domain values must be unique")]:(v[te]=!0,[])):[new tt(V.key,se,`integer expected, found ${te}`)]}}function Os(n){const t=(n.expressionContext==="property"?fo:zc)(On(n.value),n.valueSpec);if(t.result==="error")return t.value.map((o=>new tt(`${n.key}${o.key}`,n.value,o.message)));const a=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!a.outputDefined())return[new tt(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Ko(a))return[new tt(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!Ko(a))return[new tt(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Jo(a,["zoom","feature-state"]))return[new tt(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!zs(a))return[new tt(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function us(n){const t=n.key,a=n.value,o=Kt(a);return o!=="string"?[new tt(t,a,`color expected, ${o} found`)]:Jt.parse(String(a))?[]:[new tt(t,a,`color expected, "${a}" found`)]}function al(n){const t=n.key,a=n.value,o=n.valueSpec,d=[];return Array.isArray(o.values)?o.values.indexOf(la(a))===-1&&d.push(new tt(t,a,`expected one of [${o.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(o.values).indexOf(la(a))===-1&&d.push(new tt(t,a,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(a)} found`)),d}function hs(n){return Lr(On(n.value))?Os(Ir({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Br(n)}function Br(n){const t=n.value,a=n.key;if(Kt(t)!=="array")return[new tt(a,t,`array expected, ${Kt(t)} found`)];const o=n.styleSpec;let d,_=[];if(t.length<1)return[new tt(a,t,"filter array must have at least 1 element")];switch(_=_.concat(al({key:`${a}[0]`,value:t[0],valueSpec:o.filter_operator,style:n.style,styleSpec:n.styleSpec})),la(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&la(t[1])==="$type"&&_.push(new tt(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&_.push(new tt(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=Kt(t[1]),d!=="string"&&_.push(new tt(`${a}[1]`,t[1],`string expected, ${d} found`)));for(let v=2;v<t.length;v++)d=Kt(t[v]),la(t[1])==="$type"?_=_.concat(al({key:`${a}[${v}]`,value:t[v],valueSpec:o.geometry_type,style:n.style,styleSpec:n.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&_.push(new tt(`${a}[${v}]`,t[v],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)_=_.concat(Br({key:`${a}[${v}]`,value:t[v],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":d=Kt(t[1]),t.length!==2?_.push(new tt(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&_.push(new tt(`${a}[1]`,t[1],`string expected, ${d} found`))}return _}function Bs(n,t){const a=n.key,o=n.validateSpec,d=n.style,_=n.styleSpec,v=n.value,b=n.objectKey,S=_[`${t}_${n.layerType}`];if(!S)return[];const I=b.match(/^(.*)-transition$/);if(t==="paint"&&I&&S[I[1]]&&S[I[1]].transition)return o({key:a,value:v,valueSpec:_.transition,style:d,styleSpec:_});const R=n.valueSpec||S[b];if(!R)return[new tt(a,v,`unknown property "${b}"`)];let O;if(Kt(v)==="string"&&yr(R)&&!R.tokens&&(O=/^{([^}]+)}$/.exec(v)))return[new tt(a,v,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const F=[];return n.layerType==="symbol"&&(b==="text-field"&&d&&!d.glyphs&&F.push(new tt(a,v,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&Tu(On(v))&&la(v.type)==="identity"&&F.push(new tt(a,v,'"text-font" does not support identity functions'))),F.concat(o({key:n.key,value:v,valueSpec:R,style:d,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:b}))}function Nr(n){return Bs(n,"paint")}function Rc(n){return Bs(n,"layout")}function mo(n){let t=[];const a=n.value,o=n.key,d=n.style,_=n.styleSpec;if(Kt(a)!=="object")return[new tt(o,a,`object expected, ${Kt(a)} found`)];a.type||a.ref||t.push(new tt(o,a,'either "type" or "ref" is required'));let v=la(a.type);const b=la(a.ref);if(a.id){const S=la(a.id);for(let I=0;I<n.arrayIndex;I++){const R=d.layers[I];la(R.id)===S&&t.push(new tt(o,a.id,`duplicate layer id "${a.id}", previously used at line ${R.id.__line__}`))}}if("ref"in a){let S;["type","source","source-layer","filter","layout"].forEach((I=>{I in a&&t.push(new tt(o,a[I],`"${I}" is prohibited for ref layers`))})),d.layers.forEach((I=>{la(I.id)===b&&(S=I)})),S?S.ref?t.push(new tt(o,a.ref,"ref cannot reference another ref layer")):v=la(S.type):t.push(new tt(o,a.ref,`ref layer "${b}" not found`))}else if(v!=="background")if(a.source){const S=d.sources&&d.sources[a.source],I=S&&la(S.type);S?I==="vector"&&v==="raster"?t.push(new tt(o,a.source,`layer "${a.id}" requires a raster source`)):I!=="raster-dem"&&v==="hillshade"||I!=="raster-dem"&&v==="color-relief"?t.push(new tt(o,a.source,`layer "${a.id}" requires a raster-dem source`)):I==="raster"&&v!=="raster"?t.push(new tt(o,a.source,`layer "${a.id}" requires a vector source`)):I!=="vector"||a["source-layer"]?I==="raster-dem"&&v!=="hillshade"&&v!=="color-relief"?t.push(new tt(o,a.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):v!=="line"||!a.paint||!a.paint["line-gradient"]||I==="geojson"&&S.lineMetrics||t.push(new tt(o,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new tt(o,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new tt(o,a.source,`source "${a.source}" not found`))}else t.push(new tt(o,a,'missing required property "source"'));return t=t.concat(er({key:o,value:a,valueSpec:_.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${o}.type`,value:a.type,valueSpec:_.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:a,objectKey:"type"}),filter:hs,layout:S=>er({layer:a,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>Rc(Ir({layerType:v},I))}}),paint:S=>er({layer:a,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>Nr(Ir({layerType:v},I))}})}})),t}function vr(n){const t=n.value,a=n.key,o=Kt(t);return o!=="string"?[new tt(a,t,`string expected, ${o} found`)]:[]}const Dc={promoteId:function({key:n,value:t}){if(Kt(t)==="string")return vr({key:n,value:t});{const a=[];for(const o in t)a.push(...vr({key:`${n}.${o}`,value:t[o]}));return a}}};function go(n){const t=n.value,a=n.key,o=n.styleSpec,d=n.style,_=n.validateSpec;if(!t.type)return[new tt(a,t,'"type" is required')];const v=la(t.type);let b;switch(v){case"vector":case"raster":return b=er({key:a,value:t,valueSpec:o[`source_${v.replace("-","_")}`],style:n.style,styleSpec:o,objectElementValidators:Dc,validateSpec:_}),b;case"raster-dem":return b=(function(S){var I;const R=(I=S.sourceName)!==null&&I!==void 0?I:"",O=S.value,F=S.styleSpec,V=F.source_raster_dem,Z=S.style;let Y=[];const te=Kt(O);if(O===void 0)return Y;if(te!=="object")return Y.push(new tt("source_raster_dem",O,`object expected, ${te} found`)),Y;const se=la(O.encoding)==="custom",Te=["redFactor","greenFactor","blueFactor","baseShift"],de=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const ge in O)!se&&Te.includes(ge)?Y.push(new tt(ge,O[ge],`In "${R}": "${ge}" is only valid when "encoding" is set to "custom". ${de} encoding found`)):V[ge]?Y=Y.concat(S.validateSpec({key:ge,value:O[ge],valueSpec:V[ge],validateSpec:S.validateSpec,style:Z,styleSpec:F})):Y.push(new tt(ge,O[ge],`unknown property "${ge}"`));return Y})({sourceName:a,value:t,style:n.style,styleSpec:o,validateSpec:_}),b;case"geojson":if(b=er({key:a,value:t,valueSpec:o.source_geojson,style:d,styleSpec:o,validateSpec:_,objectElementValidators:Dc}),t.cluster)for(const S in t.clusterProperties){const[I,R]=t.clusterProperties[S],O=typeof I=="string"?[I,["accumulated"],["get",S]]:I;b.push(...Os({key:`${a}.${S}.map`,value:R,expressionContext:"cluster-map"})),b.push(...Os({key:`${a}.${S}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return b;case"video":return er({key:a,value:t,valueSpec:o.source_video,style:d,validateSpec:_,styleSpec:o});case"image":return er({key:a,value:t,valueSpec:o.source_image,style:d,validateSpec:_,styleSpec:o});case"canvas":return[new tt(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return al({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function tn(n){const t=n.value,a=n.styleSpec,o=a.light,d=n.style;let _=[];const v=Kt(t);if(t===void 0)return _;if(v!=="object")return _=_.concat([new tt("light",t,`object expected, ${v} found`)]),_;for(const b in t){const S=b.match(/^(.*)-transition$/);_=_.concat(S&&o[S[1]]&&o[S[1]].transition?n.validateSpec({key:b,value:t[b],valueSpec:a.transition,validateSpec:n.validateSpec,style:d,styleSpec:a}):o[b]?n.validateSpec({key:b,value:t[b],valueSpec:o[b],validateSpec:n.validateSpec,style:d,styleSpec:a}):[new tt(b,t[b],`unknown property "${b}"`)])}return _}function kc(n){const t=n.value,a=n.styleSpec,o=a.sky,d=n.style,_=Kt(t);if(t===void 0)return[];if(_!=="object")return[new tt("sky",t,`object expected, ${_} found`)];let v=[];for(const b in t)v=v.concat(o[b]?n.validateSpec({key:b,value:t[b],valueSpec:o[b],style:d,styleSpec:a}):[new tt(b,t[b],`unknown property "${b}"`)]);return v}function Ah(n){const t=n.value,a=n.styleSpec,o=a.terrain,d=n.style;let _=[];const v=Kt(t);if(t===void 0)return _;if(v!=="object")return _=_.concat([new tt("terrain",t,`object expected, ${v} found`)]),_;for(const b in t)_=_.concat(o[b]?n.validateSpec({key:b,value:t[b],valueSpec:o[b],validateSpec:n.validateSpec,style:d,styleSpec:a}):[new tt(b,t[b],`unknown property "${b}"`)]);return _}function Gl(n){let t=[];const a=n.value,o=n.key;if(Array.isArray(a)){const d=[],_=[];for(const v in a)a[v].id&&d.includes(a[v].id)&&t.push(new tt(o,a,`all the sprites' ids must be unique, but ${a[v].id} is duplicated`)),d.push(a[v].id),a[v].url&&_.includes(a[v].url)&&t.push(new tt(o,a,`all the sprites' URLs must be unique, but ${a[v].url} is duplicated`)),_.push(a[v].url),t=t.concat(er({key:`${o}[${v}]`,value:a[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return t}return vr({key:o,value:a})}function Fl(n){return t=n.value,t&&t.constructor===Object?[]:[new tt(n.key,n.value,`object expected, ${Kt(n.value)} found`)];var t}const Bn={"*":()=>[],array:Au,boolean:function(n){const t=n.value,a=n.key,o=Kt(t);return o!=="boolean"?[new tt(a,t,`boolean expected, ${o} found`)]:[]},number:ks,color:us,constants:Jn,enum:al,filter:hs,function:Ls,layer:mo,object:er,source:go,light:tn,sky:kc,terrain:Ah,projection:function(n){const t=n.value,a=n.styleSpec,o=a.projection,d=n.style,_=Kt(t);if(t===void 0)return[];if(_!=="object")return[new tt("projection",t,`object expected, ${_} found`)];let v=[];for(const b in t)v=v.concat(o[b]?n.validateSpec({key:b,value:t[b],valueSpec:o[b],style:d,styleSpec:a}):[new tt(b,t[b],`unknown property "${b}"`)]);return v},projectionDefinition:function(n){const t=n.key;let a=n.value;a=a instanceof String?a.valueOf():a;const o=Kt(a);return o!=="array"||(function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"})(a)||(function(d){return!!["interpolate","step","literal"].includes(d[0])})(a)?["array","string"].includes(o)?[]:[new tt(t,a,`projection expected, invalid type "${o}" found`)]:[new tt(t,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:vr,formatted:function(n){return vr(n).length===0?[]:Os(n)},resolvedImage:function(n){return vr(n).length===0?[]:Os(n)},padding:function(n){const t=n.key,a=n.value;if(Kt(a)==="array"){if(a.length<1||a.length>4)return[new tt(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const o={type:"number"};let d=[];for(let _=0;_<a.length;_++)d=d.concat(n.validateSpec({key:`${t}[${_}]`,value:a[_],validateSpec:n.validateSpec,valueSpec:o}));return d}return ks({key:t,value:a,valueSpec:{}})},numberArray:function(n){const t=n.key,a=n.value;if(Kt(a)==="array"){const o={type:"number"};if(a.length<1)return[new tt(t,a,"array length at least 1 expected, length 0 found")];let d=[];for(let _=0;_<a.length;_++)d=d.concat(n.validateSpec({key:`${t}[${_}]`,value:a[_],validateSpec:n.validateSpec,valueSpec:o}));return d}return ks({key:t,value:a,valueSpec:{}})},colorArray:function(n){const t=n.key,a=n.value;if(Kt(a)==="array"){if(a.length<1)return[new tt(t,a,"array length at least 1 expected, length 0 found")];let o=[];for(let d=0;d<a.length;d++)o=o.concat(us({key:`${t}[${d}]`,value:a[d]}));return o}return us({key:t,value:a})},variableAnchorOffsetCollection:function(n){const t=n.key,a=n.value,o=Kt(a),d=n.styleSpec;if(o!=="array"||a.length<1||a.length%2!=0)return[new tt(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let v=0;v<a.length;v+=2)_=_.concat(al({key:`${t}[${v}]`,value:a[v],valueSpec:d.layout_symbol["text-anchor"]})),_=_.concat(Au({key:`${t}[${v+1}]`,value:a[v+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:d}));return _},sprite:Gl,state:Fl};function $i(n){const t=n.value,a=n.valueSpec,o=n.styleSpec;return n.validateSpec=$i,a.expression&&Tu(la(t))?Ls(n):a.expression&&Nl(On(t))?Os(n):a.type&&Bn[a.type]?Bn[a.type](n):er(Ir({},n,{valueSpec:a.type?o[a.type]:a}))}function Lc(n){const t=n.value,a=n.key,o=vr(n);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new tt(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new tt(a,t,'"glyphs" url must include a "{range}" token'))),o}function gn(n,t=Ae){let a=[];return a=a.concat($i({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,validateSpec:$i,objectElementValidators:{glyphs:Lc,"*":()=>[]}})),n.constants&&(a=a.concat(Jn({key:"constants",value:n.constants}))),_o(a)}function Pn(n){return function(t){return n(Object.assign({},t,{validateSpec:$i}))}}function _o(n){return[].concat(n).sort(((t,a)=>t.line-a.line))}function cn(n){return function(...t){return _o(n.apply(this,t))}}gn.source=cn(Pn(go)),gn.sprite=cn(Pn(Gl)),gn.glyphs=cn(Pn(Lc)),gn.light=cn(Pn(tn)),gn.sky=cn(Pn(kc)),gn.terrain=cn(Pn(Ah)),gn.state=cn(Pn(Fl)),gn.layer=cn(Pn(mo)),gn.filter=cn(Pn(hs)),gn.paintProperty=cn(Pn(Nr)),gn.layoutProperty=cn(Pn(Rc));const tr=gn,bf=tr.light,Cu=tr.sky,wf=tr.paintProperty,Ul=tr.layoutProperty;function yo(n,t){let a=!1;if(t&&t.length)for(const o of t)n.fire(new xt(new Error(o.message))),a=!0;return a}class nl{constructor(t,a,o){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const v=new Int32Array(this.arrayBuffer);t=v[0],this.d=(a=v[1])+2*(o=v[2]);for(let S=0;S<this.d*this.d;S++){const I=v[3+S],R=v[3+S+1];d.push(I===R?null:v.subarray(I,R))}const b=v[3+d.length+1];this.keys=v.subarray(v[3+d.length],b),this.bboxes=v.subarray(b),this.insert=this._insertReadonly}else{this.d=a+2*o;for(let v=0;v<this.d*this.d;v++)d.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=o,this.scale=a/t,this.uid=0;const _=o/a*t;this.min=-_,this.max=t+_}insert(t,a,o,d,_){this._forEachCell(a,o,d,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(o),this.bboxes.push(d),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,o,d,_,v){this.cells[_].push(v)}query(t,a,o,d,_){const v=this.min,b=this.max;if(t<=v&&a<=v&&b<=o&&b<=d&&!_)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,a,o,d,this._queryCell,S,{},_),S}}_queryCell(t,a,o,d,_,v,b,S){const I=this.cells[_];if(I!==null){const R=this.keys,O=this.bboxes;for(let F=0;F<I.length;F++){const V=I[F];if(b[V]===void 0){const Z=4*V;(S?S(O[Z+0],O[Z+1],O[Z+2],O[Z+3]):t<=O[Z+2]&&a<=O[Z+3]&&o>=O[Z+0]&&d>=O[Z+1])?(b[V]=!0,v.push(R[V])):b[V]=!1}}}}_forEachCell(t,a,o,d,_,v,b,S){const I=this._convertToCellCoord(t),R=this._convertToCellCoord(a),O=this._convertToCellCoord(o),F=this._convertToCellCoord(d);for(let V=I;V<=O;V++)for(let Z=R;Z<=F;Z++){const Y=this.d*Z+V;if((!S||S(this._convertFromCellCoord(V),this._convertFromCellCoord(Z),this._convertFromCellCoord(V+1),this._convertFromCellCoord(Z+1)))&&_.call(this,t,a,o,d,Y,v,b,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let o=0;for(let v=0;v<this.cells.length;v++)o+=this.cells[v].length;const d=new Int32Array(a+o+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let _=a;for(let v=0;v<t.length;v++){const b=t[v];d[3+v]=_,d.set(b,_),_+=b.length}return d[3+t.length]=_,d.set(this.keys,_),_+=this.keys.length,d[3+t.length+1]=_,d.set(this.bboxes,_),_+=this.bboxes.length,d.buffer}static serialize(t,a){const o=t.toArrayBuffer();return a&&a.push(o),{buffer:o}}static deserialize(t){return new nl(t.buffer)}}const xr={};function ft(n,t,a={}){if(xr[n])throw new Error(`${n} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:n,writeable:!1}),xr[n]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}ft("Object",Object),ft("Set",Set),ft("TransferableGridIndex",nl),ft("Color",Jt),ft("Error",Error),ft("AJAXError",pe),ft("ResolvedImage",Tn),ft("StylePropertyFunction",tl),ft("StyleExpression",Eu,{omit:["_evaluator"]}),ft("ZoomDependentExpression",Rs),ft("ZoomConstantExpression",Cn),ft("CompoundExpression",Yn,{omit:["_evaluate"]});for(const n in Bl)Bl[n]._classRegistryKey||ft(`Expression_${n}`,Bl[n]);function rl(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Oc(n){return n.$name||n.constructor._classRegistryKey}function vo(n){return!(function(t){if(t===null||typeof t!="object")return!1;const a=Oc(t);return!(!a||a==="Object")})(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||rl(n)||wn(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function xo(n,t){if(vo(n))return(rl(n)||wn(n))&&t&&t.push(n),ArrayBuffer.isView(n)&&t&&t.push(n.buffer),n instanceof ImageData&&t&&t.push(n.data.buffer),n;if(Array.isArray(n)){const _=[];for(const v of n)_.push(xo(v,t));return _}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const a=Oc(n);if(!a)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!xr[a])throw new Error(`${a} is not registered.`);const{klass:o}=xr[a],d=o.serialize?o.serialize(n,t):{};if(o.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in n){if(!n.hasOwnProperty(_)||xr[a].omit.indexOf(_)>=0)continue;const v=n[_];d[_]=xr[a].shallow.indexOf(_)>=0?v:xo(v,t)}n instanceof Error&&(d.message=n.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(d.$name=a),d}function bo(n){if(vo(n))return n;if(Array.isArray(n))return n.map(bo);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const t=Oc(n)||"Object";if(!xr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=xr[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(n);const o=Object.create(a.prototype);for(const d of Object.keys(n)){if(d==="$name")continue;const _=n[d];o[d]=xr[t].shallow.indexOf(d)>=0?_:bo(_)}return o}class sl{constructor(){this.first=!0}update(t,a){const o=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=o,!0))}}const Yt={"Latin-1 Supplement":n=>n>=128&&n<=255,"Hangul Jamo":n=>n>=4352&&n<=4607,Khmer:n=>n>=6016&&n<=6143,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Kanbun:n=>n>=12688&&n<=12703,"CJK Strokes":n=>n>=12736&&n<=12783,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Hangul Syllables":n=>n>=44032&&n<=55215,"Private Use Area":n=>n>=57344&&n<=63743,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function ds(n){for(const t of n)if(So(t.charCodeAt(0)))return!0;return!1}function Ch(n){for(const t of n)if(!Vl(t.charCodeAt(0)))return!1;return!0}function Bc(n){const t=n.map((a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}})).filter((a=>a));return new RegExp(t.join("|"),"u")}const wo=Bc(["Arab","Dupl","Mong","Ougr","Syrc"]);function Vl(n){return!wo.test(String.fromCodePoint(n))}const Nc=Bc(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function So(n){return!(n!==746&&n!==747&&(n<4352||!(Yt["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||Yt["CJK Compatibility"](n)||Yt["CJK Strokes"](n)||!(!Yt["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Yt["Enclosed CJK Letters and Months"](n)||Yt["Ideographic Description Characters"](n)||Yt.Kanbun(n)||Yt.Katakana(n)&&n!==12540||!(!Yt["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!Yt["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||Yt["Vertical Forms"](n)||Yt["Yijing Hexagram Symbols"](n)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(n))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(n))||Nc.test(String.fromCodePoint(n)))))}function jc(n){return!(So(n)||(function(t){return!!(Yt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Yt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Yt["Letterlike Symbols"](t)||Yt["Number Forms"](t)||Yt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Yt["Control Pictures"](t)&&t!==9251||Yt["Optical Character Recognition"](t)||Yt["Enclosed Alphanumerics"](t)||Yt["Geometric Shapes"](t)||Yt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Yt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Yt["CJK Symbols and Punctuation"](t)||Yt.Katakana(t)||Yt["Private Use Area"](t)||Yt["CJK Compatibility Forms"](t)||Yt["Small Form Variants"](t)||Yt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(n))}const Ph=Bc(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Mo(n){return Ph.test(String.fromCodePoint(n))}function zh(n,t){return!(!t&&Mo(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||Yt.Khmer(n))}function Ns(n){for(const t of n)if(Mo(t.charCodeAt(0)))return!0;return!1}const fs=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){if(fs.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(n,t){return l(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(n.pluginStatus!=="loading")return this.setState(n),n;const a=n.pluginURL,o=new Promise((_=>{this.loadScriptResolve=_}));t(a);const d=new Promise((_=>setTimeout((()=>_()),this.TIMEOUT)));if(yield Promise.race([o,d]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:a};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)}))}};class Li{constructor(t,a){this.isSupportedScript=js,this.zoom=t,a?(this.now=a.now||0,this.fadeDuration=a.fadeDuration||0,this.zoomHistory=a.zoomHistory||new sl,this.transition=a.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sl,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),o=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*a}}}function js(n){return(function(t,a){for(const o of t)if(!zh(o.charCodeAt(0),a))return!1;return!0})(n,fs.getRTLTextPluginStatus()==="loaded")}class br{constructor(t,a,o){this.property=t,this.value=a,this.expression=(function(d,_,v){if(Tu(d))return new tl(d,_);if(Nl(d)){const b=fo(d,_,v);if(b.result==="error")throw new Error(b.value.map((S=>`${S.key}: ${S.message}`)).join(", "));return b.value}{let b=d;return _.type==="color"&&typeof d=="string"?b=Jt.parse(d):_.type!=="padding"||typeof d!="number"&&!Array.isArray(d)?_.type!=="numberArray"||typeof d!="number"&&!Array.isArray(d)?_.type!=="colorArray"||typeof d!="string"&&!Array.isArray(d)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(d)?b=ma.parse(d):_.type==="projectionDefinition"&&typeof d=="string"&&(b=Qa.parse(d)):b=Fa.parse(d):b=Ga.parse(d):b=_a.parse(d),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>b}}})(a===void 0?t.specification.default:a,t.specification,o)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,a,o){return this.property.possiblyEvaluate(this,t,a,o)}}class To{constructor(t,a){this.property=t,this.value=new br(t,void 0,a)}transitioned(t,a){return new ol(this.property,this.value,a,Qi({},t.transition,this.transition),t.now)}untransitioned(){return new ol(this.property,this.value,null,{},0)}}class Gc{constructor(t,a){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=a}getValue(t){return bn(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new To(this._values[t].property,this._globalState)),this._values[t].value=new br(this._values[t].property,a===null?void 0:bn(a),this._globalState)}getTransition(t){return bn(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new To(this._values[t].property,this._globalState)),this._values[t].transition=bn(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const o=this.getValue(a);o!==void 0&&(t[a]=o);const d=this.getTransition(a);d!==void 0&&(t[`${a}-transition`]=d)}return t}transitioned(t,a){const o=new ql(this._properties);for(const d of Object.keys(this._values))o._values[d]=this._values[d].transitioned(t,a._values[d]);return o}untransitioned(){const t=new ql(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class ol{constructor(t,a,o,d,_){this.property=t,this.value=a,this.begin=_+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=o)}possiblyEvaluate(t,a,o){const d=t.now||0,_=this.value.possiblyEvaluate(t,a,o),v=this.prior;if(v){if(d>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(d<this.begin)return v.possiblyEvaluate(t,a,o);{const b=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,a,o),_,pt(b))}}return _}}class ql{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,o){const d=new Fc(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].possiblyEvaluate(t,a,o);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ll{constructor(t,a){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=a}hasValue(t){return this._values[t].value!==void 0}getValue(t){return bn(this._values[t].value)}setValue(t,a){this._values[t]=new br(this._values[t].property,a===null?void 0:bn(a),this._globalState)}serialize(){const t={};for(const a of Object.keys(this._values)){const o=this.getValue(a);o!==void 0&&(t[a]=o)}return t}possiblyEvaluate(t,a,o){const d=new Fc(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].possiblyEvaluate(t,a,o);return d}}class jr{constructor(t,a,o){this.property=t,this.value=a,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,o,d){return this.property.evaluate(this.value,this.parameters,t,a,o,d)}}class Fc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class vt{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,o){const d=gr[this.specification.type];return d?d(t,a,o):t}}class Rt{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,o,d){return new jr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},o,d)}:t.expression,a)}interpolate(t,a,o){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new jr(this,{kind:"constant",value:void 0},t.parameters);const d=gr[this.specification.type];if(d){const _=d(t.value.value,a.value.value,o);return new jr(this,{kind:"constant",value:_},t.parameters)}return t}evaluate(t,a,o,d,_,v){return t.kind==="constant"?t.value:t.evaluate(a,o,d,_,v)}}class cl extends Rt{possiblyEvaluate(t,a,o,d){if(t.value===void 0)return new jr(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const _=t.expression.evaluate(a,null,{},o,d),v=t.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,b=this._calculate(v,v,v,a);return new jr(this,{kind:"constant",value:b},a)}if(t.expression.kind==="camera"){const _=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new jr(this,{kind:"constant",value:_},a)}return new jr(this,t.expression,a)}evaluate(t,a,o,d,_,v){if(t.kind==="source"){const b=t.evaluate(a,o,d,_,v);return this._calculate(b,b,b,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},o,d),t.evaluate({zoom:Math.floor(a.zoom)},o,d),t.evaluate({zoom:Math.floor(a.zoom)+1},o,d),a):t.value}_calculate(t,a,o,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:o,to:a}}interpolate(t){return t}}class Pu{constructor(t){this.specification=t}possiblyEvaluate(t,a,o,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const _=t.expression.evaluate(a,null,{},o,d);return this._calculate(_,_,_,a)}return this._calculate(t.expression.evaluate(new Li(Math.floor(a.zoom-1),a)),t.expression.evaluate(new Li(Math.floor(a.zoom),a)),t.expression.evaluate(new Li(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,o,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:o,to:a}}interpolate(t){return t}}class Zl{constructor(t){this.specification=t}possiblyEvaluate(t,a,o,d){return!!t.expression.evaluate(a,null,{},o,d)}interpolate(){return!1}}class Hi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const o=t[a];o.specification.overridable&&this.overridableProperties.push(a);const d=this.defaultPropertyValues[a]=new br(o,void 0,void 0),_=this.defaultTransitionablePropertyValues[a]=new To(o,void 0);this.defaultTransitioningPropertyValues[a]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=d.possiblyEvaluate({})}}}ft("DataDrivenProperty",Rt),ft("DataConstantProperty",vt),ft("CrossFadedDataDrivenProperty",cl),ft("CrossFadedProperty",Pu),ft("ColorRampProperty",Zl);const ir="-transition";class an extends It{constructor(t,a,o){if(super(),this.id=t.id,this.type=t.type,this._globalState=o,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=Ln(t.filter,o)),a.layout&&(this._unevaluatedLayout=new ll(a.layout,o)),a.paint)){this._transitionablePaint=new Gc(a.paint,o);for(const d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(const d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fc(a.paint)}}setFilter(t){this.filter=t,this._featureFilter=Ln(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const a in this._unevaluatedLayout._values){const o=this._unevaluatedLayout._values[a];for(const d of o.getGlobalStateRefs())t.add(d)}for(const a of this._featureFilter.getGlobalStateRefs())t.add(a);return t}getPaintAffectingGlobalStateRefs(){var t;const a=new globalThis.Map;if(this._transitionablePaint)for(const o in this._transitionablePaint._values){const d=this._transitionablePaint._values[o].value;for(const _ of d.getGlobalStateRefs()){const v=(t=a.get(_))!==null&&t!==void 0?t:[];v.push({name:o,value:d.value}),a.set(_,v)}}return a}setLayoutProperty(t,a,o={}){a!=null&&this._validate(Ul,`layers.${this.id}.layout.${t}`,t,a,o)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(ir)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,o={}){if(a!=null&&this._validate(wf,`layers.${this.id}.paint.${t}`,t,a,o))return!1;if(t.endsWith(ir))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const d=this._transitionablePaint._values[t],_=d.property.specification["property-type"]==="cross-faded-data-driven",v=d.value.isDataDriven(),b=d.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||v||_||this._handleOverridablePaintPropertyUpdate(t,b,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,o){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),bs(t,((a,o)=>!(a===void 0||o==="layout"&&!Object.keys(a).length||o==="paint"&&!Object.keys(a).length)))}_validate(t,a,o,d,_={}){return(!_||_.validate!==!1)&&yo(this,t.call(tr,{key:a,layerType:this.type,objectKey:o,value:d,styleSpec:Ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof jr&&yr(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}let Gs;var Md={get paint(){return Gs=Gs||new Hi({"raster-opacity":new vt(Ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new vt(Ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vt(Ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vt(Ae.paint_raster["raster-brightness-max"]),"raster-saturation":new vt(Ae.paint_raster["raster-saturation"]),"raster-contrast":new vt(Ae.paint_raster["raster-contrast"]),"raster-resampling":new vt(Ae.paint_raster["raster-resampling"]),"raster-fade-duration":new vt(Ae.paint_raster["raster-fade-duration"])})}};class Eo extends an{constructor(t,a){super(t,Md,a)}}const ar={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ji{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Xi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Oi(n,t=1){let a=0,o=0;return{members:n.map((d=>{const _=ar[d.type].BYTES_PER_ELEMENT,v=a=qt(a,Math.max(t,_)),b=d.components||1;return o=Math.max(o,_),a+=_*b,{name:d.name,type:d.type,components:b,offset:v}})),size:qt(a,Math.max(o,t)),alignment:t}}function qt(n,t){return Math.ceil(n/t)*t}class Ti extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,a)}emplace(t,a,o){const d=2*t;return this.int16[d+0]=a,this.int16[d+1]=o,t}}Ti.prototype.bytesPerElement=4,ft("StructArrayLayout2i4",Ti);class na extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,o)}emplace(t,a,o,d){const _=3*t;return this.int16[_+0]=a,this.int16[_+1]=o,this.int16[_+2]=d,t}}na.prototype.bytesPerElement=6,ft("StructArrayLayout3i6",na);class ul extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,o,d)}emplace(t,a,o,d,_){const v=4*t;return this.int16[v+0]=a,this.int16[v+1]=o,this.int16[v+2]=d,this.int16[v+3]=_,t}}ul.prototype.bytesPerElement=8,ft("StructArrayLayout4i8",ul);class ps extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,o,d,_,v)}emplace(t,a,o,d,_,v,b){const S=6*t;return this.int16[S+0]=a,this.int16[S+1]=o,this.int16[S+2]=d,this.int16[S+3]=_,this.int16[S+4]=v,this.int16[S+5]=b,t}}ps.prototype.bytesPerElement=12,ft("StructArrayLayout2i4i12",ps);class Fs extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,o,d,_,v)}emplace(t,a,o,d,_,v,b){const S=4*t,I=8*t;return this.int16[S+0]=a,this.int16[S+1]=o,this.uint8[I+4]=d,this.uint8[I+5]=_,this.uint8[I+6]=v,this.uint8[I+7]=b,t}}Fs.prototype.bytesPerElement=8,ft("StructArrayLayout2i4ub8",Fs);class Gr extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,a)}emplace(t,a,o){const d=2*t;return this.float32[d+0]=a,this.float32[d+1]=o,t}}Gr.prototype.bytesPerElement=8,ft("StructArrayLayout2f8",Gr);class Fr extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v,b,S,I,R){const O=this.length;return this.resize(O+1),this.emplace(O,t,a,o,d,_,v,b,S,I,R)}emplace(t,a,o,d,_,v,b,S,I,R,O){const F=10*t;return this.uint16[F+0]=a,this.uint16[F+1]=o,this.uint16[F+2]=d,this.uint16[F+3]=_,this.uint16[F+4]=v,this.uint16[F+5]=b,this.uint16[F+6]=S,this.uint16[F+7]=I,this.uint16[F+8]=R,this.uint16[F+9]=O,t}}Fr.prototype.bytesPerElement=20,ft("StructArrayLayout10ui20",Fr);class Ao extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v,b,S){const I=this.length;return this.resize(I+1),this.emplace(I,t,a,o,d,_,v,b,S)}emplace(t,a,o,d,_,v,b,S,I){const R=8*t;return this.uint16[R+0]=a,this.uint16[R+1]=o,this.uint16[R+2]=d,this.uint16[R+3]=_,this.uint16[R+4]=v,this.uint16[R+5]=b,this.uint16[R+6]=S,this.uint16[R+7]=I,t}}Ao.prototype.bytesPerElement=16,ft("StructArrayLayout8ui16",Ao);class zu extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v,b,S,I,R,O,F){const V=this.length;return this.resize(V+1),this.emplace(V,t,a,o,d,_,v,b,S,I,R,O,F)}emplace(t,a,o,d,_,v,b,S,I,R,O,F,V){const Z=12*t;return this.int16[Z+0]=a,this.int16[Z+1]=o,this.int16[Z+2]=d,this.int16[Z+3]=_,this.uint16[Z+4]=v,this.uint16[Z+5]=b,this.uint16[Z+6]=S,this.uint16[Z+7]=I,this.int16[Z+8]=R,this.int16[Z+9]=O,this.int16[Z+10]=F,this.int16[Z+11]=V,t}}zu.prototype.bytesPerElement=24,ft("StructArrayLayout4i4ui4i24",zu);class Fi extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,o)}emplace(t,a,o,d){const _=3*t;return this.float32[_+0]=a,this.float32[_+1]=o,this.float32[_+2]=d,t}}Fi.prototype.bytesPerElement=12,ft("StructArrayLayout3f12",Fi);class Uc extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}Uc.prototype.bytesPerElement=4,ft("StructArrayLayout1ul4",Uc);class Vc extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v,b,S,I){const R=this.length;return this.resize(R+1),this.emplace(R,t,a,o,d,_,v,b,S,I)}emplace(t,a,o,d,_,v,b,S,I,R){const O=10*t,F=5*t;return this.int16[O+0]=a,this.int16[O+1]=o,this.int16[O+2]=d,this.int16[O+3]=_,this.int16[O+4]=v,this.int16[O+5]=b,this.uint32[F+3]=S,this.uint16[O+8]=I,this.uint16[O+9]=R,t}}Vc.prototype.bytesPerElement=20,ft("StructArrayLayout6i1ul2ui20",Vc);class qc extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,o,d,_,v)}emplace(t,a,o,d,_,v,b){const S=6*t;return this.int16[S+0]=a,this.int16[S+1]=o,this.int16[S+2]=d,this.int16[S+3]=_,this.int16[S+4]=v,this.int16[S+5]=b,t}}qc.prototype.bytesPerElement=12,ft("StructArrayLayout2i2i2i12",qc);class Iu extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,o,d,_)}emplace(t,a,o,d,_,v){const b=4*t,S=8*t;return this.float32[b+0]=a,this.float32[b+1]=o,this.float32[b+2]=d,this.int16[S+6]=_,this.int16[S+7]=v,t}}Iu.prototype.bytesPerElement=16,ft("StructArrayLayout2f1f2i16",Iu);class p extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,o,d,_,v)}emplace(t,a,o,d,_,v,b){const S=16*t,I=4*t,R=8*t;return this.uint8[S+0]=a,this.uint8[S+1]=o,this.float32[I+1]=d,this.float32[I+2]=_,this.int16[R+6]=v,this.int16[R+7]=b,t}}p.prototype.bytesPerElement=16,ft("StructArrayLayout2ub2f2i16",p);class e extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,o)}emplace(t,a,o,d){const _=3*t;return this.uint16[_+0]=a,this.uint16[_+1]=o,this.uint16[_+2]=d,t}}e.prototype.bytesPerElement=6,ft("StructArrayLayout3ui6",e);class r extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v,b,S,I,R,O,F,V,Z,Y,te,se){const Te=this.length;return this.resize(Te+1),this.emplace(Te,t,a,o,d,_,v,b,S,I,R,O,F,V,Z,Y,te,se)}emplace(t,a,o,d,_,v,b,S,I,R,O,F,V,Z,Y,te,se,Te){const de=24*t,ge=12*t,De=48*t;return this.int16[de+0]=a,this.int16[de+1]=o,this.uint16[de+2]=d,this.uint16[de+3]=_,this.uint32[ge+2]=v,this.uint32[ge+3]=b,this.uint32[ge+4]=S,this.uint16[de+10]=I,this.uint16[de+11]=R,this.uint16[de+12]=O,this.float32[ge+7]=F,this.float32[ge+8]=V,this.uint8[De+36]=Z,this.uint8[De+37]=Y,this.uint8[De+38]=te,this.uint32[ge+10]=se,this.int16[de+22]=Te,t}}r.prototype.bytesPerElement=48,ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",r);class c extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o,d,_,v,b,S,I,R,O,F,V,Z,Y,te,se,Te,de,ge,De,je,et,dt,ot,ut,Ct,ct){const ht=this.length;return this.resize(ht+1),this.emplace(ht,t,a,o,d,_,v,b,S,I,R,O,F,V,Z,Y,te,se,Te,de,ge,De,je,et,dt,ot,ut,Ct,ct)}emplace(t,a,o,d,_,v,b,S,I,R,O,F,V,Z,Y,te,se,Te,de,ge,De,je,et,dt,ot,ut,Ct,ct,ht){const Ye=32*t,kt=16*t;return this.int16[Ye+0]=a,this.int16[Ye+1]=o,this.int16[Ye+2]=d,this.int16[Ye+3]=_,this.int16[Ye+4]=v,this.int16[Ye+5]=b,this.int16[Ye+6]=S,this.int16[Ye+7]=I,this.uint16[Ye+8]=R,this.uint16[Ye+9]=O,this.uint16[Ye+10]=F,this.uint16[Ye+11]=V,this.uint16[Ye+12]=Z,this.uint16[Ye+13]=Y,this.uint16[Ye+14]=te,this.uint16[Ye+15]=se,this.uint16[Ye+16]=Te,this.uint16[Ye+17]=de,this.uint16[Ye+18]=ge,this.uint16[Ye+19]=De,this.uint16[Ye+20]=je,this.uint16[Ye+21]=et,this.uint16[Ye+22]=dt,this.uint32[kt+12]=ot,this.float32[kt+13]=ut,this.float32[kt+14]=Ct,this.uint16[Ye+30]=ct,this.uint16[Ye+31]=ht,t}}c.prototype.bytesPerElement=64,ft("StructArrayLayout8i15ui1ul2f2ui64",c);class f extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}f.prototype.bytesPerElement=4,ft("StructArrayLayout1f4",f);class m extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,o)}emplace(t,a,o,d){const _=3*t;return this.uint16[6*t+0]=a,this.float32[_+1]=o,this.float32[_+2]=d,t}}m.prototype.bytesPerElement=12,ft("StructArrayLayout1ui2f12",m);class x extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,o)}emplace(t,a,o,d){const _=4*t;return this.uint32[2*t+0]=a,this.uint16[_+2]=o,this.uint16[_+3]=d,t}}x.prototype.bytesPerElement=8,ft("StructArrayLayout1ul2ui8",x);class T extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,a)}emplace(t,a,o){const d=2*t;return this.uint16[d+0]=a,this.uint16[d+1]=o,t}}T.prototype.bytesPerElement=4,ft("StructArrayLayout2ui4",T);class C extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}C.prototype.bytesPerElement=2,ft("StructArrayLayout1ui2",C);class k extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,o,d)}emplace(t,a,o,d,_){const v=4*t;return this.float32[v+0]=a,this.float32[v+1]=o,this.float32[v+2]=d,this.float32[v+3]=_,t}}k.prototype.bytesPerElement=16,ft("StructArrayLayout4f16",k);class L extends Ji{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new B(this.anchorPointX,this.anchorPointY)}}L.prototype.size=20;class j extends Vc{get(t){return new L(this,t)}}ft("CollisionBoxArray",j);class N extends Ji{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}N.prototype.size=48;class q extends r{get(t){return new N(this,t)}}ft("PlacedSymbolArray",q);class X extends Ji{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}X.prototype.size=64;class ae extends c{get(t){return new X(this,t)}}ft("SymbolInstanceArray",ae);class ne extends f{getoffsetX(t){return this.float32[1*t+0]}}ft("GlyphOffsetArray",ne);class re extends na{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}ft("SymbolLineVertexArray",re);class le extends Ji{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}le.prototype.size=12;class ue extends m{get(t){return new le(this,t)}}ft("TextAnchorOffsetArray",ue);class ce extends Ji{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ce.prototype.size=8;class me extends x{get(t){return new ce(this,t)}}ft("FeatureIndexArray",me);class ye extends Ti{}class he extends Ti{}class Se extends Ti{}class Oe extends ps{}class Re extends Fs{}class ke extends Gr{}class Le extends Fr{}class rt extends Ao{}class st extends zu{}class Qe extends Fi{}class wt extends Uc{}class Ut extends qc{}class pi extends p{}class Ai extends e{}class Ci extends T{}const Yi=Oi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ui}=Yi;class ni{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,a,o,d){const _=this.segments[this.segments.length-1];return t>ni.MAX_VERTEX_ARRAY_LENGTH&&qi(`Max vertices per segment is ${ni.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ni.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+t>ni.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==d?this.createNewSegment(a,o,d):_}createNewSegment(t,a,o){const d={vertexOffset:t.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(d.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(t,a,o){return this.prepareSegment(0,t,a,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,o,d){return new ni([{vertexOffset:t,primitiveOffset:a,vertexLength:o,primitiveLength:d,vaos:{},sortKey:0}])}}function ra(n,t){return 256*(n=Ft(Math.floor(n),0,255))+Ft(Math.floor(t),0,255)}ni.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ft("SegmentVector",ni);const nn=Oi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),va=Oi([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var xa,_n,Us,nr={exports:{}},Vs={exports:{}},Co={exports:{}},$l=(function(){if(Us)return nr.exports;Us=1;var n=(xa||(xa=1,Vs.exports=function(a,o){var d,_,v,b,S,I,R,O;for(_=a.length-(d=3&a.length),v=o,S=3432918353,I=461845907,O=0;O<_;)R=255&a.charCodeAt(O)|(255&a.charCodeAt(++O))<<8|(255&a.charCodeAt(++O))<<16|(255&a.charCodeAt(++O))<<24,++O,v=27492+(65535&(b=5*(65535&(v=(v^=R=(65535&(R=(R=(65535&R)*S+(((R>>>16)*S&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(R=0,d){case 3:R^=(255&a.charCodeAt(O+2))<<16;case 2:R^=(255&a.charCodeAt(O+1))<<8;case 1:v^=R=(65535&(R=(R=(65535&(R^=255&a.charCodeAt(O)))*S+(((R>>>16)*S&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295}return v^=a.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),Vs.exports),t=(_n||(_n=1,Co.exports=function(a,o){for(var d,_=a.length,v=o^_,b=0;_>=4;)d=1540483477*(65535&(d=255&a.charCodeAt(b)|(255&a.charCodeAt(++b))<<8|(255&a.charCodeAt(++b))<<16|(255&a.charCodeAt(++b))<<24))+((1540483477*(d>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),_-=4,++b;switch(_){case 3:v^=(255&a.charCodeAt(b+2))<<16;case 2:v^=(255&a.charCodeAt(b+1))<<8;case 1:v=1540483477*(65535&(v^=255&a.charCodeAt(b)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Co.exports);return nr.exports=n,nr.exports.murmur3=n,nr.exports.murmur2=t,nr.exports})(),hl=U($l);class ms{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,o,d){this.ids.push(rr(t)),this.positions.push(a,o,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=rr(t);let o=0,d=this.ids.length-1;for(;o<d;){const v=o+d>>1;this.ids[v]>=a?d=v:o=v+1}const _=[];for(;this.ids[o]===a;)_.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return _}static serialize(t,a){const o=new Float64Array(t.ids),d=new Uint32Array(t.positions);return wr(o,d,0,o.length-1),a&&a.push(o.buffer,d.buffer),{ids:o,positions:d}}static deserialize(t){const a=new ms;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function rr(n){const t=+n;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:hl(String(n))}function wr(n,t,a,o){for(;a<o;){const d=n[a+o>>1];let _=a-1,v=o+1;for(;;){do _++;while(n[_]<d);do v--;while(n[v]>d);if(_>=v)break;Ur(n,_,v),Ur(t,3*_,3*v),Ur(t,3*_+1,3*v+1),Ur(t,3*_+2,3*v+2)}v-a<o-v?(wr(n,t,a,v),a=v+1):(wr(n,t,v+1,o),o=v)}}function Ur(n,t,a){const o=n[t];n[t]=n[a],n[a]=o}ft("FeaturePositionMap",ms);class Nn{constructor(t,a){this.gl=t.gl,this.location=a}}class ca extends Nn{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Da extends Nn{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class jn extends Nn{constructor(t,a){super(t,a),this.current=Jt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const rn=new Float32Array(16);function Ih(n){return[ra(255*n.r,255*n.g),ra(255*n.b,255*n.a)]}class Hl{constructor(t,a,o){this.value=t,this.uniformNames=a.map((d=>`u_${d}`)),this.type=o}setUniform(t,a,o){t.set(o.constantOr(this.value))}getBinding(t,a,o){return this.type==="color"?new jn(t,a):new ca(t,a)}}class Vr{constructor(t,a){this.uniformNames=a.map((o=>`u_${o}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setConstantDashPositions(t,a){this.dashTo=[0,t.y,t.height,t.width],this.dashFrom=[0,a.y,a.height,a.width]}setUniform(t,a,o,d){let _=null;d==="u_pattern_to"?_=this.patternTo:d==="u_pattern_from"?_=this.patternFrom:d==="u_dasharray_to"?_=this.dashTo:d==="u_dasharray_from"?_=this.dashFrom:d==="u_pixel_ratio_to"?_=this.pixelRatioTo:d==="u_pixel_ratio_from"&&(_=this.pixelRatioFrom),_!==null&&t.set(_)}getBinding(t,a,o){return o.substr(0,9)==="u_pattern"||o.substr(0,12)==="u_dasharray_"?new Da(t,a):new ca(t,a)}}class qr{constructor(t,a,o,d){this.expression=t,this.type=o,this.maxValue=0,this.paintVertexAttributes=a.map((_=>({name:`a_${_}`,type:"Float32",components:o==="color"?2:1,offset:0}))),this.paintVertexArray=new d}populatePaintArray(t,a,o){const d=this.paintVertexArray.length,_=this.expression.evaluate(new Li(0,o),a,{},o.canonical,[],o.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(d,t,_)}updatePaintArray(t,a,o,d,_){const v=this.expression.evaluate(new Li(0,_),o,d);this._setPaintValue(t,a,v)}_setPaintValue(t,a,o){if(this.type==="color"){const d=Ih(o);for(let _=t;_<a;_++)this.paintVertexArray.emplace(_,d[0],d[1])}else{for(let d=t;d<a;d++)this.paintVertexArray.emplace(d,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gn{constructor(t,a,o,d,_,v){this.expression=t,this.uniformNames=a.map((b=>`u_${b}_t`)),this.type=o,this.useIntegerZoom=d,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=a.map((b=>({name:`a_${b}`,type:"Float32",components:o==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(t,a,o){const d=this.expression.evaluate(new Li(this.zoom,o),a,{},o.canonical,[],o.formattedSection),_=this.expression.evaluate(new Li(this.zoom+1,o),a,{},o.canonical,[],o.formattedSection),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,d,_)}updatePaintArray(t,a,o,d,_){const v=this.expression.evaluate(new Li(this.zoom,_),o,d),b=this.expression.evaluate(new Li(this.zoom+1,_),o,d);this._setPaintValue(t,a,v,b)}_setPaintValue(t,a,o,d){if(this.type==="color"){const _=Ih(o),v=Ih(d);for(let b=t;b<a;b++)this.paintVertexArray.emplace(b,_[0],_[1],v[0],v[1])}else{for(let _=t;_<a;_++)this.paintVertexArray.emplace(_,o,d);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const o=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,d=Ft(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,a,o){return new ca(t,a)}}class qs{constructor(t,a,o,d,_,v){this.expression=t,this.type=a,this.useIntegerZoom=o,this.zoom=d,this.layerId=v,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(t,a,o){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,this.getPositionIds(a),o)}updatePaintArray(t,a,o,d,_){this._setPaintValues(t,a,this.getPositionIds(o),_)}_setPaintValues(t,a,o,d){const _=this.getPositions(d);if(!_||!o)return;const v=_[o.min],b=_[o.mid],S=_[o.max];if(v&&b&&S)for(let I=t;I<a;I++)this.emplace(this.zoomInPaintVertexArray,I,b,v),this.emplace(this.zoomOutPaintVertexArray,I,b,S)}upload(t){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const a=this.getVertexAttributes();this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,a,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,a,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zs extends qs{getPositions(t){return t.imagePositions}getPositionIds(t){return t.patterns&&t.patterns[this.layerId]}getVertexAttributes(){return nn.members}emplace(t,a,o,d){t.emplace(a,o.tlbr[0],o.tlbr[1],o.tlbr[2],o.tlbr[3],d.tlbr[0],d.tlbr[1],d.tlbr[2],d.tlbr[3],o.pixelRatio,d.pixelRatio)}}class dl extends qs{getPositions(t){return t.dashPositions}getPositionIds(t){return t.dashes&&t.dashes[this.layerId]}getVertexAttributes(){return va.members}emplace(t,a,o,d){t.emplace(a,0,o.y,o.height,o.width,0,d.y,d.height,d.width)}}class Ru{constructor(t,a,o){this.binders={},this._buffers=[];const d=[];for(const _ in t.paint._values){if(!o(_))continue;const v=t.paint.get(_);if(!(v instanceof jr&&yr(v.property.specification)))continue;const b=Du(_,t.type),S=v.value,I=v.property.specification.type,R=v.property.useIntegerZoom,O=v.property.specification["property-type"],F=O==="cross-faded"||O==="cross-faded-data-driven";if(S.kind==="constant")this.binders[_]=F?new Vr(S.value,b):new Hl(S.value,b,I),d.push(`/u_${_}`);else if(S.kind==="source"||F){const V=Zc(_,I,"source");this.binders[_]=F?_==="line-dasharray"?new dl(S,I,R,a,V,t.id):new Zs(S,I,R,a,V,t.id):new qr(S,b,I,V),d.push(`/a_${_}`)}else{const V=Zc(_,I,"composite");this.binders[_]=new Gn(S,b,I,R,a,V),d.push(`/z_${_}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof qr||a instanceof Gn?a.maxValue:0}populatePaintArrays(t,a,o){for(const d in this.binders){const _=this.binders[d];(_ instanceof qr||_ instanceof Gn||_ instanceof qs)&&_.populatePaintArray(t,a,o)}}setConstantPatternPositions(t,a){for(const o in this.binders){const d=this.binders[o];d instanceof Vr&&d.setConstantPatternPositions(t,a)}}setConstantDashPositions(t,a){for(const o in this.binders){const d=this.binders[o];d instanceof Vr&&d.setConstantDashPositions(t,a)}}updatePaintArrays(t,a,o,d,_){let v=!1;for(const b in t){const S=a.getPositions(b);for(const I of S){const R=o.feature(I.index);for(const O in this.binders){const F=this.binders[O];if((F instanceof qr||F instanceof Gn||F instanceof qs)&&F.expression.isStateDependent===!0){const V=d.paint.get(O);F.expression=V.value,F.updatePaintArray(I.start,I.end,R,t[b],_),v=!0}}}}return v}defines(){const t=[];for(const a in this.binders){const o=this.binders[a];(o instanceof Hl||o instanceof Vr)&&t.push(...o.uniformNames.map((d=>`#define HAS_UNIFORM_${d}`)))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const o=this.binders[a];if(o instanceof qr||o instanceof Gn)for(let d=0;d<o.paintVertexAttributes.length;d++)t.push(o.paintVertexAttributes[d].name);else if(o instanceof qs){const d=o.getVertexAttributes();for(const _ of d)t.push(_.name)}}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const o=this.binders[a];if(o instanceof Hl||o instanceof Vr||o instanceof Gn)for(const d of o.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const o=[];for(const d in this.binders){const _=this.binders[d];if(_ instanceof Hl||_ instanceof Vr||_ instanceof Gn){for(const v of _.uniformNames)if(a[v]){const b=_.getBinding(t,a[v],v);o.push({name:v,property:d,binding:b})}}}return o}setUniforms(t,a,o,d){for(const{name:_,property:v,binding:b}of a)this.binders[v].setUniform(b,d,o.get(v),_)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const o=this.binders[a];if(t&&o instanceof qs){const d=t.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(o instanceof qr||o instanceof Gn)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const a in this.binders){const o=this.binders[a];(o instanceof qr||o instanceof Gn||o instanceof qs)&&o.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof qr||a instanceof Gn||a instanceof qs)&&a.destroy()}}}class gs{constructor(t,a,o=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new Ru(d,a,o);this.needsUpload=!1,this._featureMap=new ms,this._bufferOffset=0}populatePaintArrays(t,a,o,d){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(t,a,d);a.id!==void 0&&this._featureMap.add(a.id,o,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,o,d){for(const _ of o)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(t,this._featureMap,a,_,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Du(n,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}function Zc(n,t,a){const o={color:{source:Gr,composite:k},number:{source:f,composite:Gr}},d=(function(_){return{"line-pattern":{source:Le,composite:Le},"fill-pattern":{source:Le,composite:Le},"fill-extrusion-pattern":{source:Le,composite:Le},"line-dasharray":{source:rt,composite:rt}}[_]})(n);return d&&d[a]||o[t][a]}ft("ConstantBinder",Hl),ft("CrossFadedConstantBinder",Vr),ft("SourceExpressionBinder",qr),ft("CrossFadedPatternBinder",Zs),ft("CrossFadedDasharrayBinder",dl),ft("CompositeExpressionBinder",Gn),ft("ProgramConfiguration",Ru,{omit:["_buffers"]}),ft("ProgramConfigurationSet",gs);const fl=Math.pow(2,14)-1,Sf=-fl-1;function Xl(n){const t=Lt/n.extent,a=n.loadGeometry();for(let o=0;o<a.length;o++){const d=a[o];for(let _=0;_<d.length;_++){const v=d[_],b=Math.round(v.x*t),S=Math.round(v.y*t);v.x=Ft(b,Sf,fl),v.y=Ft(S,Sf,fl),(b<v.x||b>v.x+1||S<v.y||S>v.y+1)&&qi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function Zr(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?Xl(n):[]}}const Mf=-32768;function Vp(n,t,a,o,d){n.emplaceBack(Mf+8*t+o,Mf+8*a+d)}class Td{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new he,this.indexArray=new Ai,this.segments=new ni,this.programConfigurations=new gs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(t,a,o){const d=this.layers[0],_=[];let v=null,b=!1,S=d.type==="heatmap";if(d.type==="circle"){const R=d;v=R.layout.get("circle-sort-key"),b=!v.isConstant(),S=S||R.paint.get("circle-pitch-alignment")==="map"}const I=S?a.subdivisionGranularity.circle:1;for(const{feature:R,id:O,index:F,sourceLayerIndex:V}of t){const Z=this.layers[0]._featureFilter.needGeometry,Y=Zr(R,Z);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),Y,o))continue;const te=b?v.evaluate(Y,{},o):void 0,se={id:O,properties:R.properties,type:R.type,sourceLayerIndex:V,index:F,geometry:Z?Y.geometry:Xl(R),patterns:{},sortKey:te};_.push(se)}b&&_.sort(((R,O)=>R.sortKey-O.sortKey));for(const R of _){const{geometry:O,index:F,sourceLayerIndex:V}=R,Z=t[F].feature;this.addFeature(R,O,F,o,I),a.featureIndex.insert(Z,O,F,V,this.index)}}update(t,a,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ui),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,o,d,_=1){let v;switch(_){case 1:v=[0,7];break;case 3:v=[0,2,5,7];break;case 5:v=[0,1,3,4,6,7];break;case 7:v=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const b=v.length;for(const S of a)for(const I of S){const R=I.x,O=I.y;if(R<0||R>=Lt||O<0||O>=Lt)continue;const F=this.segments.prepareSegment(b*b,this.layoutVertexArray,this.indexArray,t.sortKey),V=F.vertexLength;for(let Z=0;Z<b;Z++)for(let Y=0;Y<b;Y++)Vp(this.layoutVertexArray,R,O,v[Y],v[Z]);for(let Z=0;Z<b-1;Z++)for(let Y=0;Y<b-1;Y++){const te=V+Z*b+Y,se=V+(Z+1)*b+Y;this.indexArray.emplaceBack(te,se+1,te+1),this.indexArray.emplaceBack(te,se,se+1)}F.vertexLength+=b*b,F.primitiveLength+=(b-1)*(b-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:{},canonical:d})}}function Rh(n,t){for(let a=0;a<n.length;a++)if($c(t,n[a]))return!0;for(let a=0;a<t.length;a++)if($c(n,t[a]))return!0;return!!Ad(n,t)}function Dh(n,t,a){return!!$c(n,t)||!!kh(t,n,a)}function Ed(n,t){if(n.length===1)return yn(t,n[0]);for(let a=0;a<t.length;a++){const o=t[a];for(let d=0;d<o.length;d++)if($c(n,o[d]))return!0}for(let a=0;a<n.length;a++)if(yn(t,n[a]))return!0;for(let a=0;a<t.length;a++)if(Ad(n,t[a]))return!0;return!1}function qp(n,t,a){if(n.length>1){if(Ad(n,t))return!0;for(let o=0;o<t.length;o++)if(kh(t[o],n,a))return!0}for(let o=0;o<n.length;o++)if(kh(n[o],t,a))return!0;return!1}function Ad(n,t){if(n.length===0||t.length===0)return!1;for(let a=0;a<n.length-1;a++){const o=n[a],d=n[a+1];for(let _=0;_<t.length-1;_++)if(Km(o,d,t[_],t[_+1]))return!0}return!1}function Km(n,t,a,o){return qn(n,a,o)!==qn(t,a,o)&&qn(n,t,a)!==qn(n,t,o)}function kh(n,t,a){const o=a*a;if(t.length===1)return n.distSqr(t[0])<o;for(let d=1;d<t.length;d++)if(Va(n,t[d-1],t[d])<o)return!0;return!1}function Va(n,t,a){const o=t.distSqr(a);if(o===0)return n.distSqr(t);const d=((n.x-t.x)*(a.x-t.x)+(n.y-t.y)*(a.y-t.y))/o;return n.distSqr(d<0?t:d>1?a:a.sub(t)._mult(d)._add(t))}function yn(n,t){let a,o,d,_=!1;for(let v=0;v<n.length;v++){a=n[v];for(let b=0,S=a.length-1;b<a.length;S=b++)o=a[b],d=a[S],o.y>t.y!=d.y>t.y&&t.x<(d.x-o.x)*(t.y-o.y)/(d.y-o.y)+o.x&&(_=!_)}return _}function $c(n,t){let a=!1;for(let o=0,d=n.length-1;o<n.length;d=o++){const _=n[o],v=n[d];_.y>t.y!=v.y>t.y&&t.x<(v.x-_.x)*(t.y-_.y)/(v.y-_.y)+_.x&&(a=!a)}return a}function Zp(n,t,a){const o=a[0],d=a[2];if(n.x<o.x&&t.x<o.x||n.x>d.x&&t.x>d.x||n.y<o.y&&t.y<o.y||n.y>d.y&&t.y>d.y)return!1;const _=qn(n,t,a[0]);return _!==qn(n,t,a[1])||_!==qn(n,t,a[2])||_!==qn(n,t,a[3])}function Hc(n,t,a){const o=t.paint.get(n).value;return o.kind==="constant"?o.value:a.programConfigurations.get(t.id).getMaxValue(n)}function Lh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Yl(n,t,a,o,d){if(!t[0]&&!t[1])return n;const _=B.convert(t)._mult(d);a==="viewport"&&_._rotate(-o);const v=[];for(let b=0;b<n.length;b++)v.push(n[b].sub(_));return v}function $p({queryGeometry:n,size:t},a){return Dh(n,a,t)}function Cd({queryGeometry:n,size:t,transform:a,unwrappedTileID:o,getElevation:d},_){return Dh(n,_,t*(a.projectTileCoordinates(_.x,_.y,o,d).signedDistanceFromCamera/a.cameraToCenterDistance))}function Hp({queryGeometry:n,size:t,transform:a,unwrappedTileID:o,getElevation:d},_){const v=a.projectTileCoordinates(_.x,_.y,o,d).signedDistanceFromCamera,b=t*(a.cameraToCenterDistance/v);return Dh(n,Bh(_,a,o,d),b)}function Jm({queryGeometry:n,size:t,transform:a,unwrappedTileID:o,getElevation:d},_){return Dh(n,Bh(_,a,o,d),t)}function Oh({queryGeometry:n,size:t,transform:a,unwrappedTileID:o,getElevation:d,pitchAlignment:_="map",pitchScale:v="map"},b){const S=_==="map"?v==="map"?$p:Cd:v==="map"?Hp:Jm,I={queryGeometry:n,size:t,transform:a,unwrappedTileID:o,getElevation:d};for(const R of b)for(const O of R)if(S(I,O))return!0;return!1}function Bh(n,t,a,o){const d=t.projectTileCoordinates(n.x,n.y,a,o).point;return new B((.5*d.x+.5)*t.width,(.5*-d.y+.5)*t.height)}let Tf,Ef;ft("CircleBucket",Td,{omit:["layers"]});var Xp={get paint(){return Ef=Ef||new Hi({"circle-radius":new Rt(Ae.paint_circle["circle-radius"]),"circle-color":new Rt(Ae.paint_circle["circle-color"]),"circle-blur":new Rt(Ae.paint_circle["circle-blur"]),"circle-opacity":new Rt(Ae.paint_circle["circle-opacity"]),"circle-translate":new vt(Ae.paint_circle["circle-translate"]),"circle-translate-anchor":new vt(Ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vt(Ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vt(Ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Rt(Ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Rt(Ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Rt(Ae.paint_circle["circle-stroke-opacity"])})},get layout(){return Tf=Tf||new Hi({"circle-sort-key":new Rt(Ae.layout_circle["circle-sort-key"])})}};class Af extends an{constructor(t,a){super(t,Xp,a)}createBucket(t){return new Td(t)}queryRadius(t){const a=t;return Hc("circle-radius",this,a)+Hc("circle-stroke-width",this,a)+Lh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v,unwrappedTileID:b,getElevation:S}){const I=Yl(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,v),R=this.paint.get("circle-radius").evaluate(a,o)+this.paint.get("circle-stroke-width").evaluate(a,o),O=this.paint.get("circle-pitch-scale"),F=this.paint.get("circle-pitch-alignment");let V,Z;return F==="map"?(V=I,Z=R*v):(V=(function(Y,te,se,Te){return Y.map((de=>Bh(de,te,se,Te)))})(I,_,b,S),Z=R),Oh({queryGeometry:V,size:Z,transform:_,unwrappedTileID:b,getElevation:S,pitchAlignment:F,pitchScale:O},d)}}class Pd extends Td{}let zd;ft("HeatmapBucket",Pd,{omit:["layers"]});var Yp={get paint(){return zd=zd||new Hi({"heatmap-radius":new Rt(Ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Rt(Ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vt(Ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zl(Ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vt(Ae.paint_heatmap["heatmap-opacity"])})}};function Nh(n,{width:t,height:a},o,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*a*o)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*a*o}`)}else d=new Uint8Array(t*a*o);return n.width=t,n.height=a,n.data=d,n}function jh(n,{width:t,height:a},o){if(t===n.width&&a===n.height)return;const d=Nh({},{width:t,height:a},o);Gh(n,d,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,t),height:Math.min(n.height,a)},o),n.width=t,n.height=a,n.data=d.data}function Gh(n,t,a,o,d,_){if(d.width===0||d.height===0)return t;if(d.width>n.width||d.height>n.height||a.x>n.width-d.width||a.y>n.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||o.x>t.width-d.width||o.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const v=n.data,b=t.data;if(v===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<d.height;S++){const I=((a.y+S)*n.width+a.x)*_,R=((o.y+S)*t.width+o.x)*_;for(let O=0;O<d.width*_;O++)b[R+O]=v[I+O]}return t}class ku{constructor(t,a){Nh(this,t,1,a)}resize(t){jh(this,t,1)}clone(){return new ku({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,o,d,_){Gh(t,a,o,d,_,1)}}class zn{constructor(t,a){Nh(this,t,4,a)}resize(t){jh(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new zn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,o,d,_){Gh(t,a,o,d,_,4)}setPixel(t,a,o){const d=4*(t*this.width+a);this.data[d+0]=Math.round(255*o.r/o.a),this.data[d+1]=Math.round(255*o.g/o.a),this.data[d+2]=Math.round(255*o.b/o.a),this.data[d+3]=Math.round(255*o.a)}}function Cf(n){const t={},a=n.resolution||256,o=n.clips?n.clips.length:1,d=n.image||new zn({width:a,height:o});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const _=(v,b,S)=>{t[n.evaluationKey]=S;const I=n.expression.evaluate(t);d.setPixel(v/4/a,b/4,I)};if(n.clips)for(let v=0,b=0;v<o;++v,b+=4*a)for(let S=0,I=0;S<a;S++,I+=4){const R=S/(a-1),{start:O,end:F}=n.clips[v];_(b,I,O*(1-R)+F*R)}else for(let v=0,b=0;v<a;v++,b+=4)_(0,b,v/(a-1));return d}ft("AlphaImage",ku),ft("RGBAImage",zn);const $s="big-fb";class Pf extends an{createBucket(t){return new Pd(t)}constructor(t,a){super(t,Yp,a),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Cf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has($s)&&this.heatmapFbos.delete($s)}queryRadius(t){return Hc("heatmap-radius",this,t)}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v,unwrappedTileID:b,getElevation:S}){return Oh({queryGeometry:t,size:this.paint.get("heatmap-radius").evaluate(a,o)*v,transform:_,unwrappedTileID:b,getElevation:S},d)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Wp;var Qp={get paint(){return Wp=Wp||new Hi({"hillshade-illumination-direction":new vt(Ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new vt(Ae.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new vt(Ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vt(Ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vt(Ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vt(Ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vt(Ae.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new vt(Ae.paint_hillshade["hillshade-method"])})}};class pl extends an{constructor(t,a){super(t,Qp,a),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,o=this.paint.get("hillshade-highlight-color").values,d=this.paint.get("hillshade-shadow-color").values;const _=Math.max(t.length,a.length,o.length,d.length);t=t.concat(Array(_-t.length).fill(t.at(-1))),a=a.concat(Array(_-a.length).fill(a.at(-1))),o=o.concat(Array(_-o.length).fill(o.at(-1))),d=d.concat(Array(_-d.length).fill(d.at(-1)));const v=a.map(dc);return{directionRadians:t.map(dc),altitudeRadians:v,shadowColor:d,highlightColor:o}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Id;var Kp={get paint(){return Id=Id||new Hi({"color-relief-opacity":new vt(Ae["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Zl(Ae["paint_color-relief"]["color-relief-color"])})}};class Lu{constructor(t,a,o,d){this.context=t,this.format=o,this.texture=t.gl.createTexture(),this.update(a,d)}update(t,a,o){const{width:d,height:_}=t,v=!(this.size&&this.size[0]===d&&this.size[1]===_||o),{context:b}=this,{gl:S}=b;if(this.useMipmap=!!(a&&a.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!a||a.premultiply!==!1)),v)this.size=[d,_],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||wn(t)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,t):S.texImage2D(S.TEXTURE_2D,0,this.format,d,_,0,this.format,S.UNSIGNED_BYTE,t.data);else{const{x:I,y:R}=o||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||wn(t)?S.texSubImage2D(S.TEXTURE_2D,0,I,R,S.RGBA,S.UNSIGNED_BYTE,t):S.texSubImage2D(S.TEXTURE_2D,0,I,R,d,_,S.RGBA,S.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D),b.pixelStoreUnpackFlipY.setDefault(),b.pixelStoreUnpack.setDefault(),b.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,a,o){const{context:d}=this,{gl:_}=d;_.bindTexture(_.TEXTURE_2D,this.texture),o!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(o=_.LINEAR),t!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,t),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,o||t),this.filter=t),a!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,a),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Ou{constructor(t,a,o,d=1,_=1,v=1,b=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void qi(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const S=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=_,this.blueFactor=v,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<S;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(S,I)]=this.data[this._idx(S-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,S)]=this.data[this._idx(I,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<S;I++)for(let R=0;R<S;R++){const O=this.get(I,R);O>this.max&&(this.max=O),O<this.min&&(this.min=O)}}get(t,a){const o=new Uint8Array(this.data.buffer),d=4*this._idx(t,a);return this.unpack(o[d],o[d+1],o[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,o){return t*this.redFactor+a*this.greenFactor+o*this.blueFactor-this.baseShift}pack(t){return ua(t,this.getUnpackVector())}getPixels(){return new zn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,o){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=a*this.dim,_=a*this.dim+this.dim,v=o*this.dim,b=o*this.dim+this.dim;switch(a){case-1:d=_-1;break;case 1:_=d+1}switch(o){case-1:v=b-1;break;case 1:b=v+1}const S=-a*this.dim,I=-o*this.dim;for(let R=v;R<b;R++)for(let O=d;O<_;O++)this.data[this._idx(O,R)]=t.data[this._idx(O+S,R+I)]}}function ua(n,t){const a=t[0],o=t[1],d=t[2],_=t[3],v=Math.min(a,o,d),b=Math.round((n+_)/v);return{r:Math.floor(b*v/a)%256,g:Math.floor(b*v/o)%256,b:Math.floor(b*v/d)%256}}ft("DEMData",Ou);class eg extends an{constructor(t,a){super(t,Kp,a)}_createColorRamp(t){const a={elevationStops:[],colorStops:[]},o=this._transitionablePaint._values["color-relief-color"].value.expression;if(o instanceof Cn&&o._styleExpression.expression instanceof Ua){this.colorRampExpression=o;const v=o._styleExpression.expression;a.elevationStops=v.labels,a.colorStops=[];for(const b of a.elevationStops)a.colorStops.push(v.evaluate({globals:{elevation:b}}))}if(a.elevationStops.length<1&&(a.elevationStops=[0],a.colorStops=[Jt.transparent]),a.elevationStops.length<2&&(a.elevationStops.push(a.elevationStops[0]+1),a.colorStops.push(a.colorStops[0])),a.elevationStops.length<=t)return a;const d={elevationStops:[],colorStops:[]},_=(a.elevationStops.length-1)/(t-1);for(let v=0;v<a.elevationStops.length-.5;v+=_)d.elevationStops.push(a.elevationStops[Math.round(v)]),d.colorStops.push(a.colorStops[Math.round(v)]);return qi(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),d}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,a,o){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const d=this._createColorRamp(a),_=new zn({width:d.colorStops.length,height:1}),v=new zn({width:d.colorStops.length,height:1});for(let b=0;b<d.elevationStops.length;b++){const S=ua(d.elevationStops[b],o);v.setPixel(0,b,new Jt(S.r/255,S.g/255,S.b/255,1)),_.setPixel(0,b,d.colorStops[b])}return this.colorRampTextures={elevationTexture:new Lu(t,v,t.gl.RGBA),colorTexture:new Lu(t,_,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const tg=Oi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Jp}=tg;function Wl(n,t,a){const o=a.patternDependencies;let d=!1;for(const _ of t){const v=_.paint.get(`${n}-pattern`);v.isConstant()||(d=!0);const b=v.constantOr(null);b&&(d=!0,o[b.to]=!0,o[b.from]=!0)}return d}function Po(n,t,a,o,d){const{zoom:_}=o,v=d.patternDependencies;for(const b of t){const S=b.paint.get(`${n}-pattern`).value;if(S.kind!=="constant"){let I=S.evaluate({zoom:_-1},a,{},d.availableImages),R=S.evaluate({zoom:_},a,{},d.availableImages),O=S.evaluate({zoom:_+1},a,{},d.availableImages);I=I&&I.name?I.name:I,R=R&&R.name?R.name:R,O=O&&O.name?O.name:O,v[I]=!0,v[R]=!0,v[O]=!0,a.patterns[b.id]={min:I,mid:R,max:O}}}return a}function zf(n,t,a,o,d){let _;if(d===(function(v,b,S,I){let R=0;for(let O=b,F=S-I;O<S;O+=I)R+=(v[F]-v[O])*(v[O+1]+v[F+1]),F=O;return R})(n,t,a,o)>0)for(let v=t;v<a;v+=o)_=Lf(v/o|0,n[v],n[v+1],_);else for(let v=a-o;v>=t;v-=o)_=Lf(v/o|0,n[v],n[v+1],_);return _&&Bu(_,_.next)&&(Nu(_),_=_.next),_}function Ql(n,t){if(!n)return n;t||(t=n);let a,o=n;do if(a=!1,o.steiner||!Bu(o,o.next)&&hi(o.prev,o,o.next)!==0)o=o.next;else{if(Nu(o),o=t=o.prev,o===o.next)break;a=!0}while(a||o!==t);return t}function ml(n,t,a,o,d,_,v){if(!n)return;!v&&_&&(function(S,I,R,O){let F=S;do F.z===0&&(F.z=Dd(F.x,F.y,I,R,O)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==S);F.prevZ.nextZ=null,F.prevZ=null,(function(V){let Z,Y=1;do{let te,se=V;V=null;let Te=null;for(Z=0;se;){Z++;let de=se,ge=0;for(let je=0;je<Y&&(ge++,de=de.nextZ,de);je++);let De=Y;for(;ge>0||De>0&&de;)ge!==0&&(De===0||!de||se.z<=de.z)?(te=se,se=se.nextZ,ge--):(te=de,de=de.nextZ,De--),Te?Te.nextZ=te:V=te,te.prevZ=Te,Te=te;se=de}Te.nextZ=null,Y*=2}while(Z>1)})(F)})(n,o,d,_);let b=n;for(;n.prev!==n.next;){const S=n.prev,I=n.next;if(_?em(n,o,d,_):zo(n))t.push(S.i,n.i,I.i),Nu(n),n=I.next,b=I.next;else if((n=I)===b){v?v===1?ml(n=If(Ql(n),t),t,a,o,d,_,2):v===2&&tm(n,t,a,o,d,_):ml(Ql(n),t,a,o,d,_,1);break}}}function zo(n){const t=n.prev,a=n,o=n.next;if(hi(t,a,o)>=0)return!1;const d=t.x,_=a.x,v=o.x,b=t.y,S=a.y,I=o.y,R=Math.min(d,_,v),O=Math.min(b,S,I),F=Math.max(d,_,v),V=Math.max(b,S,I);let Z=o.next;for(;Z!==t;){if(Z.x>=R&&Z.x<=F&&Z.y>=O&&Z.y<=V&&Xc(d,b,_,S,v,I,Z.x,Z.y)&&hi(Z.prev,Z,Z.next)>=0)return!1;Z=Z.next}return!0}function em(n,t,a,o){const d=n.prev,_=n,v=n.next;if(hi(d,_,v)>=0)return!1;const b=d.x,S=_.x,I=v.x,R=d.y,O=_.y,F=v.y,V=Math.min(b,S,I),Z=Math.min(R,O,F),Y=Math.max(b,S,I),te=Math.max(R,O,F),se=Dd(V,Z,t,a,o),Te=Dd(Y,te,t,a,o);let de=n.prevZ,ge=n.nextZ;for(;de&&de.z>=se&&ge&&ge.z<=Te;){if(de.x>=V&&de.x<=Y&&de.y>=Z&&de.y<=te&&de!==d&&de!==v&&Xc(b,R,S,O,I,F,de.x,de.y)&&hi(de.prev,de,de.next)>=0||(de=de.prevZ,ge.x>=V&&ge.x<=Y&&ge.y>=Z&&ge.y<=te&&ge!==d&&ge!==v&&Xc(b,R,S,O,I,F,ge.x,ge.y)&&hi(ge.prev,ge,ge.next)>=0))return!1;ge=ge.nextZ}for(;de&&de.z>=se;){if(de.x>=V&&de.x<=Y&&de.y>=Z&&de.y<=te&&de!==d&&de!==v&&Xc(b,R,S,O,I,F,de.x,de.y)&&hi(de.prev,de,de.next)>=0)return!1;de=de.prevZ}for(;ge&&ge.z<=Te;){if(ge.x>=V&&ge.x<=Y&&ge.y>=Z&&ge.y<=te&&ge!==d&&ge!==v&&Xc(b,R,S,O,I,F,ge.x,ge.y)&&hi(ge.prev,ge,ge.next)>=0)return!1;ge=ge.nextZ}return!0}function If(n,t){let a=n;do{const o=a.prev,d=a.next.next;!Bu(o,d)&&kf(o,a,a.next,d)&&vn(o,d)&&vn(d,o)&&(t.push(o.i,a.i,d.i),Nu(a),Nu(a.next),a=n=d),a=a.next}while(a!==n);return Ql(a)}function tm(n,t,a,o,d,_){let v=n;do{let b=v.next.next;for(;b!==v.prev;){if(v.i!==b.i&&im(v,b)){let S=Io(v,b);return v=Ql(v,v.next),S=Ql(S,S.next),ml(v,t,a,o,d,_,0),void ml(S,t,a,o,d,_,0)}b=b.next}v=v.next}while(v!==n)}function Rf(n,t){let a=n.x-t.x;return a===0&&(a=n.y-t.y,a===0)&&(a=(n.next.y-n.y)/(n.next.x-n.x)-(t.next.y-t.y)/(t.next.x-t.x)),a}function Df(n,t){const a=(function(d,_){let v=_;const b=d.x,S=d.y;let I,R=-1/0;if(Bu(d,v))return v;do{if(Bu(d,v.next))return v.next;if(S<=v.y&&S>=v.next.y&&v.next.y!==v.y){const Y=v.x+(S-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(Y<=b&&Y>R&&(R=Y,I=v.x<v.next.x?v:v.next,Y===b))return I}v=v.next}while(v!==_);if(!I)return null;const O=I,F=I.x,V=I.y;let Z=1/0;v=I;do{if(b>=v.x&&v.x>=F&&b!==v.x&&qa(S<V?b:R,S,F,V,S<V?R:b,S,v.x,v.y)){const Y=Math.abs(S-v.y)/(b-v.x);vn(v,d)&&(Y<Z||Y===Z&&(v.x>I.x||v.x===I.x&&Rd(I,v)))&&(I=v,Z=Y)}v=v.next}while(v!==O);return I})(n,t);if(!a)return t;const o=Io(a,n);return Ql(o,o.next),Ql(a,a.next)}function Rd(n,t){return hi(n.prev,n,t.prev)<0&&hi(t.next,n,n.next)<0}function Dd(n,t,a,o,d){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-a)*d|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-o)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function gl(n){let t=n,a=n;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==n);return a}function qa(n,t,a,o,d,_,v,b){return(d-v)*(t-b)>=(n-v)*(_-b)&&(n-v)*(o-b)>=(a-v)*(t-b)&&(a-v)*(_-b)>=(d-v)*(o-b)}function Xc(n,t,a,o,d,_,v,b){return!(n===v&&t===b)&&qa(n,t,a,o,d,_,v,b)}function im(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!(function(a,o){let d=a;do{if(d.i!==a.i&&d.next.i!==a.i&&d.i!==o.i&&d.next.i!==o.i&&kf(d,d.next,a,o))return!0;d=d.next}while(d!==a);return!1})(n,t)&&(vn(n,t)&&vn(t,n)&&(function(a,o){let d=a,_=!1;const v=(a.x+o.x)/2,b=(a.y+o.y)/2;do d.y>b!=d.next.y>b&&d.next.y!==d.y&&v<(d.next.x-d.x)*(b-d.y)/(d.next.y-d.y)+d.x&&(_=!_),d=d.next;while(d!==a);return _})(n,t)&&(hi(n.prev,n,t.prev)||hi(n,t.prev,t))||Bu(n,t)&&hi(n.prev,n,n.next)>0&&hi(t.prev,t,t.next)>0)}function hi(n,t,a){return(t.y-n.y)*(a.x-t.x)-(t.x-n.x)*(a.y-t.y)}function Bu(n,t){return n.x===t.x&&n.y===t.y}function kf(n,t,a,o){const d=sa(hi(n,t,a)),_=sa(hi(n,t,o)),v=sa(hi(a,o,n)),b=sa(hi(a,o,t));return d!==_&&v!==b||!(d!==0||!Fh(n,a,t))||!(_!==0||!Fh(n,o,t))||!(v!==0||!Fh(a,n,o))||!(b!==0||!Fh(a,t,o))}function Fh(n,t,a){return t.x<=Math.max(n.x,a.x)&&t.x>=Math.min(n.x,a.x)&&t.y<=Math.max(n.y,a.y)&&t.y>=Math.min(n.y,a.y)}function sa(n){return n>0?1:n<0?-1:0}function vn(n,t){return hi(n.prev,n,n.next)<0?hi(n,t,n.next)>=0&&hi(n,n.prev,t)>=0:hi(n,t,n.prev)<0||hi(n,n.next,t)<0}function Io(n,t){const a=kd(n.i,n.x,n.y),o=kd(t.i,t.x,t.y),d=n.next,_=t.prev;return n.next=t,t.prev=n,a.next=d,d.prev=a,o.next=a,a.prev=o,_.next=o,o.prev=_,o}function Lf(n,t,a,o){const d=kd(n,t,a);return o?(d.next=o.next,d.prev=o,o.next.prev=d,o.next=d):(d.prev=d,d.next=d),d}function Nu(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function kd(n,t,a){return{i:n,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ju{constructor(t,a){if(a>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=a}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Yc{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Yc.noSubdivision=new Yc({fill:new ju(0,0),line:new ju(0,0),tile:new ju(0,0),stencil:new ju(0,0),circle:1}),ft("SubdivisionGranularityExpression",ju),ft("SubdivisionGranularitySetting",Yc);const un=-32768,sr=32767;class am{constructor(t,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Lt/t,this._canonical=a}_getKey(t,a){return(t+=32768)<<16|a+32768}_vertexToIndex(t,a){if(t<-32768||a<-32768||t>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(t),d=0|Math.round(a),_=this._getKey(o,d);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const v=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,v),this._vertexBuffer.push(o,d),v}_subdivideTrianglesScanline(t){if(this._granularity<2)return(function(d,_){const v=[];for(let b=0;b<_.length;b+=3){const S=_[b],I=_[b+1],R=_[b+2],O=d[2*S],F=d[2*S+1];(d[2*I]-O)*(d[2*R+1]-F)-(d[2*I+1]-F)*(d[2*R]-O)>0?(v.push(S),v.push(R),v.push(I)):(v.push(S),v.push(I),v.push(R))}return v})(this._vertexBuffer,t);const a=[],o=t.length;for(let d=0;d<o;d+=3){const _=[t[d+0],t[d+1],t[d+2]],v=[this._vertexBuffer[2*t[d+0]+0],this._vertexBuffer[2*t[d+0]+1],this._vertexBuffer[2*t[d+1]+0],this._vertexBuffer[2*t[d+1]+1],this._vertexBuffer[2*t[d+2]+0],this._vertexBuffer[2*t[d+2]+1]];let b=1/0,S=1/0,I=-1/0,R=-1/0;for(let Y=0;Y<3;Y++){const te=v[2*Y],se=v[2*Y+1];b=Math.min(b,te),I=Math.max(I,te),S=Math.min(S,se),R=Math.max(R,se)}if(b===I||S===R)continue;const O=Math.floor(b/this._granularityCellSize),F=Math.ceil(I/this._granularityCellSize),V=Math.floor(S/this._granularityCellSize),Z=Math.ceil(R/this._granularityCellSize);if(O!==F||V!==Z)for(let Y=V;Y<Z;Y++){const te=this._scanlineGenerateVertexRingForCellRow(Y,v,_);_l(this._vertexBuffer,te,a)}else a.push(..._)}return a}_scanlineGenerateVertexRingForCellRow(t,a,o){const d=t*this._granularityCellSize,_=d+this._granularityCellSize,v=[];for(let b=0;b<3;b++){const S=a[2*b],I=a[2*b+1],R=a[2*(b+1)%6],O=a[(2*(b+1)+1)%6],F=a[2*(b+2)%6],V=a[(2*(b+2)+1)%6],Z=R-S,Y=O-I,te=Z===0,se=Y===0,Te=(d-I)/Y,de=(_-I)/Y,ge=Math.min(Te,de),De=Math.max(Te,de);if(!se&&(ge>=1||De<=0)||se&&(I<d||I>_)){O>=d&&O<=_&&v.push(o[(b+1)%3]);continue}!se&&ge>0&&v.push(this._vertexToIndex(S+Z*ge,I+Y*ge));const je=S+Z*Math.max(ge,0),et=S+Z*Math.min(De,1);te||this._generateIntraEdgeVertices(v,S,I,R,O,je,et),!se&&De<1&&v.push(this._vertexToIndex(S+Z*De,I+Y*De)),(se||O>=d&&O<=_)&&v.push(o[(b+1)%3]),!se&&(O<=d||O>=_)&&this._generateInterEdgeVertices(v,S,I,R,O,F,V,et,d,_)}return v}_generateIntraEdgeVertices(t,a,o,d,_,v,b){const S=d-a,I=_-o,R=I===0,O=R?Math.min(a,d):Math.min(v,b),F=R?Math.max(a,d):Math.max(v,b),V=Math.floor(O/this._granularityCellSize)+1,Z=Math.ceil(F/this._granularityCellSize)-1;if(R?a<d:v<b)for(let Y=V;Y<=Z;Y++){const te=Y*this._granularityCellSize;t.push(this._vertexToIndex(te,o+I*(te-a)/S))}else for(let Y=Z;Y>=V;Y--){const te=Y*this._granularityCellSize;t.push(this._vertexToIndex(te,o+I*(te-a)/S))}}_generateInterEdgeVertices(t,a,o,d,_,v,b,S,I,R){const O=_-o,F=v-d,V=b-_,Z=(I-_)/V,Y=(R-_)/V,te=Math.min(Z,Y),se=Math.max(Z,Y),Te=d+F*te;let de=Math.floor(Math.min(Te,S)/this._granularityCellSize)+1,ge=Math.ceil(Math.max(Te,S)/this._granularityCellSize)-1,De=S<Te;const je=V===0;if(je&&(b===I||b===R))return;if(je||te>=1||se<=0){const dt=o-b,ot=v+(a-v)*Math.min((I-b)/dt,(R-b)/dt);de=Math.floor(Math.min(ot,S)/this._granularityCellSize)+1,ge=Math.ceil(Math.max(ot,S)/this._granularityCellSize)-1,De=S<ot}const et=O>0?R:I;if(De)for(let dt=de;dt<=ge;dt++)t.push(this._vertexToIndex(dt*this._granularityCellSize,et));else for(let dt=ge;dt>=de;dt--)t.push(this._vertexToIndex(dt*this._granularityCellSize,et))}_generateOutline(t){const a=[];for(const o of t){const d=Kl(o,this._granularity,!0),_=this._pointArrayToIndices(d),v=[];for(let b=1;b<_.length;b++)v.push(_[b-1]),v.push(_[b]);a.push(v)}return a}_handlePoles(t){let a=!1,o=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(a||o)&&this._fillPoles(t,a,o)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let a=0;a<t.length;a+=2){const o=t[a+1];o===un&&(t[a+1]=-32767),o===sr&&(t[a+1]=32766)}}_generatePoleQuad(t,a,o,d,_,v){d>_!=(v===un)?(t.push(a),t.push(o),t.push(this._vertexToIndex(d,v)),t.push(o),t.push(this._vertexToIndex(_,v)),t.push(this._vertexToIndex(d,v))):(t.push(o),t.push(a),t.push(this._vertexToIndex(d,v)),t.push(this._vertexToIndex(_,v)),t.push(o),t.push(this._vertexToIndex(d,v)))}_fillPoles(t,a,o){const d=this._vertexBuffer,_=Lt,v=t.length;for(let b=2;b<v;b+=3){const S=t[b-2],I=t[b-1],R=t[b],O=d[2*S],F=d[2*S+1],V=d[2*I],Z=d[2*I+1],Y=d[2*R],te=d[2*R+1];a&&(F===0&&Z===0&&this._generatePoleQuad(t,S,I,O,V,un),Z===0&&te===0&&this._generatePoleQuad(t,I,R,V,Y,un),te===0&&F===0&&this._generatePoleQuad(t,R,S,Y,O,un)),o&&(F===_&&Z===_&&this._generatePoleQuad(t,S,I,O,V,sr),Z===_&&te===_&&this._generatePoleQuad(t,I,R,V,Y,sr),te===_&&F===_&&this._generatePoleQuad(t,R,S,Y,O,sr))}}_initializeVertices(t){for(let a=0;a<t.length;a+=2)this._vertexToIndex(t[a],t[a+1])}subdividePolygonInternal(t,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:d}=(function(b){const S=[],I=[];for(const R of b)if(R.length!==0){R!==b[0]&&S.push(I.length/2);for(let O=0;O<R.length;O++)I.push(R[O].x),I.push(R[O].y)}return{flattened:I,holeIndices:S}})(t);let _;this._initializeVertices(o);try{const b=(function(I,R,O=2){const F=R&&R.length,V=F?R[0]*O:I.length;let Z=zf(I,0,V,O,!0);const Y=[];if(!Z||Z.next===Z.prev)return Y;let te,se,Te;if(F&&(Z=(function(de,ge,De,je){const et=[];for(let dt=0,ot=ge.length;dt<ot;dt++){const ut=zf(de,ge[dt]*je,dt<ot-1?ge[dt+1]*je:de.length,je,!1);ut===ut.next&&(ut.steiner=!0),et.push(gl(ut))}et.sort(Rf);for(let dt=0;dt<et.length;dt++)De=Df(et[dt],De);return De})(I,R,Z,O)),I.length>80*O){te=I[0],se=I[1];let de=te,ge=se;for(let De=O;De<V;De+=O){const je=I[De],et=I[De+1];je<te&&(te=je),et<se&&(se=et),je>de&&(de=je),et>ge&&(ge=et)}Te=Math.max(de-te,ge-se),Te=Te!==0?32767/Te:0}return ml(Z,Y,O,te,se,Te,0),Y})(o,d),S=this._convertIndices(o,b);_=this._subdivideTrianglesScanline(S)}catch(b){console.error(b)}let v=[];return a&&(v=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:v}}_convertIndices(t,a){const o=[];for(let d=0;d<a.length;d++)o.push(this._vertexToIndex(t[2*a[d]],t[2*a[d]+1]));return o}_pointArrayToIndices(t){const a=[];for(let o=0;o<t.length;o++){const d=t[o];a.push(this._vertexToIndex(d.x,d.y))}return a}}function or(n,t,a,o=!0){return new am(a,t).subdividePolygonInternal(n,o)}function Kl(n,t,a=!1){if(!n||n.length<1)return[];if(n.length<2)return[];const o=n[0],d=n[n.length-1],_=a&&(o.x!==d.x||o.y!==d.y);if(t<2)return _?[...n,n[0]]:[...n];const v=Math.floor(Lt/t),b=[];b.push(new B(n[0].x,n[0].y));const S=n.length,I=_?S:S-1;for(let R=0;R<I;R++){const O=n[R],F=R<S-1?n[R+1]:n[0],V=O.x,Z=O.y,Y=F.x,te=F.y,se=V!==Y,Te=Z!==te;if(!se&&!Te)continue;const de=Y-V,ge=te-Z,De=Math.abs(de),je=Math.abs(ge);let et=V,dt=Z;for(;;){const ut=de>0?(Math.floor(et/v)+1)*v:(Math.ceil(et/v)-1)*v,Ct=ge>0?(Math.floor(dt/v)+1)*v:(Math.ceil(dt/v)-1)*v,ct=Math.abs(et-ut),ht=Math.abs(dt-Ct),Ye=Math.abs(et-Y),kt=Math.abs(dt-te),jt=se?ct/De:Number.POSITIVE_INFINITY,Dt=Te?ht/je:Number.POSITIVE_INFINITY;if((Ye<=ct||!se)&&(kt<=ht||!Te))break;if(jt<Dt&&se||!Te){et=ut,dt+=ge*jt;const St=new B(et,Math.round(dt));b[b.length-1].x===St.x&&b[b.length-1].y===St.y||b.push(St)}else{et+=de*Dt,dt=Ct;const St=new B(Math.round(et),dt);b[b.length-1].x===St.x&&b[b.length-1].y===St.y||b.push(St)}}const ot=new B(Y,te);b[b.length-1].x===ot.x&&b[b.length-1].y===ot.y||b.push(ot)}return b}function _l(n,t,a){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,d=n[2*t[0]];for(let S=1;S<t.length;S++){const I=n[2*t[S]];I<d&&(d=I,o=S)}const _=t.length;let v=o,b=(v+1)%_;for(;;){const S=v-1>=0?v-1:_-1,I=(b+1)%_,R=n[2*t[S]],O=n[2*t[I]],F=n[2*t[v]],V=n[2*t[v]+1],Z=n[2*t[b]+1];let Y=!1;if(R<O)Y=!0;else if(R>O)Y=!1;else{const te=Z-V,se=-(n[2*t[b]]-F),Te=V<Z?1:-1;((R-F)*te+(n[2*t[S]+1]-V)*se)*Te>((O-F)*te+(n[2*t[I]+1]-V)*se)*Te&&(Y=!0)}if(Y){const te=t[S],se=t[v],Te=t[b];te!==se&&te!==Te&&se!==Te&&a.push(Te,se,te),v--,v<0&&(v=_-1)}else{const te=t[I],se=t[v],Te=t[b];te!==se&&te!==Te&&se!==Te&&a.push(Te,se,te),b++,b>=_&&(b=0)}if(S===I)break}}function Jl(n,t,a,o,d,_,v,b,S){const I=d.length/2,R=v&&b&&S;if(I<ni.MAX_VERTEX_ARRAY_LENGTH){const O=t.prepareSegment(I,a,o),F=O.vertexLength;for(let Y=0;Y<_.length;Y+=3)o.emplaceBack(F+_[Y],F+_[Y+1],F+_[Y+2]);let V,Z;O.vertexLength+=I,O.primitiveLength+=_.length/3,R&&(Z=v.prepareSegment(I,a,b),V=Z.vertexLength,Z.vertexLength+=I);for(let Y=0;Y<d.length;Y+=2)n(d[Y],d[Y+1]);if(R)for(let Y=0;Y<S.length;Y++){const te=S[Y];for(let se=1;se<te.length;se+=2)b.emplaceBack(V+te[se-1],V+te[se]);Z.primitiveLength+=te.length/2}}else(function(O,F,V,Z,Y,te){const se=[];for(let je=0;je<Z.length/2;je++)se.push(-1);const Te={count:0};let de=0,ge=O.getOrCreateLatestSegment(F,V),De=ge.vertexLength;for(let je=2;je<Y.length;je+=3){const et=Y[je-2],dt=Y[je-1],ot=Y[je];let ut=se[et]<de,Ct=se[dt]<de,ct=se[ot]<de;ge.vertexLength+((ut?1:0)+(Ct?1:0)+(ct?1:0))>ni.MAX_VERTEX_ARRAY_LENGTH&&(ge=O.createNewSegment(F,V),de=Te.count,ut=!0,Ct=!0,ct=!0,De=0);const ht=$r(se,Z,te,Te,et,ut,ge),Ye=$r(se,Z,te,Te,dt,Ct,ge),kt=$r(se,Z,te,Te,ot,ct,ge);V.emplaceBack(De+ht-de,De+Ye-de,De+kt-de),ge.primitiveLength++}})(t,a,o,d,_,n),R&&(function(O,F,V,Z,Y,te){const se=[];for(let je=0;je<Z.length/2;je++)se.push(-1);const Te={count:0};let de=0,ge=O.getOrCreateLatestSegment(F,V),De=ge.vertexLength;for(let je=0;je<Y.length;je++){const et=Y[je];for(let dt=1;dt<Y[je].length;dt+=2){const ot=et[dt-1],ut=et[dt];let Ct=se[ot]<de,ct=se[ut]<de;ge.vertexLength+((Ct?1:0)+(ct?1:0))>ni.MAX_VERTEX_ARRAY_LENGTH&&(ge=O.createNewSegment(F,V),de=Te.count,Ct=!0,ct=!0,De=0);const ht=$r(se,Z,te,Te,ot,Ct,ge),Ye=$r(se,Z,te,Te,ut,ct,ge);V.emplaceBack(De+ht-de,De+Ye-de),ge.primitiveLength++}}})(v,a,b,d,S,n),t.forceNewSegmentOnNextPrepare(),v?.forceNewSegmentOnNextPrepare()}function $r(n,t,a,o,d,_,v){if(_){const b=o.count;return a(t[2*d],t[2*d+1]),n[d]=o.count,o.count++,v.vertexLength++,b}return n[d]}class Uh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Se,this.indexArray=new Ai,this.indexArray2=new Ci,this.programConfigurations=new gs(t.layers,t.zoom),this.segments=new ni,this.segments2=new ni,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(t,a,o){this.hasDependencies=Wl("fill",this.layers,a);const d=this.layers[0].layout.get("fill-sort-key"),_=!d.isConstant(),v=[];for(const{feature:b,id:S,index:I,sourceLayerIndex:R}of t){const O=this.layers[0]._featureFilter.needGeometry,F=Zr(b,O);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),F,o))continue;const V=_?d.evaluate(F,{},o,a.availableImages):void 0,Z={id:S,properties:b.properties,type:b.type,sourceLayerIndex:R,index:I,geometry:O?F.geometry:Xl(b),patterns:{},sortKey:V};v.push(Z)}_&&v.sort(((b,S)=>b.sortKey-S.sortKey));for(const b of v){const{geometry:S,index:I,sourceLayerIndex:R}=b;if(this.hasDependencies){const O=Po("fill",this.layers,b,{zoom:this.zoom},a);this.patternFeatures.push(O)}else this.addFeature(b,S,I,o,{},a.subdivisionGranularity);a.featureIndex.insert(t[I].feature,S,I,R,this.index)}}update(t,a,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:o})}addFeatures(t,a,o){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,a,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Jp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,o,d,_,v){for(const b of wc(a,500)){const S=or(b,d,v.fill.getGranularityForZoomLevel(d.z)),I=this.layoutVertexArray;Jl(((R,O)=>{I.emplaceBack(R,O)}),this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles,this.segments2,this.indexArray2,S.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:_,canonical:d})}}let Ld,_s;ft("FillBucket",Uh,{omit:["layers","patternFeatures"]});var nm={get paint(){return _s=_s||new Hi({"fill-antialias":new vt(Ae.paint_fill["fill-antialias"]),"fill-opacity":new Rt(Ae.paint_fill["fill-opacity"]),"fill-color":new Rt(Ae.paint_fill["fill-color"]),"fill-outline-color":new Rt(Ae.paint_fill["fill-outline-color"]),"fill-translate":new vt(Ae.paint_fill["fill-translate"]),"fill-translate-anchor":new vt(Ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new cl(Ae.paint_fill["fill-pattern"])})},get layout(){return Ld=Ld||new Hi({"fill-sort-key":new Rt(Ae.layout_fill["fill-sort-key"])})}};class Gu extends an{constructor(t,a){super(t,nm,a)}recalculate(t,a){super.recalculate(t,a);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Uh(t)}queryRadius(){return Lh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:a,transform:o,pixelsToTileUnits:d}){return Ed(Yl(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,d),a)}isTileClipped(){return!0}}const Vh=Oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),qh=Oi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Fu}=Vh;class Wc{constructor(t,a,o,d,_){this.properties={},this.extent=o,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=d,this._values=_,t.readFields(rm,this,a)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const a=t.readVarint()+t.pos,o=[];let d,_=1,v=0,b=0,S=0;for(;t.pos<a;){if(v<=0){const I=t.readVarint();_=7&I,v=I>>3}if(v--,_===1||_===2)b+=t.readSVarint(),S+=t.readSVarint(),_===1&&(d&&o.push(d),d=[]),d&&d.push(new B(b,S));else{if(_!==7)throw new Error(`unknown command ${_}`);d&&d.push(d[0].clone())}}return d&&o.push(d),o}bbox(){const t=this._pbf;t.pos=this._geometry;const a=t.readVarint()+t.pos;let o=1,d=0,_=0,v=0,b=1/0,S=-1/0,I=1/0,R=-1/0;for(;t.pos<a;){if(d<=0){const O=t.readVarint();o=7&O,d=O>>3}if(d--,o===1||o===2)_+=t.readSVarint(),v+=t.readSVarint(),_<b&&(b=_),_>S&&(S=_),v<I&&(I=v),v>R&&(R=v);else if(o!==7)throw new Error(`unknown command ${o}`)}return[b,I,S,R]}toGeoJSON(t,a,o){const d=this.extent*Math.pow(2,o),_=this.extent*t,v=this.extent*a,b=this.loadGeometry();function S(F){return[360*(F.x+_)/d-180,360/Math.PI*Math.atan(Math.exp((1-2*(F.y+v)/d)*Math.PI))-90]}function I(F){return F.map(S)}let R;if(this.type===1){const F=[];for(const Z of b)F.push(Z[0]);const V=I(F);R=F.length===1?{type:"Point",coordinates:V[0]}:{type:"MultiPoint",coordinates:V}}else if(this.type===2){const F=b.map(I);R=F.length===1?{type:"LineString",coordinates:F[0]}:{type:"MultiLineString",coordinates:F}}else{if(this.type!==3)throw new Error("unknown feature type");{const F=(function(Z){const Y=Z.length;if(Y<=1)return[Z];const te=[];let se,Te;for(let de=0;de<Y;de++){const ge=Zh(Z[de]);ge!==0&&(Te===void 0&&(Te=ge<0),Te===ge<0?(se&&te.push(se),se=[Z[de]]):se&&se.push(Z[de]))}return se&&te.push(se),te})(b),V=[];for(const Z of F)V.push(Z.map(I));R=V.length===1?{type:"Polygon",coordinates:V[0]}:{type:"MultiPolygon",coordinates:V}}}const O={type:"Feature",geometry:R,properties:this.properties};return this.id!=null&&(O.id=this.id),O}}function rm(n,t,a){n===1?t.id=a.readVarint():n===2?(function(o,d){const _=o.readVarint()+o.pos;for(;o.pos<_;){const v=d._keys[o.readVarint()],b=d._values[o.readVarint()];d.properties[v]=b}})(a,t):n===3?t.type=a.readVarint():n===4&&(t._geometry=a.pos)}function Zh(n){let t=0;for(let a,o,d=0,_=n.length,v=_-1;d<_;v=d++)a=n[d],o=n[v],t+=(o.x-a.x)*(a.y+o.y);return t}Wc.types=["Unknown","Point","LineString","Polygon"];class Of{constructor(t,a){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Od,this,a),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const a=this._pbf.readVarint()+this._pbf.pos;return new Wc(this._pbf,a,this.extent,this._keys,this._values)}}function Od(n,t,a){n===15?t.version=a.readVarint():n===1?t.name=a.readString():n===5?t.extent=a.readVarint():n===2?t._features.push(a.pos):n===3?t._keys.push(a.readString()):n===4&&t._values.push((function(o){let d=null;const _=o.readVarint()+o.pos;for(;o.pos<_;){const v=o.readVarint()>>3;d=v===1?o.readString():v===2?o.readFloat():v===3?o.readDouble():v===4?o.readVarint64():v===5?o.readVarint():v===6?o.readSVarint():v===7?o.readBoolean():null}if(d==null)throw new Error("unknown feature value");return d})(a))}class Bf{constructor(t,a){this.layers=t.readFields(ig,{},a)}}function ig(n,t,a){if(n===3){const o=new Of(a,a.readVarint()+a.pos);o.length&&(t[o.name]=o)}}const Nf=Math.pow(2,13);function Ei(n,t,a,o,d,_,v,b){n.emplaceBack(t,a,2*Math.floor(o*Nf)+v,d*Nf*2,_*Nf*2,Math.round(b))}class Wi{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new Oe,this.centroidVertexArray=new ye,this.indexArray=new Ai,this.programConfigurations=new gs(t.layers,t.zoom),this.segments=new ni,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(t,a,o){this.features=[],this.hasDependencies=Wl("fill-extrusion",this.layers,a);for(const{feature:d,id:_,index:v,sourceLayerIndex:b}of t){const S=this.layers[0]._featureFilter.needGeometry,I=Zr(d,S);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),I,o))continue;const R={id:_,sourceLayerIndex:b,index:v,geometry:S?I.geometry:Xl(d),properties:d.properties,type:d.type,patterns:{}};this.hasDependencies?this.features.push(Po("fill-extrusion",this.layers,R,{zoom:this.zoom},a)):this.addFeature(R,R.geometry,v,o,{},a.subdivisionGranularity),a.featureIndex.insert(d,R.geometry,v,b,this.index,!0)}}addFeatures(t,a,o){for(const d of this.features){const{geometry:_}=d;this.addFeature(d,_,d.index,a,o,t.subdivisionGranularity)}}update(t,a,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Fu),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,qh.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,o,d,_,v){for(const b of wc(a,500)){const S={x:0,y:0,sampleCount:0},I=this.layoutVertexArray.length;this.processPolygon(S,d,t,b,v);const R=this.layoutVertexArray.length-I,O=Math.floor(S.x/S.sampleCount),F=Math.floor(S.y/S.sampleCount);for(let V=0;V<R;V++)this.centroidVertexArray.emplaceBack(O,F)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:_,canonical:d})}processPolygon(t,a,o,d,_){if(d.length<1||Vi(d[0]))return;for(const O of d)O.length!==0&&vi(t,O);const v={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},b=_.fill.getGranularityForZoomLevel(a.z),S=Wc.types[o.type]==="Polygon";for(const O of d){if(O.length===0||Vi(O))continue;const F=Kl(O,b,S);this._generateSideFaces(F,v)}if(!S)return;const I=or(d,a,b,!1),R=this.layoutVertexArray;Jl(((O,F)=>{Ei(R,O,F,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles)}_generateSideFaces(t,a){let o=0;for(let d=1;d<t.length;d++){const _=t[d],v=t[d-1];if(bi(_,v))continue;a.segment.vertexLength+4>ni.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const b=_.sub(v)._perp()._unit(),S=v.dist(_);o+S>32768&&(o=0),Ei(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,0,o),Ei(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,1,o),o+=S,Ei(this.layoutVertexArray,v.x,v.y,b.x,b.y,0,0,o),Ei(this.layoutVertexArray,v.x,v.y,b.x,b.y,0,1,o);const I=a.segment.vertexLength;this.indexArray.emplaceBack(I,I+2,I+1),this.indexArray.emplaceBack(I+1,I+2,I+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function vi(n,t){for(let a=0;a<t.length;a++){const o=t[a];a===t.length-1&&t[0].x===o.x&&t[0].y===o.y||(n.x+=o.x,n.y+=o.y,n.sampleCount++)}}function bi(n,t){return n.x===t.x&&(n.x<0||n.x>Lt)||n.y===t.y&&(n.y<0||n.y>Lt)}function Vi(n){return n.every((t=>t.x<0))||n.every((t=>t.x>Lt))||n.every((t=>t.y<0))||n.every((t=>t.y>Lt))}let Sr;ft("FillExtrusionBucket",Wi,{omit:["layers","features"]});var ec={get paint(){return Sr=Sr||new Hi({"fill-extrusion-opacity":new vt(Ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Rt(Ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vt(Ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vt(Ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cl(Ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Rt(Ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Rt(Ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vt(Ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Uu extends an{constructor(t,a){super(t,ec,a)}createBucket(t){return new Wi(t)}queryRadius(){return Lh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v,pixelPosMatrix:b}){const S=Yl(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,v),I=this.paint.get("fill-extrusion-height").evaluate(a,o),R=this.paint.get("fill-extrusion-base").evaluate(a,o),O=(function(V,Z){const Y=[];for(const te of V){const se=[te.x,te.y,0,1];In(se,se,Z),Y.push(new B(se[0]/se[3],se[1]/se[3]))}return Y})(S,b),F=(function(V,Z,Y,te){const se=[],Te=[],de=te[8]*Z,ge=te[9]*Z,De=te[10]*Z,je=te[11]*Z,et=te[8]*Y,dt=te[9]*Y,ot=te[10]*Y,ut=te[11]*Y;for(const Ct of V){const ct=[],ht=[];for(const Ye of Ct){const kt=Ye.x,jt=Ye.y,Dt=te[0]*kt+te[4]*jt+te[12],St=te[1]*kt+te[5]*jt+te[13],ti=te[2]*kt+te[6]*jt+te[14],ea=te[3]*kt+te[7]*jt+te[15],Ea=ti+De,dn=ea+je,ur=Dt+et,La=St+dt,ha=ti+ot,Ri=ea+ut,wa=new B((Dt+de)/dn,(St+ge)/dn);wa.z=Ea/dn,ct.push(wa);const Aa=new B(ur/Ri,La/Ri);Aa.z=ha/Ri,ht.push(Aa)}se.push(ct),Te.push(ht)}return[se,Te]})(d,R,I,b);return(function(V,Z,Y){let te=1/0;Ed(Y,Z)&&(te=Ro(Y,Z[0]));for(let se=0;se<Z.length;se++){const Te=Z[se],de=V[se];for(let ge=0;ge<Te.length-1;ge++){const De=Te[ge],je=[De,Te[ge+1],de[ge+1],de[ge],De];Rh(Y,je)&&(te=Math.min(te,Ro(Y,je)))}}return te!==1/0&&te})(F[0],F[1],O)}}function Qc(n,t){return n.x*t.x+n.y*t.y}function Ro(n,t){if(n.length===1){let a=0;const o=t[a++];let d;for(;!d||o.equals(d);)if(d=t[a++],!d)return 1/0;for(;a<t.length;a++){const _=t[a],v=n[0],b=d.sub(o),S=_.sub(o),I=v.sub(o),R=Qc(b,b),O=Qc(b,S),F=Qc(S,S),V=Qc(I,b),Z=Qc(I,S),Y=R*F-O*O,te=(F*V-O*Z)/Y,se=(R*Z-O*V)/Y,Te=o.z*(1-te-se)+d.z*te+_.z*se;if(isFinite(Te))return Te}return 1/0}{let a=1/0;for(const o of t)a=Math.min(a,o.z);return a}}const ka=Oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:tc}=ka,Kc=Oi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:jf}=Kc,Hr=Math.cos(Math.PI/180*37.5),Jc=Math.pow(2,14)/.5;class eu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((a=>{this.gradients[a.id]={}})),this.layoutVertexArray=new Re,this.layoutVertexArray2=new ke,this.indexArray=new Ai,this.programConfigurations=new gs(t.layers,t.zoom),this.segments=new ni,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(t,a,o){this.hasDependencies=Wl("line",this.layers,a)||this.hasLineDasharray(this.layers);const d=this.layers[0].layout.get("line-sort-key"),_=!d.isConstant(),v=[];for(const{feature:b,id:S,index:I,sourceLayerIndex:R}of t){const O=this.layers[0]._featureFilter.needGeometry,F=Zr(b,O);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),F,o))continue;const V=_?d.evaluate(F,{},o):void 0,Z={id:S,properties:b.properties,type:b.type,sourceLayerIndex:R,index:I,geometry:O?F.geometry:Xl(b),patterns:{},dashes:{},sortKey:V};v.push(Z)}_&&v.sort(((b,S)=>b.sortKey-S.sortKey));for(const b of v){const{geometry:S,index:I,sourceLayerIndex:R}=b;this.hasDependencies?(Wl("line",this.layers,a)?Po("line",this.layers,b,{zoom:this.zoom},a):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,b,this.zoom,a),this.patternFeatures.push(b)):this.addFeature(b,S,I,o,{},{},a.subdivisionGranularity),a.featureIndex.insert(t[I].feature,S,I,R,this.index)}}update(t,a,o,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,{imagePositions:o,dashPositions:d})}addFeatures(t,a,o,d){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,a,o,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,jf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,o,d,_,v,b){const S=this.layers[0].layout,I=S.get("line-join").evaluate(t,{}),R=S.get("line-cap"),O=S.get("line-miter-limit"),F=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const V of a)this.addLine(V,t,I,R,O,F,d,b);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:_,dashPositions:v,canonical:d})}addLine(t,a,o,d,_,v,b,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Kl(t,b?S.line.getGranularityForZoomLevel(b.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let de=0;de<t.length-1;de++)this.totalDistance+=t[de].dist(t[de+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=Wc.types[a.type]==="Polygon";let R=t.length;for(;R>=2&&t[R-1].equals(t[R-2]);)R--;let O=0;for(;O<R-1&&t[O].equals(t[O+1]);)O++;if(R<(I?3:2))return;o==="bevel"&&(_=1.05);const F=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let Z,Y,te,se,Te;this.e1=this.e2=-1,I&&(Z=t[R-2],Te=t[O].sub(Z)._unit()._perp());for(let de=O;de<R;de++){if(te=de===R-1?I?t[O+1]:void 0:t[de+1],te&&t[de].equals(te))continue;Te&&(se=Te),Z&&(Y=Z),Z=t[de],Te=te?te.sub(Z)._unit()._perp():se,se=se||Te;let ge=se.add(Te);ge.x===0&&ge.y===0||ge._unit();const De=se.x*Te.x+se.y*Te.y,je=ge.x*Te.x+ge.y*Te.y,et=je!==0?1/je:1/0,dt=2*Math.sqrt(2-2*je),ot=je<Hr&&Y&&te,ut=se.x*Te.y-se.y*Te.x>0;if(ot&&de>O){const ht=Z.dist(Y);if(ht>2*F){const Ye=Z.sub(Z.sub(Y)._mult(F/ht)._round());this.updateDistance(Y,Ye),this.addCurrentVertex(Ye,se,0,0,V),Y=Ye}}const Ct=Y&&te;let ct=Ct?o:I?"butt":d;if(Ct&&ct==="round"&&(et<v?ct="miter":et<=2&&(ct="fakeround")),ct==="miter"&&et>_&&(ct="bevel"),ct==="bevel"&&(et>2&&(ct="flipbevel"),et<_&&(ct="miter")),Y&&this.updateDistance(Y,Z),ct==="miter")ge._mult(et),this.addCurrentVertex(Z,ge,0,0,V);else if(ct==="flipbevel"){if(et>100)ge=Te.mult(-1);else{const ht=et*se.add(Te).mag()/se.sub(Te).mag();ge._perp()._mult(ht*(ut?-1:1))}this.addCurrentVertex(Z,ge,0,0,V),this.addCurrentVertex(Z,ge.mult(-1),0,0,V)}else if(ct==="bevel"||ct==="fakeround"){const ht=-Math.sqrt(et*et-1),Ye=ut?ht:0,kt=ut?0:ht;if(Y&&this.addCurrentVertex(Z,se,Ye,kt,V),ct==="fakeround"){const jt=Math.round(180*dt/Math.PI/20);for(let Dt=1;Dt<jt;Dt++){let St=Dt/jt;if(St!==.5){const ea=St-.5;St+=St*ea*(St-1)*((1.0904+De*(De*(3.55645-1.43519*De)-3.2452))*ea*ea+(.848013+De*(.215638*De-1.06021)))}const ti=Te.sub(se)._mult(St)._add(se)._unit()._mult(ut?-1:1);this.addHalfVertex(Z,ti.x,ti.y,!1,ut,0,V)}}te&&this.addCurrentVertex(Z,Te,-Ye,-kt,V)}else if(ct==="butt")this.addCurrentVertex(Z,ge,0,0,V);else if(ct==="square"){const ht=Y?1:-1;this.addCurrentVertex(Z,ge,ht,ht,V)}else ct==="round"&&(Y&&(this.addCurrentVertex(Z,se,0,0,V),this.addCurrentVertex(Z,se,1,1,V,!0)),te&&(this.addCurrentVertex(Z,Te,-1,-1,V,!0),this.addCurrentVertex(Z,Te,0,0,V)));if(ot&&de<R-1){const ht=Z.dist(te);if(ht>2*F){const Ye=Z.add(te.sub(Z)._mult(F/ht)._round());this.updateDistance(Z,Ye),this.addCurrentVertex(Ye,Te,0,0,V),Z=Ye}}}}addCurrentVertex(t,a,o,d,_,v=!1){const b=a.y*d-a.x,S=-a.y-a.x*d;this.addHalfVertex(t,a.x+a.y*o,a.y-a.x*o,v,!1,o,_),this.addHalfVertex(t,b,S,v,!0,-d,_),this.distance>Jc/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,o,d,_,v))}addHalfVertex({x:t,y:a},o,d,_,v,b,S){const I=.5*(this.lineClips?this.scaledDistance*(Jc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(_?1:0),(a<<1)+(v?1:0),Math.round(63*o)+128,Math.round(63*d)+128,1+(b===0?0:b<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const R=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,R,this.e2),S.primitiveLength++),v?this.e2=R:this.e1=R}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}hasLineDasharray(t){for(const a of t){const o=a.paint.get("line-dasharray");if(o&&!o.isConstant())return!0}return!1}addLineDashDependencies(t,a,o,d){for(const _ of t){const v=_.paint.get("line-dasharray");if(!v||v.value.kind==="constant")continue;const b=_.layout.get("line-cap")==="round",S={dasharray:v.value.evaluate({zoom:o-1},a,{}),round:b},I={dasharray:v.value.evaluate({zoom:o},a,{}),round:b},R={dasharray:v.value.evaluate({zoom:o+1},a,{}),round:b},O=`${S.dasharray.join(",")},${S.round}`,F=`${I.dasharray.join(",")},${I.round}`,V=`${R.dasharray.join(",")},${R.round}`;d.dashDependencies[O]=S,d.dashDependencies[F]=I,d.dashDependencies[V]=R,a.dashes[_.id]={min:O,mid:F,max:V}}}}let lr,Bd;ft("LineBucket",eu,{omit:["layers","patternFeatures"]});var $h={get paint(){return Bd=Bd||new Hi({"line-opacity":new Rt(Ae.paint_line["line-opacity"]),"line-color":new Rt(Ae.paint_line["line-color"]),"line-translate":new vt(Ae.paint_line["line-translate"]),"line-translate-anchor":new vt(Ae.paint_line["line-translate-anchor"]),"line-width":new Rt(Ae.paint_line["line-width"]),"line-gap-width":new Rt(Ae.paint_line["line-gap-width"]),"line-offset":new Rt(Ae.paint_line["line-offset"]),"line-blur":new Rt(Ae.paint_line["line-blur"]),"line-dasharray":new cl(Ae.paint_line["line-dasharray"]),"line-pattern":new cl(Ae.paint_line["line-pattern"]),"line-gradient":new Zl(Ae.paint_line["line-gradient"])})},get layout(){return lr=lr||new Hi({"line-cap":new vt(Ae.layout_line["line-cap"]),"line-join":new Rt(Ae.layout_line["line-join"]),"line-miter-limit":new vt(Ae.layout_line["line-miter-limit"]),"line-round-limit":new vt(Ae.layout_line["line-round-limit"]),"line-sort-key":new Rt(Ae.layout_line["line-sort-key"])})}};class sm extends Rt{possiblyEvaluate(t,a){return a=new Li(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,o,d){return a=Qi({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,o,d)}}let tu;class Nd extends an{constructor(t,a){super(t,$h,a),this.gradientVersion=0,tu||(tu=new sm($h.paint.properties["line-width"].specification),tu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!(function(o){return o._styleExpression!==void 0})(a)&&a._styleExpression.expression instanceof oo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=tu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new eu(t)}queryRadius(t){const a=t,o=yl(Hc("line-width",this,a),Hc("line-gap-width",this,a)),d=Hc("line-offset",this,a);return o/2+Math.abs(d)+Lh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v}){const b=Yl(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,v),S=v/2*yl(this.paint.get("line-width").evaluate(a,o),this.paint.get("line-gap-width").evaluate(a,o)),I=this.paint.get("line-offset").evaluate(a,o);return I&&(d=(function(R,O){const F=[];for(let V=0;V<R.length;V++){const Z=R[V],Y=[];for(let te=0;te<Z.length;te++){const se=Z[te-1],Te=Z[te],de=Z[te+1],ge=te===0?new B(0,0):Te.sub(se)._unit()._perp(),De=te===Z.length-1?new B(0,0):de.sub(Te)._unit()._perp(),je=ge._add(De)._unit(),et=je.x*De.x+je.y*De.y;et!==0&&je._mult(1/et),Y.push(je._mult(O)._add(Te))}F.push(Y)}return F})(d,I*v)),(function(R,O,F){for(let V=0;V<O.length;V++){const Z=O[V];if(R.length>=3){for(let Y=0;Y<Z.length;Y++)if($c(R,Z[Y]))return!0}if(qp(R,Z,F))return!0}return!1})(b,d,S)}isTileClipped(){return!0}}function yl(n,t){return t>0?t+2*n:n}const hn=Oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ic=Oi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vu=Oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Oi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Do=Oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Gf=Oi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ff(n,t,a){return n.sections.forEach((o=>{o.text=(function(d,_,v){const b=_.layout.get("text-transform").evaluate(v,{});return b==="uppercase"?d=d.toLocaleUpperCase():b==="lowercase"&&(d=d.toLocaleLowerCase()),fs.applyArabicShaping&&(d=fs.applyArabicShaping(d)),d})(o.text,t,a)})),n}Oi([{name:"triangle",components:3,type:"Uint16"}]),Oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Oi([{type:"Float32",name:"offsetX"}]),Oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Oi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const qu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ba=24;const Hh=4294967296,Mr=1/Hh,Uf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Fn{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,a,o=this.length){for(;this.pos<o;){const d=this.readVarint(),_=d>>3,v=this.pos;this.type=7&d,t(_,a,this),this.pos===v&&this.skip(d)}return a}readMessage(t,a){return this.readFields(t,a,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Hh;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Hh;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const a=this.buf;let o,d;return d=a[this.pos++],o=127&d,d<128?o:(d=a[this.pos++],o|=(127&d)<<7,d<128?o:(d=a[this.pos++],o|=(127&d)<<14,d<128?o:(d=a[this.pos++],o|=(127&d)<<21,d<128?o:(d=a[this.pos],o|=(15&d)<<28,(function(_,v,b){const S=b.buf;let I,R;if(R=S[b.pos++],I=(112&R)>>4,R<128||(R=S[b.pos++],I|=(127&R)<<3,R<128)||(R=S[b.pos++],I|=(127&R)<<10,R<128)||(R=S[b.pos++],I|=(127&R)<<17,R<128)||(R=S[b.pos++],I|=(127&R)<<24,R<128)||(R=S[b.pos++],I|=(1&R)<<31,R<128))return iu(_,I,v);throw new Error("Expected varint not more than 10 bytes")})(o,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,a=this.pos;return this.pos=t,t-a>=12&&Uf?Uf.decode(this.buf.subarray(a,t)):(function(o,d,_){let v="",b=d;for(;b<_;){const S=o[b];let I,R,O,F=null,V=S>239?4:S>223?3:S>191?2:1;if(b+V>_)break;V===1?S<128&&(F=S):V===2?(I=o[b+1],(192&I)==128&&(F=(31&S)<<6|63&I,F<=127&&(F=null))):V===3?(I=o[b+1],R=o[b+2],(192&I)==128&&(192&R)==128&&(F=(15&S)<<12|(63&I)<<6|63&R,(F<=2047||F>=55296&&F<=57343)&&(F=null))):V===4&&(I=o[b+1],R=o[b+2],O=o[b+3],(192&I)==128&&(192&R)==128&&(192&O)==128&&(F=(15&S)<<18|(63&I)<<12|(63&R)<<6|63&O,(F<=65535||F>=1114112)&&(F=null))),F===null?(F=65533,V=1):F>65535&&(F-=65536,v+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),v+=String.fromCharCode(F),b+=V}return v})(this.buf,a,t)}readBytes(){const t=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,t);return this.pos=t,a}readPackedVarint(t=[],a){const o=this.readPackedEnd();for(;this.pos<o;)t.push(this.readVarint(a));return t}readPackedSVarint(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const a=this.readPackedEnd();for(;this.pos<a;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const a=7&t;if(a===0)for(;this.buf[this.pos++]>127;);else if(a===2)this.pos=this.readVarint()+this.pos;else if(a===5)this.pos+=4;else{if(a!==1)throw new Error(`Unimplemented type: ${a}`);this.pos+=8}}writeTag(t,a){this.writeVarint(t<<3|a)}realloc(t){let a=this.length||16;for(;a<this.pos+t;)a*=2;if(a!==this.length){const o=new Uint8Array(a);o.set(this.buf),this.buf=o,this.dataView=new DataView(o.buffer),this.length=a}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Mr),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Mr),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?(function(a,o){let d,_;if(a>=0?(d=a%4294967296|0,_=a/4294967296|0):(d=~(-a%4294967296),_=~(-a/4294967296),4294967295^d?d=d+1|0:(d=0,_=_+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),(function(v,b,S){S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,S.buf[S.pos]=127&(v>>>=7)})(d,0,o),(function(v,b){const S=(7&v)<<4;b.buf[b.pos++]|=S|((v>>>=3)?128:0),v&&(b.buf[b.pos++]=127&v|((v>>>=7)?128:0),v&&(b.buf[b.pos++]=127&v|((v>>>=7)?128:0),v&&(b.buf[b.pos++]=127&v|((v>>>=7)?128:0),v&&(b.buf[b.pos++]=127&v|((v>>>=7)?128:0),v&&(b.buf[b.pos++]=127&v)))))})(_,o)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const a=this.pos;this.pos=(function(d,_,v){for(let b,S,I=0;I<_.length;I++){if(b=_.charCodeAt(I),b>55295&&b<57344){if(!S){b>56319||I+1===_.length?(d[v++]=239,d[v++]=191,d[v++]=189):S=b;continue}if(b<56320){d[v++]=239,d[v++]=191,d[v++]=189,S=b;continue}b=S-55296<<10|b-56320|65536,S=null}else S&&(d[v++]=239,d[v++]=191,d[v++]=189,S=null);b<128?d[v++]=b:(b<2048?d[v++]=b>>6|192:(b<65536?d[v++]=b>>12|224:(d[v++]=b>>18|240,d[v++]=b>>12&63|128),d[v++]=b>>6&63|128),d[v++]=63&b|128)}return v})(this.buf,t,this.pos);const o=this.pos-a;o>=128&&Vf(a,o,this),this.pos=a-1,this.writeVarint(o),this.pos+=o}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const a=t.length;this.writeVarint(a),this.realloc(a);for(let o=0;o<a;o++)this.buf[this.pos++]=t[o]}writeRawMessage(t,a){this.pos++;const o=this.pos;t(a,this);const d=this.pos-o;d>=128&&Vf(o,d,this),this.pos=o-1,this.writeVarint(d),this.pos+=d}writeMessage(t,a,o){this.writeTag(t,2),this.writeRawMessage(a,o)}writePackedVarint(t,a){a.length&&this.writeMessage(t,ag,a)}writePackedSVarint(t,a){a.length&&this.writeMessage(t,ac,a)}writePackedBoolean(t,a){a.length&&this.writeMessage(t,Zu,a)}writePackedFloat(t,a){a.length&&this.writeMessage(t,jd,a)}writePackedDouble(t,a){a.length&&this.writeMessage(t,qf,a)}writePackedFixed32(t,a){a.length&&this.writeMessage(t,om,a)}writePackedSFixed32(t,a){a.length&&this.writeMessage(t,lm,a)}writePackedFixed64(t,a){a.length&&this.writeMessage(t,cm,a)}writePackedSFixed64(t,a){a.length&&this.writeMessage(t,um,a)}writeBytesField(t,a){this.writeTag(t,2),this.writeBytes(a)}writeFixed32Field(t,a){this.writeTag(t,5),this.writeFixed32(a)}writeSFixed32Field(t,a){this.writeTag(t,5),this.writeSFixed32(a)}writeFixed64Field(t,a){this.writeTag(t,1),this.writeFixed64(a)}writeSFixed64Field(t,a){this.writeTag(t,1),this.writeSFixed64(a)}writeVarintField(t,a){this.writeTag(t,0),this.writeVarint(a)}writeSVarintField(t,a){this.writeTag(t,0),this.writeSVarint(a)}writeStringField(t,a){this.writeTag(t,2),this.writeString(a)}writeFloatField(t,a){this.writeTag(t,5),this.writeFloat(a)}writeDoubleField(t,a){this.writeTag(t,1),this.writeDouble(a)}writeBooleanField(t,a){this.writeVarintField(t,+a)}}function iu(n,t,a){return a?4294967296*t+(n>>>0):4294967296*(t>>>0)+(n>>>0)}function Vf(n,t,a){const o=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(o);for(let d=a.pos-1;d>=n;d--)a.buf[d+o]=a.buf[d]}function ag(n,t){for(let a=0;a<n.length;a++)t.writeVarint(n[a])}function ac(n,t){for(let a=0;a<n.length;a++)t.writeSVarint(n[a])}function jd(n,t){for(let a=0;a<n.length;a++)t.writeFloat(n[a])}function qf(n,t){for(let a=0;a<n.length;a++)t.writeDouble(n[a])}function Zu(n,t){for(let a=0;a<n.length;a++)t.writeBoolean(n[a])}function om(n,t){for(let a=0;a<n.length;a++)t.writeFixed32(n[a])}function lm(n,t){for(let a=0;a<n.length;a++)t.writeSFixed32(n[a])}function cm(n,t){for(let a=0;a<n.length;a++)t.writeFixed64(n[a])}function um(n,t){for(let a=0;a<n.length;a++)t.writeSFixed64(n[a])}function Gd(n,t,a){n===1&&a.readMessage(Zf,t)}function Zf(n,t,a){if(n===3){const{id:o,bitmap:d,width:_,height:v,left:b,top:S,advance:I}=a.readMessage(ng,{});t.push({id:o,bitmap:new ku({width:_+6,height:v+6},d),metrics:{width:_,height:v,left:b,top:S,advance:I}})}}function ng(n,t,a){n===1?t.id=a.readVarint():n===2?t.bitmap=a.readBytes():n===3?t.width=a.readVarint():n===4?t.height=a.readVarint():n===5?t.left=a.readSVarint():n===6?t.top=a.readSVarint():n===7&&(t.advance=a.readVarint())}function hm(n){let t=0,a=0;for(const v of n)t+=v.w*v.h,a=Math.max(a,v.w);n.sort(((v,b)=>b.h-v.h));const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let d=0,_=0;for(const v of n)for(let b=o.length-1;b>=0;b--){const S=o[b];if(!(v.w>S.w||v.h>S.h)){if(v.x=S.x,v.y=S.y,_=Math.max(_,v.y+v.h),d=Math.max(d,v.x+v.w),v.w===S.w&&v.h===S.h){const I=o.pop();I&&b<o.length&&(o[b]=I)}else v.h===S.h?(S.x+=v.w,S.w-=v.w):v.w===S.w?(S.y+=v.h,S.h-=v.h):(o.push({x:S.x+v.w,y:S.y,w:S.w-v.w,h:v.h}),S.y+=v.h,S.h-=v.h);break}}return{w:d,h:_,fill:t/(d*_)||0}}class $f{constructor(t,{pixelRatio:a,version:o,stretchX:d,stretchY:_,content:v,textFitWidth:b,textFitHeight:S}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=d,this.stretchY=_,this.content=v,this.version=o,this.textFitWidth=b,this.textFitHeight=S}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Hf{constructor(t,a){const o={},d={};this.haveRenderCallbacks=[];const _=[];this.addImages(t,o,_),this.addImages(a,d,_);const{w:v,h:b}=hm(_),S=new zn({width:v||1,height:b||1});for(const I in t){const R=t[I],O=o[I].paddedRect;zn.copy(R.data,S,{x:0,y:0},{x:O.x+1,y:O.y+1},R.data)}for(const I in a){const R=a[I],O=d[I].paddedRect,F=O.x+1,V=O.y+1,Z=R.data.width,Y=R.data.height;zn.copy(R.data,S,{x:0,y:0},{x:F,y:V},R.data),zn.copy(R.data,S,{x:0,y:Y-1},{x:F,y:V-1},{width:Z,height:1}),zn.copy(R.data,S,{x:0,y:0},{x:F,y:V+Y},{width:Z,height:1}),zn.copy(R.data,S,{x:Z-1,y:0},{x:F-1,y:V},{width:1,height:Y}),zn.copy(R.data,S,{x:0,y:0},{x:F+Z,y:V},{width:1,height:Y})}this.image=S,this.iconPositions=o,this.patternPositions=d}addImages(t,a,o){for(const d in t){const _=t[d],v={x:0,y:0,w:_.data.width+2,h:_.data.height+2};o.push(v),a[d]=new $f(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in t.updatedImages)this.patchUpdatedImage(this.iconPositions[o],t.getImage(o),a),this.patchUpdatedImage(this.patternPositions[o],t.getImage(o),a)}patchUpdatedImage(t,a,o){if(!t||!a||t.version===a.version)return;t.version=a.version;const[d,_]=t.tl;o.update(a.data,void 0,{x:d,y:_})}}var vl;ft("ImagePosition",$f),ft("ImageAtlas",Hf),E.ao=void 0,(vl=E.ao||(E.ao={}))[vl.none=0]="none",vl[vl.horizontal=1]="horizontal",vl[vl.vertical=2]="vertical",vl[vl.horizontalOnly=3]="horizontalOnly";class ko{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,a,o){const d=new ko;return d.scale=t||1,d.fontStack=a,d.verticalAlign=o||"bottom",d}static forImage(t,a){const o=new ko;return o.imageName=t,o.verticalAlign=a||"bottom",o}}class xl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const o=new xl;for(let d=0;d<t.sections.length;d++){const _=t.sections[d];_.image?o.addImageSection(_):o.addTextSection(_,a)}return o}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let a="";for(let o=0;o<t.length;o++){const d=t.charCodeAt(o+1)||null,_=t.charCodeAt(o-1)||null;a+=d&&jc(d)&&!qu[t[o+1]]||_&&jc(_)&&!qu[t[o-1]]||!qu[t[o]]?t[o]:qu[t[o]]}return a})(this.text)}trim(){let t=0;for(let o=0;o<this.text.length&&Yh[this.text.charCodeAt(o)];o++)t++;let a=this.text.length;for(let o=this.text.length-1;o>=0&&o>=t&&Yh[this.text.charCodeAt(o)];o--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const o=new xl;return o.text=this.text.substring(t,a),o.sectionIndex=this.sectionIndex.slice(t,a),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,a)=>Math.max(t,this.sections[a].scale)),0)}getMaxImageSize(t){let a=0,o=0;for(let d=0;d<this.length();d++){const _=this.getSection(d);if(_.imageName){const v=t[_.imageName];if(!v)continue;const b=v.displaySize;a=Math.max(a,b[0]),o=Math.max(o,b[1])}}return{maxImageWidth:a,maxImageHeight:o}}addTextSection(t,a){this.text+=t.text,this.sections.push(ko.forText(t.scale,t.fontStack||a,t.verticalAlign));const o=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(o)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void qi("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(ko.forImage(a,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):qi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Xh(n,t,a,o,d,_,v,b,S,I,R,O,F,V,Z){const Y=xl.fromFeature(n,d);let te;O===E.ao.vertical&&Y.verticalizePunctuation();const{processBidirectionalText:se,processStyledBidirectionalText:Te}=fs;if(se&&Y.sections.length===1){te=[];const De=se(Y.toString(),ji(Y,I,_,t,o,V));for(const je of De){const et=new xl;et.text=je,et.sections=Y.sections;for(let dt=0;dt<je.length;dt++)et.sectionIndex.push(0);te.push(et)}}else if(Te){te=[];const De=Te(Y.text,Y.sectionIndex,ji(Y,I,_,t,o,V));for(const je of De){const et=new xl;et.text=je[0],et.sectionIndex=je[1],et.sections=Y.sections,te.push(et)}}else te=(function(De,je){const et=[],dt=De.text;let ot=0;for(const ut of je)et.push(De.substring(ot,ut)),ot=ut;return ot<dt.length&&et.push(De.substring(ot,dt.length)),et})(Y,ji(Y,I,_,t,o,V));const de=[],ge={positionedLines:de,text:Y.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:O,iconsInText:!1,verticalizable:!1};return(function(De,je,et,dt,ot,ut,Ct,ct,ht,Ye,kt,jt){let Dt=0,St=0,ti=0,ea=0;const Ea=ct==="right"?1:ct==="left"?0:.5,dn=ba/jt;let ur=0;for(const Ri of ot){Ri.trim();const wa=Ri.getMaxScale(),Aa={positionedGlyphs:[],lineOffset:0};De.positionedLines[ur]=Aa;const da=Aa.positionedGlyphs;let Un=0;if(!Ri.length()){St+=ut,++ur;continue}const Er=rg(dt,Ri,dn);for(let hr=0;hr<Ri.length();hr++){const Oa=Ri.getSection(hr),Ca=Ri.getSectionIndex(hr),$a=Ri.getCharCode(hr),Ba=sg(ht,kt,$a);let Gi;if(Oa.imageName){if(De.iconsInText=!0,Oa.scale=Oa.scale*dn,Gi=lg(Oa,Ba,wa,Er,dt),!Gi)continue;Un=Math.max(Un,Gi.imageOffset)}else if(Gi=og(Oa,$a,Ba,Er,je,et),!Gi)continue;const{rect:Ar,metrics:ru,baselineOffset:Vn}=Gi;da.push({glyph:$a,imageName:Oa.imageName,x:Dt,y:St+Vn+-17,vertical:Ba,scale:Oa.scale,fontStack:Oa.fontStack,sectionIndex:Ca,metrics:ru,rect:Ar}),Ba?(De.verticalizable=!0,Dt+=(Oa.imageName?ru.advance:ba)*Oa.scale+Ye):Dt+=ru.advance*Oa.scale+Ye}da.length!==0&&(ti=Math.max(Dt-Ye,ti),Ud(da,0,da.length-1,Ea)),Dt=0,Aa.lineOffset=Math.max(Un,(wa-1)*ba);const Sa=ut*wa+Un;St+=Sa,ea=Math.max(Sa,ea),++ur}const{horizontalAlign:La,verticalAlign:ha}=Wh(Ct);(function(Ri,wa,Aa,da,Un,Er,Sa,hr,Oa){const Ca=(wa-Aa)*Un;let $a=0;$a=Er!==Sa?-hr*da- -17:-da*Oa*Sa+.5*Sa;for(const Ba of Ri)for(const Gi of Ba.positionedGlyphs)Gi.x+=Ca,Gi.y+=$a})(De.positionedLines,Ea,La,ha,ti,ea,ut,St,ot.length),De.top+=-ha*St,De.bottom=De.top+St,De.left+=-La*ti,De.right=De.left+ti})(ge,t,a,o,te,v,b,S,O,I,F,Z),!(function(De){for(const je of De)if(je.positionedGlyphs.length!==0)return!1;return!0})(de)&&ge}const Yh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},dm={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},fm={40:!0};function Xf(n,t,a,o,d,_){if(t.imageName){const v=o[t.imageName];return v?v.displaySize[0]*t.scale*ba/_+d:0}{const v=a[t.fontStack],b=v&&v[n];return b?b.metrics.advance*t.scale+d:0}}function Yf(n,t,a,o){const d=Math.pow(n-t,2);return o?n<t?d/2:2*d:d+Math.abs(a)*a}function Fd(n,t,a){let o=0;return n===10&&(o-=1e4),a&&(o+=150),n!==40&&n!==65288||(o+=50),t!==41&&t!==65289||(o+=50),o}function Wf(n,t,a,o,d,_){let v=null,b=Yf(t,a,d,_);for(const S of o){const I=Yf(t-S.x,a,d,_)+S.badness;I<=b&&(v=S,b=I)}return{index:n,x:t,priorBreak:v,badness:b}}function Qf(n){return n?Qf(n.priorBreak).concat(n.index):[]}function ji(n,t,a,o,d,_){if(!n)return[];const v=[],b=(function(O,F,V,Z,Y,te){let se=0;for(let Te=0;Te<O.length();Te++){const de=O.getSection(Te);se+=Xf(O.getCharCode(Te),de,Z,Y,F,te)}return se/Math.max(1,Math.ceil(se/V))})(n,t,a,o,d,_),S=n.text.indexOf("")>=0;let I=0;for(let O=0;O<n.length();O++){const F=n.getSection(O),V=n.getCharCode(O);if(Yh[V]||(I+=Xf(V,F,o,d,t,_)),O<n.length()-1){const Z=!((R=V)<11904)&&(!!Yt["CJK Compatibility Forms"](R)||!!Yt["CJK Compatibility"](R)||!!Yt["CJK Strokes"](R)||!!Yt["CJK Symbols and Punctuation"](R)||!!Yt["Enclosed CJK Letters and Months"](R)||!!Yt["Halfwidth and Fullwidth Forms"](R)||!!Yt["Ideographic Description Characters"](R)||!!Yt["Vertical Forms"](R)||Nc.test(String.fromCodePoint(R)));(dm[V]||Z||F.imageName||O!==n.length()-2&&fm[n.getCharCode(O+1)])&&v.push(Wf(O+1,I,b,v,Fd(V,n.getCharCode(O+1),Z&&S),!1))}}var R;return Qf(Wf(n.length(),I,b,v,0,!0))}function Wh(n){let t=.5,a=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function rg(n,t,a){const o=t.getMaxScale()*ba,{maxImageWidth:d,maxImageHeight:_}=t.getMaxImageSize(n),v=Math.max(o,_*a);return{verticalLineContentWidth:Math.max(o,d*a),horizontalLineContentHeight:v}}function Kf(n){switch(n){case"top":return 0;case"center":return .5;default:return 1}}function sg(n,t,a){return!(n===E.ao.horizontal||!t&&!So(a)||t&&(Yh[a]||(o=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function og(n,t,a,o,d,_){const v=_[n.fontStack],b=(function(I,R,O,F){if(I&&I.rect)return I;const V=R[O.fontStack],Z=V&&V[F];return Z?{rect:null,metrics:Z.metrics}:null})(v&&v[t],d,n,t);if(b===null)return null;let S;if(a)S=o.verticalLineContentWidth-n.scale*ba;else{const I=Kf(n.verticalAlign);S=(o.horizontalLineContentHeight-n.scale*ba)*I}return{rect:b.rect,metrics:b.metrics,baselineOffset:S}}function lg(n,t,a,o,d){const _=d[n.imageName];if(!_)return null;const v=_.paddedRect,b=_.displaySize,S={width:b[0],height:b[1],left:1,top:-3,advance:t?b[1]:b[0]};let I;if(t)I=o.verticalLineContentWidth-b[1]*n.scale;else{const R=Kf(n.verticalAlign);I=(o.horizontalLineContentHeight-b[1]*n.scale)*R}return{rect:v,metrics:S,baselineOffset:I,imageOffset:(t?b[0]:b[1])*n.scale-ba*a}}function Ud(n,t,a,o){if(o===0)return;const d=n[a],_=(n[a].x+d.metrics.advance*d.scale)*o;for(let v=t;v<=a;v++)n[v].x-=_}function $u(n,t,a){const{horizontalAlign:o,verticalAlign:d}=Wh(a),_=t[0]-n.displaySize[0]*o,v=t[1]-n.displaySize[1]*d;return{image:n,top:v,bottom:v+n.displaySize[1],left:_,right:_+n.displaySize[0]}}function Vd(n){var t,a;let o=n.left,d=n.top,_=n.right-o,v=n.bottom-d;const b=(t=n.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",S=(a=n.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",I=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(S==="proportional"){if(b==="stretchOnly"&&_/v<I||b==="proportional"){const R=Math.ceil(v*I);o*=R/_,_=R}}else if(b==="proportional"&&S==="stretchOnly"&&I!==0&&_/v>I){const R=Math.ceil(_/I);d*=R/v,v=R}return{x1:o,y1:d,x2:o+_,y2:d+v}}function Qh(n,t,a,o,d,_){const v=n.image;let b;if(v.content){const te=v.content,se=v.pixelRatio||1;b=[te[0]/se,te[1]/se,v.displaySize[0]-te[2]/se,v.displaySize[1]-te[3]/se]}const S=t.left*_,I=t.right*_;let R,O,F,V;a==="width"||a==="both"?(V=d[0]+S-o[3],O=d[0]+I+o[1]):(V=d[0]+(S+I-v.displaySize[0])/2,O=V+v.displaySize[0]);const Z=t.top*_,Y=t.bottom*_;return a==="height"||a==="both"?(R=d[1]+Z-o[0],F=d[1]+Y+o[2]):(R=d[1]+(Z+Y-v.displaySize[1])/2,F=R+v.displaySize[1]),{image:v,top:R,right:O,bottom:F,left:V,collisionPadding:b}}const Hs=128,cr=32640;function Xs(n,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Li(n+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:d}=a;let _=0;for(;_<o.length&&o[_]<=n;)_++;_=Math.max(0,_-1);let v=_;for(;v<o.length&&o[v]<n+1;)v++;v=Math.min(o.length-1,v);const b=o[_],S=o[v];return a.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:b,maxZoom:S,minSize:a.evaluate(new Li(b)),maxSize:a.evaluate(new Li(S)),interpolationType:d}}}function au(n,t,a){let o="never";const d=n.get(t);return d?o=d:n.get(a)&&(o="always"),o}const cg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kh(n,t,a,o,d,_,v,b,S,I,R,O,F){const V=b?Math.min(cr,Math.round(b[0])):0,Z=b?Math.min(cr,Math.round(b[1])):0;n.emplaceBack(t,a,Math.round(32*o),Math.round(32*d),_,v,(V<<1)+(S?1:0),Z,16*I,16*R,256*O,256*F)}function qd(n,t,a){n.emplaceBack(t.x,t.y,a),n.emplaceBack(t.x,t.y,a),n.emplaceBack(t.x,t.y,a),n.emplaceBack(t.x,t.y,a)}function pm(n){for(const t of n.sections)if(Ns(t.text))return!0;return!1}class Zd{constructor(t){this.layoutVertexArray=new st,this.indexArray=new Ai,this.programConfigurations=t,this.segments=new ni,this.dynamicLayoutVertexArray=new Qe,this.opacityVertexArray=new wt,this.hasVisibleVertices=!1,this.placedSymbolArray=new q}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,o,d){this.isEmpty()||(o&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hn.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,ic.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,cg,!0),this.opacityVertexBuffer.itemSize=1),(o||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ft("SymbolBuffers",Zd);class Jf{constructor(t,a,o){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new o,this.segments=new ni,this.collisionVertexArray=new pi}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Vu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ft("CollisionBuffers",Jf);class nc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=Ks(globalThis)?Math.min(t.overscaling,128):t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((v=>v.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Xs(this.zoom,a["text-size"]),this.iconSizeData=Xs(this.zoom,a["icon-size"]);const o=this.layers[0].layout,d=o.get("symbol-sort-key"),_=o.get("symbol-z-order");this.canOverlap=au(o,"text-overlap","text-allow-overlap")!=="never"||au(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map((v=>E.ao[v]))),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Zd(new gs(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Zd(new gs(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new ne,this.lineVertexArray=new re,this.symbolInstances=new ae,this.textAnchorOffsets=new ue}calculateGlyphDependencies(t,a,o,d,_){for(let v=0;v<t.length;v++)if(a[t.charCodeAt(v)]=!0,(o||d)&&_){const b=qu[t.charAt(v)];b&&(a[b.charCodeAt(0)]=!0)}}populate(t,a,o){const d=this.layers[0],_=d.layout,v=_.get("text-font"),b=_.get("text-field"),S=_.get("icon-image"),I=(b.value.kind!=="constant"||b.value.value instanceof ja&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),R=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,O=_.get("symbol-sort-key");if(this.features=[],!I&&!R)return;const F=a.iconDependencies,V=a.glyphDependencies,Z=a.availableImages,Y=new Li(this.zoom);for(const{feature:te,id:se,index:Te,sourceLayerIndex:de}of t){const ge=d._featureFilter.needGeometry,De=Zr(te,ge);if(!d._featureFilter.filter(Y,De,o))continue;let je,et;if(ge||(De.geometry=Xl(te)),I){const ot=d.getValueAndResolveTokens("text-field",De,o,Z),ut=ja.factory(ot),Ct=this.hasRTLText=this.hasRTLText||pm(ut);(!Ct||fs.getRTLTextPluginStatus()==="unavailable"||Ct&&fs.isParsed())&&(je=Ff(ut,d,De))}if(R){const ot=d.getValueAndResolveTokens("icon-image",De,o,Z);et=ot instanceof Tn?ot:Tn.fromString(ot)}if(!je&&!et)continue;const dt=this.sortFeaturesByKey?O.evaluate(De,{},o):void 0;if(this.features.push({id:se,text:je,icon:et,index:Te,sourceLayerIndex:de,geometry:De.geometry,properties:te.properties,type:Wc.types[te.type],sortKey:dt}),et&&(F[et.name]=!0),je){const ot=v.evaluate(De,{},o).join(","),ut=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ao.vertical)>=0;for(const Ct of je.sections)if(Ct.image)F[Ct.image.name]=!0;else{const ct=ds(je.toString()),ht=Ct.fontStack||ot,Ye=V[ht]=V[ht]||{};this.calculateGlyphDependencies(Ct.text,Ye,ut,this.allowVerticalPlacement,ct)}}}_.get("symbol-placement")==="line"&&(this.features=(function(te){const se={},Te={},de=[];let ge=0;function De(ot){de.push(te[ot]),ge++}function je(ot,ut,Ct){const ct=Te[ot];return delete Te[ot],Te[ut]=ct,de[ct].geometry[0].pop(),de[ct].geometry[0]=de[ct].geometry[0].concat(Ct[0]),ct}function et(ot,ut,Ct){const ct=se[ut];return delete se[ut],se[ot]=ct,de[ct].geometry[0].shift(),de[ct].geometry[0]=Ct[0].concat(de[ct].geometry[0]),ct}function dt(ot,ut,Ct){const ct=Ct?ut[0][ut[0].length-1]:ut[0][0];return`${ot}:${ct.x}:${ct.y}`}for(let ot=0;ot<te.length;ot++){const ut=te[ot],Ct=ut.geometry,ct=ut.text?ut.text.toString():null;if(!ct){De(ot);continue}const ht=dt(ct,Ct),Ye=dt(ct,Ct,!0);if(ht in Te&&Ye in se&&Te[ht]!==se[Ye]){const kt=et(ht,Ye,Ct),jt=je(ht,Ye,de[kt].geometry);delete se[ht],delete Te[Ye],Te[dt(ct,de[jt].geometry,!0)]=jt,de[kt].geometry=null}else ht in Te?je(ht,Ye,Ct):Ye in se?et(ht,Ye,Ct):(De(ot),se[ht]=ge-1,Te[Ye]=ge-1)}return de.filter((ot=>ot.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((te,se)=>te.sortKey-se.sortKey))}update(t,a,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,{imagePositions:o}),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,{imagePositions:o}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const o=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(a[t.segment+1]),_=t.dist(a[t.segment]);const v={};for(let b=t.segment+1;b<a.length;b++)v[b]={x:a[b].x,y:a[b].y,tileUnitDistanceFromAnchor:d},b<a.length-1&&(d+=a[b+1].dist(a[b]));for(let b=t.segment||0;b>=0;b--)v[b]={x:a[b].x,y:a[b].y,tileUnitDistanceFromAnchor:_},b>0&&(_+=a[b-1].dist(a[b]));for(let b=0;b<a.length;b++){const S=v[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(t,a,o,d,_,v,b,S,I,R,O,F){const V=t.indexArray,Z=t.layoutVertexArray,Y=t.segments.prepareSegment(4*a.length,Z,V,this.canOverlap?v.sortKey:void 0),te=this.glyphOffsetArray.length,se=Y.vertexLength,Te=this.allowVerticalPlacement&&b===E.ao.vertical?Math.PI/2:0,de=v.text&&v.text.sections;for(let ge=0;ge<a.length;ge++){const{tl:De,tr:je,bl:et,br:dt,tex:ot,pixelOffsetTL:ut,pixelOffsetBR:Ct,minFontScaleX:ct,minFontScaleY:ht,glyphOffset:Ye,isSDF:kt,sectionIndex:jt}=a[ge],Dt=Y.vertexLength,St=Ye[1];Kh(Z,S.x,S.y,De.x,St+De.y,ot.x,ot.y,o,kt,ut.x,ut.y,ct,ht),Kh(Z,S.x,S.y,je.x,St+je.y,ot.x+ot.w,ot.y,o,kt,Ct.x,ut.y,ct,ht),Kh(Z,S.x,S.y,et.x,St+et.y,ot.x,ot.y+ot.h,o,kt,ut.x,Ct.y,ct,ht),Kh(Z,S.x,S.y,dt.x,St+dt.y,ot.x+ot.w,ot.y+ot.h,o,kt,Ct.x,Ct.y,ct,ht),qd(t.dynamicLayoutVertexArray,S,Te),V.emplaceBack(Dt,Dt+2,Dt+1),V.emplaceBack(Dt+1,Dt+2,Dt+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ye[0]),ge!==a.length-1&&jt===a[ge+1].sectionIndex||t.programConfigurations.populatePaintArrays(Z.length,v,v.index,{imagePositions:{},canonical:F,formattedSection:de&&de[jt]})}t.placedSymbolArray.emplaceBack(S.x,S.y,te,this.glyphOffsetArray.length-te,se,I,R,S.segment,o?o[0]:0,o?o[1]:0,d[0],d[1],b,0,!1,0,O)}_addCollisionDebugVertex(t,a,o,d,_,v){return a.emplaceBack(0,0),t.emplaceBack(o.x,o.y,d,_,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(t,a,o,d,_,v,b){const S=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),I=S.vertexLength,R=_.layoutVertexArray,O=_.collisionVertexArray,F=b.anchorX,V=b.anchorY;this._addCollisionDebugVertex(R,O,v,F,V,new B(t,a)),this._addCollisionDebugVertex(R,O,v,F,V,new B(o,a)),this._addCollisionDebugVertex(R,O,v,F,V,new B(o,d)),this._addCollisionDebugVertex(R,O,v,F,V,new B(t,d)),S.vertexLength+=4;const Z=_.indexArray;Z.emplaceBack(I,I+1),Z.emplaceBack(I+1,I+2),Z.emplaceBack(I+2,I+3),Z.emplaceBack(I+3,I),S.primitiveLength+=4}addDebugCollisionBoxes(t,a,o,d){for(let _=t;_<a;_++){const v=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,d?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Jf(Ut,Do.members,Ci),this.iconCollisionBox=new Jf(Ut,Do.members,Ci);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,o,d,_,v,b,S,I){const R={};for(let O=a;O<o;O++){const F=t.get(O);R.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},R.textFeatureIndex=F.featureIndex;break}for(let O=d;O<_;O++){const F=t.get(O);R.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},R.verticalTextFeatureIndex=F.featureIndex;break}for(let O=v;O<b;O++){const F=t.get(O);R.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},R.iconFeatureIndex=F.featureIndex;break}for(let O=S;O<I;O++){const F=t.get(O);R.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},R.verticalIconFeatureIndex=F.featureIndex;break}return R}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const o=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const o=t.placedSymbolArray.get(a),d=o.vertexStartIndex+4*o.numGlyphs;for(let _=o.vertexStartIndex;_<d;_+=4)t.indexArray.emplaceBack(_,_+2,_+1),t.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),o=Math.cos(t),d=[],_=[],v=[];for(let b=0;b<this.symbolInstances.length;++b){v.push(b);const S=this.symbolInstances.get(b);d.push(0|Math.round(a*S.anchorX+o*S.anchorY)),_.push(S.featureIndex)}return v.sort(((b,S)=>d[b]-d[S]||_[S]-_[b])),v}addToSortKeyRanges(t,a){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===a?o.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const o=this.symbolInstances.get(a);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach(((d,_,v)=>{d>=0&&v.indexOf(d)===_&&this.addIndicesForPlacedSymbol(this.text,d)})),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ep,tp;ft("SymbolBucket",nc,{omit:["layers","collisionBoxArray","features","compareText"]}),nc.MAX_GLYPHS=65535,nc.addDynamicAttributes=qd;var ip={get paint(){return tp=tp||new Hi({"icon-opacity":new Rt(Ae.paint_symbol["icon-opacity"]),"icon-color":new Rt(Ae.paint_symbol["icon-color"]),"icon-halo-color":new Rt(Ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new Rt(Ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Rt(Ae.paint_symbol["icon-halo-blur"]),"icon-translate":new vt(Ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new vt(Ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new Rt(Ae.paint_symbol["text-opacity"]),"text-color":new Rt(Ae.paint_symbol["text-color"],{runtimeType:$n,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Rt(Ae.paint_symbol["text-halo-color"]),"text-halo-width":new Rt(Ae.paint_symbol["text-halo-width"]),"text-halo-blur":new Rt(Ae.paint_symbol["text-halo-blur"]),"text-translate":new vt(Ae.paint_symbol["text-translate"]),"text-translate-anchor":new vt(Ae.paint_symbol["text-translate-anchor"])})},get layout(){return ep=ep||new Hi({"symbol-placement":new vt(Ae.layout_symbol["symbol-placement"]),"symbol-spacing":new vt(Ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vt(Ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Rt(Ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vt(Ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vt(Ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new vt(Ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new vt(Ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new vt(Ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vt(Ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new Rt(Ae.layout_symbol["icon-size"]),"icon-text-fit":new vt(Ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vt(Ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new Rt(Ae.layout_symbol["icon-image"]),"icon-rotate":new Rt(Ae.layout_symbol["icon-rotate"]),"icon-padding":new Rt(Ae.layout_symbol["icon-padding"]),"icon-keep-upright":new vt(Ae.layout_symbol["icon-keep-upright"]),"icon-offset":new Rt(Ae.layout_symbol["icon-offset"]),"icon-anchor":new Rt(Ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vt(Ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vt(Ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vt(Ae.layout_symbol["text-rotation-alignment"]),"text-field":new Rt(Ae.layout_symbol["text-field"]),"text-font":new Rt(Ae.layout_symbol["text-font"]),"text-size":new Rt(Ae.layout_symbol["text-size"]),"text-max-width":new Rt(Ae.layout_symbol["text-max-width"]),"text-line-height":new vt(Ae.layout_symbol["text-line-height"]),"text-letter-spacing":new Rt(Ae.layout_symbol["text-letter-spacing"]),"text-justify":new Rt(Ae.layout_symbol["text-justify"]),"text-radial-offset":new Rt(Ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vt(Ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Rt(Ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Rt(Ae.layout_symbol["text-anchor"]),"text-max-angle":new vt(Ae.layout_symbol["text-max-angle"]),"text-writing-mode":new vt(Ae.layout_symbol["text-writing-mode"]),"text-rotate":new Rt(Ae.layout_symbol["text-rotate"]),"text-padding":new vt(Ae.layout_symbol["text-padding"]),"text-keep-upright":new vt(Ae.layout_symbol["text-keep-upright"]),"text-transform":new Rt(Ae.layout_symbol["text-transform"]),"text-offset":new Rt(Ae.layout_symbol["text-offset"]),"text-allow-overlap":new vt(Ae.layout_symbol["text-allow-overlap"]),"text-overlap":new vt(Ae.layout_symbol["text-overlap"]),"text-ignore-placement":new vt(Ae.layout_symbol["text-ignore-placement"]),"text-optional":new vt(Ae.layout_symbol["text-optional"])})}};class $d{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:_i,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ft("FormatSectionOverride",$d,{omit:["defaultValue"]});class Hu extends an{constructor(t,a){super(t,ip,a)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const d=[];for(const _ of o)d.indexOf(_)<0&&d.push(_);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,o,d){const _=this.layout.get(t).evaluate(a,{},o,d),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||Nl(v.value)||!_?_:(function(b,S){return S.replace(/{([^{}]+)}/g,((I,R)=>b&&R in b?String(b[R]):""))})(a.properties,_)}createBucket(t){return new nc(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of ip.paint.overridableProperties){if(!Hu.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),o=new $d(a),d=new Eu(o,a.property.specification);let _=null;_=a.value.kind==="constant"||a.value.kind==="source"?new Cn("source",d):new Rs("composite",d,a.value.zoomStops),this.paint._values[t]=new jr(a.property,_,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,o){return!(!this.layout||a.isDataDriven()||o.isDataDriven())&&Hu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const o=t.get("text-field"),d=ip.paint.properties[a];let _=!1;const v=b=>{for(const S of b)if(d.overrides&&d.overrides.hasOverride(S))return void(_=!0)};if(o.value.kind==="constant"&&o.value.value instanceof ja)v(o.value.value.sections);else if(o.value.kind==="source"||o.value.kind==="composite"){const b=I=>{_||(I instanceof Bt&&Ki(I.value)===es?v(I.value.sections):I instanceof _u?v(I.sections):I.eachChild(b))},S=o.value;S._styleExpression&&b(S._styleExpression.expression)}return _}}let mm;var ug={get paint(){return mm=mm||new Hi({"background-color":new vt(Ae.paint_background["background-color"]),"background-pattern":new Pu(Ae.paint_background["background-pattern"]),"background-opacity":new vt(Ae.paint_background["background-opacity"])})}};class Jh extends an{constructor(t,a){super(t,ug,a)}}class hg extends an{constructor(t,a){super(t,{},a),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class gm{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const xi={once:!0},ed=63710088e-1;class Ys{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ys(gi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,o=this.lat*a,d=t.lat*a,_=Math.sin(o)*Math.sin(d)+Math.cos(o)*Math.cos(d)*Math.cos((t.lng-this.lng)*a);return ed*Math.acos(Math.min(_,1))}static convert(t){if(t instanceof Ys)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ys(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ys(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Hd=2*Math.PI*ed;function ap(n){return Hd*Math.cos(n*Math.PI/180)}function Xd(n){return(180+n)/360}function Xu(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function td(n,t){return n/ap(t)}function np(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function rp(n,t){return n*ap(np(t))}class id{constructor(t,a,o=0){this.x=+t,this.y=+a,this.z=+o}static fromLngLat(t,a=0){const o=Ys.convert(t);return new id(Xd(o.lng),Xu(o.lat),td(a,o.lat))}toLngLat(){return new Ys(360*this.x-180,np(this.y))}toAltitude(){return rp(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Hd*(t=np(this.y),1/Math.cos(t*Math.PI/180));var t}}function _m(n,t,a){var o=2*Math.PI*6378137/256/Math.pow(2,a);return[n*o-2*Math.PI*6378137/2,t*o-2*Math.PI*6378137/2]}class Yd{constructor(t,a,o){if(!(function(d,_,v){return!(d<0||d>25||v<0||v>=Math.pow(2,d)||_<0||_>=Math.pow(2,d))})(t,a,o))throw new Error(`x=${a}, y=${o}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=o,this.key=rc(0,t,t,a,o)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,o){const d=(v=this.y,b=this.z,S=_m(256*(_=this.x),256*(v=Math.pow(2,b)-v-1),b),I=_m(256*(_+1),256*(v+1),b),S[0]+","+S[1]+","+I[0]+","+I[1]);var _,v,b,S,I;const R=(function(O,F,V){let Z,Y="";for(let te=O;te>0;te--)Z=1<<te-1,Y+=(F&Z?1:0)+(V&Z?2:0);return Y})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new B((t.x*a-this.x)*Lt,(t.y*a-this.y)*Lt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class sp{constructor(t,a){this.wrap=t,this.canonical=a,this.key=rc(t,a.z,a.z,a.x,a.y)}}class di{constructor(t,a,o,d,_){if(this.terrainRttPosMatrix32f=null,t<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${o}`);this.overscaledZ=t,this.wrap=a,this.canonical=new Yd(o,+d,+_),this.key=rc(a,t,o,d,_)}clone(){return new di(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new di(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new di(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?rc(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):rc(this.wrap*+a,t,t,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(t){if(t.wrap!==this.wrap||this.overscaledZ-t.overscaledZ<=0)return!1;if(t.overscaledZ===0)return this.overscaledZ>0;const a=this.canonical.z-t.canonical.z;return!(a<0)&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new di(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,o=2*this.canonical.x,d=2*this.canonical.y;return[new di(a,this.wrap,a,o,d),new di(a,this.wrap,a,o+1,d),new di(a,this.wrap,a,o,d+1),new di(a,this.wrap,a,o+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new di(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new di(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new sp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new id(t.x-this.wrap,t.y))}}function rc(n,t,a,o,d){(n*=2)<0&&(n=-1*n-1);const _=1<<a;return(_*_*n+_*d+o).toString(36)+a.toString(36)+t.toString(36)}function Za(n,t){return t?n.properties[t]:n.id}ft("CanonicalTileID",Yd),ft("OverscaledTileID",di,{omit:["terrainRttPosMatrix32f"]});class nu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const a=new nu;return a.extend(t(new B(this.minX,this.minY))),a.extend(t(new B(this.maxX,this.minY))),a.extend(t(new B(this.minX,this.maxY))),a.extend(t(new B(this.maxX,this.maxY))),a}static fromPoints(t){const a=new nu;for(const o of t)a.extend(o);return a}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class op{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const o=t[a];this._stringToNumber[o]=a,this._numberToString[a]=o}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class ym{constructor(t,a,o,d,_){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=o,t._y=d,this.properties=t.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class Wd{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new nl(Lt,16,0),this.grid3D=new nl(Lt,16,0),this.featureIndexArray=new me,this.promoteId=a}insert(t,a,o,d,_,v){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,d,_);const S=v?this.grid3D:this.grid;for(let I=0;I<a.length;I++){const R=a[I],O=[1/0,1/0,-1/0,-1/0];for(let F=0;F<R.length;F++){const V=R[F];O[0]=Math.min(O[0],V.x),O[1]=Math.min(O[1],V.y),O[2]=Math.max(O[2],V.x),O[3]=Math.max(O[3],V.y)}O[0]<Lt&&O[1]<Lt&&O[2]>=0&&O[3]>=0&&S.insert(b,O[0],O[1],O[2],O[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Bf(new Fn(this.rawTileData)).layers,this.sourceLayerCoder=new op(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,o,d){this.loadVTLayers();const _=t.params,v=Lt/t.tileSize/t.scale,b=Ln(_.filter,_.globalState),S=t.queryGeometry,I=t.queryPadding*v,R=nu.fromPoints(S),O=this.grid.query(R.minX-I,R.minY-I,R.maxX+I,R.maxY+I),F=nu.fromPoints(t.cameraQueryGeometry).expandBy(I),V=this.grid3D.query(F.minX,F.minY,F.maxX,F.maxY,((te,se,Te,de)=>(function(ge,De,je,et,dt){for(const ut of ge)if(De<=ut.x&&je<=ut.y&&et>=ut.x&&dt>=ut.y)return!0;const ot=[new B(De,je),new B(De,dt),new B(et,dt),new B(et,je)];if(ge.length>2){for(const ut of ot)if($c(ge,ut))return!0}for(let ut=0;ut<ge.length-1;ut++)if(Zp(ge[ut],ge[ut+1],ot))return!0;return!1})(t.cameraQueryGeometry,te-I,se-I,Te+I,de+I)));for(const te of V)O.push(te);O.sort(Kd);const Z={};let Y;for(let te=0;te<O.length;te++){const se=O[te];if(se===Y)continue;Y=se;const Te=this.featureIndexArray.get(se);let de=null;this.loadMatchingFeature(Z,Te.bucketIndex,Te.sourceLayerIndex,Te.featureIndex,b,_.layers,_.availableImages,a,o,d,((ge,De,je)=>(de||(de=Xl(ge)),De.queryIntersectsFeature({queryGeometry:S,feature:ge,featureState:je,geometry:de,zoom:this.z,transform:t.transform,pixelsToTileUnits:v,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation}))))}return Z}loadMatchingFeature(t,a,o,d,_,v,b,S,I,R,O){const F=this.bucketLayerIDs[a];if(v&&!F.some((te=>v.has(te))))return;const V=this.sourceLayerCoder.decode(o),Z=this.vtLayers[V].feature(d);if(_.needGeometry){const te=Zr(Z,!0);if(!_.filter(new Li(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!_.filter(new Li(this.tileID.overscaledZ),Z))return;const Y=this.getId(Z,V);for(let te=0;te<F.length;te++){const se=F[te];if(v&&!v.has(se))continue;const Te=S[se];if(!Te)continue;let de={};Y&&R&&(de=R.getState(Te.sourceLayer||"_geojsonTileLayer",Y));const ge=Qi({},I[se]);ge.paint=Qd(ge.paint,Te.paint,Z,de,b),ge.layout=Qd(ge.layout,Te.layout,Z,de,b);const De=!O||O(Z,Te,de);if(!De)continue;const je=new ym(Z,this.z,this.x,this.y,Y);je.layer=ge;let et=t[se];et===void 0&&(et=t[se]=[]),et.push({featureIndex:d,feature:je,intersectionZ:De})}}lookupSymbolFeatures(t,a,o,d,_,v,b,S){const I={};this.loadVTLayers();const R=Ln(_.filterSpec,_.globalState);for(const O of t)this.loadMatchingFeature(I,o,d,O,R,v,b,S,a);return I}hasLayer(t){for(const a of this.bucketLayerIDs)for(const o of a)if(t===o)return!0;return!1}getId(t,a){var o;let d=t.id;return this.promoteId&&(d=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((o=t.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(d=Number(t.properties.cluster_id))),d}}function Qd(n,t,a,o,d){return Qr(n,((_,v)=>{const b=t instanceof Fc?t.get(v):null;return b&&b.evaluate?b.evaluate(a,o,d):b}))}function Kd(n,t){return t-n}function lp(n,t,a,o,d){const _=[];for(let v=0;v<n.length;v++){const b=n[v];let S;for(let I=0;I<b.length-1;I++){let R=b[I],O=b[I+1];R.x<t&&O.x<t||(R.x<t?R=new B(t,R.y+(t-R.x)/(O.x-R.x)*(O.y-R.y))._round():O.x<t&&(O=new B(t,R.y+(t-R.x)/(O.x-R.x)*(O.y-R.y))._round()),R.y<a&&O.y<a||(R.y<a?R=new B(R.x+(a-R.y)/(O.y-R.y)*(O.x-R.x),a)._round():O.y<a&&(O=new B(R.x+(a-R.y)/(O.y-R.y)*(O.x-R.x),a)._round()),R.x>=o&&O.x>=o||(R.x>=o?R=new B(o,R.y+(o-R.x)/(O.x-R.x)*(O.y-R.y))._round():O.x>=o&&(O=new B(o,R.y+(o-R.x)/(O.x-R.x)*(O.y-R.y))._round()),R.y>=d&&O.y>=d||(R.y>=d?R=new B(R.x+(d-R.y)/(O.y-R.y)*(O.x-R.x),d)._round():O.y>=d&&(O=new B(R.x+(d-R.y)/(O.y-R.y)*(O.x-R.x),d)._round()),S&&R.equals(S[S.length-1])||(S=[R],_.push(S)),S.push(O)))))}}return _}ft("FeatureIndex",Wd,{omit:["rawTileData","sourceLayerCoder"]});class bl extends B{constructor(t,a,o,d){super(t,a),this.angle=o,d!==void 0&&(this.segment=d)}clone(){return new bl(this.x,this.y,this.angle,this.segment)}}function Jd(n,t,a,o,d){if(t.segment===void 0||a===0)return!0;let _=t,v=t.segment+1,b=0;for(;b>-a/2;){if(v--,v<0)return!1;b-=n[v].dist(_),_=n[v]}b+=n[v].dist(n[v+1]),v++;const S=[];let I=0;for(;b<a/2;){const R=n[v],O=n[v+1];if(!O)return!1;let F=n[v-1].angleTo(R)-R.angleTo(O);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:F}),I+=F;b-S[0].distance>o;)I-=S.shift().angleDelta;if(I>d)return!1;v++,b+=R.dist(O)}return!0}function ef(n){let t=0;for(let a=0;a<n.length-1;a++)t+=n[a].dist(n[a+1]);return t}function vm(n,t,a){return n?.6*t*a:0}function cp(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function dg(n,t,a,o,d,_){const v=vm(a,d,_),b=cp(a,o)*_;let S=0;const I=ef(n)/2;for(let R=0;R<n.length-1;R++){const O=n[R],F=n[R+1],V=O.dist(F);if(S+V>I){const Z=(I-S)/V,Y=gr.number(O.x,F.x,Z),te=gr.number(O.y,F.y,Z),se=new bl(Y,te,F.angleTo(O),R);return se._round(),!v||Jd(n,se,b,v,t)?se:void 0}S+=V}}function xm(n,t,a,o,d,_,v,b,S){const I=vm(o,_,v),R=cp(o,d),O=R*v,F=n[0].x===0||n[0].x===S||n[0].y===0||n[0].y===S;return t-O<t/4&&(t=O+t/4),bm(n,F?t/2*b%t:(R/2+2*_)*v*b%t,t,I,a,O,F,!1,S)}function bm(n,t,a,o,d,_,v,b,S){const I=_/2,R=ef(n);let O=0,F=t-a,V=[];for(let Z=0;Z<n.length-1;Z++){const Y=n[Z],te=n[Z+1],se=Y.dist(te),Te=te.angleTo(Y);for(;F+a<O+se;){F+=a;const de=(F-O)/se,ge=gr.number(Y.x,te.x,de),De=gr.number(Y.y,te.y,de);if(ge>=0&&ge<S&&De>=0&&De<S&&F-I>=0&&F+I<=R){const je=new bl(ge,De,Te,Z);je._round(),o&&!Jd(n,je,_,o,d)||V.push(je)}}O+=se}return b||V.length||v||(V=bm(n,O/2,a,o,d,_,v,!0,S)),V}function wm(n,t,a,o){const d=[],_=n.image,v=_.pixelRatio,b=_.paddedRect.w-2,S=_.paddedRect.h-2;let I={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const R=_.stretchX||[[0,b]],O=_.stretchY||[[0,S]],F=(Ye,kt)=>Ye+kt[1]-kt[0],V=R.reduce(F,0),Z=O.reduce(F,0),Y=b-V,te=S-Z;let se=0,Te=V,de=0,ge=Z,De=0,je=Y,et=0,dt=te;if(_.content&&o){const Ye=_.content,kt=Ye[2]-Ye[0],jt=Ye[3]-Ye[1];(_.textFitWidth||_.textFitHeight)&&(I=Vd(n)),se=Ws(R,0,Ye[0]),de=Ws(O,0,Ye[1]),Te=Ws(R,Ye[0],Ye[2]),ge=Ws(O,Ye[1],Ye[3]),De=Ye[0]-se,et=Ye[1]-de,je=kt-Te,dt=jt-ge}const ot=I.x1,ut=I.y1,Ct=I.x2-ot,ct=I.y2-ut,ht=(Ye,kt,jt,Dt)=>{const St=ad(Ye.stretch-se,Te,Ct,ot),ti=Yu(Ye.fixed-De,je,Ye.stretch,V),ea=ad(kt.stretch-de,ge,ct,ut),Ea=Yu(kt.fixed-et,dt,kt.stretch,Z),dn=ad(jt.stretch-se,Te,Ct,ot),ur=Yu(jt.fixed-De,je,jt.stretch,V),La=ad(Dt.stretch-de,ge,ct,ut),ha=Yu(Dt.fixed-et,dt,Dt.stretch,Z),Ri=new B(St,ea),wa=new B(dn,ea),Aa=new B(dn,La),da=new B(St,La),Un=new B(ti/v,Ea/v),Er=new B(ur/v,ha/v),Sa=t*Math.PI/180;if(Sa){const Ca=Math.sin(Sa),$a=Math.cos(Sa),Ba=[$a,-Ca,Ca,$a];Ri._matMult(Ba),wa._matMult(Ba),da._matMult(Ba),Aa._matMult(Ba)}const hr=Ye.stretch+Ye.fixed,Oa=kt.stretch+kt.fixed;return{tl:Ri,tr:wa,bl:da,br:Aa,tex:{x:_.paddedRect.x+1+hr,y:_.paddedRect.y+1+Oa,w:jt.stretch+jt.fixed-hr,h:Dt.stretch+Dt.fixed-Oa},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Un,pixelOffsetBR:Er,minFontScaleX:je/v/Ct,minFontScaleY:dt/v/ct,isSDF:a}};if(o&&(_.stretchX||_.stretchY)){const Ye=up(R,Y,V),kt=up(O,te,Z);for(let jt=0;jt<Ye.length-1;jt++){const Dt=Ye[jt],St=Ye[jt+1];for(let ti=0;ti<kt.length-1;ti++)d.push(ht(Dt,kt[ti],St,kt[ti+1]))}}else d.push(ht({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return d}function Ws(n,t,a){let o=0;for(const d of n)o+=Math.max(t,Math.min(a,d[1]))-Math.max(t,Math.min(a,d[0]));return o}function up(n,t,a){const o=[{fixed:-1,stretch:0}];for(const[d,_]of n){const v=o[o.length-1];o.push({fixed:d-v.stretch,stretch:v.stretch}),o.push({fixed:d-v.stretch,stretch:v.stretch+(_-d)})}return o.push({fixed:t+1,stretch:a}),o}function ad(n,t,a,o){return n/t*a+o}function Yu(n,t,a,o){return n-t*a/o}ft("Anchor",bl);class tf{constructor(t,a,o,d,_,v,b,S,I,R){var O;if(this.boxStartIndex=t.length,I){let F=v.top,V=v.bottom;const Z=v.collisionPadding;Z&&(F-=Z[1],V+=Z[3]);let Y=V-F;Y>0&&(Y=Math.max(10,Y),this.circleDiameter=Y)}else{const F=!((O=v.image)===null||O===void 0)&&O.content&&(v.image.textFitWidth||v.image.textFitHeight)?Vd(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};F.y1=F.y1*b-S[0],F.y2=F.y2*b+S[2],F.x1=F.x1*b-S[3],F.x2=F.x2*b+S[1];const V=v.collisionPadding;if(V&&(F.x1-=V[0]*b,F.y1-=V[1]*b,F.x2+=V[2]*b,F.y2+=V[3]*b),R){const Z=new B(F.x1,F.y1),Y=new B(F.x2,F.y1),te=new B(F.x1,F.y2),se=new B(F.x2,F.y2),Te=R*Math.PI/180;Z._rotate(Te),Y._rotate(Te),te._rotate(Te),se._rotate(Te),F.x1=Math.min(Z.x,Y.x,te.x,se.x),F.x2=Math.max(Z.x,Y.x,te.x,se.x),F.y1=Math.min(Z.y,Y.y,te.y,se.y),F.y2=Math.max(Z.y,Y.y,te.y,se.y)}t.emplaceBack(a.x,a.y,F.x1,F.y1,F.x2,F.y2,o,d,_)}this.boxEndIndex=t.length}}class fg{constructor(t=[],a=(o,d)=>o<d?-1:o>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:o}=this,d=a[t];for(;t>0;){const _=t-1>>1,v=a[_];if(o(d,v)>=0)break;a[t]=v,t=_}a[t]=d}_down(t){const{data:a,compare:o}=this,d=this.length>>1,_=a[t];for(;t<d;){let v=1+(t<<1);const b=v+1;if(b<this.length&&o(a[b],a[v])<0&&(v=b),o(a[v],_)>=0)break;a[t]=a[v],t=v}a[t]=_}}function Sm(n,t=1,a=!1){const o=nu.fromPoints(n[0]),d=Math.min(o.width(),o.height());let _=d/2;const v=new fg([],hp),{minX:b,minY:S,maxX:I,maxY:R}=o;if(d===0)return new B(b,S);for(let V=b;V<I;V+=d)for(let Z=S;Z<R;Z+=d)v.push(new sc(V+_,Z+_,_,n));let O=(function(V){let Z=0,Y=0,te=0;const se=V[0];for(let Te=0,de=se.length,ge=de-1;Te<de;ge=Te++){const De=se[Te],je=se[ge],et=De.x*je.y-je.x*De.y;Y+=(De.x+je.x)*et,te+=(De.y+je.y)*et,Z+=3*et}return new sc(Y/Z,te/Z,0,V)})(n),F=v.length;for(;v.length;){const V=v.pop();(V.d>O.d||!O.d)&&(O=V,a&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,F)),V.max-O.d<=t||(_=V.h/2,v.push(new sc(V.p.x-_,V.p.y-_,_,n)),v.push(new sc(V.p.x+_,V.p.y-_,_,n)),v.push(new sc(V.p.x-_,V.p.y+_,_,n)),v.push(new sc(V.p.x+_,V.p.y+_,_,n)),F+=4)}return a&&(console.log(`num probes: ${F}`),console.log(`best distance: ${O.d}`)),O.p}function hp(n,t){return t.max-n.max}function sc(n,t,a,o){this.p=new B(n,t),this.h=a,this.d=(function(d,_){let v=!1,b=1/0;for(let S=0;S<_.length;S++){const I=_[S];for(let R=0,O=I.length,F=O-1;R<O;F=R++){const V=I[R],Z=I[F];V.y>d.y!=Z.y>d.y&&d.x<(Z.x-V.x)*(d.y-V.y)/(Z.y-V.y)+V.x&&(v=!v),b=Math.min(b,Va(d,V,Z))}}return(v?1:-1)*Math.sqrt(b)})(this.p,o),this.max=this.d+this.h*Math.SQRT2}var xn;E.aE=void 0,(xn=E.aE||(E.aE={}))[xn.center=1]="center",xn[xn.left=2]="left",xn[xn.right=3]="right",xn[xn.top=4]="top",xn[xn.bottom=5]="bottom",xn[xn["top-left"]=6]="top-left",xn[xn["top-right"]=7]="top-right",xn[xn["bottom-left"]=8]="bottom-left",xn[xn["bottom-right"]=9]="bottom-right";const Tr=Number.POSITIVE_INFINITY;function af(n,t){return t[1]!==Tr?(function(a,o,d){let _=0,v=0;switch(o=Math.abs(o),d=Math.abs(d),a){case"top-right":case"top-left":case"top":v=d-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-d}switch(a){case"top-right":case"bottom-right":case"right":_=-o;break;case"top-left":case"bottom-left":case"left":_=o}return[_,v]})(n,t[0],t[1]):(function(a,o){let d=0,_=0;o<0&&(o=0);const v=o/Math.SQRT2;switch(a){case"top-right":case"top-left":_=v-7;break;case"bottom-right":case"bottom-left":_=7-v;break;case"bottom":_=7-o;break;case"top":_=o-7}switch(a){case"top-right":case"bottom-right":d=-v;break;case"top-left":case"bottom-left":d=v;break;case"left":d=o;break;case"right":d=-o}return[d,_]})(n,t[0])}function dp(n,t,a){var o;const d=n.layout,_=(o=d.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(t,{},a);if(_){const b=_.values,S=[];for(let I=0;I<b.length;I+=2){const R=S[I]=b[I],O=b[I+1].map((F=>F*ba));R.startsWith("top")?O[1]-=7:R.startsWith("bottom")&&(O[1]+=7),S[I+1]=O}return new ma(S)}const v=d.get("text-variable-anchor");if(v){let b;b=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},a)*ba,Tr]:d.get("text-offset").evaluate(t,{},a).map((I=>I*ba));const S=[];for(const I of v)S.push(I,af(I,b));return new ma(S)}return null}function nf(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mm(n,t,a,o,d,_,v,b,S,I,R,O){let F=_.textMaxSize.evaluate(t,{});F===void 0&&(F=v);const V=n.layers[0].layout,Z=V.get("icon-offset").evaluate(t,{},R),Y=Xr(a.horizontal),te=v/24,se=n.tilePixelRatio*te,Te=n.tilePixelRatio*F/24,de=n.tilePixelRatio*b,ge=n.tilePixelRatio*V.get("symbol-spacing"),De=V.get("text-padding")*n.tilePixelRatio,je=(function(jt,Dt,St,ti=1){const ea=jt.get("icon-padding").evaluate(Dt,{},St),Ea=ea&&ea.values;return[Ea[0]*ti,Ea[1]*ti,Ea[2]*ti,Ea[3]*ti]})(V,t,R,n.tilePixelRatio),et=V.get("text-max-angle")/180*Math.PI,dt=V.get("text-rotation-alignment")!=="viewport"&&V.get("symbol-placement")!=="point",ot=V.get("icon-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",ut=V.get("symbol-placement"),Ct=ge/2,ct=V.get("icon-text-fit");let ht;o&&ct!=="none"&&(n.allowVerticalPlacement&&a.vertical&&(ht=Qh(o,a.vertical,ct,V.get("icon-text-fit-padding"),Z,te)),Y&&(o=Qh(o,Y,ct,V.get("icon-text-fit-padding"),Z,te)));const Ye=R?O.line.getGranularityForZoomLevel(R.z):1,kt=(jt,Dt)=>{Dt.x<0||Dt.x>=Lt||Dt.y<0||Dt.y>=Lt||(function(St,ti,ea,Ea,dn,ur,La,ha,Ri,wa,Aa,da,Un,Er,Sa,hr,Oa,Ca,$a,Ba,Gi,Ar,ru,Vn,Pm){const oc=St.addToLineVertexArray(ti,ea);let Oo,su,Qu,wl,i=0,s=0,u=0,g=0,M=-1,z=-1;const G={};let Q=hl("");if(St.allowVerticalPlacement&&Ea.vertical){const yt=ha.layout.get("text-rotate").evaluate(Gi,{},Vn)+90;Qu=new tf(Ri,ti,wa,Aa,da,Ea.vertical,Un,Er,Sa,yt),La&&(wl=new tf(Ri,ti,wa,Aa,da,La,Oa,Ca,Sa,yt))}if(dn){const yt=ha.layout.get("icon-rotate").evaluate(Gi,{}),Gt=ha.layout.get("icon-text-fit")!=="none",ri=wm(dn,yt,ru,Gt),si=La?wm(La,yt,ru,Gt):void 0;su=new tf(Ri,ti,wa,Aa,da,dn,Oa,Ca,!1,yt),i=4*ri.length;const Cr=St.iconSizeData;let Bo=null;Cr.kind==="source"?(Bo=[Hs*ha.layout.get("icon-size").evaluate(Gi,{})],Bo[0]>cr&&qi(`${St.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Cr.kind==="composite"&&(Bo=[Hs*Ar.compositeIconSizes[0].evaluate(Gi,{},Vn),Hs*Ar.compositeIconSizes[1].evaluate(Gi,{},Vn)],(Bo[0]>cr||Bo[1]>cr)&&qi(`${St.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),St.addSymbols(St.icon,ri,Bo,Ba,$a,Gi,E.ao.none,ti,oc.lineStartIndex,oc.lineLength,-1,Vn),M=St.icon.placedSymbolArray.length-1,si&&(s=4*si.length,St.addSymbols(St.icon,si,Bo,Ba,$a,Gi,E.ao.vertical,ti,oc.lineStartIndex,oc.lineLength,-1,Vn),z=St.icon.placedSymbolArray.length-1)}const _e=Object.keys(Ea.horizontal);for(const yt of _e){const Gt=Ea.horizontal[yt];if(!Oo){Q=hl(Gt.text);const si=ha.layout.get("text-rotate").evaluate(Gi,{},Vn);Oo=new tf(Ri,ti,wa,Aa,da,Gt,Un,Er,Sa,si)}const ri=Gt.positionedLines.length===1;if(u+=Wu(St,ti,Gt,ur,ha,Sa,Gi,hr,oc,Ea.vertical?E.ao.horizontal:E.ao.horizontalOnly,ri?_e:[yt],G,M,Ar,Vn),ri)break}Ea.vertical&&(g+=Wu(St,ti,Ea.vertical,ur,ha,Sa,Gi,hr,oc,E.ao.vertical,["vertical"],G,z,Ar,Vn));const Ne=Oo?Oo.boxStartIndex:St.collisionBoxArray.length,We=Oo?Oo.boxEndIndex:St.collisionBoxArray.length,it=Qu?Qu.boxStartIndex:St.collisionBoxArray.length,Ge=Qu?Qu.boxEndIndex:St.collisionBoxArray.length,qe=su?su.boxStartIndex:St.collisionBoxArray.length,zt=su?su.boxEndIndex:St.collisionBoxArray.length,Zt=wl?wl.boxStartIndex:St.collisionBoxArray.length,ta=wl?wl.boxEndIndex:St.collisionBoxArray.length;let ze=-1;const Me=(yt,Gt)=>yt&&yt.circleDiameter?Math.max(yt.circleDiameter,Gt):Gt;ze=Me(Oo,ze),ze=Me(Qu,ze),ze=Me(su,ze),ze=Me(wl,ze);const Be=ze>-1?1:0;Be&&(ze*=Pm/ba),St.glyphOffsetArray.length>=nc.MAX_GLYPHS&&qi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Gi.sortKey!==void 0&&St.addToSortKeyRanges(St.symbolInstances.length,Gi.sortKey);const Je=dp(ha,Gi,Vn),[Ot,Bi]=(function(yt,Gt){const ri=yt.length,si=Gt?.values;if(si?.length>0)for(let Cr=0;Cr<si.length;Cr+=2){const Bo=si[Cr+1];yt.emplaceBack(E.aE[si[Cr]],Bo[0],Bo[1])}return[ri,yt.length]})(St.textAnchorOffsets,Je);St.symbolInstances.emplaceBack(ti.x,ti.y,G.right>=0?G.right:-1,G.center>=0?G.center:-1,G.left>=0?G.left:-1,G.vertical||-1,M,z,Q,Ne,We,it,Ge,qe,zt,Zt,ta,wa,u,g,i,s,Be,0,Un,ze,Ot,Bi)})(n,Dt,jt,a,o,d,ht,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,se,[De,De,De,De],dt,S,de,je,ot,Z,t,_,I,R,v)};if(ut==="line")for(const jt of lp(t.geometry,0,0,Lt,Lt)){const Dt=Kl(jt,Ye),St=xm(Dt,ge,et,a.vertical||Y,o,24,Te,n.overscaling,Lt);for(const ti of St)Y&&Tm(n,Y.text,Ct,ti)||kt(Dt,ti)}else if(ut==="line-center"){for(const jt of t.geometry)if(jt.length>1){const Dt=Kl(jt,Ye),St=dg(Dt,et,a.vertical||Y,o,24,Te);St&&kt(Dt,St)}}else if(t.type==="Polygon")for(const jt of wc(t.geometry,0)){const Dt=Sm(jt,16);kt(Kl(jt[0],Ye,!0),new bl(Dt.x,Dt.y,0))}else if(t.type==="LineString")for(const jt of t.geometry){const Dt=Kl(jt,Ye);kt(Dt,new bl(Dt[0].x,Dt[0].y,0))}else if(t.type==="Point")for(const jt of t.geometry)for(const Dt of jt)kt([Dt],new bl(Dt.x,Dt.y,0))}function Wu(n,t,a,o,d,_,v,b,S,I,R,O,F,V,Z){const Y=(function(Te,de,ge,De,je,et,dt,ot){const ut=De.layout.get("text-rotate").evaluate(et,{})*Math.PI/180,Ct=[];for(const ct of de.positionedLines)for(const ht of ct.positionedGlyphs){if(!ht.rect)continue;const Ye=ht.rect||{};let kt=4,jt=!0,Dt=1,St=0;const ti=(je||ot)&&ht.vertical,ea=ht.metrics.advance*ht.scale/2;if(ot&&de.verticalizable&&(St=ct.lineOffset/2-(ht.imageName?-(ba-ht.metrics.width*ht.scale)/2:(ht.scale-1)*ba)),ht.imageName){const Ca=dt[ht.imageName];jt=Ca.sdf,Dt=Ca.pixelRatio,kt=1/Dt}const Ea=je?[ht.x+ea,ht.y]:[0,0];let dn=je?[0,0]:[ht.x+ea+ge[0],ht.y+ge[1]-St],ur=[0,0];ti&&(ur=dn,dn=[0,0]);const La=ht.metrics.isDoubleResolution?2:1,ha=(ht.metrics.left-kt)*ht.scale-ea+dn[0],Ri=(-ht.metrics.top-kt)*ht.scale+dn[1],wa=ha+Ye.w/La*ht.scale/Dt,Aa=Ri+Ye.h/La*ht.scale/Dt,da=new B(ha,Ri),Un=new B(wa,Ri),Er=new B(ha,Aa),Sa=new B(wa,Aa);if(ti){const Ca=new B(-ea,ea- -17),$a=-Math.PI/2,Ba=12-ea,Gi=new B(22-Ba,-(ht.imageName?Ba:0)),Ar=new B(...ur);da._rotateAround($a,Ca)._add(Gi)._add(Ar),Un._rotateAround($a,Ca)._add(Gi)._add(Ar),Er._rotateAround($a,Ca)._add(Gi)._add(Ar),Sa._rotateAround($a,Ca)._add(Gi)._add(Ar)}if(ut){const Ca=Math.sin(ut),$a=Math.cos(ut),Ba=[$a,-Ca,Ca,$a];da._matMult(Ba),Un._matMult(Ba),Er._matMult(Ba),Sa._matMult(Ba)}const hr=new B(0,0),Oa=new B(0,0);Ct.push({tl:da,tr:Un,bl:Er,br:Sa,tex:Ye,writingMode:de.writingMode,glyphOffset:Ea,sectionIndex:ht.sectionIndex,isSDF:jt,pixelOffsetTL:hr,pixelOffsetBR:Oa,minFontScaleX:0,minFontScaleY:0})}return Ct})(0,a,b,d,_,v,o,n.allowVerticalPlacement),te=n.textSizeData;let se=null;te.kind==="source"?(se=[Hs*d.layout.get("text-size").evaluate(v,{})],se[0]>cr&&qi(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):te.kind==="composite"&&(se=[Hs*V.compositeTextSizes[0].evaluate(v,{},Z),Hs*V.compositeTextSizes[1].evaluate(v,{},Z)],(se[0]>cr||se[1]>cr)&&qi(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,Y,se,b,_,v,I,t,S.lineStartIndex,S.lineLength,F,Z);for(const Te of R)O[Te]=n.text.placedSymbolArray.length-1;return 4*Y.length}function Xr(n){for(const t in n)return n[t];return null}function Tm(n,t,a,o){const d=n.compareText;if(t in d){const _=d[t];for(let v=_.length-1;v>=0;v--)if(o.dist(_[v])<a)return!0}else d[t]=[];return d[t].push(o),!1}const nd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Qs{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,o]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=o>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const _=nd[15&o];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new Qs(b,v,_,t)}constructor(t,a=64,o=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const _=nd.indexOf(this.ArrayType),v=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${o}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+v+b+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=a,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return fp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,o,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:b}=this,S=[0,_.length-1,0],I=[];for(;S.length;){const R=S.pop()||0,O=S.pop()||0,F=S.pop()||0;if(O-F<=b){for(let te=F;te<=O;te++){const se=v[2*te],Te=v[2*te+1];se>=t&&se<=o&&Te>=a&&Te<=d&&I.push(_[te])}continue}const V=F+O>>1,Z=v[2*V],Y=v[2*V+1];Z>=t&&Z<=o&&Y>=a&&Y<=d&&I.push(_[V]),(R===0?t<=Z:a<=Y)&&(S.push(F),S.push(V-1),S.push(1-R)),(R===0?o>=Z:d>=Y)&&(S.push(V+1),S.push(O),S.push(1-R))}return I}within(t,a,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:_,nodeSize:v}=this,b=[0,d.length-1,0],S=[],I=o*o;for(;b.length;){const R=b.pop()||0,O=b.pop()||0,F=b.pop()||0;if(O-F<=v){for(let te=F;te<=O;te++)Am(_[2*te],_[2*te+1],t,a)<=I&&S.push(d[te]);continue}const V=F+O>>1,Z=_[2*V],Y=_[2*V+1];Am(Z,Y,t,a)<=I&&S.push(d[V]),(R===0?t-o<=Z:a-o<=Y)&&(b.push(F),b.push(V-1),b.push(1-R)),(R===0?t+o>=Z:a+o>=Y)&&(b.push(V+1),b.push(O),b.push(1-R))}return S}}function fp(n,t,a,o,d,_){if(d-o<=a)return;const v=o+d>>1;Em(n,t,v,o,d,_),fp(n,t,a,o,v-1,1-_),fp(n,t,a,v+1,d,1-_)}function Em(n,t,a,o,d,_){for(;d>o;){if(d-o>600){const I=d-o+1,R=a-o+1,O=Math.log(I),F=.5*Math.exp(2*O/3),V=.5*Math.sqrt(O*F*(I-F)/I)*(R-I/2<0?-1:1);Em(n,t,a,Math.max(o,Math.floor(a-R*F/I+V)),Math.min(d,Math.floor(a+(I-R)*F/I+V)),_)}const v=t[2*a+_];let b=o,S=d;for(Lo(n,t,o,a),t[2*d+_]>v&&Lo(n,t,o,d);b<S;){for(Lo(n,t,b,S),b++,S--;t[2*b+_]<v;)b++;for(;t[2*S+_]>v;)S--}t[2*o+_]===v?Lo(n,t,o,S):(S++,Lo(n,t,S,d)),S<=a&&(o=S+1),a<=S&&(d=S-1)}}function Lo(n,t,a,o){rf(n,a,o),rf(t,2*a,2*o),rf(t,2*a+1,2*o+1)}function rf(n,t,a){const o=n[t];n[t]=n[a],n[a]=o}function Am(n,t,a,o){const d=n-a,_=t-o;return d*d+_*_}var pp;E.cx=void 0,(pp=E.cx||(E.cx={})).create="create",pp.load="load",pp.fullLoad="fullLoad";let sf=null,rd=[];const mp=1e3/60,gp="loadTime",_p="fullLoadTime",Cm={mark(n){performance.mark(n)},frame(n){const t=n;sf!=null&&rd.push(t-sf),sf=t},clearMetrics(){sf=null,rd=[],performance.clearMeasures(gp),performance.clearMeasures(_p);for(const n in E.cx)performance.clearMarks(E.cx[n])},getPerformanceMetrics(){performance.measure(gp,E.cx.create,E.cx.load),performance.measure(_p,E.cx.create,E.cx.fullLoad);const n=performance.getEntriesByName(gp)[0].duration,t=performance.getEntriesByName(_p)[0].duration,a=rd.length,o=1/(rd.reduce(((_,v)=>_+v),0)/a/1e3),d=rd.filter((_=>_>mp)).reduce(((_,v)=>_+(v-mp)/mp),0);return{loadTime:n,fullLoadTime:t,fps:o,percentDroppedFrames:d/(a+d)*100,totalFrames:a}}};E.$=Lt,E.A=He,E.B=function([n,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:n*Math.cos(t)*Math.sin(a),y:n*Math.sin(t)*Math.sin(a),z:n*Math.cos(a)}},E.C=gr,E.D=vt,E.E=It,E.F=Li,E.G=Cu,E.H=Ks,E.I=$f,E.J=class{constructor(n,t){this.target=n,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new gm((()=>this.process())),this.subscription=Na(this.target,"message",(a=>this.receive(a)),!1),this.globalScope=fr(self)?n:window}registerMessageHandler(n,t){this.messageHandlers[n]=t}sendAsync(n,t){return new Promise(((a,o)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=t?Na(t.signal,"abort",(()=>{_?.unsubscribe(),delete this.resolveRejects[d];const S={id:d,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)}),xi):null;this.resolveRejects[d]={resolve:S=>{_?.unsubscribe(),a(S)},reject:S=>{_?.unsubscribe(),o(S)}};const v=[],b=Object.assign(Object.assign({},n),{id:d,sourceMapId:this.mapId,origin:location.origin,data:xo(n.data,v)});this.target.postMessage(b,{transfer:v})}))}receive(n){const t=n.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const o=this.abortControllers[a];return delete this.abortControllers[a],void(o&&o.abort())}if(fr(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),t=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(n,t)}processTask(n,t){return l(this,void 0,void 0,(function*(){if(t.type==="<response>"){const d=this.resolveRejects[n];return delete this.resolveRejects[n],d?void(t.error?d.reject(bo(t.error)):d.resolve(bo(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=bo(t.data),o=new AbortController;this.abortControllers[n]=o;try{const d=yield this.messageHandlers[t.type](t.sourceMapId,a,o);this.completeTask(n,null,d)}catch(d){this.completeTask(n,d)}}))}completeTask(n,t,a){const o=[];delete this.abortControllers[n];const d={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?xo(t):null,data:xo(a,o)};this.target.postMessage(d,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.K=fe,E.L=function(){var n=new He(16);return He!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},E.M=function(n,t,a){var o,d,_,v,b,S,I,R,O,F,V,Z,Y=a[0],te=a[1],se=a[2];return t===n?(n[12]=t[0]*Y+t[4]*te+t[8]*se+t[12],n[13]=t[1]*Y+t[5]*te+t[9]*se+t[13],n[14]=t[2]*Y+t[6]*te+t[10]*se+t[14],n[15]=t[3]*Y+t[7]*te+t[11]*se+t[15]):(d=t[1],_=t[2],v=t[3],b=t[4],S=t[5],I=t[6],R=t[7],O=t[8],F=t[9],V=t[10],Z=t[11],n[0]=o=t[0],n[1]=d,n[2]=_,n[3]=v,n[4]=b,n[5]=S,n[6]=I,n[7]=R,n[8]=O,n[9]=F,n[10]=V,n[11]=Z,n[12]=o*Y+b*te+O*se+t[12],n[13]=d*Y+S*te+F*se+t[13],n[14]=_*Y+I*te+V*se+t[14],n[15]=v*Y+R*te+Z*se+t[15]),n},E.N=function(n,t,a){var o=a[0],d=a[1],_=a[2];return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=t[3]*o,n[4]=t[4]*d,n[5]=t[5]*d,n[6]=t[6]*d,n[7]=t[7]*d,n[8]=t[8]*_,n[9]=t[9]*_,n[10]=t[10]*_,n[11]=t[11]*_,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},E.O=function(n,t,a){var o=t[0],d=t[1],_=t[2],v=t[3],b=t[4],S=t[5],I=t[6],R=t[7],O=t[8],F=t[9],V=t[10],Z=t[11],Y=t[12],te=t[13],se=t[14],Te=t[15],de=a[0],ge=a[1],De=a[2],je=a[3];return n[0]=de*o+ge*b+De*O+je*Y,n[1]=de*d+ge*S+De*F+je*te,n[2]=de*_+ge*I+De*V+je*se,n[3]=de*v+ge*R+De*Z+je*Te,n[4]=(de=a[4])*o+(ge=a[5])*b+(De=a[6])*O+(je=a[7])*Y,n[5]=de*d+ge*S+De*F+je*te,n[6]=de*_+ge*I+De*V+je*se,n[7]=de*v+ge*R+De*Z+je*Te,n[8]=(de=a[8])*o+(ge=a[9])*b+(De=a[10])*O+(je=a[11])*Y,n[9]=de*d+ge*S+De*F+je*te,n[10]=de*_+ge*I+De*V+je*se,n[11]=de*v+ge*R+De*Z+je*Te,n[12]=(de=a[12])*o+(ge=a[13])*b+(De=a[14])*O+(je=a[15])*Y,n[13]=de*d+ge*S+De*F+je*te,n[14]=de*_+ge*I+De*V+je*se,n[15]=de*v+ge*R+De*Z+je*Te,n},E.P=B,E.Q=function(n,t){const a={};for(let o=0;o<t.length;o++){const d=t[o];d in n&&(a[d]=n[d])}return a},E.R=zn,E.S=Ys,E.T=Lu,E.U=Xu,E.V=Xd,E.W=Pe,E.X=Fe,E.Y=Go,E.Z=di,E._=l,E.a=H,E.a$=Ma,E.a0=function(n,t){var a,o,d,_,v;if(!n)return t??{};if(!t)return n;let b=Object.assign({},n);if(t.removeAll&&(b={removeAll:!0}),t.remove){const S=new Set(t.remove);b.add&&(b.add=b.add.filter((R=>!S.has(R.id)))),b.update&&(b.update=b.update.filter((R=>!S.has(R.id))));const I=new Set(((a=n.add)!==null&&a!==void 0?a:[]).map((R=>R.id)));t.remove=t.remove.filter((R=>!I.has(R)))}if(t.remove){const S=new Set(b.remove?b.remove.concat(t.remove):t.remove);b.remove=Array.from(S.values())}if(t.add){const S=b.add?b.add.concat(t.add):t.add,I=new Map(S.map((R=>[R.id,R])));b.add=Array.from(I.values())}if(t.update){const S=new Map((o=b.update)===null||o===void 0?void 0:o.map((I=>[I.id,I])));for(const I of t.update){const R=(d=S.get(I.id))!==null&&d!==void 0?d:{id:I.id};I.newGeometry&&(R.newGeometry=I.newGeometry),I.addOrUpdateProperties&&(R.addOrUpdateProperties=((_=R.addOrUpdateProperties)!==null&&_!==void 0?_:[]).concat(I.addOrUpdateProperties)),I.removeProperties&&(R.removeProperties=((v=R.removeProperties)!==null&&v!==void 0?v:[]).concat(I.removeProperties)),I.removeAllProperties&&(R.removeAllProperties=!0),S.set(I.id,R)}b.update=Array.from(S.values())}return b.remove&&b.add&&(b.remove=b.remove.filter((S=>b.add.findIndex((I=>I.id===S))===-1))),b},E.a1=id,E.a2=nu,E.a3=25,E.a4=Yd,E.a5=n=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((a=>{t.onloadstart=()=>{a(t)};for(const o of n){const d=window.document.createElement("source");Ee(o)||(t.crossOrigin="Anonymous"),d.src=o,t.appendChild(d)}}))},E.a6=tt,E.a7=function(){return Pi++},E.a8=j,E.a9=nc,E.aA=function(n){let t=1/0,a=1/0,o=-1/0,d=-1/0;for(const _ of n)t=Math.min(t,_.x),a=Math.min(a,_.y),o=Math.max(o,_.x),d=Math.max(d,_.y);return[t,a,o,d]},E.aB=ba,E.aC=Si,E.aD=function(n,t,a,o,d=!1){if(!a[0]&&!a[1])return[0,0];const _=d?o==="map"?-n.bearingInRadians:0:o==="viewport"?n.bearingInRadians:0;if(_){const v=Math.sin(_),b=Math.cos(_);a=[a[0]*b-a[1]*v,a[0]*v+a[1]*b]}return[d?a[0]:Si(t,a[0],n.zoom),d?a[1]:Si(t,a[1],n.zoom)]},E.aF=au,E.aG=nf,E.aH=Wh,E.aI=Qs,E.aJ=Oi,E.aK=Yc,E.aL=ye,E.aM=ni,E.aN=Ai,E.aO=gi,E.aP=Zn,E.aQ=rp,E.aR=mi,E.aS=Vt,E.aT=function(n){var t=new He(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},E.aU=function(n,t,a){return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],n},E.aV=function(n,t){var a=t[0],o=t[1],d=t[2],_=a*a+o*o+d*d;return _>0&&(_=1/Math.sqrt(_)),n[0]=t[0]*_,n[1]=t[1]*_,n[2]=t[2]*_,n},E.aW=wi,E.aX=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]},E.aY=function(n,t,a){return n[0]=t[0]*a[0],n[1]=t[1]*a[1],n[2]=t[2]*a[2],n[3]=t[3]*a[3],n},E.aZ=_t,E.a_=function(n,t,a){const o=t[0]*a[0]+t[1]*a[1]+t[2]*a[2];return o===0?null:(-(n[0]*a[0]+n[1]*a[1]+n[2]*a[2])-a[3])/o},E.aa=Ln,E.ab=Zr,E.ac=ym,E.ad=function(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((a,o,d,_)=>{const v=d||_;return t[o]=!v||v.toLowerCase(),""})),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},E.ae=dc,E.af=function(n){return Math.pow(2,n)},E.ag=Mt,E.ah=Ft,E.ai=85.051129,E.aj=td,E.ak=function(n){return Math.log(n)/Math.LN2},E.al=function(n){var t=n[0],a=n[1];return t*t+a*a},E.am=function(n){if(!n.length)return new Set;const t=Math.max(...n.map((S=>S.canonical.z)));let a=1/0,o=-1/0,d=1/0,_=-1/0;const v=[];for(const S of n){const{x:I,y:R,z:O}=S.canonical,F=Math.pow(2,t-O),V=I*F,Z=R*F;v.push({id:S,x:V,y:Z}),V<a&&(a=V),V>o&&(o=V),Z<d&&(d=Z),Z>_&&(_=Z)}const b=new Set;for(const S of v)S.x!==a&&S.x!==o&&S.y!==d&&S.y!==_||b.add(S.id);return b},E.an=function(n,t){let a=0,o=0;if(n.kind==="constant")o=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:d,minZoom:_,maxZoom:v}=n,b=d?Ft(Ua.interpolationFactor(d,t,_,v),0,1):0;n.kind==="camera"?o=gr.number(n.minSize,n.maxSize,b):a=b}return{uSizeT:a,uSize:o}},E.ap=function(n,{uSize:t,uSizeT:a},{lowerSize:o,upperSize:d}){return n.kind==="source"?o/Hs:n.kind==="composite"?gr.number(o/Hs,d/Hs,a):t},E.aq=function(n,t){var a=t[0],o=t[1],d=t[2],_=t[3],v=t[4],b=t[5],S=t[6],I=t[7],R=t[8],O=t[9],F=t[10],V=t[11],Z=t[12],Y=t[13],te=t[14],se=t[15],Te=a*b-o*v,de=a*S-d*v,ge=a*I-_*v,De=o*S-d*b,je=o*I-_*b,et=d*I-_*S,dt=R*Y-O*Z,ot=R*te-F*Z,ut=R*se-V*Z,Ct=O*te-F*Y,ct=O*se-V*Y,ht=F*se-V*te,Ye=Te*ht-de*ct+ge*Ct+De*ut-je*ot+et*dt;return Ye?(n[0]=(b*ht-S*ct+I*Ct)*(Ye=1/Ye),n[1]=(d*ct-o*ht-_*Ct)*Ye,n[2]=(Y*et-te*je+se*De)*Ye,n[3]=(F*je-O*et-V*De)*Ye,n[4]=(S*ut-v*ht-I*ot)*Ye,n[5]=(a*ht-d*ut+_*ot)*Ye,n[6]=(te*ge-Z*et-se*de)*Ye,n[7]=(R*et-F*ge+V*de)*Ye,n[8]=(v*ct-b*ut+I*dt)*Ye,n[9]=(o*ut-a*ct-_*dt)*Ye,n[10]=(Z*je-Y*ge+se*Te)*Ye,n[11]=(O*ge-R*je-V*Te)*Ye,n[12]=(b*ot-v*Ct-S*dt)*Ye,n[13]=(a*Ct-o*ot+d*dt)*Ye,n[14]=(Y*de-Z*De-te*Te)*Ye,n[15]=(R*De-O*de+F*Te)*Ye,n):null},E.ar=gt,E.as=function(n){var t=n[0],a=n[1];return Math.sqrt(t*t+a*a)},E.at=function(n){return n[0]=0,n[1]=0,n},E.au=function(n,t,a){return n[0]=t[0]*a,n[1]=t[1]*a,n},E.av=qd,E.aw=In,E.ax=function(n,t,a,o){const d=t.y-n.y,_=t.x-n.x,v=o.y-a.y,b=o.x-a.x,S=v*_-b*d;if(S===0)return null;const I=(b*(n.y-a.y)-v*(n.x-a.x))/S;return new B(n.x+I*_,n.y+I*d)},E.ay=lp,E.az=Rh,E.b=wn,E.b$=class extends Nn{constructor(n,t){super(n,t),this.current=new Array}set(n){if(n!=this.current){this.current=n;const t=new Float32Array(n);this.gl.uniform1fv(this.location,t)}}},E.b0=function(n,t,a){return n[0]=t[0]*a,n[1]=t[1]*a,n[2]=t[2]*a,n[3]=t[3]*a,n},E.b1=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]},E.b2=sp,E.b3=rc,E.b4=function(n,t,a,o,d){var _=1/Math.tan(t/2);if(n[0]=_/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=_,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,d!=null&&d!==1/0){var v=1/(o-d);n[10]=(d+o)*v,n[14]=2*d*o*v}else n[10]=-1,n[14]=-2*o;return n},E.b5=function(n){var t=new He(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},E.b6=function(n,t,a){var o=Math.sin(a),d=Math.cos(a),_=t[0],v=t[1],b=t[2],S=t[3],I=t[4],R=t[5],O=t[6],F=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=_*d+I*o,n[1]=v*d+R*o,n[2]=b*d+O*o,n[3]=S*d+F*o,n[4]=I*d-_*o,n[5]=R*d-v*o,n[6]=O*d-b*o,n[7]=F*d-S*o,n},E.b7=function(n,t,a){var o=Math.sin(a),d=Math.cos(a),_=t[4],v=t[5],b=t[6],S=t[7],I=t[8],R=t[9],O=t[10],F=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=_*d+I*o,n[5]=v*d+R*o,n[6]=b*d+O*o,n[7]=S*d+F*o,n[8]=I*d-_*o,n[9]=R*d-v*o,n[10]=O*d-b*o,n[11]=F*d-S*o,n},E.b8=function(){const n=new Float32Array(16);return Mt(n),n},E.b9=function(){const n=new Float64Array(16);return Mt(n),n},E.bA=function(n,t){const a=be(n,360),o=be(t,360),d=o-a,_=o>a?d-360:d+360;return Math.abs(d)<Math.abs(_)?d:_},E.bB=function(n){return n[0]=0,n[1]=0,n[2]=0,n},E.bC=function(n,t,a,o){const d=Math.sqrt(n*n+t*t),_=Math.sqrt(a*a+o*o);n/=d,t/=d,a/=_,o/=_;const v=Math.acos(n*a+t*o);return-t*a+n*o>0?v:-v},E.bD=function(n,t){const a=be(n,2*Math.PI),o=be(t,2*Math.PI);return Math.min(Math.abs(a-o),Math.abs(a-o+2*Math.PI),Math.abs(a-o-2*Math.PI))},E.bE=function(){const n={},t=Ae.$version;for(const a in Ae.$root){const o=Ae.$root[a];if(o.required){let d=null;d=a==="version"?t:o.type==="array"?[]:{},d!=null&&(n[a]=d)}}return n},E.bF=sl,E.bG=xe,E.bH=function n(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(!n(t[o],a[o]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const o in t)if(!n(t[o],a[o]))return!1;return!0}return t===a},E.bI=function(n){n=n.slice();const t=Object.create(null);for(let a=0;a<n.length;a++)t[n[a].id]=n[a];for(let a=0;a<n.length;a++)"ref"in n[a]&&(n[a]=fi(n[a],t[n[a].ref]));return n},E.bJ=function(n,t){if(n.type==="custom")return new hg(n,t);switch(n.type){case"background":return new Jh(n,t);case"circle":return new Af(n,t);case"color-relief":return new eg(n,t);case"fill":return new Gu(n,t);case"fill-extrusion":return new Uu(n,t);case"heatmap":return new Pf(n,t);case"hillshade":return new pl(n,t);case"line":return new Nd(n,t);case"raster":return new Eo(n,t);case"symbol":return new Hu(n,t)}},E.bK=n=>n.type==="raster",E.bL=bn,E.bM=function(n,t){if(!n)return[{command:"setStyle",args:[t]}];let a=[];try{if(!Tt(n.version,t.version))return[{command:"setStyle",args:[t]}];Tt(n.center,t.center)||a.push({command:"setCenter",args:[t.center]}),Tt(n.state,t.state)||a.push({command:"setGlobalState",args:[t.state]}),Tt(n.centerAltitude,t.centerAltitude)||a.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Tt(n.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),Tt(n.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),Tt(n.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),Tt(n.roll,t.roll)||a.push({command:"setRoll",args:[t.roll]}),Tt(n.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),Tt(n.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),Tt(n.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),Tt(n.light,t.light)||a.push({command:"setLight",args:[t.light]}),Tt(n.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),Tt(n.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),Tt(n.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const o={},d=[];(function(v,b,S,I){let R;for(R in b=b||{},v=v||{})Object.prototype.hasOwnProperty.call(v,R)&&(Object.prototype.hasOwnProperty.call(b,R)||pa(R,S,I));for(R in b)Object.prototype.hasOwnProperty.call(b,R)&&(Object.prototype.hasOwnProperty.call(v,R)?Tt(v[R],b[R])||(v[R].type==="geojson"&&b[R].type==="geojson"&&Ya(v,b,R)?ui(S,{command:"setGeoJSONSourceData",args:[R,b[R].data]}):Pa(R,b,S,I)):Ta(R,b,S))})(n.sources,t.sources,d,o);const _=[];n.layers&&n.layers.forEach((v=>{"source"in v&&o[v.source]?a.push({command:"removeLayer",args:[v.id]}):_.push(v)})),a=a.concat(d),(function(v,b,S){b=b||[];const I=(v=v||[]).map(za),R=b.map(za),O=v.reduce(Mi,{}),F=b.reduce(Mi,{}),V=I.slice(),Z=Object.create(null);let Y,te,se,Te,de;for(let ge=0,De=0;ge<I.length;ge++)Y=I[ge],Object.prototype.hasOwnProperty.call(F,Y)?De++:(ui(S,{command:"removeLayer",args:[Y]}),V.splice(V.indexOf(Y,De),1));for(let ge=0,De=0;ge<R.length;ge++)Y=R[R.length-1-ge],V[V.length-1-ge]!==Y&&(Object.prototype.hasOwnProperty.call(O,Y)?(ui(S,{command:"removeLayer",args:[Y]}),V.splice(V.lastIndexOf(Y,V.length-De),1)):De++,Te=V[V.length-ge],ui(S,{command:"addLayer",args:[F[Y],Te]}),V.splice(V.length-ge,0,Y),Z[Y]=!0);for(let ge=0;ge<R.length;ge++)if(Y=R[ge],te=O[Y],se=F[Y],!Z[Y]&&!Tt(te,se))if(Tt(te.source,se.source)&&Tt(te["source-layer"],se["source-layer"])&&Tt(te.type,se.type)){for(de in Ni(te.layout,se.layout,S,Y,null,"setLayoutProperty"),Ni(te.paint,se.paint,S,Y,null,"setPaintProperty"),Tt(te.filter,se.filter)||ui(S,{command:"setFilter",args:[Y,se.filter]}),Tt(te.minzoom,se.minzoom)&&Tt(te.maxzoom,se.maxzoom)||ui(S,{command:"setLayerZoomRange",args:[Y,se.minzoom,se.maxzoom]}),te)Object.prototype.hasOwnProperty.call(te,de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?Ni(te[de],se[de],S,Y,de.slice(6),"setPaintProperty"):Tt(te[de],se[de])||ui(S,{command:"setLayerProperty",args:[Y,de,se[de]]}));for(de in se)Object.prototype.hasOwnProperty.call(se,de)&&!Object.prototype.hasOwnProperty.call(te,de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?Ni(te[de],se[de],S,Y,de.slice(6),"setPaintProperty"):Tt(te[de],se[de])||ui(S,{command:"setLayerProperty",args:[Y,de,se[de]]}))}else ui(S,{command:"removeLayer",args:[Y]}),Te=V[V.lastIndexOf(Y)+1],ui(S,{command:"addLayer",args:[se,Te]})})(_,t.layers,a)}catch(o){console.warn("Unable to compute style diff:",o),a=[{command:"setStyle",args:[t]}]}return a},E.bN=function(n){const t=[],a=n.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),n.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},E.bO=Qr,E.bP=bs,E.bQ=class extends Nn{constructor(n,t){super(n,t),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},E.bR=jn,E.bS=class extends Nn{constructor(n,t){super(n,t),this.current=rn}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let t=1;t<16;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},E.bT=Da,E.bU=class extends Nn{constructor(n,t){super(n,t),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},E.bV=class extends Nn{constructor(n,t){super(n,t),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},E.bW=mt,E.bX=function(n,t){var a=Math.sin(t),o=Math.cos(t);return n[0]=o,n[1]=a,n[2]=0,n[3]=-a,n[4]=o,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},E.bY=function(n,t,a){var o=t[0],d=t[1],_=t[2];return n[0]=o*a[0]+d*a[3]+_*a[6],n[1]=o*a[1]+d*a[4]+_*a[7],n[2]=o*a[2]+d*a[5]+_*a[8],n},E.bZ=function(n,t,a,o,d,_,v){var b=1/(t-a),S=1/(o-d),I=1/(_-v);return n[0]=-2*b,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*S,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*I,n[11]=0,n[12]=(t+a)*b,n[13]=(d+o)*S,n[14]=(v+_)*I,n[15]=1,n},E.b_=class extends Nn{constructor(n,t){super(n,t),this.current=new Array}set(n){if(n!=this.current){this.current=n;const t=new Float32Array(4*n.length);for(let a=0;a<n.length;a++)t[4*a]=n[a].r,t[4*a+1]=n[a].g,t[4*a+2]=n[a].b,t[4*a+3]=n[a].a;this.gl.uniform4fv(this.location,t)}}},E.ba=function(){return new Float64Array(16)},E.bb=function(n,t,a){const o=new Float64Array(4);return Xe(o,n,t-90,a),o},E.bc=function(n,t,a,o){var d,_,v,b,S,I=t[0],R=t[1],O=t[2],F=t[3],V=a[0],Z=a[1],Y=a[2],te=a[3];return(_=I*V+R*Z+O*Y+F*te)<0&&(_=-_,V=-V,Z=-Z,Y=-Y,te=-te),1-_>Ue?(d=Math.acos(_),v=Math.sin(d),b=Math.sin((1-o)*d)/v,S=Math.sin(o*d)/v):(b=1-o,S=o),n[0]=b*I+S*V,n[1]=b*R+S*Z,n[2]=b*O+S*Y,n[3]=b*F+S*te,n},E.bd=function(n){const t=new Float64Array(9);var a,o,d,_,v,b,S,I,R,O,F,V,Z,Y,te,se,Te,de;O=(d=(o=n)[0])*(S=d+d),F=(_=o[1])*S,Z=(v=o[2])*S,Y=v*(I=_+_),se=(b=o[3])*S,Te=b*I,de=b*(R=v+v),(a=t)[0]=1-(V=_*I)-(te=v*R),a[3]=F-de,a[6]=Z+Te,a[1]=F+de,a[4]=1-O-te,a[7]=Y-se,a[2]=Z-Te,a[5]=Y+se,a[8]=1-O-V;const ge=Zn(-Math.asin(Ft(t[2],-1,1)));let De,je;return Math.hypot(t[5],t[8])<.001?(De=0,je=-Zn(Math.atan2(t[3],t[4]))):(De=Zn(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),je=Zn(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:De,pitch:ge+90,bearing:je}},E.be=function(n,t){return n.roll==t.roll&&n.pitch==t.pitch&&n.bearing==t.bearing},E.bf=Jt,E.bg=ca,E.bh=un,E.bi=sr,E.bj=ju,E.bk=Ke,E.bl=pt,E.bm=Qa,E.bn=function(n,t,a,o,d){return Ke(o,d,Ft((n-t)/(a-t),0,1))},E.bo=be,E.bp=function(){return new Float64Array(3)},E.bq=function(n,t,a,o){return n[0]=t[0]+a[0]*o,n[1]=t[1]+a[1]*o,n[2]=t[2]+a[2]*o,n},E.br=Xe,E.bs=function(n,t,a){var o=a[0],d=a[1],_=a[2],v=a[3],b=t[0],S=t[1],I=t[2],R=d*I-_*S,O=_*b-o*I,F=o*S-d*b;return n[0]=b+v*(R+=R)+d*(F+=F)-_*(O+=O),n[1]=S+v*O+_*R-o*F,n[2]=I+v*F+o*O-d*R,n},E.bt=function(n,t,a){const o=(d=[n[0],n[1],n[2],t[0],t[1],t[2],a[0],a[1],a[2]])[0]*((R=d[8])*(v=d[4])-(b=d[5])*(I=d[7]))+d[1]*(-R*(_=d[3])+b*(S=d[6]))+d[2]*(I*_-v*S);var d,_,v,b,S,I,R;if(o===0)return null;const O=wi([],[t[0],t[1],t[2]],[a[0],a[1],a[2]]),F=wi([],[a[0],a[1],a[2]],[n[0],n[1],n[2]]),V=wi([],[n[0],n[1],n[2]],[t[0],t[1],t[2]]),Z=mi([],O,-n[3]);return Vt(Z,Z,mi([],F,-t[3])),Vt(Z,Z,mi([],V,-a[3])),mi(Z,Z,1/o),Z},E.bu=ed,E.bv=function(){return new Float64Array(4)},E.bw=function(n,t,a,o){var d=[],_=[];return d[0]=t[0]-a[0],d[1]=t[1]-a[1],d[2]=t[2]-a[2],_[0]=d[0]*Math.cos(o)-d[1]*Math.sin(o),_[1]=d[0]*Math.sin(o)+d[1]*Math.cos(o),_[2]=d[2],n[0]=_[0]+a[0],n[1]=_[1]+a[1],n[2]=_[2]+a[2],n},E.bx=function(n,t,a,o){var d=[],_=[];return d[0]=t[0]-a[0],d[1]=t[1]-a[1],d[2]=t[2]-a[2],_[0]=d[0],_[1]=d[1]*Math.cos(o)-d[2]*Math.sin(o),_[2]=d[1]*Math.sin(o)+d[2]*Math.cos(o),n[0]=_[0]+a[0],n[1]=_[1]+a[1],n[2]=_[2]+a[2],n},E.by=function(n,t,a,o){var d=[],_=[];return d[0]=t[0]-a[0],d[1]=t[1]-a[1],d[2]=t[2]-a[2],_[0]=d[2]*Math.sin(o)+d[0]*Math.cos(o),_[1]=d[1],_[2]=d[2]*Math.cos(o)-d[0]*Math.sin(o),n[0]=_[0]+a[0],n[1]=_[1]+a[1],n[2]=_[2]+a[2],n},E.bz=function(n,t,a){var o=Math.sin(a),d=Math.cos(a),_=t[0],v=t[1],b=t[2],S=t[3],I=t[8],R=t[9],O=t[10],F=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=_*d-I*o,n[1]=v*d-R*o,n[2]=b*d-O*o,n[3]=S*d-F*o,n[8]=_*o+I*d,n[9]=v*o+R*d,n[10]=b*o+O*d,n[11]=S*o+F*d,n},E.c=$,E.c0=class extends Iu{},E.c1=Gf,E.c2=class extends e{},E.c3=$s,E.c4=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},E.c5=Cf,E.c6=function(n,t,a){var o=t[0],d=t[1],_=t[2],v=a[3]*o+a[7]*d+a[11]*_+a[15];return n[0]=(a[0]*o+a[4]*d+a[8]*_+a[12])/(v=v||1),n[1]=(a[1]*o+a[5]*d+a[9]*_+a[13])/v,n[2]=(a[2]*o+a[6]*d+a[10]*_+a[14])/v,n},E.c7=class extends ul{},E.c8=class extends C{},E.c9=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]},E.cA=function(n,t){H.REGISTERED_PROTOCOLS[n]=t},E.cB=function(n){delete H.REGISTERED_PROTOCOLS[n]},E.cC=function(n,t){const a={};for(let d=0;d<n.length;d++){const _=t&&t[n[d].id]||Or(n[d]);t&&(t[n[d].id]=_);let v=a[_];v||(v=a[_]=[]),v.push(n[d])}const o=[];for(const d in a)o.push(a[d]);return o},E.cD=ft,E.cE=op,E.cF=Wd,E.cG=Hf,E.cH=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=Lt/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const t=n.bucket.layers[0],a=t.layout,o=t._unevaluatedLayout._values,d={layoutIconSize:o["icon-size"].possiblyEvaluate(new Li(n.bucket.zoom+1),n.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Li(n.bucket.zoom+1),n.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Li(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:R}=n.bucket.textSizeData;d.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Li(I),n.canonical),o["text-size"].possiblyEvaluate(new Li(R),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:R}=n.bucket.iconSizeData;d.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Li(I),n.canonical),o["icon-size"].possiblyEvaluate(new Li(R),n.canonical)]}const _=a.get("text-line-height")*ba,v=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",b=a.get("text-keep-upright"),S=a.get("text-size");for(const I of n.bucket.features){const R=a.get("text-font").evaluate(I,{},n.canonical).join(","),O=S.evaluate(I,{},n.canonical),F=d.layoutTextSize.evaluate(I,{},n.canonical),V=d.layoutIconSize.evaluate(I,{},n.canonical),Z={horizontal:{},vertical:void 0},Y=I.text;let te,se=[0,0];if(Y){const ge=Y.toString(),De=a.get("text-letter-spacing").evaluate(I,{},n.canonical)*ba,je=Ch(ge)?De:0,et=a.get("text-anchor").evaluate(I,{},n.canonical),dt=dp(t,I,n.canonical);if(!dt){const ct=a.get("text-radial-offset").evaluate(I,{},n.canonical);se=ct?af(et,[ct*ba,Tr]):a.get("text-offset").evaluate(I,{},n.canonical).map((ht=>ht*ba))}let ot=v?"center":a.get("text-justify").evaluate(I,{},n.canonical);const ut=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(I,{},n.canonical)*ba:1/0,Ct=()=>{n.bucket.allowVerticalPlacement&&ds(ge)&&(Z.vertical=Xh(Y,n.glyphMap,n.glyphPositions,n.imagePositions,R,ut,_,et,"left",je,se,E.ao.vertical,!0,F,O))};if(!v&&dt){const ct=new Set;if(ot==="auto")for(let Ye=0;Ye<dt.values.length;Ye+=2)ct.add(nf(dt.values[Ye]));else ct.add(ot);let ht=!1;for(const Ye of ct)if(!Z.horizontal[Ye])if(ht)Z.horizontal[Ye]=Z.horizontal[0];else{const kt=Xh(Y,n.glyphMap,n.glyphPositions,n.imagePositions,R,ut,_,"center",Ye,je,se,E.ao.horizontal,!1,F,O);kt&&(Z.horizontal[Ye]=kt,ht=kt.positionedLines.length===1)}Ct()}else{ot==="auto"&&(ot=nf(et));const ct=Xh(Y,n.glyphMap,n.glyphPositions,n.imagePositions,R,ut,_,et,ot,je,se,E.ao.horizontal,!1,F,O);ct&&(Z.horizontal[ot]=ct),Ct(),ds(ge)&&v&&b&&(Z.vertical=Xh(Y,n.glyphMap,n.glyphPositions,n.imagePositions,R,ut,_,et,ot,je,se,E.ao.vertical,!1,F,O))}}let Te=!1;if(I.icon&&I.icon.name){const ge=n.imageMap[I.icon.name];ge&&(te=$u(n.imagePositions[I.icon.name],a.get("icon-offset").evaluate(I,{},n.canonical),a.get("icon-anchor").evaluate(I,{},n.canonical)),Te=!!ge.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=Te:n.bucket.sdfIcons!==Te&&qi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ge.pixelRatio!==n.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const de=Xr(Z.horizontal)||Z.vertical;n.bucket.iconsInText=!!de&&de.iconsInText,(de||te)&&Mm(n.bucket,I,Z,te,n.imageMap,d,F,V,se,Te,n.canonical,n.subdivisionGranularity)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},E.cI=Uh,E.cJ=Wi,E.cK=eu,E.cL=Bf,E.cM=Fn,E.cN=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},E.cO=function(n,t,a,o,d){return l(this,void 0,void 0,(function*(){if(Fe())try{return yield Go(n,t,a,o,d)}catch{}return(function(_,v,b,S,I){const R=_.width,O=_.height;eo&&Kr||(eo=new OffscreenCanvas(R,O),Kr=eo.getContext("2d",{willReadFrequently:!0})),eo.width=R,eo.height=O,Kr.drawImage(_,0,0,R,O);const F=Kr.getImageData(v,b,S,I);return Kr.clearRect(0,0,R,O),F.data})(n,t,a,o,d)}))},E.cP=Ou,E.cQ=U,E.cR=Of,E.cS=Wc,E.cT=zc,E.cU=function(n,t){const a=new Map;if(n!=null)if(n.type==="Feature")a.set(Za(n,t),n);else for(const o of n.features)a.set(Za(o,t),o);return a},E.cV=function(n,t){if(n==null)return!0;if(n.type==="Feature")return Za(n,t)!=null;if(n.type==="FeatureCollection"){const a=new Set;for(const o of n.features){const d=Za(o,t);if(d==null||a.has(d))return!1;a.add(d)}return!0}return!1},E.cW=function(n,t,a){var o,d,_,v;if(t.removeAll&&n.clear(),t.remove)for(const b of t.remove)n.delete(b);if(t.add)for(const b of t.add){const S=Za(b,a);S!=null&&n.set(S,b)}if(t.update)for(const b of t.update){let S=n.get(b.id);if(S==null)continue;const I=!b.removeAllProperties&&(((o=b.removeProperties)===null||o===void 0?void 0:o.length)>0||((d=b.addOrUpdateProperties)===null||d===void 0?void 0:d.length)>0);if((b.newGeometry||b.removeAllProperties||I)&&(S=Object.assign({},S),n.set(b.id,S),I&&(S.properties=Object.assign({},S.properties))),b.newGeometry&&(S.geometry=b.newGeometry),b.removeAllProperties)S.properties={};else if(((_=b.removeProperties)===null||_===void 0?void 0:_.length)>0)for(const R of b.removeProperties)Object.prototype.hasOwnProperty.call(S.properties,R)&&delete S.properties[R];if(((v=b.addOrUpdateProperties)===null||v===void 0?void 0:v.length)>0)for(const{key:R,value:O}of b.addOrUpdateProperties)S.properties[R]=O}},E.cX=fs,E.ca=function(n,t){var a=n[0],o=n[1],d=n[2],_=n[3],v=n[4],b=n[5],S=n[6],I=n[7],R=n[8],O=n[9],F=n[10],V=n[11],Z=n[12],Y=n[13],te=n[14],se=n[15],Te=t[0],de=t[1],ge=t[2],De=t[3],je=t[4],et=t[5],dt=t[6],ot=t[7],ut=t[8],Ct=t[9],ct=t[10],ht=t[11],Ye=t[12],kt=t[13],jt=t[14],Dt=t[15];return Math.abs(a-Te)<=Ue*Math.max(1,Math.abs(a),Math.abs(Te))&&Math.abs(o-de)<=Ue*Math.max(1,Math.abs(o),Math.abs(de))&&Math.abs(d-ge)<=Ue*Math.max(1,Math.abs(d),Math.abs(ge))&&Math.abs(_-De)<=Ue*Math.max(1,Math.abs(_),Math.abs(De))&&Math.abs(v-je)<=Ue*Math.max(1,Math.abs(v),Math.abs(je))&&Math.abs(b-et)<=Ue*Math.max(1,Math.abs(b),Math.abs(et))&&Math.abs(S-dt)<=Ue*Math.max(1,Math.abs(S),Math.abs(dt))&&Math.abs(I-ot)<=Ue*Math.max(1,Math.abs(I),Math.abs(ot))&&Math.abs(R-ut)<=Ue*Math.max(1,Math.abs(R),Math.abs(ut))&&Math.abs(O-Ct)<=Ue*Math.max(1,Math.abs(O),Math.abs(Ct))&&Math.abs(F-ct)<=Ue*Math.max(1,Math.abs(F),Math.abs(ct))&&Math.abs(V-ht)<=Ue*Math.max(1,Math.abs(V),Math.abs(ht))&&Math.abs(Z-Ye)<=Ue*Math.max(1,Math.abs(Z),Math.abs(Ye))&&Math.abs(Y-kt)<=Ue*Math.max(1,Math.abs(Y),Math.abs(kt))&&Math.abs(te-jt)<=Ue*Math.max(1,Math.abs(te),Math.abs(jt))&&Math.abs(se-Dt)<=Ue*Math.max(1,Math.abs(se),Math.abs(Dt))},E.cb=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},E.cc=n=>n.type==="symbol",E.cd=n=>n.type==="circle",E.ce=n=>n.type==="heatmap",E.cf=n=>n.type==="line",E.cg=n=>n.type==="fill",E.ch=n=>n.type==="fill-extrusion",E.ci=n=>n.type==="hillshade",E.cj=n=>n.type==="color-relief",E.ck=n=>n.type==="background",E.cl=n=>n.type==="custom",E.cm=Et,E.cn=function(n,t,a){const o=Nt(t.x-a.x,t.y-a.y),d=Nt(n.x-a.x,n.y-a.y);var _,v;return Zn(Math.atan2(o[0]*d[1]-o[1]*d[0],(_=o)[0]*(v=d)[0]+_[1]*v[1]))},E.co=$t,E.cp=function(n,t){return Sn[t]&&(n instanceof MouseEvent||n instanceof WheelEvent)},E.cq=function(n,t){return ws[t]&&"touches"in n},E.cr=function(n){return ws[n]||Sn[n]},E.cs=function(n,t,a){var o=t[0],d=t[1];return n[0]=a[0]*o+a[4]*d+a[12],n[1]=a[1]*o+a[5]*d+a[13],n},E.ct=function(n,t){const{x:a,y:o}=id.fromLngLat(t);return!(n<0||n>25||o<0||o>=1||a<0||a>=1)},E.cu=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},E.cv=class extends na{},E.cw=Cm,E.cy=function(n){return n.message===we},E.cz=pe,E.d=Ee,E.e=Qi,E.f=n=>l(void 0,void 0,void 0,(function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),E.g=ie,E.h=n=>new Promise(((t,a)=>{const o=new Image;o.onload=()=>{t(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame((()=>{o.src=Js}))},o.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(n)],{type:"image/png"});o.src=n.byteLength?URL.createObjectURL(d):Js})),E.i=fr,E.j=(n,t)=>Ie(Qi(n,{type:"json"}),t),E.k=xt,E.l=$e,E.m=Ie,E.n=(n,t)=>Ie(Qi(n,{type:"arrayBuffer"}),t),E.o=function(n){return new Fn(n).readFields(Gd,[])},E.p=hm,E.q=ku,E.r=Hi,E.s=Na,E.t=Gc,E.u=Yt,E.v=Ae,E.w=qi,E.x=bf,E.y=yo,E.z=tr})),P("worker",["./shared"],(function(E){class l{constructor($,H){this.keyCache={},$&&this.replace($,H)}replace($,H){this._layerConfigs={},this._layers={},this.update($,[],H)}update($,H,ie){for(const pe of $){this._layerConfigs[pe.id]=pe;const xe=this._layers[pe.id]=E.bJ(pe,ie);xe._featureFilter=E.aa(xe.filter,ie),this.keyCache[pe.id]&&delete this.keyCache[pe.id]}for(const pe of H)delete this.keyCache[pe],delete this._layerConfigs[pe],delete this._layers[pe];this.familiesBySource={};const fe=E.cC(Object.values(this._layerConfigs),this.keyCache);for(const pe of fe){const xe=pe.map((xt=>this._layers[xt.id])),Ie=xe[0];if(Ie.visibility==="none")continue;const Ee=Ie.source||"";let Ve=this.familiesBySource[Ee];Ve||(Ve=this.familiesBySource[Ee]={});const at=Ie.sourceLayer||"_geojsonTileLayer";let $e=Ve[at];$e||($e=Ve[at]=[]),$e.push(xe)}}}class B{constructor($){const H={},ie=[];for(const Ie in $){const Ee=$[Ie],Ve=H[Ie]={};for(const at in Ee){const $e=Ee[+at];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const xt={x:0,y:0,w:$e.bitmap.width+2,h:$e.bitmap.height+2};ie.push(xt),Ve[at]={rect:xt,metrics:$e.metrics}}}const{w:fe,h:pe}=E.p(ie),xe=new E.q({width:fe||1,height:pe||1});for(const Ie in $){const Ee=$[Ie];for(const Ve in Ee){const at=Ee[+Ve];if(!at||at.bitmap.width===0||at.bitmap.height===0)continue;const $e=H[Ie][Ve].rect;E.q.copy(at.bitmap,xe,{x:0,y:0},{x:$e.x+1,y:$e.y+1},at.bitmap)}}this.image=xe,this.positions=H}}E.cD("GlyphAtlas",B);class U{constructor($){this.tileID=new E.Z($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[]}parse($,H,ie,fe,pe){return E._(this,void 0,void 0,(function*(){this.status="parsing",this.data=$,this.collisionBoxArray=new E.a8;const xe=new E.cE(Object.keys($.layers).sort()),Ie=new E.cF(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Ee={},Ve={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ie,subdivisionGranularity:pe},at=H.familiesBySource[this.source];for(const Mi in at){const tt=$.layers[Mi];if(!tt)continue;tt.version===1&&E.w(`Vector tile source "${this.source}" layer "${Mi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ir=xe.encode(Mi),Rn=[];for(let Ia=0;Ia<tt.length;Ia++){const _i=tt.feature(Ia),nt=Ie.getId(_i,Mi);Rn.push({feature:_i,id:nt,index:Ia,sourceLayerIndex:Ir})}for(const Ia of at[Mi]){const _i=Ia[0];_i.source!==this.source&&E.w(`layer.source = ${_i.source} does not equal this.source = ${this.source}`),_i.minzoom&&this.zoom<Math.floor(_i.minzoom)||_i.maxzoom&&this.zoom>=_i.maxzoom||_i.visibility!=="none"&&(ee(Ia,this.zoom,ie),(Ee[_i.id]=_i.createBucket({index:Ie.bucketLayerIDs.length,layers:Ia,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ir,sourceID:this.source})).populate(Rn,Ve,this.tileID.canonical),Ie.bucketLayerIDs.push(Ia.map((nt=>nt.id))))}}const $e=E.bO(Ve.glyphDependencies,(Mi=>Object.keys(Mi).map(Number)));this.inFlightDependencies.forEach((Mi=>Mi?.abort())),this.inFlightDependencies=[];let xt=Promise.resolve({});if(Object.keys($e).length){const Mi=new AbortController;this.inFlightDependencies.push(Mi),xt=fe.sendAsync({type:"GG",data:{stacks:$e,source:this.source,tileID:this.tileID,type:"glyphs"}},Mi)}const It=Object.keys(Ve.iconDependencies);let Ae=Promise.resolve({});if(It.length){const Mi=new AbortController;this.inFlightDependencies.push(Mi),Ae=fe.sendAsync({type:"GI",data:{icons:It,source:this.source,tileID:this.tileID,type:"icons"}},Mi)}const ii=Object.keys(Ve.patternDependencies);let fi=Promise.resolve({});if(ii.length){const Mi=new AbortController;this.inFlightDependencies.push(Mi),fi=fe.sendAsync({type:"GI",data:{icons:ii,source:this.source,tileID:this.tileID,type:"patterns"}},Mi)}const Tt=Ve.dashDependencies;let ui=Promise.resolve({});if(Object.keys(Tt).length){const Mi=new AbortController;this.inFlightDependencies.push(Mi),ui=fe.sendAsync({type:"GDA",data:{dashes:Tt}},Mi)}const[Ta,pa,Pa,Ya]=yield Promise.all([xt,Ae,fi,ui]),Ni=new B(Ta),za=new E.cG(pa,Pa);for(const Mi in Ee){const tt=Ee[Mi];tt instanceof E.a9?(ee(tt.layers,this.zoom,ie),E.cH({bucket:tt,glyphMap:Ta,glyphPositions:Ni.positions,imageMap:pa,imagePositions:za.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ve.subdivisionGranularity})):tt.hasDependencies&&(tt instanceof E.cI||tt instanceof E.cJ||tt instanceof E.cK)&&(ee(tt.layers,this.zoom,ie),tt.addFeatures(Ve,this.tileID.canonical,za.patternPositions,Ya))}return this.status="done",{buckets:Object.values(Ee).filter((Mi=>!Mi.isEmpty())),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ni.image,imageAtlas:za,dashPositions:Ya,glyphMap:this.returnDependencies?Ta:null,iconMap:this.returnDependencies?pa:null,glyphPositions:this.returnDependencies?Ni.positions:null}}))}}function ee(we,$,H){const ie=new E.F($);for(const fe of we)fe.recalculate(ie,H)}class J{constructor($,H,ie){this.actor=$,this.layerIndex=H,this.availableImages=ie,this.fetching={},this.loading={},this.loaded={}}loadVectorTile($,H){return E._(this,void 0,void 0,(function*(){const ie=yield E.n($.request,H);try{return{vectorTile:new E.cL(new E.cM(ie.data)),rawData:ie.data,cacheControl:ie.cacheControl,expires:ie.expires}}catch(fe){const pe=new Uint8Array(ie.data);let xe=`Unable to parse the tile at ${$.request.url}, `;throw xe+=pe[0]===31&&pe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${fe.message}`,new Error(xe)}}))}loadTile($){return E._(this,void 0,void 0,(function*(){const H=$.uid,ie=!!($&&$.request&&$.request.collectResourceTiming)&&new E.cN($.request),fe=new U($);this.loading[H]=fe;const pe=new AbortController;fe.abort=pe;try{const xe=yield this.loadVectorTile($,pe);if(delete this.loading[H],!xe)return null;const Ie=xe.rawData,Ee={};xe.expires&&(Ee.expires=xe.expires),xe.cacheControl&&(Ee.cacheControl=xe.cacheControl);const Ve={};if(ie){const $e=ie.finish();$e&&(Ve.resourceTiming=JSON.parse(JSON.stringify($e)))}fe.vectorTile=xe.vectorTile;const at=fe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);this.loaded[H]=fe,this.fetching[H]={rawTileData:Ie,cacheControl:Ee,resourceTiming:Ve};try{const $e=yield at;return E.e({rawTileData:Ie.slice(0)},$e,Ee,Ve)}finally{delete this.fetching[H]}}catch(xe){throw delete this.loading[H],fe.status="done",this.loaded[H]=fe,xe}}))}reloadTile($){return E._(this,void 0,void 0,(function*(){const H=$.uid;if(!this.loaded||!this.loaded[H])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ie=this.loaded[H];if(ie.showCollisionBoxes=$.showCollisionBoxes,ie.status==="parsing"){const fe=yield ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);let pe;if(this.fetching[H]){const{rawTileData:xe,cacheControl:Ie,resourceTiming:Ee}=this.fetching[H];delete this.fetching[H],pe=E.e({rawTileData:xe.slice(0)},fe,Ie,Ee)}else pe=fe;return pe}if(ie.status==="done"&&ie.vectorTile)return ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity)}))}abortTile($){return E._(this,void 0,void 0,(function*(){const H=this.loading,ie=$.uid;H&&H[ie]&&H[ie].abort&&(H[ie].abort.abort(),delete H[ie])}))}removeTile($){return E._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[$.uid]&&delete this.loaded[$.uid]}))}}class W{constructor(){this.loaded={}}loadTile($){return E._(this,void 0,void 0,(function*(){const{uid:H,encoding:ie,rawImageData:fe,redFactor:pe,greenFactor:xe,blueFactor:Ie,baseShift:Ee}=$,Ve=fe.width+2,at=fe.height+2,$e=E.b(fe)?new E.R({width:Ve,height:at},yield E.cO(fe,-1,-1,Ve,at)):fe,xt=new E.cP(H,$e,ie,pe,xe,Ie,Ee);return this.loaded=this.loaded||{},this.loaded[H]=xt,xt}))}removeTile($){const H=this.loaded,ie=$.uid;H&&H[ie]&&delete H[ie]}}var K,ve,Ce=(function(){if(ve)return K;function we(H,ie){if(H.length!==0){$(H[0],ie);for(var fe=1;fe<H.length;fe++)$(H[fe],!ie)}}function $(H,ie){for(var fe=0,pe=0,xe=0,Ie=H.length,Ee=Ie-1;xe<Ie;Ee=xe++){var Ve=(H[xe][0]-H[Ee][0])*(H[Ee][1]+H[xe][1]),at=fe+Ve;pe+=Math.abs(fe)>=Math.abs(Ve)?fe-at+Ve:Ve-at+fe,fe=at}fe+pe>=0!=!!ie&&H.reverse()}return ve=1,K=function H(ie,fe){var pe,xe=ie&&ie.type;if(xe==="FeatureCollection")for(pe=0;pe<ie.features.length;pe++)H(ie.features[pe],fe);else if(xe==="GeometryCollection")for(pe=0;pe<ie.geometries.length;pe++)H(ie.geometries[pe],fe);else if(xe==="Feature")H(ie.geometry,fe);else if(xe==="Polygon")we(ie.coordinates,fe);else if(xe==="MultiPolygon")for(pe=0;pe<ie.coordinates.length;pe++)we(ie.coordinates[pe],fe);return ie}})(),Pe=E.cQ(Ce);class Fe extends E.cS{constructor($,H){super(new E.cM,0,H,[],[]),this.feature=$,this.type=$.type,this.properties=$.tags?$.tags:{},"id"in $&&(typeof $.id=="string"?this.id=parseInt($.id,10):typeof $.id!="number"||isNaN($.id)||(this.id=$.id))}loadGeometry(){const $=[],H=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ie of H){const fe=[];for(const pe of ie)fe.push(new E.P(pe[0],pe[1]));$.push(fe)}return $}}class Ue extends E.cR{constructor($,H){super(new E.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=H?H.version:1,this.extent=H?H.extent:4096,this.length=$.length,this.features=$}feature($){return new Fe(this.features[$],this.extent)}}function He(we,$){$.writeVarintField(15,we.version||1),$.writeStringField(1,we.name||""),$.writeVarintField(5,we.extent||4096);const H={keys:[],values:[],keycache:{},valuecache:{}};for(let pe=0;pe<we.length;pe++)H.feature=we.feature(pe),$.writeMessage(2,mt,H);const ie=H.keys;for(const pe of ie)$.writeStringField(3,pe);const fe=H.values;for(const pe of fe)$.writeMessage(4,Vt,pe)}function mt(we,$){if(!we.feature)return;const H=we.feature;H.id!==void 0&&$.writeVarintField(1,H.id),$.writeMessage(2,Mt,we),$.writeVarintField(3,H.type),$.writeMessage(4,ei,H)}function Mt(we,$){for(const H in we.feature?.properties){let ie=we.feature.properties[H],fe=we.keycache[H];if(ie===null)continue;fe===void 0&&(we.keys.push(H),fe=we.keys.length-1,we.keycache[H]=fe),$.writeVarint(fe),typeof ie!="string"&&typeof ie!="boolean"&&typeof ie!="number"&&(ie=JSON.stringify(ie));const pe=typeof ie+":"+ie;let xe=we.valuecache[pe];xe===void 0&&(we.values.push(ie),xe=we.values.length-1,we.valuecache[pe]=xe),$.writeVarint(xe)}}function Pt(we,$){return($<<3)+(7&we)}function _t(we){return we<<1^we>>31}function ei(we,$){const H=we.loadGeometry(),ie=we.type;let fe=0,pe=0;for(const xe of H){let Ie=1;ie===1&&(Ie=xe.length),$.writeVarint(Pt(1,Ie));const Ee=ie===3?xe.length-1:xe.length;for(let Ve=0;Ve<Ee;Ve++){Ve===1&&ie!==1&&$.writeVarint(Pt(2,Ee-1));const at=xe[Ve].x-fe,$e=xe[Ve].y-pe;$.writeVarint(_t(at)),$.writeVarint(_t($e)),fe+=at,pe+=$e}we.type===3&&$.writeVarint(Pt(7,1))}}function Vt(we,$){const H=typeof we;H==="string"?$.writeStringField(1,we):H==="boolean"?$.writeBooleanField(7,we):H==="number"&&(we%1!=0?$.writeDoubleField(3,we):we<0?$.writeSVarintField(6,we):$.writeVarintField(5,we))}const mi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:we=>we},wi=Math.fround||(Di=new Float32Array(1),we=>(Di[0]=+we,Di[0]));var Di;class Ma{constructor($){this.options=Object.assign(Object.create(mi),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:H,minZoom:ie,maxZoom:fe}=this.options;H&&console.time("total time");const pe=`prepare ${$.length} points`;H&&console.time(pe),this.points=$;const xe=[];for(let Ee=0;Ee<$.length;Ee++){const Ve=$[Ee];if(!Ve.geometry)continue;const[at,$e]=Ve.geometry.coordinates,xt=wi(Xe(at)),It=wi(gt($e));xe.push(xt,It,1/0,Ee,-1,1),this.options.reduce&&xe.push(0)}let Ie=this.trees[fe+1]=this._createTree(xe);H&&console.timeEnd(pe);for(let Ee=fe;Ee>=ie;Ee--){const Ve=+Date.now();Ie=this.trees[Ee]=this._createTree(this._cluster(Ie,Ee)),H&&console.log("z%d: %d clusters in %dms",Ee,Ie.numItems,+Date.now()-Ve)}return H&&console.timeEnd("total time"),this}getClusters($,H){let ie=(($[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,$[1]));let pe=$[2]===180?180:(($[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)ie=-180,pe=180;else if(ie>pe){const $e=this.getClusters([ie,fe,180,xe],H),xt=this.getClusters([-180,fe,pe,xe],H);return $e.concat(xt)}const Ie=this.trees[this._limitZoom(H)],Ee=Ie.range(Xe(ie),gt(xe),Xe(pe),gt(fe)),Ve=Ie.data,at=[];for(const $e of Ee){const xt=this.stride*$e;at.push(Ve[xt+5]>1?In(Ve,xt,this.clusterProps):this.points[Ve[xt+3]])}return at}getChildren($){const H=this._getOriginId($),ie=this._getOriginZoom($),fe="No cluster with the specified id.",pe=this.trees[ie];if(!pe)throw new Error(fe);const xe=pe.data;if(H*this.stride>=xe.length)throw new Error(fe);const Ie=this.options.radius/(this.options.extent*Math.pow(2,ie-1)),Ee=pe.within(xe[H*this.stride],xe[H*this.stride+1],Ie),Ve=[];for(const at of Ee){const $e=at*this.stride;xe[$e+4]===$&&Ve.push(xe[$e+5]>1?In(xe,$e,this.clusterProps):this.points[xe[$e+3]])}if(Ve.length===0)throw new Error(fe);return Ve}getLeaves($,H,ie){const fe=[];return this._appendLeaves(fe,$,H=H||10,ie=ie||0,0),fe}getTile($,H,ie){const fe=this.trees[this._limitZoom($)],pe=Math.pow(2,$),{extent:xe,radius:Ie}=this.options,Ee=Ie/xe,Ve=(ie-Ee)/pe,at=(ie+1+Ee)/pe,$e={features:[]};return this._addTileFeatures(fe.range((H-Ee)/pe,Ve,(H+1+Ee)/pe,at),fe.data,H,ie,pe,$e),H===0&&this._addTileFeatures(fe.range(1-Ee/pe,Ve,1,at),fe.data,pe,ie,pe,$e),H===pe-1&&this._addTileFeatures(fe.range(0,Ve,Ee/pe,at),fe.data,-1,ie,pe,$e),$e.features.length?$e:null}getClusterExpansionZoom($){let H=this._getOriginZoom($)-1;for(;H<=this.options.maxZoom;){const ie=this.getChildren($);if(H++,ie.length!==1)break;$=ie[0].properties.cluster_id}return H}_appendLeaves($,H,ie,fe,pe){const xe=this.getChildren(H);for(const Ie of xe){const Ee=Ie.properties;if(Ee&&Ee.cluster?pe+Ee.point_count<=fe?pe+=Ee.point_count:pe=this._appendLeaves($,Ee.cluster_id,ie,fe,pe):pe<fe?pe++:$.push(Ie),$.length===ie)break}return pe}_createTree($){const H=new E.aI($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ie=0;ie<$.length;ie+=this.stride)H.add($[ie],$[ie+1]);return H.finish(),H.data=$,H}_addTileFeatures($,H,ie,fe,pe,xe){for(const Ie of $){const Ee=Ie*this.stride,Ve=H[Ee+5]>1;let at,$e,xt;if(Ve)at=sn(H,Ee,this.clusterProps),$e=H[Ee],xt=H[Ee+1];else{const ii=this.points[H[Ee+3]];at=ii.properties;const[fi,Tt]=ii.geometry.coordinates;$e=Xe(fi),xt=gt(Tt)}const It={type:1,geometry:[[Math.round(this.options.extent*($e*pe-ie)),Math.round(this.options.extent*(xt*pe-fe))]],tags:at};let Ae;Ae=Ve||this.options.generateId?H[Ee+3]:this.points[H[Ee+3]].id,Ae!==void 0&&(It.id=Ae),xe.features.push(It)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,H){const{radius:ie,extent:fe,reduce:pe,minPoints:xe}=this.options,Ie=ie/(fe*Math.pow(2,H)),Ee=$.data,Ve=[],at=this.stride;for(let $e=0;$e<Ee.length;$e+=at){if(Ee[$e+2]<=H)continue;Ee[$e+2]=H;const xt=Ee[$e],It=Ee[$e+1],Ae=$.within(Ee[$e],Ee[$e+1],Ie),ii=Ee[$e+5];let fi=ii;for(const Tt of Ae){const ui=Tt*at;Ee[ui+2]>H&&(fi+=Ee[ui+5])}if(fi>ii&&fi>=xe){let Tt,ui=xt*ii,Ta=It*ii,pa=-1;const Pa=($e/at<<5)+(H+1)+this.points.length;for(const Ya of Ae){const Ni=Ya*at;if(Ee[Ni+2]<=H)continue;Ee[Ni+2]=H;const za=Ee[Ni+5];ui+=Ee[Ni]*za,Ta+=Ee[Ni+1]*za,Ee[Ni+4]=Pa,pe&&(Tt||(Tt=this._map(Ee,$e,!0),pa=this.clusterProps.length,this.clusterProps.push(Tt)),pe(Tt,this._map(Ee,Ni)))}Ee[$e+4]=Pa,Ve.push(ui/fi,Ta/fi,1/0,Pa,-1,fi),pe&&Ve.push(pa)}else{for(let Tt=0;Tt<at;Tt++)Ve.push(Ee[$e+Tt]);if(fi>1)for(const Tt of Ae){const ui=Tt*at;if(!(Ee[ui+2]<=H)){Ee[ui+2]=H;for(let Ta=0;Ta<at;Ta++)Ve.push(Ee[ui+Ta])}}}}return Ve}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,H,ie){if($[H+5]>1){const xe=this.clusterProps[$[H+6]];return ie?Object.assign({},xe):xe}const fe=this.points[$[H+3]].properties,pe=this.options.map(fe);return ie&&pe===fe?Object.assign({},pe):pe}}function In(we,$,H){return{type:"Feature",id:we[$+3],properties:sn(we,$,H),geometry:{type:"Point",coordinates:[(ie=we[$],360*(ie-.5)),Nt(we[$+1])]}};var ie}function sn(we,$,H){const ie=we[$+5],fe=ie>=1e4?`${Math.round(ie/1e3)}k`:ie>=1e3?Math.round(ie/100)/10+"k":ie,pe=we[$+6],xe=pe===-1?{}:Object.assign({},H[pe]);return Object.assign(xe,{cluster:!0,cluster_id:we[$+3],point_count:ie,point_count_abbreviated:fe})}function Xe(we){return we/360+.5}function gt(we){const $=Math.sin(we*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Nt(we){const $=(180-360*we)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Lt(we,$,H,ie){let fe=ie;const pe=$+(H-$>>1);let xe,Ie=H-$;const Ee=we[$],Ve=we[$+1],at=we[H],$e=we[H+1];for(let xt=$+3;xt<H;xt+=3){const It=Si(we[xt],we[xt+1],Ee,Ve,at,$e);if(It>fe)xe=xt,fe=It;else if(It===fe){const Ae=Math.abs(xt-pe);Ae<Ie&&(xe=xt,Ie=Ae)}}fe>ie&&(xe-$>3&&Lt(we,$,xe,ie),we[xe+2]=fe,H-xe>3&&Lt(we,xe,H,ie))}function Si(we,$,H,ie,fe,pe){let xe=fe-H,Ie=pe-ie;if(xe!==0||Ie!==0){const Ee=((we-H)*xe+($-ie)*Ie)/(xe*xe+Ie*Ie);Ee>1?(H=fe,ie=pe):Ee>0&&(H+=xe*Ee,ie+=Ie*Ee)}return xe=we-H,Ie=$-ie,xe*xe+Ie*Ie}function be(we,$,H,ie){const fe={id:we??null,type:$,geometry:H,tags:ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if($==="Point"||$==="MultiPoint"||$==="LineString")Ke(fe,H);else if($==="Polygon")Ke(fe,H[0]);else if($==="MultiLineString")for(const pe of H)Ke(fe,pe);else if($==="MultiPolygon")for(const pe of H)Ke(fe,pe[0]);return fe}function Ke(we,$){for(let H=0;H<$.length;H+=3)we.minX=Math.min(we.minX,$[H]),we.minY=Math.min(we.minY,$[H+1]),we.maxX=Math.max(we.maxX,$[H]),we.maxY=Math.max(we.maxY,$[H+1])}function pt(we,$,H,ie){if(!$.geometry)return;const fe=$.geometry.coordinates;if(fe&&fe.length===0)return;const pe=$.geometry.type,xe=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2);let Ie=[],Ee=$.id;if(H.promoteId?Ee=$.properties[H.promoteId]:H.generateId&&(Ee=ie||0),pe==="Point")Et(fe,Ie);else if(pe==="MultiPoint")for(const Ve of fe)Et(Ve,Ie);else if(pe==="LineString")$t(fe,Ie,xe,!1);else if(pe==="MultiLineString"){if(H.lineMetrics){for(const Ve of fe)Ie=[],$t(Ve,Ie,xe,!1),we.push(be(Ee,"LineString",Ie,$.properties));return}Ft(fe,Ie,xe,!1)}else if(pe==="Polygon")Ft(fe,Ie,xe,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(const Ve of $.geometry.geometries)pt(we,{id:Ee,geometry:Ve,properties:$.properties},H,ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ve of fe){const at=[];Ft(Ve,at,xe,!0),Ie.push(at)}}we.push(be(Ee,pe,Ie,$.properties))}function Et(we,$){$.push(gi(we[0]),Qi(we[1]),0)}function $t(we,$,H,ie){let fe,pe,xe=0;for(let Ee=0;Ee<we.length;Ee++){const Ve=gi(we[Ee][0]),at=Qi(we[Ee][1]);$.push(Ve,at,0),Ee>0&&(xe+=ie?(fe*at-Ve*pe)/2:Math.sqrt(Math.pow(Ve-fe,2)+Math.pow(at-pe,2))),fe=Ve,pe=at}const Ie=$.length-3;$[2]=1,Lt($,0,Ie,H),$[Ie+2]=1,$.size=Math.abs(xe),$.start=0,$.end=$.size}function Ft(we,$,H,ie){for(let fe=0;fe<we.length;fe++){const pe=[];$t(we[fe],pe,H,ie),$.push(pe)}}function gi(we){return we/360+.5}function Qi(we){const $=Math.sin(we*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Pi(we,$,H,ie,fe,pe,xe,Ie){if(ie/=$,pe>=(H/=$)&&xe<ie)return we;if(xe<H||pe>=ie)return null;const Ee=[];for(const Ve of we){const at=Ve.geometry;let $e=Ve.type;const xt=fe===0?Ve.minX:Ve.minY,It=fe===0?Ve.maxX:Ve.maxY;if(xt>=H&&It<ie){Ee.push(Ve);continue}if(It<H||xt>=ie)continue;let Ae=[];if($e==="Point"||$e==="MultiPoint")Qr(at,Ae,H,ie,fe);else if($e==="LineString")bs(at,Ae,H,ie,fe,!1,Ie.lineMetrics);else if($e==="MultiLineString")fa(at,Ae,H,ie,fe,!1);else if($e==="Polygon")fa(at,Ae,H,ie,fe,!0);else if($e==="MultiPolygon")for(const ii of at){const fi=[];fa(ii,fi,H,ie,fe,!0),fi.length&&Ae.push(fi)}if(Ae.length){if(Ie.lineMetrics&&$e==="LineString"){for(const ii of Ae)Ee.push(be(Ve.id,$e,ii,Ve.tags));continue}$e!=="LineString"&&$e!=="MultiLineString"||(Ae.length===1?($e="LineString",Ae=Ae[0]):$e="MultiLineString"),$e!=="Point"&&$e!=="MultiPoint"||($e=Ae.length===3?"Point":"MultiPoint"),Ee.push(be(Ve.id,$e,Ae,Ve.tags))}}return Ee.length?Ee:null}function Qr(we,$,H,ie,fe){for(let pe=0;pe<we.length;pe+=3){const xe=we[pe+fe];xe>=H&&xe<=ie&&qi($,we[pe],we[pe+1],we[pe+2])}}function bs(we,$,H,ie,fe,pe,xe){let Ie=bn(we);const Ee=fe===0?qn:fr;let Ve,at,$e=we.start;for(let fi=0;fi<we.length-3;fi+=3){const Tt=we[fi],ui=we[fi+1],Ta=we[fi+2],pa=we[fi+3],Pa=we[fi+4],Ya=fe===0?Tt:ui,Ni=fe===0?pa:Pa;let za=!1;xe&&(Ve=Math.sqrt(Math.pow(Tt-pa,2)+Math.pow(ui-Pa,2))),Ya<H?Ni>H&&(at=Ee(Ie,Tt,ui,pa,Pa,H),xe&&(Ie.start=$e+Ve*at)):Ya>ie?Ni<ie&&(at=Ee(Ie,Tt,ui,pa,Pa,ie),xe&&(Ie.start=$e+Ve*at)):qi(Ie,Tt,ui,Ta),Ni<H&&Ya>=H&&(at=Ee(Ie,Tt,ui,pa,Pa,H),za=!0),Ni>ie&&Ya<=ie&&(at=Ee(Ie,Tt,ui,pa,Pa,ie),za=!0),!pe&&za&&(xe&&(Ie.end=$e+Ve*at),$.push(Ie),Ie=bn(we)),xe&&($e+=Ve)}let xt=we.length-3;const It=we[xt],Ae=we[xt+1],ii=fe===0?It:Ae;ii>=H&&ii<=ie&&qi(Ie,It,Ae,we[xt+2]),xt=Ie.length-3,pe&&xt>=3&&(Ie[xt]!==Ie[0]||Ie[xt+1]!==Ie[1])&&qi(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&$.push(Ie)}function bn(we){const $=[];return $.size=we.size,$.start=we.start,$.end=we.end,$}function fa(we,$,H,ie,fe,pe){for(const xe of we)bs(xe,$,H,ie,fe,pe,!1)}function qi(we,$,H,ie){we.push($,H,ie)}function qn(we,$,H,ie,fe,pe){const xe=(pe-$)/(ie-$);return qi(we,pe,H+(fe-H)*xe,1),xe}function fr(we,$,H,ie,fe,pe){const xe=(pe-H)/(fe-H);return qi(we,$+(ie-$)*xe,pe,1),xe}function jo(we,$){const H=[];for(let ie=0;ie<we.length;ie++){const fe=we[ie],pe=fe.type;let xe;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")xe=Ks(fe.geometry,$);else if(pe==="MultiLineString"||pe==="Polygon"){xe=[];for(const Ie of fe.geometry)xe.push(Ks(Ie,$))}else if(pe==="MultiPolygon"){xe=[];for(const Ie of fe.geometry){const Ee=[];for(const Ve of Ie)Ee.push(Ks(Ve,$));xe.push(Ee)}}H.push(be(fe.id,pe,xe,fe.tags))}return H}function Ks(we,$){const H=[];H.size=we.size,we.start!==void 0&&(H.start=we.start,H.end=we.end);for(let ie=0;ie<we.length;ie+=3)H.push(we[ie]+$,we[ie+1],we[ie+2]);return H}function wn(we,$){if(we.transformed)return we;const H=1<<we.z,ie=we.x,fe=we.y;for(const pe of we.features){const xe=pe.geometry,Ie=pe.type;if(pe.geometry=[],Ie===1)for(let Ee=0;Ee<xe.length;Ee+=2)pe.geometry.push(Js(xe[Ee],xe[Ee+1],$,H,ie,fe));else for(let Ee=0;Ee<xe.length;Ee++){const Ve=[];for(let at=0;at<xe[Ee].length;at+=2)Ve.push(Js(xe[Ee][at],xe[Ee][at+1],$,H,ie,fe));pe.geometry.push(Ve)}}return we.transformed=!0,we}function Js(we,$,H,ie,fe,pe){return[Math.round(H*(we*ie-fe)),Math.round(H*($*ie-pe))]}function Go(we,$,H,ie,fe){const pe=$===fe.maxZoom?0:fe.tolerance/((1<<$)*fe.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:we.length,source:null,x:H,y:ie,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ie of we)eo(xe,Ie,pe,fe);return xe}function eo(we,$,H,ie){const fe=$.geometry,pe=$.type,xe=[];if(we.minX=Math.min(we.minX,$.minX),we.minY=Math.min(we.minY,$.minY),we.maxX=Math.max(we.maxX,$.maxX),we.maxY=Math.max(we.maxY,$.maxY),pe==="Point"||pe==="MultiPoint")for(let Ie=0;Ie<fe.length;Ie+=3)xe.push(fe[Ie],fe[Ie+1]),we.numPoints++,we.numSimplified++;else if(pe==="LineString")Kr(xe,fe,we,H,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(let Ie=0;Ie<fe.length;Ie++)Kr(xe,fe[Ie],we,H,pe==="Polygon",Ie===0);else if(pe==="MultiPolygon")for(let Ie=0;Ie<fe.length;Ie++){const Ee=fe[Ie];for(let Ve=0;Ve<Ee.length;Ve++)Kr(xe,Ee[Ve],we,H,!0,Ve===0)}if(xe.length){let Ie=$.tags||null;if(pe==="LineString"&&ie.lineMetrics){Ie={};for(const Ve in $.tags)Ie[Ve]=$.tags[Ve];Ie.mapbox_clip_start=fe.start/fe.size,Ie.mapbox_clip_end=fe.end/fe.size}const Ee={geometry:xe,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:Ie};$.id!==null&&(Ee.id=$.id),we.features.push(Ee)}}function Kr(we,$,H,ie,fe,pe){const xe=ie*ie;if(ie>0&&$.size<(fe?xe:ie))return void(H.numPoints+=$.length/3);const Ie=[];for(let Ee=0;Ee<$.length;Ee+=3)(ie===0||$[Ee+2]>xe)&&(H.numSimplified++,Ie.push($[Ee],$[Ee+1])),H.numPoints++;fe&&(function(Ee,Ve){let at=0;for(let $e=0,xt=Ee.length,It=xt-2;$e<xt;It=$e,$e+=2)at+=(Ee[$e]-Ee[It])*(Ee[$e+1]+Ee[It+1]);if(at>0===Ve)for(let $e=0,xt=Ee.length;$e<xt/2;$e+=2){const It=Ee[$e],Ae=Ee[$e+1];Ee[$e]=Ee[xt-2-$e],Ee[$e+1]=Ee[xt-1-$e],Ee[xt-2-$e]=It,Ee[xt-1-$e]=Ae}})(Ie,pe),we.push(Ie)}const Na={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class dc{constructor($,H){const ie=(H=this.options=(function(pe,xe){for(const Ie in xe)pe[Ie]=xe[Ie];return pe})(Object.create(Na),H)).debug;if(ie&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");let fe=(function(pe,xe){const Ie=[];if(pe.type==="FeatureCollection")for(let Ee=0;Ee<pe.features.length;Ee++)pt(Ie,pe.features[Ee],xe,Ee);else pt(Ie,pe.type==="Feature"?pe:{geometry:pe},xe);return Ie})($,H);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=(function(pe,xe){const Ie=xe.buffer/xe.extent;let Ee=pe;const Ve=Pi(pe,1,-1-Ie,Ie,0,-1,2,xe),at=Pi(pe,1,1-Ie,2+Ie,0,-1,2,xe);return(Ve||at)&&(Ee=Pi(pe,1,-Ie,1+Ie,0,-1,2,xe)||[],Ve&&(Ee=jo(Ve,1).concat(Ee)),at&&(Ee=Ee.concat(jo(at,-1)))),Ee})(fe,H),fe.length&&this.splitTile(fe,0,0,0),ie&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile($,H,ie,fe,pe,xe,Ie){const Ee=[$,H,ie,fe],Ve=this.options,at=Ve.debug;for(;Ee.length;){fe=Ee.pop(),ie=Ee.pop(),H=Ee.pop(),$=Ee.pop();const $e=1<<H,xt=Zn(H,ie,fe);let It=this.tiles[xt];if(!It&&(at>1&&console.time("creation"),It=this.tiles[xt]=Go($,H,ie,fe,Ve),this.tileCoords.push({z:H,x:ie,y:fe}),at)){at>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,ie,fe,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));const za=`z${H}`;this.stats[za]=(this.stats[za]||0)+1,this.total++}if(It.source=$,pe==null){if(H===Ve.indexMaxZoom||It.numPoints<=Ve.indexMaxPoints)continue}else{if(H===Ve.maxZoom||H===pe)continue;if(pe!=null){const za=pe-H;if(ie!==xe>>za||fe!==Ie>>za)continue}}if(It.source=null,$.length===0)continue;at>1&&console.time("clipping");const Ae=.5*Ve.buffer/Ve.extent,ii=.5-Ae,fi=.5+Ae,Tt=1+Ae;let ui=null,Ta=null,pa=null,Pa=null,Ya=Pi($,$e,ie-Ae,ie+fi,0,It.minX,It.maxX,Ve),Ni=Pi($,$e,ie+ii,ie+Tt,0,It.minX,It.maxX,Ve);$=null,Ya&&(ui=Pi(Ya,$e,fe-Ae,fe+fi,1,It.minY,It.maxY,Ve),Ta=Pi(Ya,$e,fe+ii,fe+Tt,1,It.minY,It.maxY,Ve),Ya=null),Ni&&(pa=Pi(Ni,$e,fe-Ae,fe+fi,1,It.minY,It.maxY,Ve),Pa=Pi(Ni,$e,fe+ii,fe+Tt,1,It.minY,It.maxY,Ve),Ni=null),at>1&&console.timeEnd("clipping"),Ee.push(ui||[],H+1,2*ie,2*fe),Ee.push(Ta||[],H+1,2*ie,2*fe+1),Ee.push(pa||[],H+1,2*ie+1,2*fe),Ee.push(Pa||[],H+1,2*ie+1,2*fe+1)}}getTile($,H,ie){$=+$,H=+H,ie=+ie;const fe=this.options,{extent:pe,debug:xe}=fe;if($<0||$>24)return null;const Ie=1<<$,Ee=Zn($,H=H+Ie&Ie-1,ie);if(this.tiles[Ee])return wn(this.tiles[Ee],pe);xe>1&&console.log("drilling down to z%d-%d-%d",$,H,ie);let Ve,at=$,$e=H,xt=ie;for(;!Ve&&at>0;)at--,$e>>=1,xt>>=1,Ve=this.tiles[Zn(at,$e,xt)];return Ve&&Ve.source?(xe>1&&(console.log("found parent tile z%d-%d-%d",at,$e,xt),console.time("drilling down")),this.splitTile(Ve.source,at,$e,xt,$,H,ie),xe>1&&console.timeEnd("drilling down"),this.tiles[Ee]?wn(this.tiles[Ee],pe):null):null}}function Zn(we,$,H){return 32*((1<<we)*H+$)+we}class ws extends J{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile($,H){return E._(this,void 0,void 0,(function*(){const ie=$.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const fe=this._geoJSONIndex.getTile(ie.z,ie.x,ie.y);if(!fe)return null;const pe=new Ue(fe.features,{version:2,extent:E.$});let xe=(function(Ie){const Ee=new E.cM;return(function(Ve,at){for(const $e in Ve.layers)at.writeMessage(3,He,Ve.layers[$e])})(Ie,Ee),Ee.finish()})(pe);return xe.byteOffset===0&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),{vectorTile:pe,rawData:xe.buffer}}))}loadData($){return E._(this,void 0,void 0,(function*(){var H;(H=this._pendingRequest)===null||H===void 0||H.abort();const ie=!!($&&$.request&&$.request.collectResourceTiming)&&new E.cN($.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON($,this._pendingRequest);const fe=yield this._pendingData;this._geoJSONIndex=$.cluster?new Ma((function({superclusterOptions:xe,clusterProperties:Ie}){if(!Ie||!xe)return xe;const Ee={},Ve={},at={accumulated:null,zoom:0},$e={properties:null},xt=Object.keys(Ie);for(const It of xt){const[Ae,ii]=Ie[It],fi=E.cT(ii),Tt=E.cT(typeof Ae=="string"?[Ae,["accumulated"],["get",It]]:Ae);Ee[It]=fi.value,Ve[It]=Tt.value}return xe.map=It=>{$e.properties=It;const Ae={};for(const ii of xt)Ae[ii]=Ee[ii].evaluate(at,$e);return Ae},xe.reduce=(It,Ae)=>{$e.properties=Ae;for(const ii of xt)at.accumulated=It[ii],It[ii]=Ve[ii].evaluate(at,$e)},xe})($)).load(fe.features):(function(xe,Ie){return new dc(xe,Ie)})(fe,$.geojsonVtOptions),this.loaded={};const pe={data:fe};if(ie){const xe=ie.finish();xe&&(pe.resourceTiming={},pe.resourceTiming[$.source]=JSON.parse(JSON.stringify(xe)))}return pe}catch(fe){if(delete this._pendingRequest,E.cy(fe))return{abandoned:!0};throw fe}}))}getData(){return E._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile($){const H=this.loaded;return H&&H[$.uid]?super.reloadTile($):this.loadTile($)}loadAndProcessGeoJSON($,H){return E._(this,void 0,void 0,(function*(){let ie=yield this.loadGeoJSON($,H);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(Pe(ie,!0),$.filter){const fe=E.cT($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map((xe=>`${xe.key}: ${xe.message}`)).join(", "));ie={type:"FeatureCollection",features:ie.features.filter((xe=>fe.value.evaluate({zoom:0},xe)))}}return ie}))}loadGeoJSON($,H){return E._(this,void 0,void 0,(function*(){const{promoteId:ie}=$;if($.request){const fe=yield E.j($.request,H);return this._dataUpdateable=E.cV(fe.data,ie)?E.cU(fe.data,ie):void 0,fe.data}if(typeof $.data=="string")try{const fe=JSON.parse($.data);return this._dataUpdateable=E.cV(fe,ie)?E.cU(fe,ie):void 0,fe}catch{throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`)}if(!$.dataDiff)throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${$.source}`);return E.cW(this._dataUpdateable,$.dataDiff,ie),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource($){return E._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom($){return this._geoJSONIndex.getClusterExpansionZoom($.clusterId)}getClusterChildren($){return this._geoJSONIndex.getChildren($.clusterId)}getClusterLeaves($){return this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset)}}class Sn{constructor($){this.self=$,this.actor=new E.J($),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(H,ie)=>{if(this.externalWorkerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.externalWorkerSourceTypes[H]=ie},this.self.addProtocol=E.cA,this.self.removeProtocol=E.cB,this.self.registerRTLTextPlugin=H=>{E.cX.setMethods(H)},this.actor.registerMessageHandler("LDT",((H,ie)=>this._getDEMWorkerSource(H,ie.source).loadTile(ie))),this.actor.registerMessageHandler("RDT",((H,ie)=>E._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(H,ie.source).removeTile(ie)})))),this.actor.registerMessageHandler("GCEZ",((H,ie)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(H,ie.type,ie.source).getClusterExpansionZoom(ie)})))),this.actor.registerMessageHandler("GCC",((H,ie)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(H,ie.type,ie.source).getClusterChildren(ie)})))),this.actor.registerMessageHandler("GCL",((H,ie)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(H,ie.type,ie.source).getClusterLeaves(ie)})))),this.actor.registerMessageHandler("LD",((H,ie)=>this._getWorkerSource(H,ie.type,ie.source).loadData(ie))),this.actor.registerMessageHandler("GD",((H,ie)=>this._getWorkerSource(H,ie.type,ie.source).getData())),this.actor.registerMessageHandler("LT",((H,ie)=>this._getWorkerSource(H,ie.type,ie.source).loadTile(ie))),this.actor.registerMessageHandler("RT",((H,ie)=>this._getWorkerSource(H,ie.type,ie.source).reloadTile(ie))),this.actor.registerMessageHandler("AT",((H,ie)=>this._getWorkerSource(H,ie.type,ie.source).abortTile(ie))),this.actor.registerMessageHandler("RMT",((H,ie)=>this._getWorkerSource(H,ie.type,ie.source).removeTile(ie))),this.actor.registerMessageHandler("RS",((H,ie)=>E._(this,void 0,void 0,(function*(){if(!this.workerSources[H]||!this.workerSources[H][ie.type]||!this.workerSources[H][ie.type][ie.source])return;const fe=this.workerSources[H][ie.type][ie.source];delete this.workerSources[H][ie.type][ie.source],fe.removeSource!==void 0&&fe.removeSource(ie)})))),this.actor.registerMessageHandler("RM",(H=>E._(this,void 0,void 0,(function*(){delete this.layerIndexes[H],delete this.availableImages[H],delete this.workerSources[H],delete this.demWorkerSources[H],this.globalStates.delete(H)})))),this.actor.registerMessageHandler("SR",((H,ie)=>E._(this,void 0,void 0,(function*(){this.referrer=ie})))),this.actor.registerMessageHandler("SRPS",((H,ie)=>this._syncRTLPluginState(H,ie))),this.actor.registerMessageHandler("IS",((H,ie)=>E._(this,void 0,void 0,(function*(){this.self.importScripts(ie)})))),this.actor.registerMessageHandler("SI",((H,ie)=>this._setImages(H,ie))),this.actor.registerMessageHandler("UL",((H,ie)=>E._(this,void 0,void 0,(function*(){this._getLayerIndex(H).update(ie.layers,ie.removedIds,this._getGlobalState(H))})))),this.actor.registerMessageHandler("UGS",((H,ie)=>E._(this,void 0,void 0,(function*(){const fe=this._getGlobalState(H);for(const pe in ie)fe[pe]=ie[pe]})))),this.actor.registerMessageHandler("SL",((H,ie)=>E._(this,void 0,void 0,(function*(){this._getLayerIndex(H).replace(ie,this._getGlobalState(H))}))))}_getGlobalState($){let H=this.globalStates.get($);return H||(H={},this.globalStates.set($,H)),H}_setImages($,H){return E._(this,void 0,void 0,(function*(){this.availableImages[$]=H;for(const ie in this.workerSources[$]){const fe=this.workerSources[$][ie];for(const pe in fe)fe[pe].availableImages=H}}))}_syncRTLPluginState($,H){return E._(this,void 0,void 0,(function*(){return yield E.cX.syncState(H,this.self.importScripts)}))}_getAvailableImages($){let H=this.availableImages[$];return H||(H=[]),H}_getLayerIndex($){let H=this.layerIndexes[$];return H||(H=this.layerIndexes[$]=new l),H}_getWorkerSource($,H,ie){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][H]||(this.workerSources[$][H]={}),!this.workerSources[$][H][ie]){const fe={sendAsync:(pe,xe)=>(pe.targetMapId=$,this.actor.sendAsync(pe,xe))};switch(H){case"vector":this.workerSources[$][H][ie]=new J(fe,this._getLayerIndex($),this._getAvailableImages($));break;case"geojson":this.workerSources[$][H][ie]=new ws(fe,this._getLayerIndex($),this._getAvailableImages($));break;default:this.workerSources[$][H][ie]=new this.externalWorkerSourceTypes[H](fe,this._getLayerIndex($),this._getAvailableImages($))}}return this.workerSources[$][H][ie]}_getDEMWorkerSource($,H){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][H]||(this.demWorkerSources[$][H]=new W),this.demWorkerSources[$][H]}}return E.i(self)&&(self.worker=new Sn(self)),Sn})),P("index",["exports","./shared"],(function(E,l){var B="5.9.0";function U(){var p=new l.A(4);return l.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}let ee,J;const W={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(p,e,r){const c=requestAnimationFrame((m=>{f(),e(m)})),{unsubscribe:f}=l.s(p.signal,"abort",(()=>{f(),cancelAnimationFrame(c),r(l.c())}),!1)},frameAsync(p){return new Promise(((e,r)=>{this.frame(p,e,r)}))},getImageData(p,e=0){return this.getImageCanvasContext(p).getImageData(-e,-e,p.width+2*e,p.height+2*e)},getImageCanvasContext(p){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=p.width,e.height=p.height,r.drawImage(p,0,0,p.width,p.height),r},resolveURL:p=>(ee||(ee=document.createElement("a")),ee.href=p,ee.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(J==null&&(J=matchMedia("(prefers-reduced-motion: reduce)")),J.matches)}};class K{static testProp(e){if(!K.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in K.docStyle)return e[r];return e[0]}static create(e,r,c){const f=window.document.createElement(e);return r!==void 0&&(f.className=r),c&&c.appendChild(f),f}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){K.docStyle&&K.selectProp&&(K.userSelect=K.docStyle[K.selectProp],K.docStyle[K.selectProp]="none")}static enableDrag(){K.docStyle&&K.selectProp&&(K.docStyle[K.selectProp]=K.userSelect)}static setTransform(e,r){e.style[K.transformProp]=r}static addEventListener(e,r,c,f={}){e.addEventListener(r,c,"passive"in f?f:f.capture)}static removeEventListener(e,r,c,f={}){e.removeEventListener(r,c,"passive"in f?f:f.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",K.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",K.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",K.suppressClickInternal,!0)}),0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,c){const f=r.boundingClientRect;return new l.P((c.clientX-f.left)/r.x-e.clientLeft,(c.clientY-f.top)/r.y-e.clientTop)}static mousePos(e,r){const c=K.getScale(e);return K.getPoint(e,c,r)}static touchPos(e,r){const c=[],f=K.getScale(e);for(let m=0;m<r.length;m++)c.push(K.getPoint(e,f,r[m]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),c=r.querySelectorAll("script");for(const f of c)f.remove();return K.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const c=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!c.includes("javascript:")&&!c.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const c of r)K.removeAttributes(c),K.clean(c)}static removeAttributes(e){for(const{name:r,value:c}of e.attributes)K.isPossiblyDangerous(r,c)&&e.removeAttribute(r)}}K.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,K.selectProp=K.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),K.transformProp=K.testProp(["transform","WebkitTransform"]);const ve={supported:!1,testSupport:function(p){!Fe&&Pe&&(Ue?He(p):Ce=p)}};let Ce,Pe,Fe=!1,Ue=!1;function He(p){const e=p.createTexture();p.bindTexture(p.TEXTURE_2D,e);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,Pe),p.isContextLost())return;ve.supported=!0}catch{}p.deleteTexture(e),Fe=!0}var mt;typeof document<"u"&&(Pe=document.createElement("img"),Pe.onload=()=>{Ce&&He(Ce),Ce=null,Ue=!0},Pe.onerror=()=>{Fe=!0,Ce=null},Pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(p){let e,r,c,f;p.resetRequestQueue=()=>{e=[],r=0,c=0,f={}},p.addThrottleControl=C=>{const k=c++;return f[k]=C,k},p.removeThrottleControl=C=>{delete f[C],x()},p.getImage=(C,k,L=!0)=>new Promise(((j,N)=>{ve.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),l.e(C,{type:"image"}),e.push({abortController:k,requestParameters:C,supportImageRefresh:L,state:"queued",onError:q=>{N(q)},onSuccess:q=>{j(q)}}),x()}));const m=C=>l._(this,void 0,void 0,(function*(){C.state="running";const{requestParameters:k,supportImageRefresh:L,onError:j,onSuccess:N,abortController:q}=C,X=L===!1&&!l.i(self)&&!l.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce(((re,le)=>re&&le==="accept"),!0));r++;const ae=X?T(k,q):l.m(k,q);try{const re=yield ae;delete C.abortController,C.state="completed",re.data instanceof HTMLImageElement||l.b(re.data)?N(re):re.data&&N({data:yield(ne=re.data,typeof createImageBitmap=="function"?l.f(ne):l.h(ne)),cacheControl:re.cacheControl,expires:re.expires})}catch(re){delete C.abortController,j(re)}finally{r--,x()}var ne})),x=()=>{const C=(()=>{for(const k of Object.keys(f))if(f[k]())return!0;return!1})()?l.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=r;k<C&&e.length>0;k++){const L=e.shift();L.abortController.signal.aborted?k--:m(L)}},T=(C,k)=>new Promise(((L,j)=>{const N=new Image,q=C.url,X=C.credentials;X&&X==="include"?N.crossOrigin="use-credentials":(X&&X==="same-origin"||!l.d(q))&&(N.crossOrigin="anonymous"),k.signal.addEventListener("abort",(()=>{N.src="",j(l.c())})),N.fetchPriority="high",N.onload=()=>{N.onerror=N.onload=null,L({data:N})},N.onerror=()=>{N.onerror=N.onload=null,k.signal.aborted||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},N.src=q}))})(mt||(mt={})),mt.resetRequestQueue();class Mt{constructor(e){this._transformRequestFn=e??null}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Pt(p){const e=[];if(typeof p=="string")e.push({id:"default",url:p});else if(p&&p.length>0){const r=[];for(const{id:c,url:f}of p){const m=`${c}${f}`;r.indexOf(m)===-1&&(r.push(m),e.push({id:c,url:f}))}}return e}function _t(p,e,r){try{const c=new URL(p);return c.pathname+=`${e}${r}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${p}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ei(p){const{userImage:e}=p;return!!(e&&e.render&&e.render())&&(p.data.replace(new Uint8Array(e.data.buffer)),!0)}class Vt extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:c}of this.requestors)c(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const c=r.spriteData;r.data=new l.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let c=!0;const f=r.data||r.spriteData;return this._validateStretch(r.stretchX,f&&f.width)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(r.stretchY,f&&f.height)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(r.content,r)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,r){if(!e)return!0;let c=0;for(const f of e){if(f[0]<c||f[1]<f[0]||r<f[1])return!1;c=f[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const c=r.spriteData,f=c&&c.width||r.data.width,m=c&&c.height||r.data.height;return!(e[0]<0||f<e[0]||e[1]<0||m<e[1]||e[2]<0||f<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,c=!0){const f=this.getImage(e);if(c&&(f.data.width!==r.data.width||f.data.height!==r.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=f.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((r,c)=>{let f=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(f=!1);this.isLoaded()||f?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})}))}_getImagesForIds(e){const r={};for(const c of e){let f=this.getImage(c);f||(this.fire(new l.l("styleimagemissing",{id:c})),f=this.getImage(c)),f?r[c]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:l.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],c=this.getImage(e);if(!c)return null;if(r&&r.position.version===c.version)return r.position;if(r)r.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},m=new l.I(f,c);this.patterns[e]={bin:f,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.T(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:r,h:c}=l.p(e),f=this.atlasImage;f.resize({width:r||1,height:c||1});for(const m in this.patterns){const{bin:x}=this.patterns[m],T=x.x+1,C=x.y+1,k=this.getImage(m).data,L=k.width,j=k.height;l.R.copy(k,f,{x:0,y:0},{x:T,y:C},{width:L,height:j}),l.R.copy(k,f,{x:0,y:j-1},{x:T,y:C-1},{width:L,height:1}),l.R.copy(k,f,{x:0,y:0},{x:T,y:C+j},{width:L,height:1}),l.R.copy(k,f,{x:L-1,y:0},{x:T-1,y:C},{width:1,height:j}),l.R.copy(k,f,{x:0,y:0},{x:T+L,y:C},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const c=this.getImage(r);c||l.w(`Image with ID: "${r}" was not found`),ei(c)&&this.updateImage(r,c)}}}const mi=1e20;function wi(p,e,r,c,f,m,x,T,C){for(let k=e;k<e+c;k++)Di(p,r*m+k,m,f,x,T,C);for(let k=r;k<r+f;k++)Di(p,k*m+e,1,c,x,T,C)}function Di(p,e,r,c,f,m,x){m[0]=0,x[0]=-mi,x[1]=mi,f[0]=p[e];for(let T=1,C=0,k=0;T<c;T++){f[T]=p[e+T*r];const L=T*T;do{const j=m[C];k=(f[T]-f[j]+L-j*j)/(T-j)/2}while(k<=x[C]&&--C>-1);C++,m[C]=T,x[C]=k,x[C+1]=mi}for(let T=0,C=0;T<c;T++){for(;x[C+1]<T;)C++;const k=m[C],L=T-k;p[e+T*r]=f[k]+L*L}}class Ma{constructor(e,r,c){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={},this.lang=c}setURL(e){this.url=e}getGlyphs(e){return l._(this,void 0,void 0,(function*(){const r=[];for(const m in e)for(const x of e[m])r.push(this._getAndCacheGlyphsPromise(m,x));const c=yield Promise.all(r),f={};for(const{stack:m,id:x,glyph:T}of c)f[m]||(f[m]={}),f[m][x]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return f}))}_getAndCacheGlyphsPromise(e,r){return l._(this,void 0,void 0,(function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[r];if(f!==void 0)return{stack:e,id:r,glyph:f};if(f=this._tinySDF(c,e,r),f)return c.glyphs[r]=f,{stack:e,id:r,glyph:f};const m=Math.floor(r/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[m])return{stack:e,id:r,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[m]){const T=Ma.loadGlyphRange(e,m,this.url,this.requestManager);c.requests[m]=T}const x=yield c.requests[m];for(const T in x)this._doesCharSupportLocalGlyph(+T)||(c.glyphs[+T]=x[+T]);return c.ranges[m]=!0,{stack:e,id:r,glyph:x[r]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||l.u["CJK Unified Ideographs"](e)||l.u["Hangul Syllables"](e)||l.u.Hiragana(e)||l.u.Katakana(e)||l.u["CJK Symbols and Punctuation"](e)||l.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,c){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let m=e.tinySDF;if(!m){let T="400";/bold/i.test(r)?T="900":/medium/i.test(r)?T="500":/light/i.test(r)&&(T="200"),m=e.tinySDF=new Ma.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:f,fontWeight:T})}const x=m.draw(String.fromCharCode(c));return{id:c,bitmap:new l.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ma.loadGlyphRange=function(p,e,r,c){return l._(this,void 0,void 0,(function*(){const f=256*e,m=f+255,x=c.transformRequest(r.replace("{fontstack}",p).replace("{range}",`${f}-${m}`),"Glyphs"),T=yield l.n(x,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${e}, ${f}-${m}`);const C={};for(const k of l.o(T.data))C[k.id]=k;return C}))},Ma.TinySDF=class{constructor({fontSize:p=24,buffer:e=3,radius:r=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:m="normal",fontStyle:x="normal",lang:T=null}={}){this.buffer=e,this.cutoff=c,this.radius=r,this.lang=T;const C=this.size=p+4*e,k=this._createCanvas(C),L=this.ctx=k.getContext("2d",{willReadFrequently:!0});L.font=`${x} ${m} ${p}px ${f}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(p){const e=document.createElement("canvas");return e.width=e.height=p,e}draw(p){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:m}=this.ctx.measureText(p),x=Math.ceil(r),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-f))),C=Math.min(this.size-this.buffer,x+Math.ceil(c)),k=T+2*this.buffer,L=C+2*this.buffer,j=Math.max(k*L,0),N=new Uint8ClampedArray(j),q={data:N,width:k,height:L,glyphWidth:T,glyphHeight:C,glyphTop:x,glyphLeft:0,glyphAdvance:e};if(T===0||C===0)return q;const{ctx:X,buffer:ae,gridInner:ne,gridOuter:re}=this;this.lang&&(X.lang=this.lang),X.clearRect(ae,ae,T,C),X.fillText(p,ae,ae+x);const le=X.getImageData(ae,ae,T,C);re.fill(mi,0,j),ne.fill(0,0,j);for(let ue=0;ue<C;ue++)for(let ce=0;ce<T;ce++){const me=le.data[4*(ue*T+ce)+3]/255;if(me===0)continue;const ye=(ue+ae)*k+ce+ae;if(me===1)re[ye]=0,ne[ye]=mi;else{const he=.5-me;re[ye]=he>0?he*he:0,ne[ye]=he<0?he*he:0}}wi(re,0,0,k,L,k,this.f,this.v,this.z),wi(ne,ae,ae,T,C,k,this.f,this.v,this.z);for(let ue=0;ue<j;ue++){const ce=Math.sqrt(re[ue])-Math.sqrt(ne[ue]);N[ue]=Math.round(255-255*(ce/this.radius+this.cutoff))}return q}};class In{constructor(){this.specification=l.v.light.position}possiblyEvaluate(e,r){return l.B(e.expression.evaluate(r))}interpolate(e,r,c){return{x:l.C.number(e.x,r.x,c),y:l.C.number(e.y,r.y,c),z:l.C.number(e.z,r.z,c)}}}let sn;class Xe extends l.E{constructor(e){super(),sn=sn||new l.r({anchor:new l.D(l.v.light.anchor),position:new In,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.t(sn,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(l.x,e,r))for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,c){return(!c||c.validate!==!1)&&l.y(this,e.call(l.z,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:l.v}))}}const gt=new l.r({"sky-color":new l.D(l.v.sky["sky-color"]),"horizon-color":new l.D(l.v.sky["horizon-color"]),"fog-color":new l.D(l.v.sky["fog-color"]),"fog-ground-blend":new l.D(l.v.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.v.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.v.sky["atmosphere-blend"])});class Nt extends l.E{constructor(e){super(),this._transitionable=new l.t(gt,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0))}setSky(e,r={}){if(!this._validate(l.G,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,c={}){return c?.validate!==!1&&l.y(this,e.call(l.z,l.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Lt{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const c=e.join(",")+String(r);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,r)),this.dashEntry[c]}getDashRanges(e,r,c){const f=[];let m=e.length%2==1?-e[e.length-1]*c:0,x=e[0]*c,T=!0;f.push({left:m,right:x,isDash:T,zeroLength:e[0]===0});let C=e[0];for(let k=1;k<e.length;k++){T=!T;const L=e[k];m=C*c,C+=L,x=C*c,f.push({left:m,right:x,isDash:T,zeroLength:L===0})}return f}addRoundDash(e,r,c){const f=r/2;for(let m=-c;m<=c;m++){const x=this.width*(this.nextRow+c+m);let T=0,C=e[T];for(let k=0;k<this.width;k++){k/C.right>1&&(C=e[++T]);const L=Math.abs(k-C.left),j=Math.abs(k-C.right),N=Math.min(L,j);let q;const X=m/c*(f+1);if(C.isDash){const ae=f-Math.abs(X);q=Math.sqrt(N*N+ae*ae)}else q=f-Math.sqrt(N*N+X*X);this.data[x+k]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(e){for(let T=e.length-1;T>=0;--T){const C=e[T],k=e[T+1];C.zeroLength?e.splice(T,1):k&&k.isDash===C.isDash&&(k.left=C.left,e.splice(T,1))}const r=e[0],c=e[e.length-1];r.isDash===c.isDash&&(r.left=c.left-this.width,c.right=r.right+this.width);const f=this.width*this.nextRow;let m=0,x=e[m];for(let T=0;T<this.width;T++){T/x.right>1&&(x=e[++m]);const C=Math.abs(T-x.left),k=Math.abs(T-x.right),L=Math.min(C,k);this.data[f+T]=Math.max(0,Math.min(255,(x.isDash?L:-L)+128))}}addDash(e,r){const c=r?7:0,f=2*c+1;if(this.nextRow+f>this.height)return l.w("LineAtlas out of space"),null;let m=0;for(let T=0;T<e.length;T++)m+=e[T];if(m!==0){const T=this.width/m,C=this.getDashRanges(e,this.width,T);r?this.addRoundDash(C,T,c):this.addRegularDash(C)}const x={y:this.nextRow+c,height:2*c,width:m};return this.nextRow+=f,this.dirty=!0,x}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const Si="maplibre_preloaded_worker_pool";class be{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<be.workerCount;)this.workers.push(new Worker(l.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((r=>{r.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Si]}numActive(){return Object.keys(this.active).length}}const Ke=Math.floor(W.hardwareConcurrency/2);let pt,Et;function $t(){return pt||(pt=new be),pt}be.workerCount=l.H(globalThis)?Math.max(Math.min(Ke,3),1):1;class Ft{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const c=this.workerPool.acquire(r);for(let f=0;f<c.length;f++){const m=new l.J(c[f],r);m.name=`Worker ${f}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const c=[];for(const f of this.actors)c.push(f.sendAsync({type:e,data:r}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((r=>{r.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const c of this.actors)c.registerMessageHandler(e,r)}}function gi(){return Et||(Et=new Ft($t(),l.K),Et.registerMessageHandler("GR",((p,e,r)=>l.m(e,r)))),Et}function Qi(p,e){const r=l.L();return l.M(r,r,[1,1,0]),l.N(r,r,[.5*p.width,.5*p.height,1]),p.calculatePosMatrix?l.O(r,r,p.calculatePosMatrix(e.toUnwrapped())):r}function Pi(p,e,r,c,f,m,x){var T;const C=(function(N,q,X){if(N)for(const ae of N){const ne=q[ae];if(ne&&ne.source===X&&ne.type==="fill-extrusion")return!0}else for(const ae in q){const ne=q[ae];if(ne.source===X&&ne.type==="fill-extrusion")return!0}return!1})((T=f?.layers)!==null&&T!==void 0?T:null,e,p.id),k=m.maxPitchScaleFactor(),L=p.tilesIn(c,k,C);L.sort(Qr);const j=[];for(const N of L)j.push({wrappedTileID:N.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(e,r,p._state,N.queryGeometry,N.cameraQueryGeometry,N.scale,f,m,k,Qi(p.transform,N.tileID),x?(q,X)=>x(N.tileID,q,X):void 0)});return(function(N,q){for(const X in N)for(const ae of N[X])bs(ae,q);return N})((function(N){const q={},X={};for(const ae of N){const ne=ae.queryResults,re=ae.wrappedTileID,le=X[re]=X[re]||{};for(const ue in ne){const ce=ne[ue],me=le[ue]=le[ue]||{},ye=q[ue]=q[ue]||[];for(const he of ce)me[he.featureIndex]||(me[he.featureIndex]=!0,ye.push(he))}}return q})(j),p)}function Qr(p,e){const r=p.tileID,c=e.tileID;return r.overscaledZ-c.overscaledZ||r.canonical.y-c.canonical.y||r.wrap-c.wrap||r.canonical.x-c.canonical.x}function bs(p,e){const r=p.feature,c=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=c}function bn(p,e,r){return l._(this,void 0,void 0,(function*(){let c=p;if(p.url?c=(yield l.j(e.transformRequest(p.url,"Source"),r)).data:yield W.frameAsync(r),!c)return null;const f=l.Q(l.e(c,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(f.vectorLayerIds=c.vector_layers.map((m=>m.id))),f}))}class fa{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof l.S?new l.S(e.lng,e.lat):l.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof l.S?new l.S(e.lng,e.lat):l.S.convert(e),this}extend(e){const r=this._sw,c=this._ne;let f,m;if(e instanceof l.S)f=e,m=e;else{if(!(e instanceof fa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(fa.convert(e)):this.extend(l.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(l.S.convert(e)):this;if(f=e._sw,m=e._ne,!f||!m)return this}return r||c?(r.lng=Math.min(f.lng,r.lng),r.lat=Math.min(f.lat,r.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new l.S(f.lng,f.lat),this._ne=new l.S(m.lng,m.lat)),this}getCenter(){return new l.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.S(this.getWest(),this.getNorth())}getSouthEast(){return new l.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:c}=l.S.convert(e);let f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){return e instanceof fa?e:e&&new fa(e)}static fromLngLat(e,r=0){const c=360*r/40075017,f=c/Math.cos(Math.PI/180*e.lat);return new fa(new l.S(e.lng-f,e.lat-c),new l.S(e.lng+f,e.lat+c))}adjustAntiMeridian(){const e=new l.S(this._sw.lng,this._sw.lat),r=new l.S(this._ne.lng,this._ne.lat);return new fa(e,e.lng>r.lng?new l.S(r.lng+360,r.lat):r)}}class qi{constructor(e,r,c){this.bounds=fa.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),c=Math.floor(l.V(this.bounds.getWest())*r),f=Math.floor(l.U(this.bounds.getNorth())*r),m=Math.ceil(l.V(this.bounds.getEast())*r),x=Math.ceil(l.U(this.bounds.getSouth())*r);return e.x>=c&&e.x<m&&e.y>=f&&e.y<x}}class qn extends l.E{constructor(e,r,c,f){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.Q(r,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield bn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(l.e(this,e),e.bounds&&(this.tileBounds=new qi(e.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new l.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(e){return l._(this,void 0,void 0,(function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((m,x)=>{e.reloadPromise={resolve:m,reject:x}}))}else e.actor=this.dispatcher.getActor(),f="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:f,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return l._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class fr extends l.E{constructor(e,r,c,f){super(),this.id=e,this.dispatcher=c,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},r),l.e(this,l.Q(r,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield bn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(l.e(this,r),r.bounds&&(this.tileBounds=new qi(r.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this._loaded=!0,this.fire(new l.k(r))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return l.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return l._(this,void 0,void 0,(function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield mt.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&(c.cacheControl||c.expires)&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const f=this.map.painter.context,m=f.gl,x=c.data;e.texture=this.map.painter.getTileTexture(x.width),e.texture?e.texture.update(x,{useMipmap:!0}):(e.texture=new l.T(f,x,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}}))}abortTile(e){return l._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class jo extends fr{constructor(e,r,c,f){super(e,r,c,f),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return l._(this,void 0,void 0,(function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const f=yield mt.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){const m=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const x=l.b(m)&&l.W()?m:yield this.readImageNow(m),T={type:this.type,uid:e.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const C=yield e.actor.sendAsync({type:"LDT",data:T});e.dem=C,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}}))}readImageNow(e){return l._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&l.X()){const r=e.width+2,c=e.height+2;try{return new l.R({width:r,height:c},yield l.Y(e,-1,-1,r,c))}catch{}}return W.getImageData(e,1)}))}_getNeighboringTiles(e){const r=e.canonical,c=Math.pow(2,r.z),f=(r.x-1+c)%c,m=r.x===0?e.wrap-1:e.wrap,x=(r.x+1+c)%c,T=r.x+1===c?e.wrap+1:e.wrap,C={};return C[new l.Z(e.overscaledZ,m,r.z,f,r.y).key]={backfilled:!1},C[new l.Z(e.overscaledZ,T,r.z,x,r.y).key]={backfilled:!1},r.y>0&&(C[new l.Z(e.overscaledZ,m,r.z,f,r.y-1).key]={backfilled:!1},C[new l.Z(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},C[new l.Z(e.overscaledZ,T,r.z,x,r.y-1).key]={backfilled:!1}),r.y+1<c&&(C[new l.Z(e.overscaledZ,m,r.z,f,r.y+1).key]={backfilled:!1},C[new l.Z(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},C[new l.Z(e.overscaledZ,T,r.z,x,r.y+1).key]={backfilled:!1}),C}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class Ks extends l.E{constructor(e,r,c,f){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:r.data},this.actor=c.getActor(),this.setEventedParent(f),this._data=r.data,this._options=l.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:l.$,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(r.clusterMaxZoom),minPoints:Math.max(2,r.clusterMinPoints||2),extent:l.$,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(l.$/this.tileSize)}_getClusterMaxZoom(e){const r=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||l.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${r}"`),r}load(){return l._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=l.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return l._(this,void 0,void 0,(function*(){const e=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map((r=>r.coordinates)).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return l._(this,void 0,void 0,(function*(){const e=new fa,r=yield this.getData();let c;switch(r.type){case"FeatureCollection":c=r.features.map((f=>this.getCoordinatesFromGeometry(f.geometry))).flat(1/0);break;case"Feature":c=this.getCoordinatesFromGeometry(r.geometry);break;default:c=this.getCoordinatesFromGeometry(r)}if(c.length==0)return e;for(let f=0;f<c.length-1;f+=2)e.extend([c[f],c[f+1]]);return e}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:c}})}_updateWorkerData(){return l._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:e,diff:r}=this._pendingWorkerUpdate;if(!e&&!r)return void l.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const c=l.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(c.request=this.map._requestManager.transformRequest(W.resolveURL(e),"Source"),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):r&&(c.dataDiff=r,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new l.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:c});if(this._isUpdatingWorker=!1,this._removed||f.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));this._data=f.data;let m=null;f.resourceTiming&&f.resourceTiming[this.id]&&(m=f.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&l.e(x,{resourceTiming:m}),this.fire(new l.l("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(f){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(f))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return l._(this,void 0,void 0,(function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const f=yield this.actor.sendAsync({type:r,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(f,this.map.painter,r==="RT")}))}abortTile(e){return l._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return l._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class wn extends l.E{constructor(e,r,c,f){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=c,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=r}load(e){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield mt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new l.k(r))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(l.a1.fromLngLat);var c;return this.tileID=(function(f){const m=l.a2.fromPoints(f),x=m.width(),T=m.height(),C=Math.max(x,T),k=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),L=Math.pow(2,k);return new l.a4(k,Math.floor((m.minX+m.maxX)/2*L),Math.floor((m.minY+m.maxY)/2*L))})(r),this.terrainTileRanges=this._getOverlappingTileRanges(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map((f=>this.tileID.getTilePoint(f)._round())),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new l.T(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const m=this.tiles[f];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return l._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:r,minY:c,maxX:f,maxY:m}=l.a2.fromPoints(e),x={};for(let T=0;T<=l.a3;T++){const C=Math.pow(2,T),k=Math.floor(r*C),L=Math.floor(c*C),j=Math.floor(f*C),N=Math.floor(m*C);x[T]={minTileX:k,minTileY:L,maxTileX:j,maxTileY:N}}return x}}class Js extends wn{constructor(e,r,c,f){super(e,r,c,f),this.roundZoom=!0,this.type="video",this.options=r}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield l.a5(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new l.k(r))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new l.k(new l.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new l.T(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const m=this.tiles[f];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Go extends wn{constructor(e,r,c,f){super(e,r,c,f),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some((m=>!Array.isArray(m)||m.length!==2||m.some((x=>typeof x!="number"))))||this.fire(new l.k(new l.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.a6(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new l.k(new l.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,c=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.T(r,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const m in this.tiles){const x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,f=!0)}f&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const eo={},Kr=p=>{switch(p){case"geojson":return Ks;case"image":return wn;case"raster":return fr;case"raster-dem":return jo;case"vector":return qn;case"video":return Js;case"canvas":return Go}return eo[p]},Na="RTLPluginLoaded";class dc extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=gi()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((r=>{throw this.status="error",r}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return l._(this,arguments,void 0,(function*(r,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=W.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return l._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(Na))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Zn=null;function ws(){return Zn||(Zn=new dc),Zn}var Sn,we;(function(p){p[p.Base=0]="Base",p[p.Parent=1]="Parent"})(Sn||(Sn={})),(function(p){p[p.Departing=0]="Departing",p[p.Incoming=1]="Incoming"})(we||(we={}));class ${constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=e,this.uid=l.a7(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(e){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(e||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:e,fadingDirection:r,fadingParentID:c,fadeEndTime:f}){this.resetFadeLogic(),this.fadingRole=e,this.fadingDirection=r,this.fadingParentID=c,this.fadeEndTime=f}setSelfFadeLogic(e){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=e}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=W.now(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(f,m){const x={};if(!m)return x;for(const T of f){const C=T.layerIds.map((k=>m.getLayer(k))).filter(Boolean);if(C.length!==0){T.layers=C,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map((k=>C.filter((L=>L.id===k))[0])));for(const k of C)x[k.id]=T}}return x})(e.buckets,r?.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const m=this.buckets[f];if(m instanceof l.a9){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const m=this.buckets[f];if(m instanceof l.a9&&m.hasRTLText){this.hasRTLText=!0,ws().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const m=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(f).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),this.dashPositions=e.dashPositions}else this.collisionBoxArray=new l.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l.T(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l.T(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,c,f,m,x,T,C,k,L,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:m,scale:x,tileSize:this.tileSize,pixelPosMatrix:L,transform:C,params:T,queryPadding:this.queryPadding*k,getElevation:j},e,r,c):{}}querySourceFeatures(e,r){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),m=r&&r.sourceLayer?r.sourceLayer:"",x=f._geojsonTileLayer||f[m];if(!x)return;const T=l.aa(r?.filter,r?.globalState),{z:C,x:k,y:L}=this.tileID.canonical,j={z:C,x:k,y:L};for(let N=0;N<x.length;N++){const q=x.feature(N);if(T.needGeometry){const ne=l.ab(q,!0);if(!T.filter(new l.F(this.tileID.overscaledZ),ne,this.tileID.canonical))continue}else if(!T.filter(new l.F(this.tileID.overscaledZ),q))continue;const X=c.getId(q,m),ae=new l.ac(q,C,k,L,X);ae.tile=j,e.push(ae)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const c=l.ad(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(r)if(this.expirationTime<r)f=!0;else{const m=this.expirationTime-r;m?this.expirationTime=c+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!r.style.hasLayer(f))continue;const m=this.buckets[f],x=m.layers[0].sourceLayer||"_geojsonTileLayer",T=c[x],C=e[x];if(!T||!C||Object.keys(C).length===0)continue;m.update(C,T,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const k=r&&r.style&&r.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(m)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<W.now()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(e){this.symbolFadeHoldUntil=W.now()+e}setDependencies(e,r){const c={};for(const f of r)c[f]=!0;this.dependencies[e]=c}hasDependency(e,r){for(const c of e){const f=this.dependencies[c];if(f){for(const m of r)if(f[m])return!0}}return!1}}class H{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,c){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const m={value:r,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout((()=>{this.remove(e,m)}),c)),this.data[f].push(m),this.order.push(f),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const c=e.wrapped().key,f=r===void 0?0:this.data[c].indexOf(r),m=this.data[c][f];return this.data[c].splice(f,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const c in this.data)for(const f of this.data[c])e(f.value)||r.push(f);for(const c of r)this.remove(c.value.tileID,c)}}class ie{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,c){const f=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},l.e(this.stateChanges[e][f],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==f&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const m in this.state[e][f])c[m]||(this.deletedStates[e][f][m]=null)}else for(const m in c)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][m]===null&&delete this.deletedStates[e][f][m]}removeFeatureState(e,r,c){if(this.deletedStates[e]===null)return;const f=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&r!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][c]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(c in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][c]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,r){const c=String(r),f=l.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][r];if(m===null)return{};for(const x in m)delete f[x]}return f}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const m={};for(const x in this.stateChanges[f])this.state[f][x]||(this.state[f][x]={}),l.e(this.state[f][x],this.stateChanges[f][x]),m[x]=this.state[f][x];c[f]=m}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const m={};if(this.deletedStates[f]===null)for(const x in this.state[f])m[x]={},this.state[f][x]={};else for(const x in this.deletedStates[f]){if(this.deletedStates[f][x]===null)this.state[f][x]={};else for(const T of Object.keys(this.deletedStates[f][x]))delete this.state[f][x][T];m[x]=this.state[f][x]}c[f]=c[f]||{},l.e(c[f],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in e)e[f].setFeatureState(c,r)}}const fe=89.25;function pe(p,e){const r=l.ah(e.lat,-l.ai,l.ai);return new l.P(l.V(e.lng)*p,l.U(r)*p)}function xe(p,e){return new l.a1(e.x/p,e.y/p).toLngLat()}function Ie(p){return p.cameraToCenterDistance*Math.min(.85*Math.tan(l.ae(90-p.pitch)),Math.tan(l.ae(fe-p.pitch)))}function Ee(p,e){const r=p.canonical,c=e/l.af(r.z),f=r.x+Math.pow(2,r.z)*p.wrap,m=l.ag(new Float64Array(16));return l.M(m,m,[f*c,r.y*c,0]),l.N(m,m,[c/l.$,c/l.$,1]),m}function Ve(p,e,r,c,f){const m=l.a1.fromLngLat(p,e),x=f*l.aj(1,p.lat),T=x*Math.cos(l.ae(r)),C=Math.sqrt(x*x-T*T),k=C*Math.sin(l.ae(-c)),L=C*Math.cos(l.ae(-c));return new l.a1(m.x+k,m.y+L,m.z+T)}function at(p,e,r){const c=e.intersectsFrustum(p);if(!r||c===0)return c;const f=e.intersectsPlane(r);return f===0?0:c===2&&f===2?2:1}function $e(p,e,r){let c=0;const f=(r-e)/10;for(let m=0;m<10;m++)c+=f*Math.pow(Math.cos(e+(m+.5)/10*(r-e)),p);return c}function xt(p,e){return function(r,c,f,m,x){const T=2*((p-1)/l.ak(Math.cos(l.ae(fe-x))/Math.cos(l.ae(fe)))-1),C=Math.acos(f/m),k=2*$e(T-1,0,l.ae(x/2)),L=Math.min(l.ae(fe),C+l.ae(x/2)),j=$e(T-1,Math.min(L,C-l.ae(x/2)),L),N=Math.atan(c/f),q=Math.hypot(c,f);let X=r;return X+=l.ak(m/q/Math.max(.5,Math.cos(l.ae(x/2)))),X+=T*l.ak(Math.cos(N))/2,X-=l.ak(Math.max(1,j/k/e))/2,X}}const It=xt(9.314,3);function Ae(p,e){const r=(e.roundZoom?Math.round:Math.floor)(p.zoom+l.ak(p.tileSize/e.tileSize));return Math.max(0,r)}function ii(p,e){const r=p.getCameraFrustum(),c=p.getClippingPlane(),f=p.screenPointToMercatorCoordinate(p.getCameraPoint()),m=l.a1.fromLngLat(p.center,p.elevation);f.z=m.z+Math.cos(p.pitchInRadians)*p.cameraToCenterDistance/p.worldSize;const x=p.getCoveringTilesDetailsProvider(),T=x.allowVariableZoom(p,e),C=Ae(p,e),k=e.minzoom||0,L=e.maxzoom!==void 0?e.maxzoom:p.maxZoom,j=Math.min(Math.max(0,C),L),N=Math.pow(2,j),q=[N*f.x,N*f.y,0],X=[N*m.x,N*m.y,0],ae=Math.hypot(m.x-f.x,m.y-f.y),ne=Math.abs(m.z-f.z),re=Math.hypot(ae,ne),le=me=>({zoom:0,x:0,y:0,wrap:me,fullyVisible:!1}),ue=[],ce=[];if(p.renderWorldCopies&&x.allowWorldCopies())for(let me=1;me<=3;me++)ue.push(le(-me)),ue.push(le(me));for(ue.push(le(0));ue.length>0;){const me=ue.pop(),ye=me.x,he=me.y;let Se=me.fullyVisible;const Oe={x:ye,y:he,z:me.zoom},Re=x.getTileBoundingVolume(Oe,me.wrap,p.elevation,e);if(!Se){const st=at(r,Re,c);if(st===0)continue;Se=st===2}const ke=x.distanceToTile2d(f.x,f.y,Oe,Re);let Le=C;T&&(Le=(e.calculateTileZoom||It)(p.zoom+l.ak(p.tileSize/e.tileSize),ke,ne,re,p.fov)),Le=(e.roundZoom?Math.round:Math.floor)(Le),Le=Math.max(0,Le);const rt=Math.min(Le,L);if(me.wrap=x.getWrap(m,Oe,me.wrap),me.zoom>=rt){if(me.zoom<k)continue;const st=j-me.zoom,Qe=q[0]-.5-(ye<<st),wt=q[1]-.5-(he<<st),Ut=e.reparseOverscaled?Math.max(me.zoom,Le):me.zoom;ce.push({tileID:new l.Z(me.zoom===L?Ut:me.zoom,me.wrap,me.zoom,ye,he),distanceSq:l.al([X[0]-.5-ye,X[1]-.5-he]),tileDistanceToCamera:Math.sqrt(Qe*Qe+wt*wt)})}else for(let st=0;st<4;st++)ue.push({zoom:me.zoom+1,x:(ye<<1)+st%2,y:(he<<1)+(st>>1),wrap:me.wrap,fullyVisible:Se})}return ce.sort(((me,ye)=>me.distanceSq-ye.distanceSq)).map((me=>me.tileID))}const fi=l.a2.fromPoints([new l.P(0,0),new l.P(l.$,l.$)]);class Tt extends l.E{constructor(e,r,c){super(),this.id=e,this.dispatcher=c,this.on("data",(f=>this._dataHandler(f))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((f,m,x,T)=>{const C=new(Kr(m.type))(f,m,x,T);if(C.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${C.id}`);return C})(e,r,c,this),this._tiles={},this._cache=new H(0,(f=>this._unloadTile(f))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new ie,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,c){return l._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,c)}catch(f){e.state="errored",f.status!==404?this._source.fire(new l.k(f,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new l.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const c=this._tiles[r];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(ui).map((e=>e.key))}getRenderableIds(e){const r=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&r.push(this._tiles[c]);return e?r.sort(((c,f)=>{const m=c.tileID,x=f.tileID,T=new l.P(m.canonical.x,m.canonical.y)._rotate(-this.transform.bearingInRadians),C=new l.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians);return m.overscaledZ-x.overscaledZ||C.y-T.y||C.x-T.x})).map((c=>c.tileID.key)):r.map((c=>c.tileID)).sort(ui).map((c=>c.key))}hasRenderableParent(e){const r=e.overscaledZ-1;if(r>=this._source.minzoom){const c=this._getLoadedTile(e.scaledTo(r));if(c)return this._isIdRenderable(c.tileID.key)}return!1}_isIdRenderable(e,r=!1){var c;return(c=this._tiles[e])===null||c===void 0?void 0:c.isRenderable(r)}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)e?this._reloadTile(r,"expired"):this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return l._(this,void 0,void 0,(function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=r),yield this._loadTile(c,e,r))}))}_tileLoaded(e,r,c){e.timeAdded=W.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let f=0;f<r.length;f++){const m=r[f];if(e.neighboringTiles&&e.neighboringTiles[m]){const x=this.getTileByID(m);c(e,x),c(x,e)}}function c(f,m){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let x=m.tileID.canonical.x-f.tileID.canonical.x;const T=m.tileID.canonical.y-f.tileID.canonical.y,C=Math.pow(2,f.tileID.canonical.z),k=m.tileID.key;x===0&&T===0||Math.abs(T)>1||(Math.abs(x)>1&&(Math.abs(x+C)===1?x+=C:Math.abs(x-C)===1&&(x-=C)),m.dem&&f.dem&&(f.dem.backfillBorder(m.dem,x,T),f.neighboringTiles&&f.neighboringTiles[k]&&(f.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r){const c=Object.values(e),f=this._getLoadedDescendents(c),m={};for(const x of c){const T=f[x.key];if(!T?.length){m[x.key]=x;continue}const C=x.overscaledZ+Tt.maxUnderzooming,k=T.filter((N=>N.tileID.overscaledZ<=C));if(!k.length){m[x.key]=x;continue}const L=Math.min(...k.map((N=>N.tileID.overscaledZ))),j=k.filter((N=>N.tileID.overscaledZ===L)).map((N=>N.tileID));for(const N of j)r[N.key]=N;this._areDescendentsComplete(j,L,x.overscaledZ)||(m[x.key]=x)}return m}_getLoadedDescendents(e){var r;const c={};for(const f in this._tiles){const m=this._tiles[f];if(m.hasData())for(const x of e)m.tileID.isChildOf(x)&&(c[r=x.key]||(c[r]=[])).push(m)}return c}_areDescendentsComplete(e,r,c){return e.length===1&&e[0].isOverscaled()?e[0].overscaledZ===r:Math.pow(4,r-c)===e.length}_getLoadedTile(e){const r=this._tiles[e.key];return r?.hasData()?r:null}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,f=Math.floor(r*c*(this._maxTileCacheZoomLevels===null?l.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(m)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const c={};for(const f in this._tiles){const m=this._tiles[f];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+r),c[m.tileID.key]=m}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}update(e,r){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((C=>new l.Z(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y))):(c=ii(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter((C=>this._source.hasTile(C))))):c=[],this.usedForTerrain&&(c=this._addTerrainIdealTiles(c));const f=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,f&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const m=Ae(e,this._source),x=this._updateRetainedTiles(c,m),T=Ta(this._source.type);T&&this._rasterFadeDuration>0&&!r&&this._updateFadingTiles(c,x),T?this._cleanUpRasterTiles(x):this._cleanUpVectorTiles(x)}_cleanUpRasterTiles(e){for(const r in this._tiles)e[r]||this._removeTile(r)}_cleanUpVectorTiles(e){for(const r in this._tiles){const c=this._tiles[r];e[r]?c.clearSymbolFadeHold():c.hasSymbolBuckets?c.holdingForSymbolFade()?c.symbolFadeFinished()&&this._removeTile(r):c.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(r)}}_addTerrainIdealTiles(e){const r=[];for(const c of e)if(c.canonical.z>this._source.minzoom){const f=c.scaledTo(c.canonical.z-1);r.push(f);const m=c.scaledTo(Math.max(this._source.minzoom,Math.min(c.canonical.z,5)));r.push(m)}return e.concat(r)}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForSymbolFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var c;const f={},m={},x=Math.max(r-Tt.maxOverzooming,this._source.minzoom);let T={};for(const C of e){const k=this._addTile(C);f[C.key]=C,k.hasData()||(T[C.key]=C)}T=this._retainLoadedChildren(T,f);for(const C in T){const k=T[C];let L=this._tiles[C],j=L?.wasRequested();for(let N=k.overscaledZ-1;N>=x;--N){const q=k.scaledTo(N);if(m[q.key])break;if(m[q.key]=!0,L=this.getTile(q),!L&&j&&(L=this._addTile(q)),L){const X=L.hasData();if((X||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||j)&&(f[q.key]=q),j=L.wasRequested(),X)break}}}return f}_updateFadingTiles(e,r){const c=W.now(),f=l.am(e);for(const m of e){const x=this._tiles[m.key];x.fadingDirection!==we.Departing&&x.fadeOpacity!==0||x.resetFadeLogic(),this._updateFadingAncestor(x,r,c)||this._updateFadingDescendents(x,r,c)||this._updateFadingEdge(x,f,c)||x.resetFadeLogic()}}_updateFadingAncestor(e,r,c){if(!e.hasData())return!1;const{tileID:f,fadingRole:m,fadingDirection:x,fadingParentID:T}=e;if(m===Sn.Base&&x===we.Incoming&&T)return r[T.key]=T,!0;const C=Math.max(f.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let k=f.overscaledZ-1;k>=C;k--){const L=f.scaledTo(k),j=this._getLoadedTile(L);if(j)return e.setCrossFadeLogic({fadingRole:Sn.Base,fadingDirection:we.Incoming,fadingParentID:j.tileID,fadeEndTime:c+this._rasterFadeDuration}),j.setCrossFadeLogic({fadingRole:Sn.Parent,fadingDirection:we.Departing,fadeEndTime:c+this._rasterFadeDuration}),r[L.key]=L,!0}return!1}_updateFadingDescendents(e,r,c){if(!e.hasData())return!1;const f=e.tileID.children(this._source.maxzoom);let m=this._updateFadingChildren(e,f,r,c);if(m)return!0;for(const x of f){const T=x.children(this._source.maxzoom);this._updateFadingChildren(e,T,r,c)&&(m=!0)}return m}_updateFadingChildren(e,r,c,f){if(r[0].overscaledZ>=this._source.maxzoom)return!1;let m=!1;for(const x of r){const T=this._getLoadedTile(x);if(!T)continue;const{fadingRole:C,fadingDirection:k,fadingParentID:L}=T;C===Sn.Base&&k===we.Departing&&L||(T.setCrossFadeLogic({fadingRole:Sn.Base,fadingDirection:we.Departing,fadingParentID:e.tileID,fadeEndTime:f+this._rasterFadeDuration}),e.setCrossFadeLogic({fadingRole:Sn.Parent,fadingDirection:we.Incoming,fadeEndTime:f+this._rasterFadeDuration})),c[x.key]=x,m=!0}return m}_updateFadingEdge(e,r,c){const f=e.tileID;return!!e.selfFading||!e.hasData()&&!!r.has(f)&&(e.setSelfFadeLogic(c+this._rasterFadeDuration),!0)}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(r.resetFadeLogic(),this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const c=r;return r||(r=new $(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,c||this._source.fire(new l.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=r.getExpiryTimeout();c&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),c))}refreshTiles(e){for(const r in this._tiles)(this._isIdRenderable(r)||this._tiles[r].state=="errored")&&e.some((c=>c.equals(this._tiles[r].tileID.canonical)))&&this._reloadTile(r,"expired")}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){e.dataType==="source"&&(e.sourceDataType!=="metadata"?e.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,c){const f=[],m=this.transform;if(!m)return f;const x=m.getCoveringTilesDetailsProvider().allowWorldCopies(),T=c?m.getCameraQueryGeometry(e):e,C=q=>m.screenPointToMercatorCoordinate(q,this.terrain),k=this.transformBbox(e,C,!x),L=this.transformBbox(T,C,!x),j=this.getIds(),N=l.a2.fromPoints(L);for(let q=0;q<j.length;q++){const X=this._tiles[j[q]];if(X.holdingForSymbolFade())continue;const ae=x?[X.tileID]:[X.tileID.unwrapTo(-1),X.tileID.unwrapTo(0)],ne=Math.pow(2,m.zoom-X.tileID.overscaledZ),re=r*X.queryPadding*l.$/X.tileSize/ne;for(const le of ae){const ue=N.map((ce=>le.getTilePoint(new l.a1(ce.x,ce.y))));if(ue.expandBy(re),ue.intersects(fi)){const ce=k.map((ye=>le.getTilePoint(ye))),me=L.map((ye=>le.getTilePoint(ye)));f.push({tile:X,tileID:x?le:le.unwrapTo(0),queryGeometry:ce,cameraQueryGeometry:me,scale:ne})}}}return f}transformBbox(e,r,c){let f=e.map(r);if(c){const m=l.a2.fromPoints(e);m.shrinkBy(.001*Math.min(m.width(),m.height()));const x=m.map(r);l.a2.fromPoints(f).covers(x)||(f=f.map((T=>T.x>.5?new l.a1(T.x-1,T.y,T.z):T)))}return f}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map((c=>this._tiles[c].tileID));return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(Ta(this._source.type)&&this._rasterFadeDuration>0){const e=W.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setRasterFadeDuration(e){this._rasterFadeDuration=e}setFeatureState(e,r,c){this._state.updateState(e=e||"_geojsonTileLayer",r,c)}removeFeatureState(e,r,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,c)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,c){const f=this._tiles[e];f&&f.setDependencies(r,c)}reloadTilesForDependencies(e,r){for(const c in this._tiles)this._tiles[c].hasDependency(e,r)&&this._reloadTile(c,"reloading");this._cache.filter((c=>!c.hasDependency(e,r)))}}function ui(p,e){const r=Math.abs(2*p.wrap)-+(p.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return p.overscaledZ-e.overscaledZ||c-r||e.canonical.y-p.canonical.y||e.canonical.x-p.canonical.x}function Ta(p){return p==="raster"||p==="image"||p==="video"}Tt.maxOverzooming=10,Tt.maxUnderzooming=3;class pa{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=l.ah(e,0,1);let r=1,c=this._distances[r];const f=e*this.paddedLength+this.padding;for(;c<f&&r<this._distances.length;)c=this._distances[++r];const m=r-1,x=this._distances[m],T=c-x,C=T>0?(f-x)/T:0;return this.points[m].mult(1-C).add(this.points[r].mult(C))}}function Pa(p,e){let r=!0;return p==="always"||p!=="never"&&e!=="never"||(r=!1),r}class Ya{constructor(e,r,c){const f=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(r/c);for(let x=0;x<this.xCellCount*this.yCellCount;x++)f.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,c,f,m){this._forEachCell(r,c,f,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(m)}insertCircle(e,r,c,f){this._forEachCell(r-f,c-f,r+f,c+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(c),this.circles.push(f)}_insertBoxCell(e,r,c,f,m,x){this.boxCells[m].push(x)}_insertCircleCell(e,r,c,f,m,x){this.circleCells[m].push(x)}_query(e,r,c,f,m,x,T){if(c<0||e>this.width||f<0||r>this.height)return[];const C=[];if(e<=0&&r<=0&&this.width<=c&&this.height<=f){if(m)return[{key:null,x1:e,y1:r,x2:c,y2:f}];for(let k=0;k<this.boxKeys.length;k++)C.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const L=this.circles[3*k],j=this.circles[3*k+1],N=this.circles[3*k+2];C.push({key:this.circleKeys[k],x1:L-N,y1:j-N,x2:L+N,y2:j+N})}}else this._forEachCell(e,r,c,f,this._queryCell,C,{hitTest:m,overlapMode:x,seenUids:{box:{},circle:{}}},T);return C}query(e,r,c,f){return this._query(e,r,c,f,!1,null)}hitTest(e,r,c,f,m,x){return this._query(e,r,c,f,!0,m,x).length>0}hitTestCircle(e,r,c,f,m){const x=e-c,T=e+c,C=r-c,k=r+c;if(T<0||x>this.width||k<0||C>this.height)return!1;const L=[];return this._forEachCell(x,C,T,k,this._queryCellCircle,L,{hitTest:!0,overlapMode:f,circle:{x:e,y:r,radius:c},seenUids:{box:{},circle:{}}},m),L.length>0}_queryCell(e,r,c,f,m,x,T,C){const{seenUids:k,hitTest:L,overlapMode:j}=T,N=this.boxCells[m];if(N!==null){const X=this.bboxes;for(const ae of N)if(!k.box[ae]){k.box[ae]=!0;const ne=4*ae,re=this.boxKeys[ae];if(e<=X[ne+2]&&r<=X[ne+3]&&c>=X[ne+0]&&f>=X[ne+1]&&(!C||C(re))&&(!L||!Pa(j,re.overlapMode))&&(x.push({key:re,x1:X[ne],y1:X[ne+1],x2:X[ne+2],y2:X[ne+3]}),L))return!0}}const q=this.circleCells[m];if(q!==null){const X=this.circles;for(const ae of q)if(!k.circle[ae]){k.circle[ae]=!0;const ne=3*ae,re=this.circleKeys[ae];if(this._circleAndRectCollide(X[ne],X[ne+1],X[ne+2],e,r,c,f)&&(!C||C(re))&&(!L||!Pa(j,re.overlapMode))){const le=X[ne],ue=X[ne+1],ce=X[ne+2];if(x.push({key:re,x1:le-ce,y1:ue-ce,x2:le+ce,y2:ue+ce}),L)return!0}}}return!1}_queryCellCircle(e,r,c,f,m,x,T,C){const{circle:k,seenUids:L,overlapMode:j}=T,N=this.boxCells[m];if(N!==null){const X=this.bboxes;for(const ae of N)if(!L.box[ae]){L.box[ae]=!0;const ne=4*ae,re=this.boxKeys[ae];if(this._circleAndRectCollide(k.x,k.y,k.radius,X[ne+0],X[ne+1],X[ne+2],X[ne+3])&&(!C||C(re))&&!Pa(j,re.overlapMode))return x.push(!0),!0}}const q=this.circleCells[m];if(q!==null){const X=this.circles;for(const ae of q)if(!L.circle[ae]){L.circle[ae]=!0;const ne=3*ae,re=this.circleKeys[ae];if(this._circlesCollide(X[ne],X[ne+1],X[ne+2],k.x,k.y,k.radius)&&(!C||C(re))&&!Pa(j,re.overlapMode))return x.push(!0),!0}}}_forEachCell(e,r,c,f,m,x,T,C){const k=this._convertToXCellCoord(e),L=this._convertToYCellCoord(r),j=this._convertToXCellCoord(c),N=this._convertToYCellCoord(f);for(let q=k;q<=j;q++)for(let X=L;X<=N;X++)if(m.call(this,e,r,c,f,this.xCellCount*X+q,x,T,C))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,c,f,m,x){const T=f-e,C=m-r,k=c+x;return k*k>T*T+C*C}_circleAndRectCollide(e,r,c,f,m,x,T){const C=(x-f)/2,k=Math.abs(e-(f+C));if(k>C+c)return!1;const L=(T-m)/2,j=Math.abs(r-(m+L));if(j>L+c)return!1;if(k<=C||j<=L)return!0;const N=k-C,q=j-L;return N*N+q*q<=c*c}}function Ni(p,e,r){const c=l.L();if(!p){const{vecSouth:j,vecEast:N}=Mi(e),q=U();q[0]=N[0],q[1]=N[1],q[2]=j[0],q[3]=j[1],f=q,(L=(x=(m=q)[0])*(k=m[3])-(C=m[2])*(T=m[1]))&&(f[0]=k*(L=1/L),f[1]=-T*L,f[2]=-C*L,f[3]=x*L),c[0]=q[0],c[1]=q[1],c[4]=q[2],c[5]=q[3]}var f,m,x,T,C,k,L;return l.N(c,c,[1/r,1/r,1]),c}function za(p,e,r,c){if(p){const f=l.L();if(!e){const{vecSouth:m,vecEast:x}=Mi(r);f[0]=x[0],f[1]=x[1],f[4]=m[0],f[5]=m[1]}return l.N(f,f,[c,c,1]),f}return r.pixelsToClipSpaceMatrix}function Mi(p){const e=Math.cos(p.rollInRadians),r=Math.sin(p.rollInRadians),c=Math.cos(p.pitchInRadians),f=Math.cos(p.bearingInRadians),m=Math.sin(p.bearingInRadians),x=l.ar();x[0]=-f*c*r-m*e,x[1]=-m*c*r+f*e;const T=l.as(x);T<1e-9?l.at(x):l.au(x,x,1/T);const C=l.ar();C[0]=f*c*e-m*r,C[1]=m*c*e+f*r;const k=l.as(C);return k<1e-9?l.at(C):l.au(C,C,1/k),{vecEast:C,vecSouth:x}}function tt(p,e,r,c){let f;c?(f=[p,e,c(p,e),1],l.aw(f,f,r)):(f=[p,e,0,1],oa(f,f,r));const m=f[3];return{point:new l.P(f[0]/m,f[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function Ir(p,e){return .5+p/e*.5}function Rn(p,e){return p.x>=-e[0]&&p.x<=e[0]&&p.y>=-e[1]&&p.y<=e[1]}function Ia(p,e,r,c,f,m,x,T,C,k,L,j,N){const q=r?p.textSizeData:p.iconSizeData,X=l.an(q,e.transform.zoom),ae=[256/e.width*2+1,256/e.height*2+1],ne=r?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;ne.clear();const re=p.lineVertexArray,le=r?p.text.placedSymbolArray:p.icon.placedSymbolArray,ue=e.transform.width/e.transform.height;let ce=!1;for(let me=0;me<le.length;me++){const ye=le.get(me);if(ye.hidden||ye.writingMode===l.ao.vertical&&!ce){Dn(ye.numGlyphs,ne);continue}ce=!1;const he=new l.P(ye.anchorX,ye.anchorY),Se={getElevation:N,pitchedLabelPlaneMatrix:c,lineVertexArray:re,pitchWithMap:m,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:he,unwrappedTileID:C,width:k,height:L,translation:j},Oe=Ht(ye.anchorX,ye.anchorY,Se);if(!Rn(Oe.point,ae)){Dn(ye.numGlyphs,ne);continue}const Re=Ir(e.transform.cameraToCenterDistance,Oe.signedDistanceFromCamera),ke=l.ap(q,X,ye),Le=m?ke*e.transform.getPitchedTextCorrection(ye.anchorX,ye.anchorY,C)/Re:ke*Re,rt=Xt({projectionContext:Se,pitchedLabelPlaneMatrixInverse:f,symbol:ye,fontSize:Le,flip:!1,keepUpright:x,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:ne,aspectRatio:ue,rotateToLine:T});ce=rt.useVertical,(rt.notEnoughRoom||ce||rt.needsFlipping&&Xt({projectionContext:Se,pitchedLabelPlaneMatrixInverse:f,symbol:ye,fontSize:Le,flip:!0,keepUpright:x,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:ne,aspectRatio:ue,rotateToLine:T}).notEnoughRoom)&&Dn(ye.numGlyphs,ne)}r?p.text.dynamicLayoutVertexBuffer.updateData(ne):p.icon.dynamicLayoutVertexBuffer.updateData(ne)}function _i(p,e,r,c,f,m,x,T){const C=m.glyphStartIndex+m.numGlyphs,k=m.lineStartIndex,L=m.lineStartIndex+m.lineLength,j=e.getoffsetX(m.glyphStartIndex),N=e.getoffsetX(C-1),q=pr(p*j,r,c,f,m.segment,k,L,T,x);if(!q)return null;const X=pr(p*N,r,c,f,m.segment,k,L,T,x);return X?T.projectionCache.anyProjectionOccluded?null:{first:q,last:X}:null}function nt(p,e,r,c){return p===l.ao.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*c?{useVertical:!0}:(p===l.ao.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function Xt(p){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:c,fontSize:f,flip:m,keepUpright:x,glyphOffsetArray:T,dynamicLayoutVertexArray:C,aspectRatio:k,rotateToLine:L}=p,j=f/24,N=c.lineOffsetX*j,q=c.lineOffsetY*j;let X;if(c.numGlyphs>1){const ae=c.glyphStartIndex+c.numGlyphs,ne=c.lineStartIndex,re=c.lineStartIndex+c.lineLength,le=_i(j,T,N,q,m,c,L,e);if(!le)return{notEnoughRoom:!0};const ue=Rr(le.first.point.x,le.first.point.y,e,r),ce=Rr(le.last.point.x,le.last.point.y,e,r);if(x&&!m){const me=nt(c.writingMode,ue,ce,k);if(me)return me}X=[le.first];for(let me=c.glyphStartIndex+1;me<ae-1;me++){const ye=pr(j*T.getoffsetX(me),N,q,m,c.segment,ne,re,e,L);if(!ye)return{notEnoughRoom:!0};X.push(ye)}X.push(le.last)}else{if(x&&!m){const ne=Jr(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,re=c.lineStartIndex+c.segment+1,le=new l.P(e.lineVertexArray.getx(re),e.lineVertexArray.gety(re)),ue=Jr(le.x,le.y,e),ce=ue.signedDistanceFromCamera>0?ue.point:Wt(e.tileAnchorPoint,le,ne,1,e),me=Rr(ne.x,ne.y,e,r),ye=Rr(ce.x,ce.y,e,r),he=nt(c.writingMode,me,ye,k);if(he)return he}const ae=pr(j*T.getoffsetX(c.glyphStartIndex),N,q,m,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,e,L);if(!ae||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};X=[ae]}for(const ae of X)l.av(C,ae.point,ae.angle);return{}}function Wt(p,e,r,c,f){const m=p.add(p.sub(e)._unit()),x=Jr(m.x,m.y,f).point,T=r.sub(x);return r.add(T._mult(c/T.mag()))}function $n(p,e,r){const c=e.projectionCache;if(c.projections[p])return c.projections[p];const f=new l.P(e.lineVertexArray.getx(p),e.lineVertexArray.gety(p)),m=Jr(f.x,f.y,e);if(m.signedDistanceFromCamera>0)return c.projections[p]=m.point,c.anyProjectionOccluded=c.anyProjectionOccluded||m.isOccluded,m.point;const x=p-r.direction;return Wt(r.distanceFromAnchor===0?e.tileAnchorPoint:new l.P(e.lineVertexArray.getx(x),e.lineVertexArray.gety(x)),f,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function Jr(p,e,r){const c=p+r.translation[0],f=e+r.translation[1];let m;return r.pitchWithMap?(m=tt(c,f,r.pitchedLabelPlaneMatrix,r.getElevation),m.isOccluded=!1):(m=r.transform.projectTileCoordinates(c,f,r.unwrappedTileID,r.getElevation),m.point.x=(.5*m.point.x+.5)*r.width,m.point.y=(.5*-m.point.y+.5)*r.height),m}function Rr(p,e,r,c){if(r.pitchWithMap){const f=[p,e,0,1];return l.aw(f,f,c),r.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],r.unwrappedTileID,r.getElevation).point}return{x:p/r.width*2-1,y:1-e/r.height*2}}function Ht(p,e,r){return r.transform.projectTileCoordinates(p,e,r.unwrappedTileID,r.getElevation)}function to(p,e,r){return p._unit()._perp()._mult(e*r)}function es(p,e,r,c,f,m,x,T,C){if(T.projectionCache.offsets[p])return T.projectionCache.offsets[p];const k=r.add(e);if(p+C.direction<c||p+C.direction>=f)return T.projectionCache.offsets[p]=k,k;const L=$n(p+C.direction,T,C),j=to(L.sub(r),x,C.direction),N=r.add(j),q=L.add(j);return T.projectionCache.offsets[p]=l.ax(m,k,N,q)||k,T.projectionCache.offsets[p]}function pr(p,e,r,c,f,m,x,T,C){const k=c?p-e:p+e;let L=k>0?1:-1,j=0;c&&(L*=-1,j=Math.PI),L<0&&(j+=Math.PI);let N,q=L>0?m+f:m+f+1;T.projectionCache.cachedAnchorPoint?N=T.projectionCache.cachedAnchorPoint:(N=Jr(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=N);let X,ae,ne=N,re=N,le=0,ue=0;const ce=Math.abs(k),me=[];let ye;for(;le+ue<=ce;){if(q+=L,q<m||q>=x)return null;le+=ue,re=ne,ae=X;const Oe={absOffsetX:ce,direction:L,distanceFromAnchor:le,previousVertex:re};if(ne=$n(q,T,Oe),r===0)me.push(re),ye=ne.sub(re);else{let Re;const ke=ne.sub(re);Re=ke.mag()===0?to($n(q+L,T,Oe).sub(ne),r,L):to(ke,r,L),ae||(ae=re.add(Re)),X=es(q,Re,ne,m,x,ae,r,T,Oe),me.push(ae),ye=X.sub(ae)}ue=ye.mag()}const he=ye._mult((ce-le)/ue)._add(ae||re),Se=j+Math.atan2(ne.y-re.y,ne.x-re.x);return me.push(he),{point:he,angle:C?Se:0,path:me}}const Ss=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Dn(p,e){for(let r=0;r<p;r++){const c=e.length;e.resize(c+4),e.float32.set(Ss,3*c)}}function oa(p,e,r){const c=e[0],f=e[1];return p[0]=r[0]*c+r[4]*f+r[12],p[1]=r[1]*c+r[5]*f+r[13],p[3]=r[3]*c+r[7]*f+r[15],p}const ga=100;class kn{constructor(e,r=new Ya(e.width+200,e.height+200,25),c=new Ya(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=c,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+ga,this.screenBottomBoundary=e.height+ga,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,c,f,m,x,T,C,k,L,j,N){const q=this.projectAndGetPerspectiveRatio(e.anchorPointX+C[0],e.anchorPointY+C[1],m,L,N),X=c*q.perspectiveRatio;let ae;if(x||T)ae=this._projectCollisionBox(e,X,f,m,x,T,C,q,L,j,N);else{const ye=q.x+(j?j.x*X:0),he=q.y+(j?j.y*X:0);ae={allPointsOccluded:!1,box:[ye+e.x1*X,he+e.y1*X,ye+e.x2*X,he+e.y2*X]}}const[ne,re,le,ue]=ae.box,ce=x?ae.allPointsOccluded:q.isOccluded;let me=ce;return me||(me=q.perspectiveRatio<this.perspectiveRatioCutoff),me||(me=!this.isInsideGrid(ne,re,le,ue)),me||r!=="always"&&this.grid.hitTest(ne,re,le,ue,r,k)?{box:[ne,re,le,ue],placeable:!1,offscreen:!1,occluded:ce}:{box:[ne,re,le,ue],placeable:!0,offscreen:this.isOffscreen(ne,re,le,ue),occluded:ce}}placeCollisionCircles(e,r,c,f,m,x,T,C,k,L,j,N,q,X){const ae=[],ne=new l.P(r.anchorX,r.anchorY),re=this.getPerspectiveRatio(ne.x,ne.y,x,X),le=(k?m*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,x)/re:m*re)/l.aB,ue={getElevation:X,pitchedLabelPlaneMatrix:T,lineVertexArray:c,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ne,unwrappedTileID:x,width:this.transform.width,height:this.transform.height,translation:q},ce=_i(le,f,r.lineOffsetX*le,r.lineOffsetY*le,!1,r,!1,ue);let me=!1,ye=!1,he=!0;if(ce){const Se=.5*j*re+N,Oe=new l.P(-100,-100),Re=new l.P(this.screenRightBoundary,this.screenBottomBoundary),ke=new pa,Le=ce.first,rt=ce.last;let st=[];for(let Ut=Le.path.length-1;Ut>=1;Ut--)st.push(Le.path[Ut]);for(let Ut=1;Ut<rt.path.length;Ut++)st.push(rt.path[Ut]);const Qe=2.5*Se;if(k){const Ut=this.projectPathToScreenSpace(st,ue);st=Ut.some((pi=>pi.signedDistanceFromCamera<=0))?[]:Ut.map((pi=>pi.point))}let wt=[];if(st.length>0){const Ut=st[0].clone(),pi=st[0].clone();for(let Ai=1;Ai<st.length;Ai++)Ut.x=Math.min(Ut.x,st[Ai].x),Ut.y=Math.min(Ut.y,st[Ai].y),pi.x=Math.max(pi.x,st[Ai].x),pi.y=Math.max(pi.y,st[Ai].y);wt=Ut.x>=Oe.x&&pi.x<=Re.x&&Ut.y>=Oe.y&&pi.y<=Re.y?[st]:pi.x<Oe.x||Ut.x>Re.x||pi.y<Oe.y||Ut.y>Re.y?[]:l.ay([st],Oe.x,Oe.y,Re.x,Re.y)}for(const Ut of wt){ke.reset(Ut,.25*Se);let pi=0;pi=ke.length<=.5*Se?1:Math.ceil(ke.paddedLength/Qe)+1;for(let Ai=0;Ai<pi;Ai++){const Ci=Ai/Math.max(pi-1,1),Yi=ke.lerp(Ci),Ui=Yi.x+ga,ni=Yi.y+ga;ae.push(Ui,ni,Se,0);const ra=Ui-Se,nn=ni-Se,va=Ui+Se,xa=ni+Se;if(he=he&&this.isOffscreen(ra,nn,va,xa),ye=ye||this.isInsideGrid(ra,nn,va,xa),e!=="always"&&this.grid.hitTestCircle(Ui,ni,Se,e,L)&&(me=!0,!C))return{circles:[],offscreen:!1,collisionDetected:me}}}}return{circles:!C&&me||!ye||re<this.perspectiveRatioCutoff?[]:ae,offscreen:he,collisionDetected:me}}projectPathToScreenSpace(e,r){const c=(function(f,m){const x=l.L();return l.aq(x,m.pitchedLabelPlaneMatrix),f.map((T=>{const C=tt(T.x,T.y,x,m.getElevation),k=m.transform.projectTileCoordinates(C.point.x,C.point.y,m.unwrappedTileID,m.getElevation);return k.point.x=(.5*k.point.x+.5)*m.width,k.point.y=(.5*-k.point.y+.5)*m.height,k}))})(e,r);return(function(f){let m=0,x=0,T=0,C=0;for(let k=0;k<f.length;k++)f[k].isOccluded?(T=k+1,C=0):(C++,C>x&&(x=C,m=T));return f.slice(m,m+x)})(c)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[],c=new l.a2;for(const j of e){const N=new l.P(j.x+ga,j.y+ga);c.extend(N),r.push(N)}const{minX:f,minY:m,maxX:x,maxY:T}=c,C=this.grid.query(f,m,x,T).concat(this.ignoredGrid.query(f,m,x,T)),k={},L={};for(const j of C){const N=j.key;if(k[N.bucketInstanceId]===void 0&&(k[N.bucketInstanceId]={}),k[N.bucketInstanceId][N.featureIndex])continue;const q=[new l.P(j.x1,j.y1),new l.P(j.x2,j.y1),new l.P(j.x2,j.y2),new l.P(j.x1,j.y2)];l.az(r,q)&&(k[N.bucketInstanceId][N.featureIndex]=!0,L[N.bucketInstanceId]===void 0&&(L[N.bucketInstanceId]=[]),L[N.bucketInstanceId].push(N.featureIndex))}return L}insertCollisionBox(e,r,c,f,m,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:m,collisionGroupID:x,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,c,f,m,x){const T=c?this.ignoredGrid:this.grid,C={bucketInstanceId:f,featureIndex:m,collisionGroupID:x,overlapMode:r};for(let k=0;k<e.length;k+=4)T.insertCircle(C,e[k],e[k+1],e[k+2])}projectAndGetPerspectiveRatio(e,r,c,f,m){if(m){let x;f?(x=[e,r,f(e,r),1],l.aw(x,x,m)):(x=[e,r,0,1],oa(x,x,m));const T=x[3];return{x:(x[0]/T+1)/2*this.transform.width+ga,y:(-x[1]/T+1)/2*this.transform.height+ga,perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}{const x=this.transform.projectTileCoordinates(e,r,c,f);return{x:(x.point.x+1)/2*this.transform.width+ga,y:(1-x.point.y)/2*this.transform.height+ga,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5,isOccluded:x.isOccluded,signedDistanceFromCamera:x.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,c,f){const m=this.transform.projectTileCoordinates(e,r,c,f);return .5+this.transform.cameraToCenterDistance/m.signedDistanceFromCamera*.5}isOffscreen(e,r,c,f){return c<ga||e>=this.screenRightBoundary||f<ga||r>this.screenBottomBoundary}isInsideGrid(e,r,c,f){return c>=0&&e<this.gridRightBoundary&&f>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=l.ag([]);return l.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,c,f,m,x,T,C,k,L,j){let N=1,q=0,X=0,ae=1;const ne=e.anchorPointX+T[0],re=e.anchorPointY+T[1];if(x&&!m){const st=this.projectAndGetPerspectiveRatio(ne+1,re,f,k,j),Qe=st.x-C.x,wt=Math.atan((st.y-C.y)/Qe)+(Qe<0?Math.PI:0),Ut=Math.sin(wt),pi=Math.cos(wt);N=pi,q=Ut,X=-Ut,ae=pi}else if(!x&&m){const st=Mi(this.transform);N=st.vecEast[0],q=st.vecEast[1],X=st.vecSouth[0],ae=st.vecSouth[1]}let le=C.x,ue=C.y,ce=r;m&&(le=ne,ue=re,ce=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),ce*=this.transform.getPitchedTextCorrection(ne,re,f),L||(ce*=l.ah(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),L&&(le+=N*L.x*ce+X*L.y*ce,ue+=q*L.x*ce+ae*L.y*ce);const me=e.x1*ce,ye=e.x2*ce,he=(me+ye)/2,Se=e.y1*ce,Oe=e.y2*ce,Re=(Se+Oe)/2,ke=[{offsetX:me,offsetY:Se},{offsetX:he,offsetY:Se},{offsetX:ye,offsetY:Se},{offsetX:ye,offsetY:Re},{offsetX:ye,offsetY:Oe},{offsetX:he,offsetY:Oe},{offsetX:me,offsetY:Oe},{offsetX:me,offsetY:Re}];let Le=[];for(const{offsetX:st,offsetY:Qe}of ke)Le.push(new l.P(le+N*st+X*Qe,ue+q*st+ae*Qe));let rt=!1;if(m){const st=Le.map((Qe=>this.projectAndGetPerspectiveRatio(Qe.x,Qe.y,f,k,j)));rt=st.some((Qe=>!Qe.isOccluded)),Le=st.map((Qe=>new l.P(Qe.x,Qe.y)))}else rt=!0;return{box:l.aA(Le),allPointsOccluded:!rt}}}class zi{constructor(e,r,c,f){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):f&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class ts{constructor(e,r,c,f,m){this.text=new zi(e?e.text:null,r,c,m),this.icon=new zi(e?e.icon:null,r,f,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class El{constructor(e,r,c){this.text=e,this.icon=r,this.skipFade=c}}class hu{constructor(e,r,c,f,m){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=c,this.bucketIndex=f,this.tileID=m}}class io{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:c=>c.collisionGroupID===r}}return this.collisionGroups[e]}}function Ms(p,e,r,c,f){const{horizontalAlign:m,verticalAlign:x}=l.aH(p);return new l.P(-(m-.5)*e+c[0]*f,-(x-.5)*r+c[1]*f)}class fc{constructor(e,r,c,f,m){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new kn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new io(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(c,f)=>r.getElevation(e,c,f):null}getBucketParts(e,r,c,f){const m=c.getBucket(r),x=c.latestFeatureIndex;if(!m||!x||r.id!==m.layerIds[0])return;const T=c.collisionBoxArray,C=m.layers[0].layout,k=m.layers[0].paint,L=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),j=c.tileSize/l.$,N=c.tileID.toUnwrapped(),q=C.get("text-rotation-alignment")==="map",X=l.aC(c,1,this.transform.zoom),ae=l.aD(this.collisionIndex.transform,c,k.get("text-translate"),k.get("text-translate-anchor")),ne=l.aD(this.collisionIndex.transform,c,k.get("icon-translate"),k.get("icon-translate-anchor")),re=Ni(q,this.transform,X);this.retainedQueryData[m.bucketInstanceId]=new hu(m.bucketInstanceId,x,m.sourceLayerIndex,m.index,c.tileID);const le={bucket:m,layout:C,translationText:ae,translationIcon:ne,unwrappedTileID:N,pitchedLabelPlaneMatrix:re,scale:L,textPixelRatio:j,holdingForFade:c.holdingForSymbolFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:l.an(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(f)for(const ue of m.sortKeyRanges){const{sortKey:ce,symbolInstanceStart:me,symbolInstanceEnd:ye}=ue;e.push({sortKey:ce,symbolInstanceStart:me,symbolInstanceEnd:ye,parameters:le})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:le})}attemptAnchorPlacement(e,r,c,f,m,x,T,C,k,L,j,N,q,X,ae,ne,re,le,ue,ce){const me=l.aE[e.textAnchor],ye=[e.textOffset0,e.textOffset1],he=Ms(me,c,f,ye,m),Se=this.collisionIndex.placeCollisionBox(r,N,C,k,L,T,x,ne,j.predicate,ue,he,ce);if((!le||this.collisionIndex.placeCollisionBox(le,N,C,k,L,T,x,re,j.predicate,ue,he,ce).placeable)&&Se.placeable){let Oe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID].text&&(Oe=this.prevPlacement.variableOffsets[q.crossTileID].anchor),q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[q.crossTileID]={textOffset:ye,width:c,height:f,anchor:me,textBoxScale:m,prevAnchor:Oe},this.markUsedJustification(X,me,q,ae),X.allowVerticalPlacement&&(this.markUsedOrientation(X,ae,q),this.placedOrientations[q.crossTileID]=ae),{shift:he,placedGlyphBoxes:Se}}}placeLayerBucketPart(e,r,c){const{bucket:f,layout:m,translationText:x,translationIcon:T,unwrappedTileID:C,pitchedLabelPlaneMatrix:k,textPixelRatio:L,holdingForFade:j,collisionBoxArray:N,partiallyEvaluatedTextSize:q,collisionGroup:X}=e.parameters,ae=m.get("text-optional"),ne=m.get("icon-optional"),re=l.aF(m,"text-overlap","text-allow-overlap"),le=re==="always",ue=l.aF(m,"icon-overlap","icon-allow-overlap"),ce=ue==="always",me=m.get("text-rotation-alignment")==="map",ye=m.get("text-pitch-alignment")==="map",he=m.get("icon-text-fit")!=="none",Se=m.get("symbol-z-order")==="viewport-y",Oe=le&&(ce||!f.hasIconData()||ne),Re=ce&&(le||!f.hasTextData()||ae);!f.collisionArrays&&N&&f.deserializeCollisionBoxes(N);const ke=this.retainedQueryData[f.bucketInstanceId].tileID,Le=this._getTerrainElevationFunc(ke),rt=this.transform.getFastPathSimpleProjectionMatrix(ke),st=(Qe,wt,Ut)=>{var pi,Ai;if(r[Qe.crossTileID])return;if(j)return void(this.placements[Qe.crossTileID]=new El(!1,!1,!1));let Ci=!1,Yi=!1,Ui=!0,ni=null,ra={box:null,placeable:!1,offscreen:null,occluded:!1},nn={placeable:!1},va=null,xa=null,_n=null,Us=0,nr=0,Vs=0;wt.textFeatureIndex?Us=wt.textFeatureIndex:Qe.useRuntimeCollisionCircles&&(Us=Qe.featureIndex),wt.verticalTextFeatureIndex&&(nr=wt.verticalTextFeatureIndex);const Co=wt.textBox;if(Co){const rr=ca=>{let Da=l.ao.horizontal;if(f.allowVerticalPlacement&&!ca&&this.prevPlacement){const jn=this.prevPlacement.placedOrientations[Qe.crossTileID];jn&&(this.placedOrientations[Qe.crossTileID]=jn,Da=jn,this.markUsedOrientation(f,Da,Qe))}return Da},wr=(ca,Da)=>{if(f.allowVerticalPlacement&&Qe.numVerticalGlyphVertices>0&&wt.verticalTextBox){for(const jn of f.writingModes)if(jn===l.ao.vertical?(ra=Da(),nn=ra):ra=ca(),ra&&ra.placeable)break}else ra=ca()},Ur=Qe.textAnchorOffsetStartIndex,Nn=Qe.textAnchorOffsetEndIndex;if(Nn===Ur){const ca=(Da,jn)=>{const rn=this.collisionIndex.placeCollisionBox(Da,re,L,ke,C,ye,me,x,X.predicate,Le,void 0,rt);return rn&&rn.placeable&&(this.markUsedOrientation(f,jn,Qe),this.placedOrientations[Qe.crossTileID]=jn),rn};wr((()=>ca(Co,l.ao.horizontal)),(()=>{const Da=wt.verticalTextBox;return f.allowVerticalPlacement&&Qe.numVerticalGlyphVertices>0&&Da?ca(Da,l.ao.vertical):{box:null,offscreen:null}})),rr(ra&&ra.placeable)}else{let ca=l.aE[(Ai=(pi=this.prevPlacement)===null||pi===void 0?void 0:pi.variableOffsets[Qe.crossTileID])===null||Ai===void 0?void 0:Ai.anchor];const Da=(rn,Ih,Hl)=>{const Vr=rn.x2-rn.x1,qr=rn.y2-rn.y1,Gn=Qe.textBoxScale,qs=he&&ue==="never"?Ih:null;let Zs=null,dl=re==="never"?1:2,Ru="never";ca&&dl++;for(let gs=0;gs<dl;gs++){for(let Du=Ur;Du<Nn;Du++){const Zc=f.textAnchorOffsets.get(Du);if(ca&&Zc.textAnchor!==ca)continue;const fl=this.attemptAnchorPlacement(Zc,rn,Vr,qr,Gn,me,ye,L,ke,C,X,Ru,Qe,f,Hl,x,T,qs,Le);if(fl&&(Zs=fl.placedGlyphBoxes,Zs&&Zs.placeable))return Ci=!0,ni=fl.shift,Zs}ca?ca=null:Ru=re}return c&&!Zs&&(Zs={box:this.collisionIndex.placeCollisionBox(Co,"always",L,ke,C,ye,me,x,X.predicate,Le,void 0,rt).box,offscreen:!1,placeable:!1,occluded:!1}),Zs};wr((()=>Da(Co,wt.iconBox,l.ao.horizontal)),(()=>{const rn=wt.verticalTextBox;return f.allowVerticalPlacement&&(!ra||!ra.placeable)&&Qe.numVerticalGlyphVertices>0&&rn?Da(rn,wt.verticalIconBox,l.ao.vertical):{box:null,occluded:!0,offscreen:null}})),ra&&(Ci=ra.placeable,Ui=ra.offscreen);const jn=rr(ra&&ra.placeable);if(!Ci&&this.prevPlacement){const rn=this.prevPlacement.variableOffsets[Qe.crossTileID];rn&&(this.variableOffsets[Qe.crossTileID]=rn,this.markUsedJustification(f,rn.anchor,Qe,jn))}}}if(va=ra,Ci=va&&va.placeable,Ui=va&&va.offscreen,Qe.useRuntimeCollisionCircles&&Qe.centerJustifiedTextSymbolIndex>=0){const rr=f.text.placedSymbolArray.get(Qe.centerJustifiedTextSymbolIndex),wr=l.ap(f.textSizeData,q,rr),Ur=m.get("text-padding");xa=this.collisionIndex.placeCollisionCircles(re,rr,f.lineVertexArray,f.glyphOffsetArray,wr,C,k,c,ye,X.predicate,Qe.collisionCircleDiameter,Ur,x,Le),xa.circles.length&&xa.collisionDetected&&!c&&l.w("Collisions detected, but collision boxes are not shown"),Ci=le||xa.circles.length>0&&!xa.collisionDetected,Ui=Ui&&xa.offscreen}if(wt.iconFeatureIndex&&(Vs=wt.iconFeatureIndex),wt.iconBox){const rr=wr=>this.collisionIndex.placeCollisionBox(wr,ue,L,ke,C,ye,me,T,X.predicate,Le,he&&ni?ni:void 0,rt);nn&&nn.placeable&&wt.verticalIconBox?(_n=rr(wt.verticalIconBox),Yi=_n.placeable):(_n=rr(wt.iconBox),Yi=_n.placeable),Ui=Ui&&_n.offscreen}const $l=ae||Qe.numHorizontalGlyphVertices===0&&Qe.numVerticalGlyphVertices===0,hl=ne||Qe.numIconVertices===0;$l||hl?hl?$l||(Yi=Yi&&Ci):Ci=Yi&&Ci:Yi=Ci=Yi&&Ci;const ms=Yi&&_n.placeable;if(Ci&&va.placeable&&this.collisionIndex.insertCollisionBox(va.box,re,m.get("text-ignore-placement"),f.bucketInstanceId,nn&&nn.placeable&&nr?nr:Us,X.ID),ms&&this.collisionIndex.insertCollisionBox(_n.box,ue,m.get("icon-ignore-placement"),f.bucketInstanceId,Vs,X.ID),xa&&Ci&&this.collisionIndex.insertCollisionCircles(xa.circles,re,m.get("text-ignore-placement"),f.bucketInstanceId,Us,X.ID),c&&this.storeCollisionData(f.bucketInstanceId,Ut,wt,va,_n,xa),Qe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Qe.crossTileID]=new El((Ci||Oe)&&!va?.occluded,(Yi||Re)&&!_n?.occluded,Ui||f.justReloaded),r[Qe.crossTileID]=!0};if(Se){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Qe=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let wt=Qe.length-1;wt>=0;--wt){const Ut=Qe[wt];st(f.symbolInstances.get(Ut),f.collisionArrays[Ut],Ut)}}else for(let Qe=e.symbolInstanceStart;Qe<e.symbolInstanceEnd;Qe++)st(f.symbolInstances.get(Qe),f.collisionArrays[Qe],Qe);f.justReloaded=!1}storeCollisionData(e,r,c,f,m,x){if(c.textBox||c.iconBox){let T,C;this.collisionBoxArrays.has(e)?T=this.collisionBoxArrays.get(e):(T=new Map,this.collisionBoxArrays.set(e,T)),T.has(r)?C=T.get(r):(C={text:null,icon:null},T.set(r,C)),c.textBox&&(C.text=f.box),c.iconBox&&(C.icon=m.box)}if(x){let T=this.collisionCircleArrays[e];T===void 0&&(T=this.collisionCircleArrays[e]=[]);for(let C=0;C<x.circles.length;C+=4)T.push(x.circles[C+0]-ga),T.push(x.circles[C+1]-ga),T.push(x.circles[C+2]),T.push(x.collisionDetected?1:0)}}markUsedJustification(e,r,c,f){let m;m=f===l.ao.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[l.aG(r)];const x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const T of x)T>=0&&(e.text.placedSymbolArray.get(T).crossTileID=m>=0&&T!==m?0:c.crossTileID)}markUsedOrientation(e,r,c){const f=r===l.ao.horizontal||r===l.ao.horizontalOnly?r:0,m=r===l.ao.vertical?r:0,x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const T of x)e.text.placedSymbolArray.get(T).placedOrientation=f;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let c=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const f=r?r.symbolFadeChange(e):1,m=r?r.opacities:{},x=r?r.variableOffsets:{},T=r?r.placedOrientations:{};for(const C in this.placements){const k=this.placements[C],L=m[C];L?(this.opacities[C]=new ts(L,f,k.text,k.icon),c=c||k.text!==L.text.placed||k.icon!==L.icon.placed):(this.opacities[C]=new ts(null,f,k.text,k.icon,k.skipFade),c=c||k.text||k.icon)}for(const C in m){const k=m[C];if(!this.opacities[C]){const L=new ts(k,f,!1,!1);L.isHidden()||(this.opacities[C]=L,c=c||k.text.placed||k.icon.placed)}}for(const C in x)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=x[C]);for(const C in T)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=T[C]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const c={};for(const f of r){const m=f.getBucket(e);m&&f.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,f.tileID,c,f.collisionBoxArray)}}updateBucketOpacities(e,r,c,f){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],x=m.layout,T=new ts(null,0,!1,!1,!0),C=x.get("text-allow-overlap"),k=x.get("icon-allow-overlap"),L=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=x.get("text-rotation-alignment")==="map",N=x.get("text-pitch-alignment")==="map",q=x.get("icon-text-fit")!=="none",X=new ts(null,0,C&&(k||!e.hasIconData()||x.get("icon-optional")),k&&(C||!e.hasTextData()||x.get("text-optional")),!0);!e.collisionArrays&&f&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(f);const ae=(re,le,ue)=>{for(let ce=0;ce<le/4;ce++)re.opacityVertexArray.emplaceBack(ue);re.hasVisibleVertices=re.hasVisibleVertices||ue!==Wa},ne=this.collisionBoxArrays.get(e.bucketInstanceId);for(let re=0;re<e.symbolInstances.length;re++){const le=e.symbolInstances.get(re),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:ce,crossTileID:me}=le;let ye=this.opacities[me];c[me]?ye=T:ye||(ye=X,this.opacities[me]=ye),c[me]=!0;const he=le.numIconVertices>0,Se=this.placedOrientations[le.crossTileID],Oe=Se===l.ao.vertical,Re=Se===l.ao.horizontal||Se===l.ao.horizontalOnly;if(ue>0||ce>0){const Le=rh(ye.text);ae(e.text,ue,Oe?Wa:Le),ae(e.text,ce,Re?Wa:Le);const rt=ye.text.isHidden();[le.rightJustifiedTextSymbolIndex,le.centerJustifiedTextSymbolIndex,le.leftJustifiedTextSymbolIndex].forEach((wt=>{wt>=0&&(e.text.placedSymbolArray.get(wt).hidden=rt||Oe?1:0)})),le.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(le.verticalPlacedTextSymbolIndex).hidden=rt||Re?1:0);const st=this.variableOffsets[le.crossTileID];st&&this.markUsedJustification(e,st.anchor,le,Se);const Qe=this.placedOrientations[le.crossTileID];Qe&&(this.markUsedJustification(e,"left",le,Qe),this.markUsedOrientation(e,Qe,le))}if(he){const Le=rh(ye.icon),rt=!(q&&le.verticalPlacedIconSymbolIndex&&Oe);le.placedIconSymbolIndex>=0&&(ae(e.icon,le.numIconVertices,rt?Le:Wa),e.icon.placedSymbolArray.get(le.placedIconSymbolIndex).hidden=ye.icon.isHidden()),le.verticalPlacedIconSymbolIndex>=0&&(ae(e.icon,le.numVerticalIconVertices,rt?Wa:Le),e.icon.placedSymbolArray.get(le.verticalPlacedIconSymbolIndex).hidden=ye.icon.isHidden())}const ke=ne&&ne.has(re)?ne.get(re):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Le=e.collisionArrays[re];if(Le){let rt=new l.P(0,0);if(Le.textBox||Le.verticalTextBox){let st=!0;if(L){const Qe=this.variableOffsets[me];Qe?(rt=Ms(Qe.anchor,Qe.width,Qe.height,Qe.textOffset,Qe.textBoxScale),j&&rt._rotate(N?-this.transform.bearingInRadians:this.transform.bearingInRadians)):st=!1}if(Le.textBox||Le.verticalTextBox){let Qe;Le.textBox&&(Qe=Oe),Le.verticalTextBox&&(Qe=Re),Al(e.textCollisionBox.collisionVertexArray,ye.text.placed,!st||Qe,ke.text,rt.x,rt.y)}}if(Le.iconBox||Le.verticalIconBox){const st=!!(!Re&&Le.verticalIconBox);let Qe;Le.iconBox&&(Qe=st),Le.verticalIconBox&&(Qe=!st),Al(e.iconCollisionBox.collisionVertexArray,ye.icon.placed,Qe,ke.icon,q?rt.x:0,q?rt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const c=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function Al(p,e,r,c,f,m){c&&c.length!==0||(c=[0,0,0,0]);const x=c[0]-ga,T=c[1]-ga,C=c[2]-ga,k=c[3]-ga;p.emplaceBack(e?1:0,r?1:0,f||0,m||0,x,T),p.emplaceBack(e?1:0,r?1:0,f||0,m||0,C,T),p.emplaceBack(e?1:0,r?1:0,f||0,m||0,C,k),p.emplaceBack(e?1:0,r?1:0,f||0,m||0,x,k)}const is=Math.pow(2,25),on=Math.pow(2,24),ah=Math.pow(2,17),yf=Math.pow(2,16),nh=Math.pow(2,9),ud=Math.pow(2,8),pc=Math.pow(2,1);function rh(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const e=p.placed?1:0,r=Math.floor(127*p.opacity);return r*is+e*on+r*ah+e*yf+r*nh+e*ud+r*pc+e}const Wa=0;class mc{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,c,f,m){const x=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(x,f,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort(((T,C)=>T.sortKey-C.sortKey)));this._currentPartIndex<x.length;)if(r.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,m())return!0;return!1}}class sh{constructor(e,r,c,f,m,x,T,C){this.placement=new fc(e,r,x,T,C),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,r,c){const f=W.now(),m=()=>!this._forceFullPlacement&&W.now()-f>2;for(;this._currentPlacementIndex>=0;){const x=r[e[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=T)&&(!x.maxzoom||x.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new mc(x)),this._inProgressLayer.continuePlacement(c[x.source],this.placement,this._showCollisionBoxes,x,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Ts=512/l.$/2;class ao{constructor(e,r,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const f=new Map;for(let m=0;m<r.length;m++){const x=r.get(m),T=x.key,C=f.get(T);C?C.push(x):f.set(T,[x])}for(const[m,x]of f){const T={positions:x.map((C=>({x:Math.floor(C.anchorX*Ts),y:Math.floor(C.anchorY*Ts)}))),crossTileIDs:x.map((C=>C.crossTileID))};if(T.positions.length>128){const C=new l.aI(T.positions.length,16,Uint16Array);for(const{x:k,y:L}of T.positions)C.add(k,L);C.finish(),delete T.positions,T.index=C}this._symbolsByKey[m]=T}}getScaledCoordinates(e,r){const{x:c,y:f,z:m}=this.tileID.canonical,{x,y:T,z:C}=r.canonical,k=Ts/Math.pow(2,C-m),L=(T*l.$+e.anchorY)*k,j=f*l.$*Ts;return{x:Math.floor((x*l.$+e.anchorX)*k-c*l.$*Ts),y:Math.floor(L-j)}}findMatches(e,r,c){const f=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let m=0;m<e.length;m++){const x=e.get(m);if(x.crossTileID)continue;const T=this._symbolsByKey[x.key];if(!T)continue;const C=this.getScaledCoordinates(x,r);if(T.index){const k=T.index.range(C.x-f,C.y-f,C.x+f,C.y+f).sort();for(const L of k){const j=T.crossTileIDs[L];if(!c[j]){c[j]=!0,x.crossTileID=j;break}}}else if(T.positions)for(let k=0;k<T.positions.length;k++){const L=T.positions[k],j=T.crossTileIDs[k];if(Math.abs(L.x-C.x)<=f&&Math.abs(L.y-C.y)<=f&&!c[j]){c[j]=!0,x.crossTileID=j;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class hd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Cl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const c in this.indexes){const f=this.indexes[c],m={};for(const x in f){const T=f[x];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+r),m[T.tileID.key]=T}this.indexes[c]=m}this.lng=e}addBucket(e,r,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<r.symbolInstances.length;m++)r.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const f=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const x=this.indexes[m];if(Number(m)>e.overscaledZ)for(const T in x){const C=x[T];C.tileID.isChildOf(e)&&C.findMatches(r.symbolInstances,e,f)}else{const T=x[e.scaledTo(Number(m)).key];T&&T.findMatches(r.symbolInstances,e,f)}}for(let m=0;m<r.symbolInstances.length;m++){const x=r.symbolInstances.get(m);x.crossTileID||(x.crossTileID=c.generate(),f[x.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new ao(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const c of r.getCrossTileIDsLists())for(const f of c)delete this.usedCrossTileIDs[e][f]}removeStaleBuckets(e){let r=!1;for(const c in this.indexes){const f=this.indexes[c];for(const m in f)e[f[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,f[m]),delete f[m],r=!0)}return r}}class as{constructor(){this.layerIndexes={},this.crossTileIDs=new hd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,c){let f=this.layerIndexes[e.id];f===void 0&&(f=this.layerIndexes[e.id]=new Cl);let m=!1;const x={};f.handleWrapJump(c);for(const T of r){const C=T.getBucket(e);C&&e.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(T.tileID,C,this.crossTileIDs)&&(m=!0),x[C.bucketInstanceId]=!0)}return f.removeStaleBuckets(x)&&(m=!0),m}pruneUnusedLayers(e){const r={};e.forEach((c=>{r[c]=!0}));for(const c in this.layerIndexes)r[c]||delete this.layerIndexes[c]}}var oh="void main() {fragColor=vec4(1.0);}";const pn={prelude:li(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:li("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:li("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:li(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:li(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:li(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:li(oh,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:li(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:li(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:li("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:li("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:li(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:li("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:li(oh,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:li(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:li(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:li(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:li(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:li(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:li(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:li(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:li(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:li(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:li(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:li(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:li(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:li(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:li(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:li(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:li(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:li(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:li("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:li("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:li("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:li("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:li(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:li("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function li(p,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/in ([\w]+) ([\w]+)/g),f=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=m?m.concat(f):f,T={};return{fragmentSource:p=p.replace(r,((C,k,L,j,N)=>(T[N]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${N}
in ${L} ${j} ${N};
#else
uniform ${L} ${j} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${L} ${j} ${N} = u_${N};
#endif
`))),vertexSource:e=e.replace(r,((C,k,L,j,N)=>{const q=j==="float"?"vec2":"vec4",X=N.match(/color/)?"color":q;return T[N]?k==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
in ${L} ${q} a_${N};
out ${L} ${j} ${N};
#else
uniform ${L} ${j} u_${N};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${L} ${j} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${X}(a_${N}, u_${N}_t);
#else
    ${L} ${j} ${N} = u_${N};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
in ${L} ${q} a_${N};
#else
uniform ${L} ${j} u_${N};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${L} ${j} ${N} = a_${N};
#else
    ${L} ${j} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${L} ${j} ${N} = unpack_mix_${X}(a_${N}, u_${N}_t);
#else
    ${L} ${j} ${N} = u_${N};
#endif
`})),staticAttributes:c,staticUniforms:x}}class no{constructor(e,r,c){this.vertexBuffer=e,this.indexBuffer=r,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Mn=l.aJ([{name:"a_pos",type:"Int16",components:2}]);const Fo="#define PROJECTION_MERCATOR",Jt="mercator";class Hn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Jt}get shaderDefine(){return Fo}get shaderPreludeCode(){return pn.projectionMercator}get vertexShaderPreludeCode(){return pn.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,c,f,m){if(this._cachedMesh)return this._cachedMesh;const x=new l.aL;x.emplaceBack(0,0),x.emplaceBack(l.$,0),x.emplaceBack(0,l.$),x.emplaceBack(l.$,l.$);const T=e.createVertexBuffer(x,Mn.members),C=l.aM.simpleSegment(0,0,4,2),k=new l.aN;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const L=e.createIndexBuffer(k);return this._cachedMesh=new no(T,L,C),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Uo{constructor(e=0,r=0,c=0,f=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(c)||c<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=c,this.right=f}interpolate(e,r,c){return r.top!=null&&e.top!=null&&(this.top=l.C.number(e.top,r.top,c)),r.bottom!=null&&e.bottom!=null&&(this.bottom=l.C.number(e.bottom,r.bottom,c)),r.left!=null&&e.left!=null&&(this.left=l.C.number(e.left,r.left,c)),r.right!=null&&e.right!=null&&(this.right=l.C.number(e.right,r.right,c)),this}getCenter(e,r){const c=l.ah((this.left+e-this.right)/2,0,e),f=l.ah((this.top+r-this.bottom)/2,0,r);return new l.P(c,f)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Uo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ro(p,e){if(!p.renderWorldCopies||p.lngRange)return;const r=e.lng-p.center.lng;e.lng+=r>180?-360:r<-180?360:0}function ja(p){return Math.max(0,Math.floor(p))}class _a{constructor(e,r,c,f,m,x){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=m??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=ja(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Uo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,c){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=ja(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Uo(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!c&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=l.aO(e,-180,180)*Math.PI/180;var c,f,m,x,T,C,k,L,j;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=U(),c=this._rotationMatrix,m=-this._bearingInRadians,x=(f=this._rotationMatrix)[0],T=f[1],C=f[2],k=f[3],L=Math.sin(m),j=Math.cos(m),c[0]=x*j+C*L,c[1]=T*j+k*L,c[2]=x*-L+C*j,c[3]=T*-L+k*j)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=l.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aP(this._fovInRadians)}setFov(e){e=l.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=l.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=l.af(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,c){this._unmodified=!1,this._edgeInsets.interpolate(e,r,c),this._constrain(),this._calcMatrices()}resize(e,r,c=!0){this._width=e,this._height=r,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new fa([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-l.ai,l.ai])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{const{minX:c,minY:f,maxX:m,maxY:x}=l.a2.fromPoints(r).extend(e);return[new l.P(c,f),new l.P(m,f),new l.P(m,x),new l.P(c,x),new l.P(c,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(c),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=l.ag(new Float64Array(16));l.N(e,e,[this._width/2,-this._height/2,1]),l.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=l.ag(new Float64Array(16)),l.N(e,e,[1,-1,1]),l.M(e,e,[-1,-1,0]),l.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,c,f){const m=c!==void 0?c:this.bearing,x=f=f!==void 0?f:this.pitch,T=l.a1.fromLngLat(e,r),C=-Math.cos(l.ae(x)),k=Math.sin(l.ae(x)),L=k*Math.sin(l.ae(m)),j=-k*Math.cos(l.ae(m));let N=this.elevation;const q=r-N;let X;C*q>=0||Math.abs(C)<.1?(X=1e4,N=r+X*C):X=-q/C;let ae,ne,re=l.aQ(1,T.y),le=0;do{if(le+=1,le>10)break;ne=X/re,ae=new l.a1(T.x+L*ne,T.y+j*ne),re=1/ae.meterInMercatorCoordinateUnits()}while(Math.abs(X-ne*re)>1e-12);return{center:ae.toLngLat(),elevation:N,zoom:l.ak(this.height/2/Math.tan(this.fovInRadians/2)/ne/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=l.aj(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/r,f=l.a1.fromLngLat(this.center,this.elevation),m=Ve(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=e;const x=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),l.aQ(m.z,f.y),this.bearing,this.pitch);this._elevation=x.elevation,this._center=x.center,this.setZoom(x.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=l.aj(1,this.center.lat)*this.worldSize;return Ve(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/l.$,1/r/l.$]}}class Ga{constructor(e,r){this.min=e,this.max=r,this.center=l.aR([],l.aS([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],c=l.aT(this.min),f=l.aT(this.max);for(let m=0;m<r.length;m++)c[m]=r[m]?this.min[m]:this.center[m],f[m]=r[m]?this.center[m]:this.max[m];return f[2]=this.max[2],new Ga(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let c=0;c<e.planes.length;c++){const f=this.intersectsPlane(e.planes[c]);if(f===0)return 0;f===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],c=e[3];for(let f=0;f<3;f++)e[f]>0?(r+=e[f]*this.min[f],c+=e[f]*this.max[f]):(c+=e[f]*this.min[f],r+=e[f]*this.max[f]);return r>=0?2:c<0?0:1}}class Fa{distanceToTile2d(e,r,c,f){const m=f.distanceX([e,r]),x=f.distanceY([e,r]);return Math.hypot(m,x)}getWrap(e,r,c){return c}getTileBoundingVolume(e,r,c,f){var m,x;let T=0,C=0;if(f?.terrain){const L=new l.Z(e.z,r,e.z,e.x,e.y),j=f.terrain.getMinMaxElevation(L);T=(m=j.minElevation)!==null&&m!==void 0?m:Math.min(0,c),C=(x=j.maxElevation)!==null&&x!==void 0?x:Math.max(0,c)}const k=1<<e.z;return new Ga([r+e.x/k,e.y/k,T],[r+(e.x+1)/k,(e.y+1)/k,C])}allowVariableZoom(e,r){const c=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,f=l.ah(78.5-c/2,0,60);return!!r.terrain||e.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class Zi{constructor(e,r,c){this.points=e,this.planes=r,this.aabb=c}static fromInvProjectionMatrix(e,r=1,c=0,f,m){const x=m?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],T=Math.pow(2,c),C=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((N=>(function(q,X,ae,ne){const re=l.aw([],q,X),le=1/re[3]/ae*ne;return l.aY(re,re,[le,le,1/re[3],le])})(N,e,r,T)));f&&(function(N,q,X,ae){const ne=ae?4:0,re=ae?0:4;let le=0;const ue=[],ce=[];for(let he=0;he<4;he++){const Se=l.aU([],N[he+re],N[he+ne]),Oe=l.aZ(Se);l.aR(Se,Se,1/Oe),ue.push(Oe),ce.push(Se)}for(let he=0;he<4;he++){const Se=l.a_(N[he+ne],ce[he],X);le=Se!==null&&Se>=0?Math.max(le,Se):Math.max(le,ue[he])}const me=(function(he,Se){const Oe=l.aU([],he[Se[0]],he[Se[1]]),Re=l.aU([],he[Se[2]],he[Se[1]]),ke=[0,0,0,0];return l.aV(ke,l.aW([],Oe,Re)),ke[3]=-l.aX(ke,he[Se[0]]),ke})(N,q),ye=(function(he,Se){const Oe=l.a$(he),Re=l.b0([],he,1/Oe),ke=l.aU([],Se,l.aR([],Re,l.aX(Se,Re))),Le=l.a$(ke);if(Le>0){const rt=Math.sqrt(1-Re[3]*Re[3]),st=l.aR([],Re,-Re[3]),Qe=l.aS([],st,l.aR([],ke,rt/Le));return l.b1(Se,Qe)}return null})(X,me);if(ye!==null){const he=ye/l.aX(ce[0],me);le=Math.min(le,he)}for(let he=0;he<4;he++){const Se=Math.min(le,ue[he]);N[he+re]=[N[he+ne][0]+ce[he][0]*Se,N[he+ne][1]+ce[he][1]*Se,N[he+ne][2]+ce[he][2]*Se,1]}})(C,x[0],f,m);const k=x.map((N=>{const q=l.aU([],C[N[0]],C[N[1]]),X=l.aU([],C[N[2]],C[N[1]]),ae=l.aV([],l.aW([],q,X)),ne=-l.aX(ae,C[N[1]]);return ae.concat(ne)})),L=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],j=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const N of C)for(let q=0;q<3;q++)L[q]=Math.min(L[q],N[q]),j[q]=Math.max(j[q],N[q]);return new Zi(C,k,new Ga(L,j))}}class ns{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,c){return this._helper.interpolatePadding(e,r,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,c=!0){this._helper.resize(e,r,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,c,f,m){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new _a({calcMatrices:()=>{this._calcMatrices()},getConstrained:(x,T)=>this.getConstrained(x,T)},e,r,c,f,m),this._coveringTilesDetailsProvider=new Fa}clone(){const e=new ns;return e.apply(this),e}apply(e,r,c){this._helper.apply(e,r,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new l.b2(0,e)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new l.P(0,0)),f=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),m=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),x=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),T=Math.floor(Math.min(c.x,f.x,m.x,x.x)),C=Math.floor(Math.max(c.x,f.x,m.x,x.x)),k=1;for(let L=T-k;L<=C+k;L++)L!==0&&r.push(new l.b2(L,e))}return r}getCameraFrustum(){return Zi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),c=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(e,r){const c=l.aj(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(r,c),m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),x=l.a1.fromLngLat(e),T=new l.a1(x.x-(f.x-m.x),x.y-(f.y-m.y));this.setCenter(T?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(l.a1.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(l.a1.fromLngLat(e))}screenPointToLocation(e,r){var c;return(c=this.screenPointToMercatorCoordinate(e,r))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const c=r.pointCoordinate(e);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const c=r||0,f=[e.x,e.y,0,1],m=[e.x,e.y,1,1];l.aw(f,f,this._pixelMatrixInverse),l.aw(m,m,this._pixelMatrixInverse);const x=f[3],T=m[3],C=f[1]/x,k=m[1]/T,L=f[2]/x,j=m[2]/T,N=L===j?0:(c-L)/(j-L);return new l.a1(l.C.number(f[0]/x,m[0]/T,N)/this.worldSize,l.C.number(C,k,N)/this.worldSize,c)}coordinatePoint(e,r=0,c=this._pixelMatrix){const f=[e.x*this.worldSize,e.y*this.worldSize,r,1];return l.aw(f,f,c),new l.P(f[0]/f[3],f[1]/f[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Ie(this));return new fa().extend(this.screenPointToLocation(new l.P(0,e))).extend(this.screenPointToLocation(new l.P(this._helper._width,e))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-Ie(this)}calculatePosMatrix(e,r=!1,c){var f;const m=(f=e.key)!==null&&f!==void 0?f:l.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),x=r?this._alignedPosMatrixCache:this._posMatrixCache;if(x.has(m)){const k=x.get(m);return c?k.f32:k.f64}const T=Ee(e,this.worldSize);l.O(T,r?this._alignedProjMatrix:this._viewProjMatrix,T);const C={f64:T,f32:new Float32Array(T)};return x.set(m,C),c?C.f32:C.f64}calculateFogMatrix(e){const r=e.key,c=this._fogMatrixCacheF32;if(c.has(r))return c.get(r);const f=Ee(e,this.worldSize);return l.O(f,this._fogMatrix,f),c.set(r,new Float32Array(f)),c.get(r)}getConstrained(e,r){r=l.ah(+r,this.minZoom,this.maxZoom);const c={center:new l.S(e.lng,e.lat),zoom:r};let f=this._helper._lngRange;if(!this._helper._renderWorldCopies&&f===null){const ue=179.9999999999;f=[-ue,ue]}const m=this.tileSize*l.af(c.zoom);let x=0,T=m,C=0,k=m,L=0,j=0;const{x:N,y:q}=this.size;if(this._helper._latRange){const ue=this._helper._latRange;x=l.U(ue[1])*m,T=l.U(ue[0])*m,T-x<q&&(L=q/(T-x))}f&&(C=l.aO(l.V(f[0])*m,0,m),k=l.aO(l.V(f[1])*m,0,m),k<C&&(k+=m),k-C<N&&(j=N/(k-C)));const{x:X,y:ae}=pe(m,e);let ne,re;const le=Math.max(j||0,L||0);if(le){const ue=new l.P(j?(k+C)/2:X,L?(T+x)/2:ae);return c.center=xe(m,ue).wrap(),c.zoom+=l.ak(le),c}if(this._helper._latRange){const ue=q/2;ae-ue<x&&(re=x+ue),ae+ue>T&&(re=T-ue)}if(f){const ue=(C+k)/2;let ce=X;this._helper._renderWorldCopies&&(ce=l.aO(X,ue-m/2,ue+m/2));const me=N/2;ce-me<C&&(ne=C+me),ce+me>k&&(ne=k-me)}if(ne!==void 0||re!==void 0){const ue=new l.P(ne??X,re??ae);c.center=xe(m,ue).wrap()}return c}calculateCenterFromCameraLngLatAlt(e,r,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,c,f)}_calculateNearFarZIfNeeded(e,r,c){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),m=e-f*this._helper._pixelPerMeter/Math.cos(r),x=f<0?m:e,T=Math.PI/2+this.pitchInRadians,C=l.ae(this.fov)*(Math.abs(Math.cos(l.ae(this.roll)))*this.height+Math.abs(Math.sin(l.ae(this.roll)))*this.width)/this.height*(.5+c.y/this.height),k=Math.sin(C)*x/Math.sin(l.ah(Math.PI-T-C,.01,Math.PI-.01)),L=Ie(this),j=Math.atan(L/this._helper.cameraToCenterDistance),N=l.ae(.75),q=j>N?2*j*(.5+c.y/(2*L)):N,X=Math.sin(q)*x/Math.sin(l.ah(Math.PI-T-q,.01,Math.PI-.01)),ae=Math.min(k,X);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*ae+x),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=pe(this.worldSize,this.center),c=r.x,f=r.y;this._helper._pixelPerMeter=l.aj(1,this.center.lat)*this.worldSize;const m=l.ae(Math.min(this.pitch,fe)),x=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(m));let T;this._calculateNearFarZIfNeeded(x,m,e),T=new Float64Array(16),l.b4(T,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.aq(this._invProjMatrix,T),T[8]=2*-e.x/this._helper._width,T[9]=2*e.y/this._helper._height,this._projectionMatrix=l.b5(T),l.N(T,T,[1,-1,1]),l.M(T,T,[0,0,-this._helper.cameraToCenterDistance]),l.b6(T,T,-this.rollInRadians),l.b7(T,T,this.pitchInRadians),l.b6(T,T,-this.bearingInRadians),l.M(T,T,[-c,-f,0]),this._mercatorMatrix=l.N([],T,[this.worldSize,this.worldSize,this.worldSize]),l.N(T,T,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,T),l.M(T,T,[0,0,-this.elevation]),this._viewProjMatrix=T,this._invViewProjMatrix=l.aq([],T);const C=[0,0,-1,1];l.aw(C,C,this._invViewProjMatrix),this._cameraPosition=[C[0]/C[3],C[1]/C[3],C[2]/C[3]],this._fogMatrix=new Float64Array(16),l.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,x,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,l.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.M(this._fogMatrix,this._fogMatrix,[-c,-f,0]),l.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,T);const k=this._helper._width%2/2,L=this._helper._height%2/2,j=Math.cos(this.bearingInRadians),N=Math.sin(-this.bearingInRadians),q=c-Math.round(c)+j*k+N*L,X=f-Math.round(f)+j*L+N*k,ae=new Float64Array(T);if(l.M(ae,ae,[q>.5?q-1:q,X>.5?X-1:X,0]),this._alignedProjMatrix=ae,T=l.aq(new Float64Array(16),this._pixelMatrix),!T)throw new Error("failed to invert matrix");this._pixelMatrixInverse=T,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new l.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return l.aw(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=l.aj(1,this.center.lat)*this.worldSize;return Ve(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const c=l.a1.fromLngLat(e),f=[c.x*this.worldSize,c.y*this.worldSize,r,1];return l.aw(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(e){const{overscaledTileID:r,aligned:c,applyTerrainMatrix:f}=e,m=this._helper.getMercatorTileCoordinates(r),x=r?this.calculatePosMatrix(r,c,!0):null;let T;return T=r&&r.terrainRttPosMatrix32f&&f?r.terrainRttPosMatrix32f:x||l.b8(),{mainMatrix:T,tileMercatorCoords:m,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:T}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,c){return 1}transformLightDirection(e){return l.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,c,f){const m=this.calculatePosMatrix(c);let x;f?(x=[e,r,f(e,r),1],l.aw(x,x,m)):(x=[e,r,0,1],oa(x,x,m));const T=x[3];return{point:new l.P(x[0]/T,x[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const c=l.a1.fromLngLat(e,r),f=c.meterInMercatorCoordinateUnits(),m=l.b9();return l.M(m,m,[c.x,c.y,c.z]),l.b6(m,m,Math.PI),l.b7(m,m,Math.PI/2),l.N(m,m,[-f,f,f]),m}getProjectionDataForCustomLayer(e=!0){const r=new l.Z(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),f=Ee(r,this.worldSize);l.O(f,this._viewProjMatrix,f),c.tileMercatorCoords=[0,0,1,1];const m=[l.$,l.$,this.worldSize/this._helper.pixelsPerMeter],x=l.ba();return l.N(x,f,m),c.fallbackMatrix=x,c.mainMatrix=x,c}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function ma(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Tn(p){if(p.useSlerp)if(p.k<1){const e=l.bb(p.startEulerAngles.roll,p.startEulerAngles.pitch,p.startEulerAngles.bearing),r=l.bb(p.endEulerAngles.roll,p.endEulerAngles.pitch,p.endEulerAngles.bearing),c=new Float64Array(4);l.bc(c,e,r,p.k);const f=l.bd(c);p.tr.setRoll(f.roll),p.tr.setPitch(f.pitch),p.tr.setBearing(f.bearing)}else p.tr.setRoll(p.endEulerAngles.roll),p.tr.setPitch(p.endEulerAngles.pitch),p.tr.setBearing(p.endEulerAngles.bearing);else p.tr.setRoll(l.C.number(p.startEulerAngles.roll,p.endEulerAngles.roll,p.k)),p.tr.setPitch(l.C.number(p.startEulerAngles.pitch,p.endEulerAngles.pitch,p.k)),p.tr.setBearing(l.C.number(p.startEulerAngles.bearing,p.endEulerAngles.bearing,p.k))}function Qa(p,e,r,c,f){const m=f.padding,x=pe(f.worldSize,r.getNorthWest()),T=pe(f.worldSize,r.getNorthEast()),C=pe(f.worldSize,r.getSouthEast()),k=pe(f.worldSize,r.getSouthWest()),L=l.ae(-c),j=x.rotate(L),N=T.rotate(L),q=C.rotate(L),X=k.rotate(L),ae=new l.P(Math.max(j.x,N.x,X.x,q.x),Math.max(j.y,N.y,X.y,q.y)),ne=new l.P(Math.min(j.x,N.x,X.x,q.x),Math.min(j.y,N.y,X.y,q.y)),re=ae.sub(ne),le=(f.width-(m.left+m.right+e.left+e.right))/re.x,ue=(f.height-(m.top+m.bottom+e.top+e.bottom))/re.y;if(ue<0||le<0)return void ma();const ce=Math.min(l.ak(f.scale*Math.min(le,ue)),p.maxZoom),me=l.P.convert(p.offset),ye=new l.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(l.ae(c)),he=me.add(ye).mult(f.scale/l.af(ce));return{center:xe(f.worldSize,x.add(C).div(2).sub(he)),zoom:ce,bearing:c}}class mr{get useGlobeControls(){return!1}handlePanInertia(e,r){const c=e.mag(),f=Math.abs(Ie(r));return{easingOffset:e.mult(Math.min(.75*f/c,1)),easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,c){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(c,e.around)}cameraForBoxAndBearing(e,r,c,f,m){return Qa(e,r,c,f,m)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(l.S.convert(r.center))}handleEaseTo(e,r){const c=e.zoom,f=e.padding,m={roll:e.roll,pitch:e.pitch,bearing:e.bearing},x={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},T=r.zoom!==void 0,C=!e.isPaddingEqual(r.padding);let k=!1;const L=T?+r.zoom:e.zoom;let j=e.centerPoint.add(r.offsetAsPoint);const N=e.screenPointToLocation(j),{center:q,zoom:X}=e.getConstrained(l.S.convert(r.center||N),L??c);ro(e,q);const ae=pe(e.worldSize,N),ne=pe(e.worldSize,q).sub(ae),re=l.af(X-c);return k=X!==c,{easeFunc:le=>{if(k&&e.setZoom(l.C.number(c,X,le)),l.be(m,x)||Tn({startEulerAngles:m,endEulerAngles:x,tr:e,k:le,useSlerp:m.roll!=x.roll}),C&&(e.interpolatePadding(f,r.padding,le),j=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const ue=l.af(e.zoom-c),ce=X>c?Math.min(2,re):Math.max(.5,re),me=Math.pow(ce,1-le),ye=xe(e.worldSize,ae.add(ne.mult(le*me)).mult(ue));e.setLocationAtPoint(e.renderWorldCopies?ye.wrap():ye,j)}},isZooming:k,elevationCenter:q}}handleFlyTo(e,r){const c=r.zoom!==void 0,f=e.zoom,m=e.getConstrained(l.S.convert(r.center||r.locationAtOffset),c?+r.zoom:f),x=m.center,T=m.zoom;ro(e,x);const C=pe(e.worldSize,r.locationAtOffset),k=pe(e.worldSize,x).sub(C),L=k.mag(),j=l.af(T-f);let N;if(r.minZoom!==void 0){const q=Math.min(+r.minZoom,f,T),X=e.getConstrained(x,q).zoom;N=l.af(X-f)}return{easeFunc:(q,X,ae,ne)=>{e.setZoom(q===1?T:f+l.ak(X));const re=q===1?x:xe(e.worldSize,C.add(k.mult(ae)).mult(X));e.setLocationAtPoint(e.renderWorldCopies?re.wrap():re,ne)},scaleOfZoom:j,targetCenter:x,scaleOfMinZoom:N,pixelPathLength:L}}}class Ii{constructor(e,r,c){this.blendFunction=e,this.blendColor=r,this.mask=c}}Ii.Replace=[1,0],Ii.disabled=new Ii(Ii.Replace,l.bf.transparent,[!1,!1,!1,!1]),Ii.unblended=new Ii(Ii.Replace,l.bf.transparent,[!0,!0,!0,!0]),Ii.alphaBlended=new Ii([1,771],l.bf.transparent,[!0,!0,!0,!0]);const Ki=2305;class ai{constructor(e,r,c){this.enable=e,this.mode=r,this.frontFace=c}}ai.disabled=new ai(!1,1029,Ki),ai.backCCW=new ai(!0,1029,Ki),ai.frontCCW=new ai(!0,1028,Ki);class Bt{constructor(e,r,c){this.func=e,this.mask=r,this.range=c}}Bt.ReadOnly=!1,Bt.ReadWrite=!0,Bt.disabled=new Bt(519,Bt.ReadOnly,[0,1]);const Es=7680;class Qt{constructor(e,r,c,f,m,x){this.test=e,this.ref=r,this.mask=c,this.fail=f,this.depthFail=m,this.pass=x}}Qt.disabled=new Qt({func:519,mask:0},0,0,Es,Es,Es);const ln=new WeakMap;function ya(p){var e;if(ln.has(p))return ln.get(p);{const r=(e=p.getParameter(p.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return ln.set(p,r),r}}class Pl{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,c=r.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const f=new l.aL;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const m=new l.aN;m.emplaceBack(0,1,2),this._fullscreenTriangle=new no(r.createVertexBuffer(f,Mn.members),r.createIndexBuffer(m),l.aM.simpleSegment(0,0,f.length,m.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(c.TEXTURE1);const x=c.createTexture();c.bindTexture(c.TEXTURE_2D,x),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(x),ya(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const c=this._cachedRenderContext.context,f=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:l.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,f.TRIANGLES,Bt.disabled,Qt.disabled,Ii.unblended,ai.disabled,((m,x)=>({u_input:m,u_output_expected:x}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ya(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const m=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:m}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ya(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Pl._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const As=l.$/128;function gc(p,e){const r=p.granularity!==void 0?Math.max(p.granularity,1):1,c=r+(p.generateBorders?2:0),f=r+(p.extendToNorthPole||p.generateBorders?1:0)+(p.extendToSouthPole||p.generateBorders?1:0),m=c+1,x=f+1,T=p.generateBorders?-1:0,C=p.generateBorders||p.extendToNorthPole?-1:0,k=r+(p.generateBorders?1:0),L=r+(p.generateBorders||p.extendToSouthPole?1:0),j=m*x,N=c*f*6,q=m*x>65536;if(q&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const X=q||e==="32bit",ae=new Int16Array(2*j);let ne=0;for(let ue=C;ue<=L;ue++)for(let ce=T;ce<=k;ce++){let me=ce/r*l.$;ce===-1&&(me=-As),ce===r+1&&(me=l.$+As);let ye=ue/r*l.$;ue===-1&&(ye=p.extendToNorthPole?l.bh:-As),ue===r+1&&(ye=p.extendToSouthPole?l.bi:l.$+As),ae[ne++]=me,ae[ne++]=ye}const re=X?new Uint32Array(N):new Uint16Array(N);let le=0;for(let ue=0;ue<f;ue++)for(let ce=0;ce<c;ce++){const me=ce+1+ue*m,ye=ce+(ue+1)*m,he=ce+1+(ue+1)*m;re[le++]=ce+ue*m,re[le++]=ye,re[le++]=me,re[le++]=me,re[le++]=ye,re[le++]=he}return{vertices:ae.buffer.slice(0),indices:re.buffer.slice(0),uses32bitIndices:X}}const so=new l.aK({fill:new l.bj(128,2),line:new l.bj(512,0),tile:new l.bj(128,32),stencil:new l.bj(128,1),circle:3});class Vo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return pn.projectionGlobe}get vertexShaderPreludeCode(){return pn.projectionMercator.vertexSource}get subdivisionGranularity(){return so}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Pl(e));const r=l.U(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(r,c),m=W.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=m);const x=Math.min(Math.max((m-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bl(x))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,c,f,m){const x=(m==="stencil"?so.stencil:so.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:x,generateBorders:c,extendToNorthPole:r.y===0&&f,extendToSouthPole:r.y===(1<<r.z)-1&&f})}_getMesh(e,r){const c=this._getMeshKey(r);if(c in this._tileMeshCache)return this._tileMeshCache[c];const f=(function(m,x){const T=gc(x,"16bit"),C=l.aL.deserialize({arrayBuffer:T.vertices,length:T.vertices.byteLength/2/2}),k=l.aN.deserialize({arrayBuffer:T.indices,length:T.indices.byteLength/2/3});return new no(m.createVertexBuffer(C,Mn.members),m.createIndexBuffer(k),l.aM.simpleSegment(0,0,C.length,k.length))})(e,r);return this._tileMeshCache[c]=f,f}recalculate(e){}hasTransition(){const e=W.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const qo=new l.r({type:new l.D(l.v.projection.type)});class Zo extends l.E{constructor(e){super(),this._transitionable=new l.t(qo,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0)),this._mercatorProjection=new Hn,this._verticalPerspectiveProjection=new Vo}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof l.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,c,f,m){return this.currentProjection.getMeshFromTileID(e,r,c,f,m)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function zl(p){const e=$o(p.worldSize,p.center.lat);return 2*Math.PI*e}function rs(p,e,r,c,f){const m=1/(1<<f),x=e/l.$*m+c*m,T=l.bo((p/l.$*m+r*m)*Math.PI*2+Math.PI,2*Math.PI),C=2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI,k=Math.cos(C),L=new Float64Array(3);return L[0]=Math.sin(T)*k,L[1]=Math.sin(C),L[2]=Math.cos(T)*k,L}function Ka(p){return(function(e,r){const c=Math.cos(r),f=new Float64Array(3);return f[0]=Math.sin(e)*c,f[1]=Math.sin(r),f[2]=Math.cos(e)*c,f})(p.lng*Math.PI/180,p.lat*Math.PI/180)}function $o(p,e){return p/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Ho(p){const e=Math.asin(p[1])/Math.PI*180,r=Math.sqrt(p[0]*p[0]+p[2]*p[2]);if(r>1e-6){const c=p[0]/r,f=Math.acos(p[2]/r),m=(c>0?f:-f)/Math.PI*180;return new l.S(l.aO(m,-180,180),e)}return new l.S(0,e)}function oo(p){return Math.cos(p*Math.PI/180)}function Ja(p,e){const r=oo(p),c=oo(e);return l.ak(c/r)}function du(p,e){const r=p.rotate(e.bearingInRadians),c=e.zoom+Ja(e.center.lat,0),f=l.bk(1/oo(e.center.lat),1/oo(Math.min(Math.abs(e.center.lat),60)),l.bn(c,7,3,0,1)),m=360/zl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new l.S(e.center.lng-r.x*m*f,l.ah(e.center.lat+r.y*m,-l.ai,l.ai))}function fu(p){const e=.5*p,r=Math.sin(e),c=Math.cos(e);return Math.log(r+c)-Math.log(c-r)}function dd(p,e,r,c){const f=p.lat+r*c;if(Math.abs(r)>1){const m=(Math.sign(p.lat+r)!==Math.sign(p.lat)?-Math.abs(p.lat):Math.abs(p.lat))*Math.PI/180,x=Math.abs(p.lat+r)*Math.PI/180,T=fu(m+c*(x-m)),C=fu(m),k=fu(x);return new l.S(p.lng+e*((T-C)/(k-C)),f)}return new l.S(p.lng+e*c,f)}class fd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,r,c,f){const m=`${e.z}_${e.x}_${e.y}_${f?.terrain?"t":""}`,x=this._cache.get(m);if(x)return x;const T=this._cachePrevious.get(m);if(T)return this._cache.set(m,T),T;const C=this._boundingVolumeFactory(e,r,c,f);return this._cache.set(m,C),this._hadAnyChanges=!0,C}}class Ua{constructor(e,r,c,f){this.min=c,this.max=f,this.points=e,this.planes=r}static fromAabb(e,r){const c=[];for(let f=0;f<8;f++)c.push([1&~f?e[0]:r[0],(f>>1&1)==1?r[1]:e[1],(f>>2&1)==1?r[2]:e[2]]);return new Ua(c,[[-1,0,0,r[0]],[1,0,0,-e[0]],[0,-1,0,r[1]],[0,1,0,-e[1]],[0,0,-1,r[2]],[0,0,1,-e[2]]],e,r)}static fromCenterSizeAngles(e,r,c){const f=l.br([],c[0],c[1],c[2]),m=l.bs([],[r[0],0,0],f),x=l.bs([],[0,r[1],0],f),T=l.bs([],[0,0,r[2]],f),C=[...e],k=[...e];for(let j=0;j<8;j++)for(let N=0;N<3;N++){const q=e[N]+m[N]*(1&~j?-1:1)+x[N]*((j>>1&1)==1?1:-1)+T[N]*((j>>2&1)==1?1:-1);C[N]=Math.min(C[N],q),k[N]=Math.max(k[N],q)}const L=[];for(let j=0;j<8;j++){const N=[...e];l.aS(N,N,l.aR([],m,1&~j?-1:1)),l.aS(N,N,l.aR([],x,(j>>1&1)==1?1:-1)),l.aS(N,N,l.aR([],T,(j>>2&1)==1?1:-1)),L.push(N)}return new Ua(L,[[...m,-l.aX(m,L[0])],[...x,-l.aX(x,L[0])],[...T,-l.aX(T,L[0])],[-m[0],-m[1],-m[2],-l.aX(m,L[7])],[-x[0],-x[1],-x[2],-l.aX(x,L[7])],[-T[0],-T[1],-T[2],-l.aX(T,L[7])]],C,k)}intersectsFrustum(e){let r=!0;const c=this.points.length,f=this.planes.length,m=e.planes.length,x=e.points.length;for(let T=0;T<m;T++){const C=e.planes[T];let k=0;for(let L=0;L<c;L++){const j=this.points[L];C[0]*j[0]+C[1]*j[1]+C[2]*j[2]+C[3]>=0&&k++}if(k===0)return 0;k<c&&(r=!1)}if(r)return 2;for(let T=0;T<f;T++){const C=this.planes[T];let k=0;for(let L=0;L<x;L++){const j=e.points[L];C[0]*j[0]+C[1]*j[1]+C[2]*j[2]+C[3]>=0&&k++}if(k===0)return 0}return 1}intersectsPlane(e){const r=this.points.length;let c=0;for(let f=0;f<r;f++){const m=this.points[f];e[0]*m[0]+e[1]*m[1]+e[2]*m[2]+e[3]>=0&&c++}return c===r?2:c===0?0:1}}function Il(p,e,r){const c=p-e;return c<0?-c:Math.max(0,c-r)}function gr(p,e,r,c,f){const m=p-r;let x;return x=m<0?Math.min(-m,1+m-f):m>1?Math.min(Math.max(m-f,0),1-m):0,Math.max(x,Il(e,c,f))}class pu{constructor(){this._boundingVolumeCache=new fd(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,r,c,f){const m=1<<c.z,x=1/m,T=c.x/m,C=c.y/m;let k=2;return k=Math.min(k,gr(e,r,T,C,x)),k=Math.min(k,gr(e,r,T+.5,-C-x,x)),k=Math.min(k,gr(e,r,T+.5,2-C-x,x)),k}getWrap(e,r,c){const f=1<<r.z,m=1/f,x=r.x/f,T=Il(e.x,x,m),C=Il(e.x,x-1,m),k=Il(e.x,x+1,m),L=Math.min(T,C,k);return L===k?1:L===C?-1:0}allowVariableZoom(e,r){return Ae(e,r)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,r,c,f){return this._boundingVolumeCache.getTileBoundingVolume(e,r,c,f)}_computeTileBoundingVolume(e,r,c,f){var m,x;let T=0,C=0;if(f?.terrain){const k=new l.Z(e.z,r,e.z,e.x,e.y),L=f.terrain.getMinMaxElevation(k);T=(m=L.minElevation)!==null&&m!==void 0?m:Math.min(0,c),C=(x=L.maxElevation)!==null&&x!==void 0?x:Math.max(0,c)}if(T/=l.bu,C/=l.bu,T+=1,C+=1,e.z<=0)return Ua.fromAabb([-C,-C,-C],[C,C,C]);if(e.z===1)return Ua.fromAabb([e.x===0?-C:0,e.y===0?0:-C,-C],[e.x===0?0:C,e.y===0?C:0,C]);{const k=[rs(0,0,e.x,e.y,e.z),rs(l.$,0,e.x,e.y,e.z),rs(l.$,l.$,e.x,e.y,e.z),rs(0,l.$,e.x,e.y,e.z)],L=[];for(const ke of k)L.push(l.aR([],ke,C));if(C!==T)for(const ke of k)L.push(l.aR([],ke,T));e.y===0&&L.push([0,1,0]),e.y===(1<<e.z)-1&&L.push([0,-1,0]);const j=[1,1,1],N=[-1,-1,-1];for(const ke of L)for(let Le=0;Le<3;Le++)j[Le]=Math.min(j[Le],ke[Le]),N[Le]=Math.max(N[Le],ke[Le]);const q=rs(l.$/2,l.$/2,e.x,e.y,e.z),X=l.aW([],[0,1,0],q);l.aV(X,X);const ae=l.aW([],q,X);l.aV(ae,ae);const ne=l.aW([],k[2],k[1]);l.aV(ne,ne);const re=l.aW([],k[0],k[3]);l.aV(re,re),L.push(l.aR([],q,C)),e.y>=(1<<e.z)/2&&L.push(l.aR([],rs(l.$/2,0,e.x,e.y,e.z),C)),e.y<(1<<e.z)/2&&L.push(l.aR([],rs(l.$/2,l.$,e.x,e.y,e.z),C));const le=_c(q,L),ue=_c(ae,L),ce=[-q[0],-q[1],-q[2],le.max],me=[q[0],q[1],q[2],-le.min],ye=[-ae[0],-ae[1],-ae[2],ue.max],he=[ae[0],ae[1],ae[2],-ue.min],Se=[...ne,0],Oe=[...re,0],Re=[];return e.y===0?Re.push(l.bt(Oe,Se,ce),l.bt(Oe,Se,me)):Re.push(l.bt(ye,Se,ce),l.bt(ye,Se,me),l.bt(ye,Oe,ce),l.bt(ye,Oe,me)),e.y===(1<<e.z)-1?Re.push(l.bt(Oe,Se,ce),l.bt(Oe,Se,me)):Re.push(l.bt(he,Se,ce),l.bt(he,Se,me),l.bt(he,Oe,ce),l.bt(he,Oe,me)),new Ua(Re,[ce,me,ye,he,Se,Oe],j,N)}}}function _c(p,e){let r=1/0,c=-1/0;for(const f of e){const m=l.aX(p,f);r=Math.min(r,m),c=Math.max(c,m)}return{min:r,max:c}}class yc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,c){return this._helper.interpolatePadding(e,r,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=l.bv(),this._projectionMatrix=l.b9(),this._globeViewProjMatrix32f=l.b8(),this._globeViewProjMatrixNoCorrection=l.b9(),this._globeViewProjMatrixNoCorrectionInverted=l.b9(),this._globeProjMatrixInverted=l.b9(),this._cameraPosition=l.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new _a({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new pu}clone(){const e=new yc;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=l.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:c}=e,f=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,c=this.cameraToCenterDistance/e,f=Math.sin(r)*c,m=Math.cos(r)*c+1,x=1/Math.sqrt(f*f+m*m)*1;let T=-f,C=m;const k=Math.sqrt(T*T+C*C);T/=k,C/=k;const L=[0,T,C];l.bw(L,L,[0,0,0],-this.bearingInRadians),l.bx(L,L,[0,0,0],-1*this.center.lat*Math.PI/180),l.by(L,L,[0,0,0],this.center.lng*Math.PI/180);const j=1/l.aZ(L);return l.aR(L,L,j),[...L,-x*j]}isLocationOccluded(e){return!this.isSurfacePointVisible(Ka(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,f=Math.cos(c),m=[Math.sin(r)*f,Math.sin(c),Math.cos(r)*f],x=[m[2],0,-m[0]],T=[0,0,0];l.aW(T,x,m),l.aV(x,x),l.aV(T,T);const C=[0,0,0];return l.aV(C,[x[0]*e[0]+T[0]*e[1]+m[0]*e[2],x[1]*e[0]+T[1]*e[1]+m[1]*e[2],x[2]*e[0]+T[2]*e[1]+m[2]*e[2]]),C}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,c){const f=(function(T,C,k){const L=1/(1<<k.z);return new l.a1(T/l.$*L+k.x*L,C/l.$*L+k.y*L)})(e,r,c.canonical),m=(x=f.y,[l.bo(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI]);var x;return this.getCircleRadiusCorrection()/Math.cos(m[1])}projectTileCoordinates(e,r,c,f){const m=c.canonical,x=rs(e,r,m.x,m.y,m.z),T=1+(f?f(e,r):0)/l.bu,C=[x[0]*T,x[1]*T,x[2]*T,1];l.aw(C,C,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,L=k[0]*x[0]+k[1]*x[1]+k[2]*x[2]+k[3]<0;return{point:new l.P(C[0]/C[3],C[1]/C[3]),signedDistanceFromCamera:C[3],isOccluded:L}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=$o(this.worldSize,this.center.lat),r=l.ba(),c=l.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),l.b4(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;r[8]=2*-f.x/this._helper._width,r[9]=2*f.y/this._helper._height,this._projectionMatrix=l.b5(r),this._globeProjMatrixInverted=l.ba(),l.aq(this._globeProjMatrixInverted,r),l.M(r,r,[0,0,-this.cameraToCenterDistance]),l.b6(r,r,this.rollInRadians),l.b7(r,r,-this.pitchInRadians),l.b6(r,r,this.bearingInRadians),l.M(r,r,[0,0,-e]);const m=l.bp();m[0]=e,m[1]=e,m[2]=e,l.b7(c,r,this.center.lat*Math.PI/180),l.bz(c,c,-this.center.lng*Math.PI/180),l.N(c,c,m),this._globeViewProjMatrixNoCorrection=c,l.b7(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.bz(r,r,-this.center.lng*Math.PI/180),l.N(r,r,m),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=l.ba(),l.aq(this._globeViewProjMatrixNoCorrectionInverted,c);const x=l.bp();this._cameraPosition=l.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,l.bw(this._cameraPosition,this._cameraPosition,x,-this.rollInRadians),l.bx(this._cameraPosition,this._cameraPosition,x,this.pitchInRadians),l.bw(this._cameraPosition,this._cameraPosition,x,-this.bearingInRadians),l.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bx(this._cameraPosition,this._cameraPosition,x,-this.center.lat*Math.PI/180),l.by(this._cameraPosition,this._cameraPosition,x,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const T=l.b5(this._globeViewProjMatrixNoCorrectionInverted);l.N(T,T,[1,1,-1]),this._cachedFrustum=Zi.fromInvProjectionMatrix(T,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){l.w("calculateFogMatrix is not supported on globe projection.");const r=l.ba();return l.ag(r),r}getVisibleUnwrappedCoordinates(e){return[new l.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Ka(e);l.aR(c,c,1+r/l.bu);const f=l.bv();return l.aw(f,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,c=[new l.P(0,0),new l.P(e,0),new l.P(this.width,0),new l.P(this.width,r),new l.P(this.width,this.height),new l.P(e,this.height),new l.P(0,this.height),new l.P(0,r)],f=[];for(const j of c)f.push(this.unprojectScreenPoint(j));let m=0,x=0,T=0,C=0;const k=this.center;for(const j of f){const N=l.bA(k.lng,j.lng),q=l.bA(k.lat,j.lat);N<x&&(x=N),N>m&&(m=N),q<C&&(C=q),q>T&&(T=q)}const L=[k.lng+x,k.lat+C,k.lng+m,k.lat+T];return this.isSurfacePointOnScreen([0,1,0])&&(L[3]=90,L[0]=-180,L[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(L[1]=-90,L[0]=-180,L[2]=180),new fa(L)}getConstrained(e,r){const c=l.ah(e.lat,-l.ai,l.ai),f=l.ah(+r,this.minZoom+Ja(0,c),this.maxZoom);return{center:new l.S(e.lng,c),zoom:f}}calculateCenterFromCameraLngLatAlt(e,r,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,c,f)}setLocationAtPoint(e,r){const c=Ka(this.unprojectScreenPoint(r)),f=Ka(e),m=l.bp();l.bB(m);const x=l.bp();l.by(x,c,m,-this.center.lng*Math.PI/180),l.bx(x,x,m,this.center.lat*Math.PI/180);const T=f[0]*f[0]+f[2]*f[2],C=x[0]*x[0];if(T<C)return;const k=Math.sqrt(T-C),L=-k,j=l.bC(f[0],f[2],x[0],k),N=l.bC(f[0],f[2],x[0],L),q=l.bp();l.by(q,f,m,-j);const X=l.bC(q[1],q[2],x[1],x[2]),ae=l.bp();l.by(ae,f,m,-N);const ne=l.bC(ae[1],ae[2],x[1],x[2]),re=.5*Math.PI,le=X>=-re&&X<=re,ue=ne>=-re&&ne<=re;let ce,me;if(le&&ue){const Oe=this.center.lng*Math.PI/180,Re=this.center.lat*Math.PI/180;l.bD(j,Oe)+l.bD(X,Re)<l.bD(N,Oe)+l.bD(ne,Re)?(ce=j,me=X):(ce=N,me=ne)}else if(le)ce=j,me=X;else{if(!ue)return;ce=N,me=ne}const ye=ce/Math.PI*180,he=me/Math.PI*180,Se=this.center.lat;this.setCenter(new l.S(ye,l.ah(he,-90,90))),this.setZoom(this.zoom+Ja(Se,this.center.lat))}locationToScreenPoint(e,r){const c=Ka(e);if(r){const f=r.getElevationForLngLatZoom(e,this._helper._tileZoom);l.aR(c,c,1+f/l.bu)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(e){const r=l.bv();return l.aw(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new l.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const c=r.pointCoordinate(e);if(c)return c}return l.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var c;return(c=this.screenPointToMercatorCoordinate(e,r))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(e,r){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(c,f)}getRayDirectionFromPixel(e){const r=l.bv();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,l.aw(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const c=l.bp();c[0]=r[0]-this._cameraPosition[0],c[1]=r[1]-this._cameraPosition[1],c[2]=r[2]-this._cameraPosition[2];const f=l.bp();return l.aV(f,c),f}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=l.bv();return l.aw(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const c=l.aX(e,r),f=l.bp(),m=l.bp();l.aR(m,r,c),l.aU(f,e,m);const x=1-l.aX(f,f);if(x<0)return null;const T=l.aX(e,e)-1,C=-c+(c<0?1:-1)*Math.sqrt(x),k=T/C,L=C;return{tMin:Math.min(k,L),tMax:Math.max(k,L)}}unprojectScreenPoint(e){const r=this._cameraPosition,c=this.getRayDirectionFromPixel(e),f=this.rayPlanetIntersection(r,c);if(f){const L=l.bp();l.aS(L,r,[c[0]*f.tMin,c[1]*f.tMin,c[2]*f.tMin]);const j=l.bp();return l.aV(j,L),Ho(j)}const m=this._cachedClippingPlane,x=m[0]*c[0]+m[1]*c[1]+m[2]*c[2],T=-l.b1(m,r)/x,C=l.bp();if(T>0)l.aS(C,r,[c[0]*T,c[1]*T,c[2]*T]);else{const L=l.bp();l.aS(L,r,[2*c[0],2*c[1],2*c[2]]);const j=l.b1(this._cachedClippingPlane,L);l.aU(C,L,[this._cachedClippingPlane[0]*j,this._cachedClippingPlane[1]*j,this._cachedClippingPlane[2]*j])}const k=(function(L){const j=l.bp();return j[0]=L[0]*-L[3],j[1]=L[1]*-L[3],j[2]=L[2]*-L[3],{center:j,radius:Math.sqrt(1-L[3]*L[3])}})(m);return Ho((function(L,j,N){const q=l.bp();l.aU(q,N,L);const X=l.bp();return l.bq(X,L,q,j/l.a$(q)),X})(k.center,k.radius,C))}getMatrixForModel(e,r){const c=l.S.convert(e),f=1/l.bu,m=l.b9();return l.bz(m,m,c.lng/180*Math.PI),l.b7(m,m,-c.lat/180*Math.PI),l.M(m,m,[0,0,1+r/l.bu]),l.b7(m,m,.5*Math.PI),l.N(m,m,[f,f,f]),m}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new l.Z(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class Cs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,c){return this._helper.interpolatePadding(e,r,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,c=!0){this._helper.resize(e,r,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new _a({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new ns,this._verticalPerspectiveTransform=new yc}clone(){const e=new Cs;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),c=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:r.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return l.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,c){const f=this._mercatorTransform.getPitchedTextCorrection(e,r,c),m=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,c);return l.bk(f,m,this._globeness)}projectTileCoordinates(e,r,c,f){return this.currentTransform.projectTileCoordinates(e,r,c,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,c,f)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return c.fallbackMatrix=r.mainMatrix,c}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Dr{get useGlobeControls(){return!0}handlePanInertia(e,r){const c=du(e,r);return Math.abs(c.lng-r.center.lng)>180&&(c.lng=r.center.lng+179.5*Math.sign(c.lng-r.center.lng)),{easingCenter:c,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const c=e.around,f=r.screenPointToLocation(c);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const m=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const x=r.zoom-m;if(x===0)return;const T=l.bA(r.center.lng,f.lng),C=T/(Math.abs(T/180)+1),k=l.bA(r.center.lat,f.lat),L=r.getRayDirectionFromPixel(c),j=r.cameraPosition,N=-1*l.aX(j,L),q=l.bp();l.aS(q,j,[L[0]*N,L[1]*N,L[2]*N]);const X=l.aZ(q)-1,ae=Math.exp(.5*-Math.max(X-.3,0)),ne=$o(r.worldSize,r.center.lat)/Math.min(r.width,r.height),re=l.bn(ne,.9,.5,1,.25),le=(1-l.af(-x))*Math.min(ae,re),ue=r.center.lat,ce=r.zoom,me=new l.S(r.center.lng+C*le,l.ah(r.center.lat+k*le,-l.ai,l.ai));r.setLocationAtPoint(f,c);const ye=r.center,he=l.bn(Math.abs(T),45,85,0,1),Se=l.bn(ne,.75,.35,0,1),Oe=Math.pow(Math.max(he,Se),.25),Re=l.bA(ye.lng,me.lng),ke=l.bA(ye.lat,me.lat);r.setCenter(new l.S(ye.lng+Re*Oe,ye.lat+ke*Oe).wrap()),r.setZoom(ce+Ja(ue,r.center.lat))}handleMapControlsPan(e,r,c){if(!e.panDelta)return;const f=r.center.lat,m=r.zoom;r.setCenter(du(e.panDelta,r).wrap()),r.setZoom(m+Ja(f,r.center.lat))}cameraForBoxAndBearing(e,r,c,f,m){const x=Qa(e,r,c,f,m),T=r.left/m.width*2-1,C=(m.width-r.right)/m.width*2-1,k=r.top/m.height*-2+1,L=(m.height-r.bottom)/m.height*-2+1,j=l.bA(c.getWest(),c.getEast())<0,N=j?c.getEast():c.getWest(),q=j?c.getWest():c.getEast(),X=Math.max(c.getNorth(),c.getSouth()),ae=Math.min(c.getNorth(),c.getSouth()),ne=N+.5*l.bA(N,q),re=X+.5*l.bA(X,ae),le=m.clone();le.setCenter(x.center),le.setBearing(x.bearing),le.setPitch(0),le.setRoll(0),le.setZoom(x.zoom);const ue=le.modelViewProjectionMatrix,ce=[Ka(c.getNorthWest()),Ka(c.getNorthEast()),Ka(c.getSouthWest()),Ka(c.getSouthEast()),Ka(new l.S(q,re)),Ka(new l.S(N,re)),Ka(new l.S(ne,X)),Ka(new l.S(ne,ae))],me=Ka(x.center);let ye=Number.POSITIVE_INFINITY;for(const he of ce)T<0&&(ye=Dr.getLesserNonNegativeNonNull(ye,Dr.solveVectorScale(he,me,ue,"x",T))),C>0&&(ye=Dr.getLesserNonNegativeNonNull(ye,Dr.solveVectorScale(he,me,ue,"x",C))),k>0&&(ye=Dr.getLesserNonNegativeNonNull(ye,Dr.solveVectorScale(he,me,ue,"y",k))),L<0&&(ye=Dr.getLesserNonNegativeNonNull(ye,Dr.solveVectorScale(he,me,ue,"y",L)));if(Number.isFinite(ye)&&ye!==0)return x.zoom=le.zoom+l.ak(ye),x;ma()}handleJumpToCenterZoom(e,r){const c=e.center.lat,f=e.getConstrained(r.center?l.S.convert(r.center):e.center,e.zoom).center;e.setCenter(f.wrap());const m=r.zoom!==void 0?+r.zoom:e.zoom+Ja(c,f.lat);e.zoom!==m&&e.setZoom(m)}handleEaseTo(e,r){const c=e.zoom,f=e.center,m=e.padding,x={roll:e.roll,pitch:e.pitch,bearing:e.bearing},T={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},C=r.zoom!==void 0,k=!e.isPaddingEqual(r.padding);let L=!1;const j=r.center?l.S.convert(r.center):f,N=e.getConstrained(j,c).center;ro(e,N);const q=e.clone();q.setCenter(N),q.setZoom(C?+r.zoom:c+Ja(f.lat,j.lat)),q.setBearing(r.bearing);const X=new l.P(l.ah(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),l.ah(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));q.setLocationAtPoint(N,X);const ae=(r.offset&&r.offsetAsPoint.mag())>0?q.center:N,ne=C?+r.zoom:c+Ja(f.lat,ae.lat),re=c+Ja(f.lat,0),le=ne+Ja(ae.lat,0),ue=l.bA(f.lng,ae.lng),ce=l.bA(f.lat,ae.lat),me=l.af(le-re);return L=ne!==c,{easeFunc:ye=>{if(l.be(x,T)||Tn({startEulerAngles:x,endEulerAngles:T,tr:e,k:ye,useSlerp:x.roll!=T.roll}),k&&e.interpolatePadding(m,r.padding,ye),r.around)l.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const he=le>re?Math.min(2,me):Math.max(.5,me),Se=Math.pow(he,1-ye),Oe=dd(f,ue,ce,ye*Se);e.setCenter(Oe.wrap())}if(L){const he=l.C.number(re,le,ye)+Ja(0,e.center.lat);e.setZoom(he)}},isZooming:L,elevationCenter:ae}}handleFlyTo(e,r){const c=r.zoom!==void 0,f=e.center,m=e.zoom,x=e.padding,T=!e.isPaddingEqual(r.padding),C=e.getConstrained(l.S.convert(r.center||r.locationAtOffset),m).center,k=c?+r.zoom:e.zoom+Ja(e.center.lat,C.lat),L=e.clone();L.setCenter(C),L.setZoom(k),L.setBearing(r.bearing);const j=new l.P(l.ah(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),l.ah(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));L.setLocationAtPoint(C,j);const N=L.center;ro(e,N);const q=(function(ce,me,ye){const he=Ka(me),Se=Ka(ye),Oe=l.aX(he,Se),Re=Math.acos(Oe),ke=zl(ce);return Re/(2*Math.PI)*ke})(e,f,N),X=m+Ja(f.lat,0),ae=k+Ja(N.lat,0),ne=l.af(ae-X);let re;if(typeof r.minZoom=="number"){const ce=+r.minZoom+Ja(N.lat,0),me=Math.min(ce,X,ae)+Ja(0,N.lat),ye=e.getConstrained(N,me).zoom+Ja(N.lat,0);re=l.af(ye-X)}const le=l.bA(f.lng,N.lng),ue=l.bA(f.lat,N.lat);return{easeFunc:(ce,me,ye,he)=>{const Se=dd(f,le,ue,ye);T&&e.interpolatePadding(x,r.padding,ce);const Oe=ce===1?N:Se;e.setCenter(Oe.wrap());const Re=X+l.ak(me);e.setZoom(ce===1?k:Re+Ja(0,Oe.lat))},scaleOfZoom:ne,targetCenter:N,scaleOfMinZoom:re,pixelPathLength:q}}static solveVectorScale(e,r,c,f,m){const x=f==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],T=[c[3],c[7],c[11],c[15]],C=e[0]*x[0]+e[1]*x[1]+e[2]*x[2],k=e[0]*T[0]+e[1]*T[1]+e[2]*T[2],L=r[0]*x[0]+r[1]*x[1]+r[2]*x[2],j=r[0]*T[0]+r[1]*T[1]+r[2]*T[2];return L+m*k===C+m*j||T[3]*(C-L)+x[3]*(j-k)+C*j==L*k?null:(L+x[3]-m*j-m*T[3])/(L-C-m*j+m*k)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class lh{constructor(e){this._globe=e,this._mercatorCameraHelper=new mr,this._verticalPerspectiveCameraHelper=new Dr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,c){this.currentHelper.handleMapControlsPan(e,r,c)}cameraForBoxAndBearing(e,r,c,f,m){return this.currentHelper.cameraForBoxAndBearing(e,r,c,f,m)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const mu=(p,e)=>l.y(p,e&&e.filter((r=>r.identifier!=="source.canvas"))),vf=l.bE();class ch extends l.E{constructor(e,r={}){var c,f;super(),this._rtlPluginLoaded=()=>{for(const x in this.sourceCaches){const T=this.sourceCaches[x].getSource().type;T!=="vector"&&T!=="geojson"||this.sourceCaches[x].reload()}},this.map=e,this.dispatcher=new Ft($t(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((x,T)=>this.getGlyphs(x,T))),this.dispatcher.registerMessageHandler("GI",((x,T)=>this.getImages(x,T))),this.dispatcher.registerMessageHandler("GDA",((x,T)=>this.getDashes(x,T))),this.imageManager=new Vt,this.imageManager.setEventedParent(this);const m=((c=e._container)===null||c===void 0?void 0:c.lang)||typeof document<"u"&&((f=document.documentElement)===null||f===void 0?void 0:f.lang)||void 0;this.glyphManager=new Ma(e._requestManager,r.localIdeographFontFamily,m),this.lineAtlas=new Lt(256,512),this.crossTileSymbolIndex=new as,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",l.bG()),ws().on(Na,this._rtlPluginLoaded),this.on("data",(x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const T=this.sourceCaches[x.sourceId];if(!T)return;const C=T.getSource();if(C&&C.vectorLayerIds)for(const k in this._layers){const L=this._layers[k];L.source===C.id&&this._validateLayer(L)}}))}setGlobalStateProperty(e,r){var c,f,m;this._checkLoaded();const x=r===null?(m=(f=(c=this.stylesheet.state)===null||c===void 0?void 0:c[e])===null||f===void 0?void 0:f.default)!==null&&m!==void 0?m:null:r;if(l.bH(x,this._globalState[e]))return this;this._globalState[e]=x,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const r=[];for(const c in e)!l.bH(this._globalState[c],e[c].default)&&(r.push(c),this._globalState[c]=e[c].default);this._applyGlobalStateChanges(r)}_applyGlobalStateChanges(e){if(e.length===0)return;const r=new Set,c={};for(const f of e){c[f]=this._globalState[f];for(const m in this._layers){const x=this._layers[m],T=x.getLayoutAffectingGlobalStateRefs(),C=x.getPaintAffectingGlobalStateRefs();if(T.has(f)&&r.add(x.source),C.has(f))for(const{name:k,value:L}of C.get(f))this._updatePaintProperty(x,k,L)}}this.dispatcher.broadcast("UGS",c);for(const f in this.sourceCaches)r.has(f)&&(this._reloadSource(f),this._changed=!0)}loadURL(e,r={},c){this.fire(new l.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const f=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;l.j(f,this._loadStyleRequest).then((x=>{this._loadStyleRequest=null,this._load(x.data,r,c)})).catch((x=>{this._loadStyleRequest=null,x&&!m.signal.aborted&&this.fire(new l.k(x))}))}loadJSON(e,r={},c){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,W.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,c)})).catch((()=>{}))}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(vf,{validate:!1})}_load(e,r,c){var f,m;let x=r.transformStyle?r.transformStyle(c,e):e;if(!r.validate||!mu(this,l.z(x))){x=Object.assign({},x),this._loaded=!0,this.stylesheet=x;for(const T in x.sources)this.addSource(T,x.sources[T],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new Xe(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new Nt(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){var e,r,c;const f=l.bI(this.stylesheet.layers);this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this.dispatcher.broadcast("SL",f),this._order=f.map((m=>m.id)),this._layers={},this._serializedLayers=null;for(const m of f){const x=l.bJ(m,this._globalState);if(x.setEventedParent(this,{layer:{id:m.id}}),this._layers[m.id]=x,l.bK(x)&&this.sourceCaches[x.source]){const T=(c=(r=m.paint)===null||r===void 0?void 0:r["raster-fade-duration"])!==null&&c!==void 0?c:x.paint.get("raster-fade-duration");this.sourceCaches[x.source].setRasterFadeDuration(T)}}}_loadSprite(e,r=!1,c=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(m,x,T,C){return l._(this,void 0,void 0,(function*(){const k=Pt(m),L=T>1?"@2x":"",j={},N={};for(const{id:q,url:X}of k){const ae=x.transformRequest(_t(X,L,".json"),"SpriteJSON");j[q]=l.j(ae,C);const ne=x.transformRequest(_t(X,L,".png"),"SpriteImage");N[q]=mt.getImage(ne,C)}return yield Promise.all([...Object.values(j),...Object.values(N)]),(function(q,X){return l._(this,void 0,void 0,(function*(){const ae={};for(const ne in q){ae[ne]={};const re=W.getImageCanvasContext((yield X[ne]).data),le=(yield q[ne]).data;for(const ue in le){const{width:ce,height:me,x:ye,y:he,sdf:Se,pixelRatio:Oe,stretchX:Re,stretchY:ke,content:Le,textFitWidth:rt,textFitHeight:st}=le[ue];ae[ne][ue]={data:null,pixelRatio:Oe,sdf:Se,stretchX:Re,stretchY:ke,content:Le,textFitWidth:rt,textFitHeight:st,spriteData:{width:ce,height:me,x:ye,y:he,context:re}}}}return ae}))})(j,N)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((m=>{if(this._spriteRequest=null,m)for(const x in m){this._spritesImagesIds[x]=[];const T=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter((C=>!(C in m))):[];for(const C of T)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in m[x]){const k=x==="default"?C:`${x}:${C}`;this._spritesImagesIds[x].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,m[x][C],!1):this.imageManager.addImage(k,m[x][C]),r&&(this._changedImages[k]=!0)}}})).catch((m=>{this._spriteRequest=null,f=m,this.fire(new l.k(f))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),c&&c(f)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const c=e.sourceLayer;if(!c)return;const f=r.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(c)===-1)&&this.fire(new l.k(new Error(`Source layer "${c}" does not exist on source "${f.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?l.bL(c):c);const f=[];for(const m of e)if(c[m]){const x=r?l.bL(c[m]):c[m];f.push(x)}return f}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const c of r){const f=this._layers[c];f.type!=="custom"&&(e[c]=f.serialize())}return e}hasTransitions(){var e,r,c;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const f=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(f.length||m.length)&&this._updateWorkerLayers(f,m);for(const x in this._updatedSources){const T=this._updatedSources[x];if(T==="reload")this._reloadSource(x);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const f in this.sourceCaches){const m=this.sourceCaches[f];c[f]=m.used,m.used=!1}for(const f of this._order){const m=this._layers[f];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const f in c){const m=this.sourceCaches[f];!!c[f]!=!!m.used&&m.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var c;this._checkLoaded();const f=this.serialize();if(e=r.transformStyle?r.transformStyle(f,e):e,((c=r.validate)===null||c===void 0||c)&&mu(this,l.z(e)))return!1;(e=l.bL(e)).layers=l.bI(e.layers);const m=l.bM(f,e),x=this._getOperationsToPerform(m);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const T of x.operations)T();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],c=[];for(const f of e)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push((()=>this.addLayer.apply(this,f.args)));break;case"removeLayer":r.push((()=>this.removeLayer.apply(this,f.args)));break;case"setPaintProperty":r.push((()=>this.setPaintProperty.apply(this,f.args)));break;case"setLayoutProperty":r.push((()=>this.setLayoutProperty.apply(this,f.args)));break;case"setFilter":r.push((()=>this.setFilter.apply(this,f.args)));break;case"addSource":r.push((()=>this.addSource.apply(this,f.args)));break;case"removeSource":r.push((()=>this.removeSource.apply(this,f.args)));break;case"setLayerZoomRange":r.push((()=>this.setLayerZoomRange.apply(this,f.args)));break;case"setLight":r.push((()=>this.setLight.apply(this,f.args)));break;case"setGeoJSONSourceData":r.push((()=>this.setGeoJSONSourceData.apply(this,f.args)));break;case"setGlyphs":r.push((()=>this.setGlyphs.apply(this,f.args)));break;case"setSprite":r.push((()=>this.setSprite.apply(this,f.args)));break;case"setTerrain":r.push((()=>this.map.setTerrain.apply(this,f.args)));break;case"setSky":r.push((()=>this.setSky.apply(this,f.args)));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":r.push((()=>this.setGlobalState.apply(this,f.args)));break;case"setTransition":r.push((()=>{}));break;default:c.push(f.command)}return{operations:r,unimplemented:c}}addImage(e,r){if(this.getImage(e))return this.fire(new l.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new l.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(l.z.source,`sources.${e}`,r,null,c))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const f=this.sourceCaches[e]=new Tt(e,r,this.dispatcher);f.style=this,f.setEventedParent(this,(()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:e}))),f.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new l.k(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,c={}){this._checkLoaded();const f=e.id;if(this.getLayer(f))return void this.fire(new l.k(new Error(`Layer "${f}" already exists on this map.`)));let m;if(e.type==="custom"){if(mu(this,l.bN(e)))return;m=l.bJ(e,this._globalState)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(f,e.source),e=l.bL(e),e=l.e(e,{source:f})),this._validate(l.z.layer,`layers.${f}`,e,{arrayIndex:-1},c))return;m=l.bJ(e,this._globalState),this._validateLayer(m),m.setEventedParent(this,{layer:{id:f}})}const x=r?this._order.indexOf(r):this._order.length;if(r&&x===-1)this.fire(new l.k(new Error(`Cannot add layer "${f}" before non-existing layer "${r}".`)));else{if(this._order.splice(x,0,f),this._layerOrderChanged=!0,this._layers[f]=m,this._removedLayers[f]&&m.source&&m.type!=="custom"){const T=this._removedLayers[f];delete this._removedLayers[f],T.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new l.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const c=this._order.indexOf(e);this._order.splice(c,1);const f=r?this._order.indexOf(r):this._order.length;r&&f===-1?this.fire(new l.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(f,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,c){this._checkLoaded();const f=this.getLayer(e);f?f.minzoom===r&&f.maxzoom===c||(r!=null&&(f.minzoom=r),c!=null&&(f.maxzoom=c),this._updateLayer(f)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,c={}){this._checkLoaded();const f=this.getLayer(e);if(f){if(!l.bH(f.filter,r))return r==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(l.z.filter,`layers.${f.id}.filter`,r,null,c)||(f.setFilter(l.bL(r)),this._updateLayer(f)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return l.bL(this.getLayer(e).filter)}setLayoutProperty(e,r,c,f={}){this._checkLoaded();const m=this.getLayer(e);m?l.bH(m.getLayoutProperty(r),c)||(m.setLayoutProperty(r,c,f),this._updateLayer(m)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const c=this.getLayer(e);if(c)return c.getLayoutProperty(r);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,c,f={}){this._checkLoaded();const m=this.getLayer(e);m?l.bH(m.getPaintProperty(r),c)||this._updatePaintProperty(m,r,c,f):this.fire(new l.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,r,c,f={}){e.setPaintProperty(r,c,f)&&this._updateLayer(e),l.bK(e)&&r==="raster-fade-duration"&&this.sourceCaches[e.source].setRasterFadeDuration(c),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const c=e.source,f=e.sourceLayer,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new l.k(new Error(`The source '${c}' does not exist in the map's style.`)));const x=m.getSource().type;x==="geojson"&&f?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||f?(e.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),m.setFeatureState(f,e.id,r)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const c=e.source,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new l.k(new Error(`The source '${c}' does not exist in the map's style.`)));const m=f.getSource().type,x=m==="vector"?e.sourceLayer:void 0;m!=="vector"||x?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(x,e.id,r):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,c=e.sourceLayer,f=this.sourceCaches[r];if(f!==void 0)return f.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(c,e.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=l.bO(this.sourceCaches,(m=>m.serialize())),r=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,f=this.stylesheet;return l.bP({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:e,layers:r,terrain:c},(m=>m!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=x=>this._layers[x].type==="fill-extrusion",c={},f=[];for(let x=this._order.length-1;x>=0;x--){const T=this._order[x];if(r(T)){c[T]=x;for(const C of e){const k=C[T];if(k)for(const L of k)f.push(L)}}}f.sort(((x,T)=>T.intersectionZ-x.intersectionZ));const m=[];for(let x=this._order.length-1;x>=0;x--){const T=this._order[x];if(r(T))for(let C=f.length-1;C>=0;C--){const k=f[C].feature;if(c[k.layer.id]<x)break;m.push(k),f.pop()}else for(const C of e){const k=C[T];if(k)for(const L of k)m.push(L.feature)}}return m}queryRenderedFeatures(e,r,c){r&&r.filter&&this._validate(l.z.filter,"queryRenderedFeatures.filter",r.filter,null,r);const f={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of r.layers){const L=this._layers[k];if(!L)return this.fire(new l.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];f[L.source]=!0}}const m=[];r.availableImages=this._availableImages;const x=this._serializedAllLayers(),T=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,C=Object.assign(Object.assign({},r),{layers:T,globalState:this._globalState});for(const k in this.sourceCaches)r.layers&&!f[k]||m.push(Pi(this.sourceCaches[k],this._layers,x,e,C,c,this.map.terrain?(L,j,N)=>this.map.terrain.getElevation(L,j,N):void 0));return this.placement&&m.push((function(k,L,j,N,q,X,ae){const ne={},re=X.queryRenderedSymbols(N),le=[];for(const ue of Object.keys(re).map(Number))le.push(ae[ue]);le.sort(Qr);for(const ue of le){const ce=ue.featureIndex.lookupSymbolFeatures(re[ue.bucketInstanceId],L,ue.bucketIndex,ue.sourceLayerIndex,{filterSpec:q.filter,globalState:q.globalState},q.layers,q.availableImages,k);for(const me in ce){const ye=ne[me]=ne[me]||[],he=ce[me];he.sort(((Se,Oe)=>{const Re=ue.featureSortOrder;if(Re){const ke=Re.indexOf(Se.featureIndex);return Re.indexOf(Oe.featureIndex)-ke}return Oe.featureIndex-Se.featureIndex}));for(const Se of he)ye.push(Se)}}return(function(ue,ce,me){for(const ye in ue)for(const he of ue[ye])bs(he,me[ce[ye].source]);return ue})(ne,k,j)})(this._layers,x,this.sourceCaches,e,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,r){r?.filter&&this._validate(l.z.filter,"querySourceFeatures.filter",r.filter,null,r);const c=this.sourceCaches[e];return c?(function(f,m){const x=f.getRenderableIds().map((k=>f.getTileByID(k))),T=[],C={};for(let k=0;k<x.length;k++){const L=x[k],j=L.tileID.canonical.key;C[j]||(C[j]=!0,L.querySourceFeatures(T,m))}return T})(c,r?Object.assign(Object.assign({},r),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const x in e)if(!l.bH(e[x],c[x])){f=!0;break}if(!f)return;const m={now:W.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(m)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const c=this.getSky();let f=!1;if(!e&&!c)return;if(e&&!c)f=!0;else if(!e&&c)f=!0;else for(const x in e)if(!l.bH(e[x],c[x])){f=!0;break}if(!f)return;const m={now:W.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(m)}_setProjectionInternal(e){const r=(function(c){if(Array.isArray(c)){const f=new Zo({type:c});return{projection:f,transform:new Cs,cameraHelper:new lh(f)}}switch(c){case"mercator":return{projection:new Hn,transform:new ns,cameraHelper:new mr};case"globe":{const f=new Zo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new Cs,cameraHelper:new lh(f)}}case"vertical-perspective":return{projection:new Vo,transform:new yc,cameraHelper:new Dr};default:return l.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new Hn,transform:new ns,cameraHelper:new mr}}})(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(e,r,c,f,m={}){return(!m||m.validate!==!1)&&mu(this,e.call(l.z,l.e({key:r,style:this.serialize(),value:c,styleSpec:l.v},f)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ws().off(Na,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const c=this.sourceCaches[r];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,c,f,m=!1){let x=!1,T=!1;const C={};for(const k of this._order){const L=this._layers[k];if(L.type!=="symbol")continue;if(!C[L.source]){const N=this.sourceCaches[L.source];C[L.source]=N.getRenderableIds(!0).map((q=>N.getTileByID(q))).sort(((q,X)=>X.tileID.overscaledZ-q.tileID.overscaledZ||(q.tileID.isLessThan(X.tileID)?-1:1)))}const j=this.crossTileSymbolIndex.addLayer(L,C[L.source],e.center.lng);x=x||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(W.now(),e.zoom))&&(this.pauseablePlacement=new sh(e,this.map.terrain,this._order,m,r,c,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(W.now()),T=!0),x&&this.pauseablePlacement.placement.setStale()),T||x)for(const k of this._order){const L=this._layers[k];L.type==="symbol"&&this.placement.updateLayerOpacities(L,C[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(W.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return l._(this,void 0,void 0,(function*(){const c=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[r.source];return f&&f.setDependencies(r.tileID.key,r.type,r.icons),c}))}getGlyphs(e,r){return l._(this,void 0,void 0,(function*(){const c=yield this.glyphManager.getGlyphs(r.stacks),f=this.sourceCaches[r.source];return f&&f.setDependencies(r.tileID.key,r.type,[""]),c}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(l.z.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}getDashes(e,r){return l._(this,void 0,void 0,(function*(){const c={};for(const[f,m]of Object.entries(r.dashes))c[f]=this.lineAtlas.getDash(m.dasharray,m.round);return c}))}addSprite(e,r,c={},f){this._checkLoaded();const m=[{id:e,url:r}],x=[...Pt(this.stylesheet.sprite),...m];this._validate(l.z.sprite,"sprite",x,null,c)||(this.stylesheet.sprite=x,this._loadSprite(m,!0,f))}removeSprite(e){this._checkLoaded();const r=Pt(this.stylesheet.sprite);if(r.find((c=>c.id===e))){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;r.splice(r.findIndex((c=>c.id===e)),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Pt(this.stylesheet.sprite)}setSprite(e,r={},c){this._checkLoaded(),e&&this._validate(l.z.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var xf=l.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class gu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,c,f,m,x,T,C,k){this.context=e;let L=this.boundPaintVertexBuffers.length!==f.length;for(let j=0;!L&&j<f.length;j++)this.boundPaintVertexBuffers[j]!==f[j]&&(L=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==c||L||this.boundIndexBuffer!==m||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==k?this.freshBind(r,c,f,m,x,T,C,k):(e.bindVertexArray.set(this.vao),T&&T.bind(),m&&m.dynamicDraw&&m.bind(),C&&C.bind(),k&&k.bind())}freshBind(e,r,c,f,m,x,T,C){const k=e.numAttributes,L=this.context,j=L.gl;this.vao&&this.destroy(),this.vao=L.createVertexArray(),L.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=f,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=C,r.enableAttributes(j,e);for(const N of c)N.enableAttributes(j,e);x&&x.enableAttributes(j,e),T&&T.enableAttributes(j,e),C&&C.enableAttributes(j,e),r.bind(),r.setVertexAttribPointers(j,e,m);for(const N of c)N.bind(),N.setVertexAttribPointers(j,e,m);x&&(x.bind(),x.setVertexAttribPointers(j,e,m)),f&&f.bind(),T&&(T.bind(),T.setVertexAttribPointers(j,e,m)),C&&(C.bind(),C.setVertexAttribPointers(j,e,m)),L.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const uh=(p,e,r,c,f)=>({u_texture:0,u_ele_delta:p,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):l.bf.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:r?r.calculateFogBlendOpacity(c):0,u_horizon_color:r?r.properties.get("horizon-color"):l.bf.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),_u={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Rl(p){const e=[];for(let r=0;r<p.length;r++){if(p[r]===null)continue;const c=p[r].split(" ");e.push(c.pop())}return e}class hh{constructor(e,r,c,f,m,x,T,C,k=[]){const L=e.gl;this.program=L.createProgram();const j=Rl(r.staticAttributes),N=c?c.getBinderAttributes():[],q=j.concat(N),X=pn.prelude.staticUniforms?Rl(pn.prelude.staticUniforms):[],ae=T.staticUniforms?Rl(T.staticUniforms):[],ne=r.staticUniforms?Rl(r.staticUniforms):[],re=c?c.getBinderUniforms():[],le=X.concat(ae).concat(ne).concat(re),ue=[];for(const Re of le)ue.indexOf(Re)<0&&ue.push(Re);const ce=c?c.defines():[];ya(L)&&ce.unshift("#version 300 es"),m&&ce.push("#define OVERDRAW_INSPECTOR;"),x&&ce.push("#define TERRAIN3D;"),C&&ce.push(C),k&&ce.push(...k);let me=ce.concat(pn.prelude.fragmentSource,T.fragmentSource,r.fragmentSource).join(`
`),ye=ce.concat(pn.prelude.vertexSource,T.vertexSource,r.vertexSource).join(`
`);ya(L)||(me=(function(Re){return Re.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(me),ye=(function(Re){return Re.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(ye));const he=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);if(L.shaderSource(he,me),L.compileShader(he),!L.getShaderParameter(he,L.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${L.getShaderInfoLog(he)}`);L.attachShader(this.program,he);const Se=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);if(L.shaderSource(Se,ye),L.compileShader(Se),!L.getShaderParameter(Se,L.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${L.getShaderInfoLog(Se)}`);L.attachShader(this.program,Se),this.attributes={};const Oe={};this.numAttributes=q.length;for(let Re=0;Re<this.numAttributes;Re++)q[Re]&&(L.bindAttribLocation(this.program,Re,q[Re]),this.attributes[q[Re]]=Re);if(L.linkProgram(this.program),!L.getProgramParameter(this.program,L.LINK_STATUS))throw new Error(`Program failed to link: ${L.getProgramInfoLog(this.program)}`);L.deleteShader(Se),L.deleteShader(he);for(let Re=0;Re<ue.length;Re++){const ke=ue[Re];if(ke&&!Oe[ke]){const Le=L.getUniformLocation(this.program,ke);Le&&(Oe[ke]=Le)}}this.fixedUniforms=f(e,Oe),this.terrainUniforms=((Re,ke)=>({u_depth:new l.bQ(Re,ke.u_depth),u_terrain:new l.bQ(Re,ke.u_terrain),u_terrain_dim:new l.bg(Re,ke.u_terrain_dim),u_terrain_matrix:new l.bS(Re,ke.u_terrain_matrix),u_terrain_unpack:new l.bT(Re,ke.u_terrain_unpack),u_terrain_exaggeration:new l.bg(Re,ke.u_terrain_exaggeration)}))(e,Oe),this.projectionUniforms=((Re,ke)=>({u_projection_matrix:new l.bS(Re,ke.u_projection_matrix),u_projection_tile_mercator_coords:new l.bT(Re,ke.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.bT(Re,ke.u_projection_clipping_plane),u_projection_transition:new l.bg(Re,ke.u_projection_transition),u_projection_fallback_matrix:new l.bS(Re,ke.u_projection_fallback_matrix)}))(e,Oe),this.binderUniforms=c?c.getUniforms(e,Oe):[]}draw(e,r,c,f,m,x,T,C,k,L,j,N,q,X,ae,ne,re,le,ue){const ce=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(f),e.setColorMode(m),e.setCullFace(x),C){e.activeTexture.set(ce.TEXTURE2),ce.bindTexture(ce.TEXTURE_2D,C.depthTexture),e.activeTexture.set(ce.TEXTURE3),ce.bindTexture(ce.TEXTURE_2D,C.texture);for(const ye in this.terrainUniforms)this.terrainUniforms[ye].set(C[ye])}if(k)for(const ye in k)this.projectionUniforms[_u[ye]].set(k[ye]);if(T)for(const ye in this.fixedUniforms)this.fixedUniforms[ye].set(T[ye]);ne&&ne.setUniforms(e,this.binderUniforms,X,{zoom:ae});let me=0;switch(r){case ce.LINES:me=2;break;case ce.TRIANGLES:me=3;break;case ce.LINE_STRIP:me=1}for(const ye of q.get()){const he=ye.vaos||(ye.vaos={});(he[L]||(he[L]=new gu)).bind(e,this,j,ne?ne.getPaintVertexBuffers():[],N,ye.vertexOffset,re,le,ue),ce.drawElements(r,ye.primitiveLength*me,ce.UNSIGNED_SHORT,ye.primitiveOffset*me*2)}}}function Xn(p,e,r){const c=1/l.aC(r,1,e.transform.tileZoom),f=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,e.transform.tileZoom)/f,x=m*(r.tileID.canonical.x+r.tileID.wrap*f),T=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[c,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[x>>16,T>>16],u_pixel_coord_lower:[65535&x,65535&T]}}const Dl=(p,e,r,c)=>{const f=p.style.light,m=f.properties.get("position"),x=[m.x,m.y,m.z],T=l.bW();f.properties.get("anchor")==="viewport"&&l.bX(T,p.transform.bearingInRadians),l.bY(x,x,T);const C=p.transform.transformLightDirection(x),k=f.properties.get("color");return{u_lightpos:x,u_lightpos_globe:C,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:c}},dh=(p,e,r,c,f,m,x)=>l.e(Dl(p,e,r,c),Xn(m,p,x),{u_height_factor:-Math.pow(2,f.overscaledZ)/x.tileSize/8}),Xo=(p,e,r,c)=>l.e(Xn(e,p,r),{u_fill_translate:c}),kl=(p,e)=>({u_world:p,u_fill_translate:e}),pd=(p,e,r,c,f)=>l.e(Xo(p,e,r,f),{u_world:c}),vc=(p,e,r,c,f)=>{const m=p.transform;let x,T,C=0;if(r.paint.get("circle-pitch-alignment")==="map"){const k=l.aC(e,1,m.zoom);x=!0,T=[k,k],C=k/(l.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*f}else x=!1,T=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+x,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:T,u_globe_extrude_scale:C,u_translate:c}},md=p=>({u_pixel_extrude_scale:[1/p.width,1/p.height]}),kr=p=>({u_viewport_size:[p.width,p.height]}),gd=(p,e=1)=>({u_color:p,u_overlay:0,u_overlay_scale:e}),fh=(p,e,r,c)=>{const f=l.aC(p,1,e)/(l.$*Math.pow(2,p.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:l.aC(p,1,e),u_intensity:r,u_globe_extrude_scale:f}},_d=(p,e,r,c)=>{const f=l.L();l.bZ(f,0,p.width,p.height,0,0,1);const m=p.context.gl;return{u_matrix:f,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:r,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}},ph=(p,e,r)=>{const c=r.paint.get("hillshade-accent-color");let f;switch(r.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const m=r.getIlluminationProperties();for(let x=0;x<m.directionRadians.length;x++)r.paint.get("hillshade-illumination-anchor")==="viewport"&&(m.directionRadians[x]+=p.transform.bearingInRadians);return{u_image:0,u_latrange:Ll(0,e.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:m.altitudeRadians,u_azimuths:m.directionRadians,u_accent:c,u_method:f,u_highlights:m.highlightColor,u_shadows:m.shadowColor}},yu=(p,e)=>{const r=e.stride,c=l.L();return l.bZ(c,0,l.$,-l.$,0,0,1),l.M(c,c,[0,-l.$,0]),{u_matrix:c,u_image:1,u_dimension:[r,r],u_zoom:p.overscaledZ,u_unpack:e.getUnpackVector()}};function Ll(p,e){const r=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new l.a1(0,c/r).toLngLat().lat,new l.a1(0,(c+1)/r).toLngLat().lat]}const Ol=(p,e,r=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:r,u_opacity:p.paint.get("color-relief-opacity")}),xc=(p,e,r,c)=>{const f=p.transform;return{u_translation:gh(p,e,r),u_ratio:c/l.aC(e,1,f.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},bc=(p,e,r,c,f)=>l.e(xc(p,e,r,c),{u_image:0,u_image_height:f}),lo=(p,e,r,c,f)=>{const m=p.transform,x=Ps(e,m);return{u_translation:gh(p,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:c/l.aC(e,1,m.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[x,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},mh=(p,e,r,c,f)=>{const m=Ps(e,p.transform);return l.e(xc(p,e,r,c),{u_tileratio:m,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image:0,u_mix:f.t,u_lineatlas_width:p.lineAtlas.width,u_lineatlas_height:p.lineAtlas.height})},vu=(p,e,r,c,f,m)=>{const x=Ps(e,p.transform);return l.e(xc(p,e,r,c),{u_image:0,u_image_height:m,u_tileratio:x,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image_dash:1,u_mix:f.t,u_lineatlas_width:p.lineAtlas.width,u_lineatlas_height:p.lineAtlas.height})};function Ps(p,e){return 1/l.aC(p,1,e.tileZoom)}function gh(p,e,r){return l.aD(p.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const wc=(p,e,r,c,f)=>{return{u_tl_parent:p,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(x=c.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(m=c.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:yd(c.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var m,x};function yd(p){p*=Math.PI/180;const e=Math.sin(p),r=Math.cos(p);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const vd=(p,e,r,c,f,m,x,T,C,k,L,j,N)=>{const q=x.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:q.width/q.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_label_plane_matrix:T,u_coord_matrix:C,u_is_text:+L,u_pitch_with_map:+c,u_is_along_line:f,u_is_variable_anchor:m,u_texsize:j,u_texture:0,u_translation:k,u_pitched_scale:N}},_h=(p,e,r,c,f,m,x,T,C,k,L,j,N,q)=>{const X=x.transform;return l.e(vd(p,e,r,c,f,m,x,T,C,k,L,j,q),{u_gamma_scale:c?Math.cos(X.pitch*Math.PI/180)*X.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},xd=(p,e,r,c,f,m,x,T,C,k,L,j,N)=>l.e(_h(p,e,r,c,f,m,x,T,C,k,!0,L,0,N),{u_texsize_icon:j,u_texture_icon:1}),bd=(p,e)=>({u_opacity:p,u_color:e}),yh=(p,e,r,c,f)=>l.e((function(m,x,T,C){const k=T.imageManager.getPattern(m.from.toString()),L=T.imageManager.getPattern(m.to.toString()),{width:j,height:N}=T.imageManager.getPixelSize(),q=Math.pow(2,C.tileID.overscaledZ),X=C.tileSize*Math.pow(2,T.transform.tileZoom)/q,ae=X*(C.tileID.canonical.x+C.tileID.wrap*q),ne=X*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[j,N],u_mix:x.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/l.aC(C,1,T.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ne>>16],u_pixel_coord_lower:[65535&ae,65535&ne]}})(r,f,e,c),{u_opacity:p}),En=(p,e)=>{},co={fillExtrusion:(p,e)=>({u_lightpos:new l.bU(p,e.u_lightpos),u_lightpos_globe:new l.bU(p,e.u_lightpos_globe),u_lightintensity:new l.bg(p,e.u_lightintensity),u_lightcolor:new l.bU(p,e.u_lightcolor),u_vertical_gradient:new l.bg(p,e.u_vertical_gradient),u_opacity:new l.bg(p,e.u_opacity),u_fill_translate:new l.bV(p,e.u_fill_translate)}),fillExtrusionPattern:(p,e)=>({u_lightpos:new l.bU(p,e.u_lightpos),u_lightpos_globe:new l.bU(p,e.u_lightpos_globe),u_lightintensity:new l.bg(p,e.u_lightintensity),u_lightcolor:new l.bU(p,e.u_lightcolor),u_vertical_gradient:new l.bg(p,e.u_vertical_gradient),u_height_factor:new l.bg(p,e.u_height_factor),u_opacity:new l.bg(p,e.u_opacity),u_fill_translate:new l.bV(p,e.u_fill_translate),u_image:new l.bQ(p,e.u_image),u_texsize:new l.bV(p,e.u_texsize),u_pixel_coord_upper:new l.bV(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(p,e.u_pixel_coord_lower),u_scale:new l.bU(p,e.u_scale),u_fade:new l.bg(p,e.u_fade)}),fill:(p,e)=>({u_fill_translate:new l.bV(p,e.u_fill_translate)}),fillPattern:(p,e)=>({u_image:new l.bQ(p,e.u_image),u_texsize:new l.bV(p,e.u_texsize),u_pixel_coord_upper:new l.bV(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(p,e.u_pixel_coord_lower),u_scale:new l.bU(p,e.u_scale),u_fade:new l.bg(p,e.u_fade),u_fill_translate:new l.bV(p,e.u_fill_translate)}),fillOutline:(p,e)=>({u_world:new l.bV(p,e.u_world),u_fill_translate:new l.bV(p,e.u_fill_translate)}),fillOutlinePattern:(p,e)=>({u_world:new l.bV(p,e.u_world),u_image:new l.bQ(p,e.u_image),u_texsize:new l.bV(p,e.u_texsize),u_pixel_coord_upper:new l.bV(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(p,e.u_pixel_coord_lower),u_scale:new l.bU(p,e.u_scale),u_fade:new l.bg(p,e.u_fade),u_fill_translate:new l.bV(p,e.u_fill_translate)}),circle:(p,e)=>({u_camera_to_center_distance:new l.bg(p,e.u_camera_to_center_distance),u_scale_with_map:new l.bQ(p,e.u_scale_with_map),u_pitch_with_map:new l.bQ(p,e.u_pitch_with_map),u_extrude_scale:new l.bV(p,e.u_extrude_scale),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_globe_extrude_scale:new l.bg(p,e.u_globe_extrude_scale),u_translate:new l.bV(p,e.u_translate)}),collisionBox:(p,e)=>({u_pixel_extrude_scale:new l.bV(p,e.u_pixel_extrude_scale)}),collisionCircle:(p,e)=>({u_viewport_size:new l.bV(p,e.u_viewport_size)}),debug:(p,e)=>({u_color:new l.bR(p,e.u_color),u_overlay:new l.bQ(p,e.u_overlay),u_overlay_scale:new l.bg(p,e.u_overlay_scale)}),depth:En,clippingMask:En,heatmap:(p,e)=>({u_extrude_scale:new l.bg(p,e.u_extrude_scale),u_intensity:new l.bg(p,e.u_intensity),u_globe_extrude_scale:new l.bg(p,e.u_globe_extrude_scale)}),heatmapTexture:(p,e)=>({u_matrix:new l.bS(p,e.u_matrix),u_world:new l.bV(p,e.u_world),u_image:new l.bQ(p,e.u_image),u_color_ramp:new l.bQ(p,e.u_color_ramp),u_opacity:new l.bg(p,e.u_opacity)}),hillshade:(p,e)=>({u_image:new l.bQ(p,e.u_image),u_latrange:new l.bV(p,e.u_latrange),u_exaggeration:new l.bg(p,e.u_exaggeration),u_altitudes:new l.b$(p,e.u_altitudes),u_azimuths:new l.b$(p,e.u_azimuths),u_accent:new l.bR(p,e.u_accent),u_method:new l.bQ(p,e.u_method),u_shadows:new l.b_(p,e.u_shadows),u_highlights:new l.b_(p,e.u_highlights)}),hillshadePrepare:(p,e)=>({u_matrix:new l.bS(p,e.u_matrix),u_image:new l.bQ(p,e.u_image),u_dimension:new l.bV(p,e.u_dimension),u_zoom:new l.bg(p,e.u_zoom),u_unpack:new l.bT(p,e.u_unpack)}),colorRelief:(p,e)=>({u_image:new l.bQ(p,e.u_image),u_unpack:new l.bT(p,e.u_unpack),u_dimension:new l.bV(p,e.u_dimension),u_elevation_stops:new l.bQ(p,e.u_elevation_stops),u_color_stops:new l.bQ(p,e.u_color_stops),u_color_ramp_size:new l.bQ(p,e.u_color_ramp_size),u_opacity:new l.bg(p,e.u_opacity)}),line:(p,e)=>({u_translation:new l.bV(p,e.u_translation),u_ratio:new l.bg(p,e.u_ratio),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_units_to_pixels:new l.bV(p,e.u_units_to_pixels)}),lineGradient:(p,e)=>({u_translation:new l.bV(p,e.u_translation),u_ratio:new l.bg(p,e.u_ratio),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_units_to_pixels:new l.bV(p,e.u_units_to_pixels),u_image:new l.bQ(p,e.u_image),u_image_height:new l.bg(p,e.u_image_height)}),linePattern:(p,e)=>({u_translation:new l.bV(p,e.u_translation),u_texsize:new l.bV(p,e.u_texsize),u_ratio:new l.bg(p,e.u_ratio),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_image:new l.bQ(p,e.u_image),u_units_to_pixels:new l.bV(p,e.u_units_to_pixels),u_scale:new l.bU(p,e.u_scale),u_fade:new l.bg(p,e.u_fade)}),lineSDF:(p,e)=>({u_translation:new l.bV(p,e.u_translation),u_ratio:new l.bg(p,e.u_ratio),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_units_to_pixels:new l.bV(p,e.u_units_to_pixels),u_image:new l.bQ(p,e.u_image),u_mix:new l.bg(p,e.u_mix),u_tileratio:new l.bg(p,e.u_tileratio),u_crossfade_from:new l.bg(p,e.u_crossfade_from),u_crossfade_to:new l.bg(p,e.u_crossfade_to),u_lineatlas_width:new l.bg(p,e.u_lineatlas_width),u_lineatlas_height:new l.bg(p,e.u_lineatlas_height)}),lineGradientSDF:(p,e)=>({u_translation:new l.bV(p,e.u_translation),u_ratio:new l.bg(p,e.u_ratio),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_units_to_pixels:new l.bV(p,e.u_units_to_pixels),u_image:new l.bQ(p,e.u_image),u_image_height:new l.bg(p,e.u_image_height),u_tileratio:new l.bg(p,e.u_tileratio),u_crossfade_from:new l.bg(p,e.u_crossfade_from),u_crossfade_to:new l.bg(p,e.u_crossfade_to),u_image_dash:new l.bQ(p,e.u_image_dash),u_mix:new l.bg(p,e.u_mix),u_lineatlas_width:new l.bg(p,e.u_lineatlas_width),u_lineatlas_height:new l.bg(p,e.u_lineatlas_height)}),raster:(p,e)=>({u_tl_parent:new l.bV(p,e.u_tl_parent),u_scale_parent:new l.bg(p,e.u_scale_parent),u_buffer_scale:new l.bg(p,e.u_buffer_scale),u_fade_t:new l.bg(p,e.u_fade_t),u_opacity:new l.bg(p,e.u_opacity),u_image0:new l.bQ(p,e.u_image0),u_image1:new l.bQ(p,e.u_image1),u_brightness_low:new l.bg(p,e.u_brightness_low),u_brightness_high:new l.bg(p,e.u_brightness_high),u_saturation_factor:new l.bg(p,e.u_saturation_factor),u_contrast_factor:new l.bg(p,e.u_contrast_factor),u_spin_weights:new l.bU(p,e.u_spin_weights),u_coords_top:new l.bT(p,e.u_coords_top),u_coords_bottom:new l.bT(p,e.u_coords_bottom)}),symbolIcon:(p,e)=>({u_is_size_zoom_constant:new l.bQ(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bQ(p,e.u_is_size_feature_constant),u_size_t:new l.bg(p,e.u_size_t),u_size:new l.bg(p,e.u_size),u_camera_to_center_distance:new l.bg(p,e.u_camera_to_center_distance),u_pitch:new l.bg(p,e.u_pitch),u_rotate_symbol:new l.bQ(p,e.u_rotate_symbol),u_aspect_ratio:new l.bg(p,e.u_aspect_ratio),u_fade_change:new l.bg(p,e.u_fade_change),u_label_plane_matrix:new l.bS(p,e.u_label_plane_matrix),u_coord_matrix:new l.bS(p,e.u_coord_matrix),u_is_text:new l.bQ(p,e.u_is_text),u_pitch_with_map:new l.bQ(p,e.u_pitch_with_map),u_is_along_line:new l.bQ(p,e.u_is_along_line),u_is_variable_anchor:new l.bQ(p,e.u_is_variable_anchor),u_texsize:new l.bV(p,e.u_texsize),u_texture:new l.bQ(p,e.u_texture),u_translation:new l.bV(p,e.u_translation),u_pitched_scale:new l.bg(p,e.u_pitched_scale)}),symbolSDF:(p,e)=>({u_is_size_zoom_constant:new l.bQ(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bQ(p,e.u_is_size_feature_constant),u_size_t:new l.bg(p,e.u_size_t),u_size:new l.bg(p,e.u_size),u_camera_to_center_distance:new l.bg(p,e.u_camera_to_center_distance),u_pitch:new l.bg(p,e.u_pitch),u_rotate_symbol:new l.bQ(p,e.u_rotate_symbol),u_aspect_ratio:new l.bg(p,e.u_aspect_ratio),u_fade_change:new l.bg(p,e.u_fade_change),u_label_plane_matrix:new l.bS(p,e.u_label_plane_matrix),u_coord_matrix:new l.bS(p,e.u_coord_matrix),u_is_text:new l.bQ(p,e.u_is_text),u_pitch_with_map:new l.bQ(p,e.u_pitch_with_map),u_is_along_line:new l.bQ(p,e.u_is_along_line),u_is_variable_anchor:new l.bQ(p,e.u_is_variable_anchor),u_texsize:new l.bV(p,e.u_texsize),u_texture:new l.bQ(p,e.u_texture),u_gamma_scale:new l.bg(p,e.u_gamma_scale),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_is_halo:new l.bQ(p,e.u_is_halo),u_translation:new l.bV(p,e.u_translation),u_pitched_scale:new l.bg(p,e.u_pitched_scale)}),symbolTextAndIcon:(p,e)=>({u_is_size_zoom_constant:new l.bQ(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bQ(p,e.u_is_size_feature_constant),u_size_t:new l.bg(p,e.u_size_t),u_size:new l.bg(p,e.u_size),u_camera_to_center_distance:new l.bg(p,e.u_camera_to_center_distance),u_pitch:new l.bg(p,e.u_pitch),u_rotate_symbol:new l.bQ(p,e.u_rotate_symbol),u_aspect_ratio:new l.bg(p,e.u_aspect_ratio),u_fade_change:new l.bg(p,e.u_fade_change),u_label_plane_matrix:new l.bS(p,e.u_label_plane_matrix),u_coord_matrix:new l.bS(p,e.u_coord_matrix),u_is_text:new l.bQ(p,e.u_is_text),u_pitch_with_map:new l.bQ(p,e.u_pitch_with_map),u_is_along_line:new l.bQ(p,e.u_is_along_line),u_is_variable_anchor:new l.bQ(p,e.u_is_variable_anchor),u_texsize:new l.bV(p,e.u_texsize),u_texsize_icon:new l.bV(p,e.u_texsize_icon),u_texture:new l.bQ(p,e.u_texture),u_texture_icon:new l.bQ(p,e.u_texture_icon),u_gamma_scale:new l.bg(p,e.u_gamma_scale),u_device_pixel_ratio:new l.bg(p,e.u_device_pixel_ratio),u_is_halo:new l.bQ(p,e.u_is_halo),u_translation:new l.bV(p,e.u_translation),u_pitched_scale:new l.bg(p,e.u_pitched_scale)}),background:(p,e)=>({u_opacity:new l.bg(p,e.u_opacity),u_color:new l.bR(p,e.u_color)}),backgroundPattern:(p,e)=>({u_opacity:new l.bg(p,e.u_opacity),u_image:new l.bQ(p,e.u_image),u_pattern_tl_a:new l.bV(p,e.u_pattern_tl_a),u_pattern_br_a:new l.bV(p,e.u_pattern_br_a),u_pattern_tl_b:new l.bV(p,e.u_pattern_tl_b),u_pattern_br_b:new l.bV(p,e.u_pattern_br_b),u_texsize:new l.bV(p,e.u_texsize),u_mix:new l.bg(p,e.u_mix),u_pattern_size_a:new l.bV(p,e.u_pattern_size_a),u_pattern_size_b:new l.bV(p,e.u_pattern_size_b),u_scale_a:new l.bg(p,e.u_scale_a),u_scale_b:new l.bg(p,e.u_scale_b),u_pixel_coord_upper:new l.bV(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(p,e.u_pixel_coord_lower),u_tile_units_to_pixels:new l.bg(p,e.u_tile_units_to_pixels)}),terrain:(p,e)=>({u_texture:new l.bQ(p,e.u_texture),u_ele_delta:new l.bg(p,e.u_ele_delta),u_fog_matrix:new l.bS(p,e.u_fog_matrix),u_fog_color:new l.bR(p,e.u_fog_color),u_fog_ground_blend:new l.bg(p,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.bg(p,e.u_fog_ground_blend_opacity),u_horizon_color:new l.bR(p,e.u_horizon_color),u_horizon_fog_blend:new l.bg(p,e.u_horizon_fog_blend),u_is_globe_mode:new l.bg(p,e.u_is_globe_mode)}),terrainDepth:(p,e)=>({u_ele_delta:new l.bg(p,e.u_ele_delta)}),terrainCoords:(p,e)=>({u_texture:new l.bQ(p,e.u_texture),u_terrain_coords_id:new l.bg(p,e.u_terrain_coords_id),u_ele_delta:new l.bg(p,e.u_ele_delta)}),projectionErrorMeasurement:(p,e)=>({u_input:new l.bg(p,e.u_input),u_output_expected:new l.bg(p,e.u_output_expected)}),atmosphere:(p,e)=>({u_sun_pos:new l.bU(p,e.u_sun_pos),u_atmosphere_blend:new l.bg(p,e.u_atmosphere_blend),u_globe_position:new l.bU(p,e.u_globe_position),u_globe_radius:new l.bg(p,e.u_globe_radius),u_inv_proj_matrix:new l.bS(p,e.u_inv_proj_matrix)}),sky:(p,e)=>({u_sky_color:new l.bR(p,e.u_sky_color),u_horizon_color:new l.bR(p,e.u_horizon_color),u_horizon:new l.bV(p,e.u_horizon),u_horizon_normal:new l.bV(p,e.u_horizon_normal),u_sky_horizon_blend:new l.bg(p,e.u_sky_horizon_blend),u_sky_blend:new l.bg(p,e.u_sky_blend)})};class ss{constructor(e,r,c){this.context=e;const f=e.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const xu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class bu{constructor(e,r,c,f){this.length=r.length,this.attributes=c,this.itemSize=r.bytesPerElement,this.dynamicDraw=f,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let c=0;c<this.attributes.length;c++){const f=r.attributes[this.attributes[c].name];f!==void 0&&e.enableVertexAttribArray(f)}}setVertexAttribPointers(e,r,c){for(let f=0;f<this.attributes.length;f++){const m=this.attributes[f],x=r.attributes[m.name];x!==void 0&&e.vertexAttribPointer(x,m.components,e[xu[m.type]],!1,this.itemSize,m.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class yi{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class wu extends yi{getDefault(){return l.bf.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class vh extends yi{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class _r extends yi{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Sc extends yi{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Mc extends yi{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class xh extends yi{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class wd extends yi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Yo extends yi{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Wo extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class bh extends yi{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class wh extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class os extends yi{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Tc extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class Ec extends yi{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Su extends yi{getDefault(){return l.bf.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Qo extends yi{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Ac extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class Bl extends yi{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Yn extends yi{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Sh extends yi{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Mu extends yi{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Wn extends yi{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ls extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class An extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class zs extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ko extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Jo extends yi{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Cc extends yi{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const c=this.gl;ya(c)?c.bindVertexArray(e):(r=c.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class uo extends yi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class yr extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Mh extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ho extends yi{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class Kt extends ho{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Tu extends ho{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Qn extends ho{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Pc="Framebuffer is not complete";class Kn{constructor(e,r,c,f,m){this.context=e,this.width=r,this.height=c;const x=e.gl,T=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Kt(e,T),f)this.depthAttachment=m?new Qn(e,T):new Tu(e,T);else if(m)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error(Pc)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class Sd{constructor(e){var r,c;if(this.gl=e,this.clearColor=new wu(this),this.clearDepth=new vh(this),this.clearStencil=new _r(this),this.colorMask=new Sc(this),this.depthMask=new Mc(this),this.stencilMask=new xh(this),this.stencilFunc=new wd(this),this.stencilOp=new Yo(this),this.stencilTest=new Wo(this),this.depthRange=new bh(this),this.depthTest=new wh(this),this.depthFunc=new os(this),this.blend=new Tc(this),this.blendFunc=new Ec(this),this.blendColor=new Su(this),this.blendEquation=new Qo(this),this.cullFace=new Ac(this),this.cullFaceSide=new Bl(this),this.frontFace=new Yn(this),this.program=new Sh(this),this.activeTexture=new Mu(this),this.viewport=new Wn(this),this.bindFramebuffer=new ls(this),this.bindRenderbuffer=new An(this),this.bindTexture=new zs(this),this.bindVertexBuffer=new Ko(this),this.bindElementBuffer=new Jo(this),this.bindVertexArray=new Cc(this),this.pixelStoreUnpack=new uo(this),this.pixelStoreUnpackPremultiplyAlpha=new yr(this),this.pixelStoreUnpackFlipY=new Mh(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),ya(e)){this.HALF_FLOAT=e.HALF_FLOAT;const f=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:f?.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:f?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const f=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=f?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new ss(this,e,r)}createVertexBuffer(e,r,c){return new bu(this,e,r,c)}createRenderbuffer(e,r,c){const f=this.gl,m=f.createRenderbuffer();return this.bindRenderbuffer.set(m),f.renderbufferStorage(f.RENDERBUFFER,e,r,c),this.bindRenderbuffer.set(null),m}createFramebuffer(e,r,c,f){return new Kn(this,e,r,c,f)}clear({color:e,depth:r,stencil:c}){const f=this.gl;let m=0;e&&(m|=f.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(m|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),c!==void 0&&(m|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),f.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){l.bH(e.blendFunction,Ii.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return ya(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return ya(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let el;function Is(p,e,r,c,f){const m=p.context,x=p.transform,T=m.gl,C=p.useProgram("collisionBox"),k=[];let L=0,j=0;for(let re=0;re<c.length;re++){const le=c[re],ue=e.getTile(le).getBucket(r);if(!ue)continue;const ce=f?ue.textCollisionBox:ue.iconCollisionBox,me=ue.collisionCircleArray;me.length>0&&(k.push({circleArray:me,circleOffset:j,coord:le}),L+=me.length/4,j=L),ce&&C.draw(m,T.LINES,Bt.disabled,Qt.disabled,p.colorModeForRenderPass(),ai.disabled,md(p.transform),p.style.map.terrain&&p.style.map.terrain.getTerrainData(le),x.getProjectionData({overscaledTileID:le,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,null,p.transform.zoom,null,null,ce.collisionVertexBuffer)}if(!f||!k.length)return;const N=p.useProgram("collisionCircle"),q=new l.c0;q.resize(4*L),q._trim();let X=0;for(const re of k)for(let le=0;le<re.circleArray.length/4;le++){const ue=4*le,ce=re.circleArray[ue+0],me=re.circleArray[ue+1],ye=re.circleArray[ue+2],he=re.circleArray[ue+3];q.emplace(X++,ce,me,ye,he,0),q.emplace(X++,ce,me,ye,he,1),q.emplace(X++,ce,me,ye,he,2),q.emplace(X++,ce,me,ye,he,3)}(!el||el.length<2*L)&&(el=(function(re){const le=2*re,ue=new l.c2;ue.resize(le),ue._trim();for(let ce=0;ce<le;ce++){const me=6*ce;ue.uint16[me+0]=4*ce+0,ue.uint16[me+1]=4*ce+1,ue.uint16[me+2]=4*ce+2,ue.uint16[me+3]=4*ce+2,ue.uint16[me+4]=4*ce+3,ue.uint16[me+5]=4*ce+0}return ue})(L));const ae=m.createIndexBuffer(el,!0),ne=m.createVertexBuffer(q,l.c1.members,!0);for(const re of k){const le=kr(p.transform);N.draw(m,T.TRIANGLES,Bt.disabled,Qt.disabled,p.colorModeForRenderPass(),ai.disabled,le,p.style.map.terrain&&p.style.map.terrain.getTerrainData(re.coord),null,r.id,ne,ae,l.aM.simpleSegment(0,2*re.circleOffset,re.circleArray.length,re.circleArray.length/2),null,p.transform.zoom,null,null,null)}ne.destroy(),ae.destroy()}const Th=l.ag(new Float32Array(16));function Eu(p,e,r,c,f,m){const{horizontalAlign:x,verticalAlign:T}=l.aH(p);return new l.P((-(x-.5)*e/f+c[0])*m,(-(T-.5)*r/f+c[1])*m)}function Nl(p,e,r,c,f,m){const x=e.tileAnchorPoint.add(new l.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let T=c.mult(m);r||(T=T.rotate(-f));const C=x.add(T);return tt(C.x,C.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const T=Jr(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(p),C=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return p.add(c.rotate(C))}return p.add(c)}function zc(p,e,r,c,f,m,x,T,C,k,L,j){const N=p.text.placedSymbolArray,q=p.text.dynamicLayoutVertexArray,X=p.icon.dynamicLayoutVertexArray,ae={};q.clear();for(let ne=0;ne<N.length;ne++){const re=N.get(ne),le=re.hidden||!re.crossTileID||p.allowVerticalPlacement&&!re.placedOrientation?null:c[re.crossTileID];if(le){const ue=new l.P(re.anchorX,re.anchorY),ce={getElevation:j,width:f.width,height:f.height,pitchedLabelPlaneMatrix:m,pitchWithMap:r,transform:f,tileAnchorPoint:ue,translation:k,unwrappedTileID:L},me=r?Ht(ue.x,ue.y,ce):Jr(ue.x,ue.y,ce),ye=Ir(f.cameraToCenterDistance,me.signedDistanceFromCamera);let he=l.ap(p.textSizeData,T,re)*ye/l.aB;r&&(he*=p.tilePixelRatio/x);const{width:Se,height:Oe,anchor:Re,textOffset:ke,textBoxScale:Le}=le,rt=Eu(Re,Se,Oe,ke,Le,he),st=f.getPitchedTextCorrection(ue.x+k[0],ue.y+k[1],L),Qe=Nl(me.point,ce,e,rt,-f.bearingInRadians,st),wt=p.allowVerticalPlacement&&re.placedOrientation===l.ao.vertical?Math.PI/2:0;for(let Ut=0;Ut<re.numGlyphs;Ut++)l.av(q,Qe,wt);C&&re.associatedIconIndex>=0&&(ae[re.associatedIconIndex]={shiftedAnchor:Qe,angle:wt})}else Dn(re.numGlyphs,q)}if(C){X.clear();const ne=p.icon.placedSymbolArray;for(let re=0;re<ne.length;re++){const le=ne.get(re);if(le.hidden)Dn(le.numGlyphs,X);else{const ue=ae[re];if(ue)for(let ce=0;ce<le.numGlyphs;ce++)l.av(X,ue.shiftedAnchor,ue.angle);else Dn(le.numGlyphs,X)}}p.icon.dynamicLayoutVertexBuffer.updateData(X)}p.text.dynamicLayoutVertexBuffer.updateData(q)}function Cn(p,e,r){return r.iconsInText&&e?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Rs(p,e,r,c,f,m,x,T,C,k,L,j,N){const q=p.context,X=q.gl,ae=p.transform,ne=T==="map",re=C==="map",le=T!=="viewport"&&r.layout.get("symbol-placement")!=="point",ue=ne&&!re&&!le,ce=!r.layout.get("symbol-sort-key").isConstant();let me=!1;const ye=p.getDepthModeForSublayer(0,Bt.ReadOnly),he=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Se=[],Oe=ae.getCircleRadiusCorrection();for(const Re of c){const ke=e.getTile(Re),Le=ke.getBucket(r);if(!Le)continue;const rt=f?Le.text:Le.icon;if(!rt||!rt.segments.get().length||!rt.hasVisibleVertices)continue;const st=rt.programConfigurations.get(r.id),Qe=f||Le.sdfIcons,wt=f?Le.textSizeData:Le.iconSizeData,Ut=re||ae.pitch!==0,pi=p.useProgram(Cn(Qe,f,Le),st),Ai=l.an(wt,ae.zoom),Ci=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Re);let Yi,Ui,ni,ra,nn=[0,0],va=null;if(f)Ui=ke.glyphAtlasTexture,ni=X.LINEAR,Yi=ke.glyphAtlasTexture.size,Le.iconsInText&&(nn=ke.imageAtlasTexture.size,va=ke.imageAtlasTexture,ra=Ut||p.options.rotating||p.options.zooming||wt.kind==="composite"||wt.kind==="camera"?X.LINEAR:X.NEAREST);else{const ca=r.layout.get("icon-size").constantOr(0)!==1||Le.iconsNeedLinear;Ui=ke.imageAtlasTexture,ni=Qe||p.options.rotating||p.options.zooming||ca||Ut?X.LINEAR:X.NEAREST,Yi=ke.imageAtlasTexture.size}const xa=l.aC(ke,1,p.transform.zoom),_n=Ni(ne,p.transform,xa),Us=l.L();l.aq(Us,_n);const nr=za(re,ne,p.transform,xa),Vs=l.aD(ae,ke,m,x),Co=ae.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),$l=he&&Le.hasTextData(),hl=r.layout.get("icon-text-fit")!=="none"&&$l&&Le.hasIconData();if(le){const ca=p.style.map.terrain?(jn,rn)=>p.style.map.terrain.getElevation(Re,jn,rn):null,Da=r.layout.get("text-rotation-alignment")==="map";Ia(Le,p,f,_n,Us,re,k,Da,Re.toUnwrapped(),ae.width,ae.height,Vs,ca)}const ms=f&&he||hl,rr=le||ms?Th:re?_n:p.transform.clipSpaceToPixelsMatrix,wr=Qe&&r.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ur;Ur=Qe?Le.iconsInText?xd(wt.kind,Ai,ue,re,le,ms,p,rr,nr,Vs,Yi,nn,Oe):_h(wt.kind,Ai,ue,re,le,ms,p,rr,nr,Vs,f,Yi,0,Oe):vd(wt.kind,Ai,ue,re,le,ms,p,rr,nr,Vs,f,Yi,Oe);const Nn={program:pi,buffers:rt,uniformValues:Ur,projectionData:Co,atlasTexture:Ui,atlasTextureIcon:va,atlasInterpolation:ni,atlasInterpolationIcon:ra,isSDF:Qe,hasHalo:wr};if(ce&&Le.canOverlap){me=!0;const ca=rt.segments.get();for(const Da of ca)Se.push({segments:new l.aM([Da]),sortKey:Da.sortKey,state:Nn,terrainData:Ci})}else Se.push({segments:rt.segments,sortKey:0,state:Nn,terrainData:Ci})}me&&Se.sort(((Re,ke)=>Re.sortKey-ke.sortKey));for(const Re of Se){const ke=Re.state;if(q.activeTexture.set(X.TEXTURE0),ke.atlasTexture.bind(ke.atlasInterpolation,X.CLAMP_TO_EDGE),ke.atlasTextureIcon&&(q.activeTexture.set(X.TEXTURE1),ke.atlasTextureIcon&&ke.atlasTextureIcon.bind(ke.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),ke.isSDF){const Le=ke.uniformValues;ke.hasHalo&&(Le.u_is_halo=1,fo(ke.buffers,Re.segments,r,p,ke.program,ye,L,j,Le,ke.projectionData,Re.terrainData)),Le.u_is_halo=0}fo(ke.buffers,Re.segments,r,p,ke.program,ye,L,j,ke.uniformValues,ke.projectionData,Re.terrainData)}}function fo(p,e,r,c,f,m,x,T,C,k,L){const j=c.context;f.draw(j,j.gl.TRIANGLES,m,x,T,ai.backCCW,C,L,k,r.id,p.layoutVertexBuffer,p.indexBuffer,e,r.paint,c.transform.zoom,p.programConfigurations.get(r.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function tl(p,e,r,c,f){const m=p.context,x=m.gl,T=Qt.disabled,C=new Ii([x.ONE,x.ONE],l.bf.transparent,[!0,!0,!0,!0]),k=e.getBucket(r);if(!k)return;const L=c.key;let j=r.heatmapFbos.get(L);j||(j=mn(m,e.tileSize,e.tileSize),r.heatmapFbos.set(L,j)),m.bindFramebuffer.set(j.framebuffer),m.viewport.set([0,0,e.tileSize,e.tileSize]),m.clear({color:l.bf.transparent});const N=k.programConfigurations.get(r.id),q=p.useProgram("heatmap",N,!f),X=p.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ae=p.style.map.terrain.getTerrainData(c);q.draw(m,x.TRIANGLES,Bt.disabled,T,C,ai.disabled,fh(e,p.transform.zoom,r.paint.get("heatmap-intensity"),1),ae,X,r.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,r.paint,p.transform.zoom,N)}function po(p,e,r,c,f){const m=p.context,x=m.gl,T=p.transform;m.setColorMode(p.colorModeForRenderPass());const C=en(m,e),k=r.key,L=e.heatmapFbos.get(k);if(!L)return;m.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,L.colorAttachment.get()),m.activeTexture.set(x.TEXTURE1),C.bind(x.LINEAR,x.CLAMP_TO_EDGE);const j=T.getProjectionData({overscaledTileID:r,applyTerrainMatrix:f,applyGlobeMatrix:!c});p.useProgram("heatmapTexture").draw(m,x.TRIANGLES,Bt.disabled,Qt.disabled,p.colorModeForRenderPass(),ai.disabled,_d(p,e,0,1),null,j,e.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments,e.paint,T.zoom),L.destroy(),e.heatmapFbos.delete(k)}function mn(p,e,r){var c,f;const m=p.gl,x=m.createTexture();m.bindTexture(m.TEXTURE_2D,x),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const T=(c=p.HALF_FLOAT)!==null&&c!==void 0?c:m.UNSIGNED_BYTE,C=(f=p.RGBA16F)!==null&&f!==void 0?f:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,C,e,r,0,m.RGBA,T,null);const k=p.createFramebuffer(e,r,!1,!1);return k.colorAttachment.set(x),k}function en(p,e){return e.colorRampTexture||(e.colorRampTexture=new l.T(p,e.colorRamp,p.gl.RGBA)),e.colorRampTexture}function Lr(p,e,r,c,f,m,x,T){let C=256;if(f.stepInterpolant){const k=e.getSource().maxzoom,L=x.canonical.z===k?Math.ceil(1<<p.transform.maxZoom-x.canonical.z):1;C=l.ah(l.c4(m.maxLineLength/l.$*1024*L),256,r.maxTextureSize)}return T.gradient=l.c5({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:C,image:T.gradient||void 0,clips:m.lineClipsArray}),T.texture?T.texture.update(T.gradient):T.texture=new l.T(r,T.gradient,c.RGBA),T.version=f.gradientVersion,T.texture}function cs(p,e,r,c,f){p.activeTexture.set(e.TEXTURE0),r.imageAtlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE),c.updatePaintBuffers(f)}function Ln(p,e,r,c,f,m){(f||p.lineAtlas.dirty)&&(e.activeTexture.set(r.TEXTURE0),p.lineAtlas.bind(e)),c.updatePaintBuffers(m)}function Ds(p,e,r,c,f,m,x){const T=m.gradients[f.id];let C=T.texture;f.gradientVersion!==T.version&&(C=Lr(p,e,r,c,f,m,x,T)),r.activeTexture.set(c.TEXTURE0),C.bind(f.stepInterpolant?c.NEAREST:c.LINEAR,c.CLAMP_TO_EDGE)}function Eh(p,e,r,c,f,m,x,T,C){const k=m.gradients[f.id];let L=k.texture;f.gradientVersion!==k.version&&(L=Lr(p,e,r,c,f,m,x,k)),r.activeTexture.set(c.TEXTURE0),L.bind(f.stepInterpolant?c.NEAREST:c.LINEAR,c.CLAMP_TO_EDGE),r.activeTexture.set(c.TEXTURE1),p.lineAtlas.bind(r),T.updatePaintBuffers(C)}function il(p,e,r,c,f){if(!r||!c||!c.imageAtlas)return;const m=c.imageAtlas.patternPositions;let x=m[r.to.toString()],T=m[r.from.toString()];if(!x&&T&&(x=T),!T&&x&&(T=x),!x||!T){const C=f.getPaintProperty(e);x=m[C],T=m[C]}x&&T&&p.setConstantPatternPositions(x,T)}function jl(p,e,r,c,f,m,x,T){const C=p.context.gl,k="fill-pattern",L=r.paint.get(k),j=L&&L.constantOr(1),N=r.getCrossfadeParameters();let q,X,ae,ne,re;const le=p.transform,ue=r.paint.get("fill-translate"),ce=r.paint.get("fill-translate-anchor");x?(X=j&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=C.LINES):(X=j?"fillPattern":"fill",q=C.TRIANGLES);const me=L.constantOr(null);for(const ye of c){const he=e.getTile(ye);if(j&&!he.patternsLoaded())continue;const Se=he.getBucket(r);if(!Se)continue;const Oe=Se.programConfigurations.get(r.id),Re=p.useProgram(X,Oe),ke=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ye);j&&(p.context.activeTexture.set(C.TEXTURE0),he.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Oe.updatePaintBuffers(N)),il(Oe,k,me,he,r);const Le=le.getProjectionData({overscaledTileID:ye,applyGlobeMatrix:!T,applyTerrainMatrix:!0}),rt=l.aD(le,he,ue,ce);if(x){ne=Se.indexBuffer2,re=Se.segments2;const Qe=[C.drawingBufferWidth,C.drawingBufferHeight];ae=X==="fillOutlinePattern"&&j?pd(p,N,he,Qe,rt):kl(Qe,rt)}else ne=Se.indexBuffer,re=Se.segments,ae=j?Xo(p,N,he,rt):{u_fill_translate:rt};const st=p.stencilModeForClipping(ye);Re.draw(p.context,q,f,st,m,ai.backCCW,ae,ke,Le,r.id,Se.layoutVertexBuffer,ne,re,r.paint,p.transform.zoom,Oe)}}function Ic(p,e,r,c,f,m,x,T){const C=p.context,k=C.gl,L="fill-extrusion-pattern",j=r.paint.get(L),N=j.constantOr(1),q=r.getCrossfadeParameters(),X=r.paint.get("fill-extrusion-opacity"),ae=j.constantOr(null),ne=p.transform;for(const re of c){const le=e.getTile(re),ue=le.getBucket(r);if(!ue)continue;const ce=p.style.map.terrain&&p.style.map.terrain.getTerrainData(re),me=ue.programConfigurations.get(r.id),ye=p.useProgram(N?"fillExtrusionPattern":"fillExtrusion",me);N&&(p.context.activeTexture.set(k.TEXTURE0),le.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),me.updatePaintBuffers(q));const he=ne.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!T,applyTerrainMatrix:!0});il(me,L,ae,le,r);const Se=l.aD(ne,le,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Oe=r.paint.get("fill-extrusion-vertical-gradient"),Re=N?dh(p,Oe,X,Se,re,q,le):Dl(p,Oe,X,Se);ye.draw(C,C.gl.TRIANGLES,f,m,x,ai.backCCW,Re,ce,he,r.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,r.paint,p.transform.zoom,me,p.style.map.terrain&&ue.centroidVertexBuffer)}}function Ra(p,e,r,c,f,m,x,T,C){var k;const L=p.style.projection,j=p.context,N=p.transform,q=j.gl,X=[`#define NUM_ILLUMINATION_SOURCES ${r.paint.get("hillshade-highlight-color").values.length}`],ae=p.useProgram("hillshade",null,!1,X),ne=!p.options.moving;for(const re of c){const le=e.getTile(re),ue=le.fbo;if(!ue)continue;const ce=L.getMeshFromTileID(j,re.canonical,T,!0,"raster"),me=(k=p.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(re);j.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,ue.colorAttachment.get());const ye=N.getProjectionData({overscaledTileID:re,aligned:ne,applyGlobeMatrix:!C,applyTerrainMatrix:!0});ae.draw(j,q.TRIANGLES,m,f[re.overscaledZ],x,ai.backCCW,ph(p,le,r),me,ye,r.id,ce.vertexBuffer,ce.indexBuffer,ce.segments)}}function ki(p,e,r,c,f,m,x,T,C){var k;const L=p.style.projection,j=p.context,N=p.transform,q=j.gl,X=p.useProgram("colorRelief"),ae=!p.options.moving;let ne=!0,re=0;for(const le of c){const ue=e.getTile(le),ce=ue.dem;if(ne){const Re=q.getParameter(q.MAX_TEXTURE_SIZE),{elevationTexture:ke,colorTexture:Le}=r.getColorRampTextures(j,Re,ce.getUnpackVector());j.activeTexture.set(q.TEXTURE1),ke.bind(q.NEAREST,q.CLAMP_TO_EDGE),j.activeTexture.set(q.TEXTURE4),Le.bind(q.LINEAR,q.CLAMP_TO_EDGE),ne=!1,re=ke.size[0]}if(!ce||!ce.data)continue;const me=ce.stride,ye=ce.getPixels();if(j.activeTexture.set(q.TEXTURE0),j.pixelStoreUnpackPremultiplyAlpha.set(!1),ue.demTexture=ue.demTexture||p.getTileTexture(me),ue.demTexture){const Re=ue.demTexture;Re.update(ye,{premultiply:!1}),Re.bind(q.LINEAR,q.CLAMP_TO_EDGE)}else ue.demTexture=new l.T(j,ye,q.RGBA,{premultiply:!1}),ue.demTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE);const he=L.getMeshFromTileID(j,le.canonical,T,!0,"raster"),Se=(k=p.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(le),Oe=N.getProjectionData({overscaledTileID:le,aligned:ae,applyGlobeMatrix:!C,applyTerrainMatrix:!0});X.draw(j,q.TRIANGLES,m,f[le.overscaledZ],x,ai.backCCW,Ol(r,ue.dem,re),Se,Oe,r.id,he.vertexBuffer,he.indexBuffer,he.segments)}}const ci=[new l.P(0,0),new l.P(l.$,0),new l.P(l.$,l.$),new l.P(0,l.$)];function Or(p,e,r,c,f,m,x,T,C=!1,k=!1){const L=c[c.length-1].overscaledZ,j=p.context,N=j.gl,q=p.useProgram("raster"),X=p.transform,ae=p.style.projection,ne=p.colorModeForRenderPass(),re=!p.options.moving,le=r.paint.get("raster-opacity"),ue=r.paint.get("raster-resampling"),ce=r.paint.get("raster-fade-duration"),me=!!p.style.map.terrain;for(const ye of c){const he=p.getDepthModeForSublayer(ye.overscaledZ-L,le===1?Bt.ReadWrite:Bt.ReadOnly,N.LESS),Se=e.getTile(ye),Oe=ue==="nearest"?N.NEAREST:N.LINEAR;j.activeTexture.set(N.TEXTURE0),Se.texture.bind(Oe,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),j.activeTexture.set(N.TEXTURE1);const{parentTile:Re,parentScaleBy:ke,parentTopLeft:Le,fadeValues:rt}=Jn(Se,e,ce,me);Se.fadeOpacity=rt.tileOpacity,Re?(Re.fadeOpacity=rt.parentTileOpacity,Re.texture.bind(Oe,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST)):Se.texture.bind(Oe,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),Se.texture.useMipmap&&j.extTextureFilterAnisotropic&&p.transform.pitch>20&&N.texParameterf(N.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const st=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ye),Qe=X.getProjectionData({overscaledTileID:ye,aligned:re,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),wt=wc(Le,ke,rt.fadeMix,r,T),Ut=ae.getMeshFromTileID(j,ye.canonical,m,x,"raster");q.draw(j,N.TRIANGLES,he,f?f[ye.overscaledZ]:Qt.disabled,ne,C?ai.frontCCW:ai.backCCW,wt,st,Qe,r.id,Ut.vertexBuffer,Ut.indexBuffer,Ut.segments)}}function Jn(p,e,r,c){const f={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(r===0||c)return f;if(p.fadingParentID){const m=e._getLoadedTile(p.fadingParentID);if(!m)return f;const x=Math.pow(2,m.tileID.overscaledZ-p.tileID.overscaledZ),T=[p.tileID.canonical.x*x%1,p.tileID.canonical.y*x%1],C=(function(k,L,j){const N=W.now(),q=(N-L.timeAdded)/j,X=k.fadingDirection===we.Incoming,ae=l.ah((N-k.timeAdded)/j,0,1),ne=l.ah(1-q,0,1),re=X?ae:ne;return{tileOpacity:re,parentTileOpacity:X?ne:ae,fadeMix:{opacity:1,mix:1-re}}})(p,m,r);return{parentTile:m,parentScaleBy:x,parentTopLeft:T,fadeValues:C}}if(p.selfFading){const m=(function(x,T){const C=W.now(),k=l.ah((C-x.timeAdded)/T,0,1);return{tileOpacity:k,fadeMix:{opacity:k,mix:0}}})(p,r);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:m}}return f}const la=new l.bf(1,0,0,1),On=new l.bf(0,1,0,1),er=new l.bf(0,0,1,1),Au=new l.bf(1,0,1,1),ks=new l.bf(0,1,1,1);function Ls(p,e,r,c){us(p,0,e+r/2,p.transform.width,r,c)}function Os(p,e,r,c){us(p,e-r/2,0,r,p.transform.height,c)}function us(p,e,r,c,f,m){const x=p.context,T=x.gl;T.enable(T.SCISSOR_TEST),T.scissor(e*p.pixelRatio,r*p.pixelRatio,c*p.pixelRatio,f*p.pixelRatio),x.clear({color:m}),T.disable(T.SCISSOR_TEST)}function al(p,e,r){const c=p.context,f=c.gl,m=p.useProgram("debug"),x=Bt.disabled,T=Qt.disabled,C=p.colorModeForRenderPass(),k="$debug",L=p.style.map.terrain&&p.style.map.terrain.getTerrainData(r);c.activeTexture.set(f.TEXTURE0);const j=e.getTileByID(r.key).latestRawTileData,N=Math.floor((j&&j.byteLength||0)/1024),q=e.getTile(r).tileSize,X=512/Math.min(q,512)*(r.overscaledZ/p.transform.zoom)*.5;let ae=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(ae+=` => ${r.overscaledZ}`),(function(re,le){re.initDebugOverlayCanvas();const ue=re.debugOverlayCanvas,ce=re.context.gl,me=re.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,ue.width,ue.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(le,5,5),me.strokeText(le,5,5),re.debugOverlayTexture.update(ue),re.debugOverlayTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)})(p,`${ae} ${N}kB`);const ne=p.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(c,f.TRIANGLES,x,T,Ii.alphaBlended,ai.disabled,gd(l.bf.transparent,X),null,ne,k,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),m.draw(c,f.LINE_STRIP,x,T,C,ai.disabled,gd(l.bf.red),L,ne,k,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function hs(p,e,r,c){const{isRenderingGlobe:f}=c,m=p.context,x=m.gl,T=p.transform,C=p.colorModeForRenderPass(),k=p.getDepthModeFor3D(),L=p.useProgram("terrain");m.bindFramebuffer.set(null),m.viewport.set([0,0,p.width,p.height]);for(const j of r){const N=e.getTerrainMesh(j.tileID),q=p.renderToTexture.getTexture(j),X=e.getTerrainData(j.tileID);m.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,q.texture);const ae=e.getMeshFrameDelta(T.zoom),ne=T.calculateFogMatrix(j.tileID.toUnwrapped()),re=uh(ae,ne,p.style.sky,T.pitch,f),le=T.getProjectionData({overscaledTileID:j.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});L.draw(m,x.TRIANGLES,k,Qt.disabled,C,ai.backCCW,re,X,le,"terrain",N.vertexBuffer,N.indexBuffer,N.segments)}}function Br(p,e){if(!e.mesh){const r=new l.aL;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const c=new l.aN;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),e.mesh=new no(p.createVertexBuffer(r,Mn.members),p.createIndexBuffer(c),l.aM.simpleSegment(0,0,r.length,c.length))}return e.mesh}class Bs{constructor(e,r){this.context=new Sd(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Tt.maxUnderzooming+Tt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new as}resize(e,r,c){if(this.width=Math.floor(e*c),this.height=Math.floor(r*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const e=this.context,r=new l.aL;r.emplaceBack(0,0),r.emplaceBack(l.$,0),r.emplaceBack(0,l.$),r.emplaceBack(l.$,l.$),this.tileExtentBuffer=e.createVertexBuffer(r,Mn.members),this.tileExtentSegments=l.aM.simpleSegment(0,0,4,2);const c=new l.aL;c.emplaceBack(0,0),c.emplaceBack(l.$,0),c.emplaceBack(0,l.$),c.emplaceBack(l.$,l.$),this.debugBuffer=e.createVertexBuffer(c,Mn.members),this.debugSegments=l.aM.simpleSegment(0,0,4,5);const f=new l.c7;f.emplaceBack(0,0,0,0),f.emplaceBack(l.$,0,l.$,0),f.emplaceBack(0,l.$,0,l.$),f.emplaceBack(l.$,l.$,l.$,l.$),this.rasterBoundsBuffer=e.createVertexBuffer(f,xf.members),this.rasterBoundsSegments=l.aM.simpleSegment(0,0,4,2);const m=new l.aL;m.emplaceBack(0,0),m.emplaceBack(l.$,0),m.emplaceBack(0,l.$),m.emplaceBack(l.$,l.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(m,Mn.members),this.rasterBoundsSegmentsPosOnly=l.aM.simpleSegment(0,0,4,5);const x=new l.aL;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(x,Mn.members),this.viewportSegments=l.aM.simpleSegment(0,0,4,2);const T=new l.c8;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(T);const C=new l.aN;C.emplaceBack(1,0,2),C.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(C);const k=this.context.gl;this.stencilClearMode=new Qt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new no(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=l.L();l.bZ(c,0,this.width,this.height,0,0,1),l.N(c,c,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const f={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Bt.disabled,this.stencilClearMode,Ii.disabled,ai.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,c){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Ii.disabled),f.setDepthMode(Bt.disabled);const m={};for(const x of r)m[x.key]=this.nextStencilID++;this._renderTileMasks(m,r,c,!0),this._renderTileMasks(m,r,c,!1),this._tileClippingMaskIDs=m}_renderTileMasks(e,r,c,f){const m=this.context,x=m.gl,T=this.style.projection,C=this.transform,k=this.useProgram("clippingMask");for(const L of r){const j=e[L.key],N=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L),q=T.getMeshFromTileID(this.context,L.canonical,f,!0,"stencil"),X=C.getProjectionData({overscaledTileID:L,applyGlobeMatrix:!c,applyTerrainMatrix:!0});k.draw(m,x.TRIANGLES,Bt.disabled,new Qt({func:x.ALWAYS,mask:0},j,255,x.KEEP,x.KEEP,x.REPLACE),Ii.disabled,c?ai.disabled:ai.backCCW,null,N,X,"$clipping",q.vertexBuffer,q.indexBuffer,q.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,c=this.style.projection,f=this.transform,m=this.useProgram("depth"),x=this.getDepthModeFor3D(),T=ii(f,{tileSize:f.tileSize});for(const C of T){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(C),L=c.getMeshFromTileID(this.context,C.canonical,!0,!0,"raster"),j=f.getProjectionData({overscaledTileID:C,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(e,r.TRIANGLES,x,Qt.disabled,Ii.disabled,ai.backCCW,null,k,j,"$clipping",L.vertexBuffer,L.indexBuffer,L.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new Qt({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new Qt({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,c=e.sort(((x,T)=>T.overscaledZ-x.overscaledZ)),f=c[c.length-1].overscaledZ,m=c[0].overscaledZ-f+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const x={};for(let T=0;T<m;T++)x[T+f]=new Qt({func:r.GEQUAL,mask:255},T+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=m,[x,c]}return[{[f]:Qt.disabled},c]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,c=e.sort(((x,T)=>T.overscaledZ-x.overscaledZ)),f=c[c.length-1].overscaledZ,m=c[0].overscaledZ-f+1;if(this.clearStencil(),m>1){const x={},T={};for(let C=0;C<m;C++)x[C+f]=new Qt({func:r.GREATER,mask:255},m+1+C,255,r.KEEP,r.KEEP,r.REPLACE),T[C+f]=new Qt({func:r.GREATER,mask:255},1+C,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*m+1,[x,T,c]}return this.nextStencilID=3,[{[f]:new Qt({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[f]:new Qt({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Ii([e.CONSTANT_COLOR,e.ONE],new l.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ii.unblended:Ii.alphaBlended}getDepthModeForSublayer(e,r,c){if(!this.opaquePassEnabledForLayer())return Bt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Bt(c||this.context.gl.LEQUAL,r,[f,f])}getDepthModeFor3D(){return new Bt(this.context.gl.LEQUAL,Bt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var c,f;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(W.now()),this.imageManager.beginFrame();const m=this.style._order,x=this.style.sourceCaches,T={},C={},k={},L={isRenderingToTexture:!1,isRenderingGlobe:((c=e.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const N in x){const q=x[N];q.used&&q.prepare(this.context),T[N]=q.getVisibleCoordinates(!1),C[N]=T[N].slice().reverse(),k[N]=q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let N=0;N<m.length;N++)if(this.style._layers[m[N]].is3D()){this.opaquePassCutoff=N;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const N of m){const q=this.style._layers[N];if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const X=C[q.source];(q.type==="custom"||X.length)&&this.renderLayer(this,x[q.source],q,X,L)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:N=>this.useProgram(N)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?l.bf.black:l.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(N,q){const X=N.context,ae=X.gl,ne=((ye,he,Se)=>{const Oe=Math.cos(he.rollInRadians),Re=Math.sin(he.rollInRadians),ke=Ie(he),Le=he.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ye.properties.get("sky-color"),u_horizon_color:ye.properties.get("horizon-color"),u_horizon:[(he.width/2-ke*Re)*Se,(he.height/2+ke*Oe)*Se],u_horizon_normal:[-Re,Oe],u_sky_horizon_blend:ye.properties.get("sky-horizon-blend")*he.height/2*Se,u_sky_blend:Le}})(q,N.style.map.transform,N.pixelRatio),re=new Bt(ae.LEQUAL,Bt.ReadWrite,[0,1]),le=Qt.disabled,ue=N.colorModeForRenderPass(),ce=N.useProgram("sky"),me=Br(X,q);ce.draw(X,ae.TRIANGLES,re,le,ue,ai.disabled,ne,null,void 0,"sky",me.vertexBuffer,me.indexBuffer,me.segments)})(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const N=this.style._layers[m[this.currentLayer]],q=x[N.source],X=T[N.source];this._renderTileClippingMasks(N,X,!1),this.renderLayer(this,q,N,X,L)}this.renderPass="translucent";let j=!1;for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const N=this.style._layers[m[this.currentLayer]],q=x[N.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(N,L))continue;this.opaquePassEnabledForLayer()||j||(j=!0,L.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const X=(N.type==="symbol"?k:C)[N.source];this._renderTileClippingMasks(N,T[N.source],!!this.renderToTexture),this.renderLayer(this,q,N,X,L)}if(L.isRenderingGlobe&&(function(N,q,X){const ae=N.context,ne=ae.gl,re=N.useProgram("atmosphere"),le=new Bt(ne.LEQUAL,Bt.ReadOnly,[0,1]),ue=N.transform,ce=(function(Le,rt){const st=Le.properties.get("position"),Qe=[-st.x,-st.y,-st.z],wt=l.ag(new Float64Array(16));return Le.properties.get("anchor")==="map"&&(l.b6(wt,wt,rt.rollInRadians),l.b7(wt,wt,-rt.pitchInRadians),l.b6(wt,wt,rt.bearingInRadians),l.b7(wt,wt,rt.center.lat*Math.PI/180),l.bz(wt,wt,-rt.center.lng*Math.PI/180)),l.c6(Qe,Qe,wt),Qe})(X,N.transform),me=ue.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ye=q.properties.get("atmosphere-blend")*me.projectionTransition;if(ye===0)return;const he=$o(ue.worldSize,ue.center.lat),Se=ue.inverseProjectionMatrix,Oe=new Float64Array(4);Oe[3]=1,l.aw(Oe,Oe,ue.modelViewProjectionMatrix),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1,l.aw(Oe,Oe,Se),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1;const Re=((Le,rt,st,Qe,wt)=>({u_sun_pos:Le,u_atmosphere_blend:rt,u_globe_position:st,u_globe_radius:Qe,u_inv_proj_matrix:wt}))(ce,ye,[Oe[0],Oe[1],Oe[2]],he,Se),ke=Br(ae,q);re.draw(ae,ne.TRIANGLES,le,Qt.disabled,Ii.alphaBlended,ai.disabled,Re,null,null,"atmosphere",ke.vertexBuffer,ke.indexBuffer,ke.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const N=(function(q,X){let ae=null;const ne=Object.values(q._layers).flatMap((ce=>ce.source&&!ce.isHidden(X)?[q.sourceCaches[ce.source]]:[])),re=ne.filter((ce=>ce.getSource().type==="vector")),le=ne.filter((ce=>ce.getSource().type!=="vector")),ue=ce=>{(!ae||ae.getSource().maxzoom<ce.getSource().maxzoom)&&(ae=ce)};return re.forEach((ce=>ue(ce))),ae||le.forEach((ce=>ue(ce))),ae})(this.style,this.transform.zoom);N&&(function(q,X,ae){for(let ne=0;ne<ae.length;ne++)al(q,X,ae[ne])})(this,N,N.getVisibleCoordinates())}this.options.showPadding&&(function(N){const q=N.transform.padding;Ls(N,N.transform.height-(q.top||0),3,la),Ls(N,q.bottom||0,3,On),Os(N,q.left||0,3,er),Os(N,N.transform.width-(q.right||0),3,Au);const X=N.transform.centerPoint;(function(ae,ne,re,le){us(ae,ne-1,re-10,2,20,le),us(ae,ne-10,re-1,20,2,le)})(N,X.x,N.transform.height-X.y,ks)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=e?!l.c9(r,c):!l.ca(r,c)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(l.cb(r,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(m,x){const T=m.context,C=T.gl,k=m.transform,L=Ii.unblended,j=new Bt(C.LEQUAL,Bt.ReadWrite,[0,1]),N=x.sourceCache.getRenderableTiles(),q=m.useProgram("terrainDepth");T.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:l.bf.transparent,depth:1});for(const X of N){const ae=x.getTerrainMesh(X.tileID),ne=x.getTerrainData(X.tileID),re=k.getProjectionData({overscaledTileID:X.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),le={u_ele_delta:x.getMeshFrameDelta(k.zoom)};q.draw(T,C.TRIANGLES,j,Qt.disabled,L,ai.backCCW,le,ne,re,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])})(this,this.style.map.terrain),(function(m,x){const T=m.context,C=T.gl,k=m.transform,L=Ii.unblended,j=new Bt(C.LEQUAL,Bt.ReadWrite,[0,1]),N=x.getCoordsTexture(),q=x.sourceCache.getRenderableTiles(),X=m.useProgram("terrainCoords");T.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:l.bf.transparent,depth:1}),x.coordsIndex=[];for(const ae of q){const ne=x.getTerrainMesh(ae.tileID),re=x.getTerrainData(ae.tileID);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,N.texture);const le={u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(k.zoom)},ue=k.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});X.draw(T,C.TRIANGLES,j,Qt.disabled,L,ai.backCCW,le,re,ue,"terrain",ne.vertexBuffer,ne.indexBuffer,ne.segments),x.coordsIndex.push(ae.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])})(this,this.style.map.terrain))}renderLayer(e,r,c,f,m){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(f||[]).length)&&(this.id=c.id,l.cc(c)?(function(x,T,C,k,L,j){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:N}=j,q=Qt.disabled,X=x.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ae,ne,re,le,ue,ce,me,ye,he){const Se=ne.transform,Oe=ne.style.map.terrain,Re=ue==="map",ke=ce==="map";for(const Le of ae){const rt=le.getTile(Le),st=rt.getBucket(re);if(!st||!st.text||!st.text.segments.get().length)continue;const Qe=l.an(st.textSizeData,Se.zoom),wt=l.aC(rt,1,ne.transform.zoom),Ut=Ni(Re,ne.transform,wt),pi=re.layout.get("icon-text-fit")!=="none"&&st.hasIconData();if(Qe){const Ai=Math.pow(2,Se.zoom-rt.tileID.overscaledZ),Ci=Oe?(Yi,Ui)=>Oe.getElevation(Le,Yi,Ui):null;zc(st,Re,ke,he,Se,Ut,Ai,Qe,pi,l.aD(Se,rt,me,ye),Le.toUnwrapped(),Ci)}}})(k,x,C,T,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),L),C.paint.get("icon-opacity").constantOr(1)!==0&&Rs(x,T,C,k,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),q,X,N),C.paint.get("text-opacity").constantOr(1)!==0&&Rs(x,T,C,k,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),q,X,N),T.map.showCollisionBoxes&&(Is(x,T,C,k,!0),Is(x,T,C,k,!1))})(e,r,c,f,this.style.placement.variableOffsets,m):l.cd(c)?(function(x,T,C,k,L){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=L,N=C.paint.get("circle-opacity"),q=C.paint.get("circle-stroke-width"),X=C.paint.get("circle-stroke-opacity"),ae=!C.layout.get("circle-sort-key").isConstant();if(N.constantOr(1)===0&&(q.constantOr(1)===0||X.constantOr(1)===0))return;const ne=x.context,re=ne.gl,le=x.transform,ue=x.getDepthModeForSublayer(0,Bt.ReadOnly),ce=Qt.disabled,me=x.colorModeForRenderPass(),ye=[],he=le.getCircleRadiusCorrection();for(let Se=0;Se<k.length;Se++){const Oe=k[Se],Re=T.getTile(Oe),ke=Re.getBucket(C);if(!ke)continue;const Le=C.paint.get("circle-translate"),rt=C.paint.get("circle-translate-anchor"),st=l.aD(le,Re,Le,rt),Qe=ke.programConfigurations.get(C.id),wt=x.useProgram("circle",Qe),Ut=ke.layoutVertexBuffer,pi=ke.indexBuffer,Ai=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Oe),Ci={programConfiguration:Qe,program:wt,layoutVertexBuffer:Ut,indexBuffer:pi,uniformValues:vc(x,Re,C,st,he),terrainData:Ai,projectionData:le.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!j,applyTerrainMatrix:!0})};if(ae){const Yi=ke.segments.get();for(const Ui of Yi)ye.push({segments:new l.aM([Ui]),sortKey:Ui.sortKey,state:Ci})}else ye.push({segments:ke.segments,sortKey:0,state:Ci})}ae&&ye.sort(((Se,Oe)=>Se.sortKey-Oe.sortKey));for(const Se of ye){const{programConfiguration:Oe,program:Re,layoutVertexBuffer:ke,indexBuffer:Le,uniformValues:rt,terrainData:st,projectionData:Qe}=Se.state;Re.draw(ne,re.TRIANGLES,ue,ce,me,ai.backCCW,rt,st,Qe,C.id,ke,Le,Se.segments,C.paint,x.transform.zoom,Oe)}})(e,r,c,f,m):l.ce(c)?(function(x,T,C,k,L){if(C.paint.get("heatmap-opacity")===0)return;const j=x.context,{isRenderingToTexture:N,isRenderingGlobe:q}=L;if(x.style.map.terrain){for(const X of k){const ae=T.getTile(X);T.hasRenderableParent(X)||(x.renderPass==="offscreen"?tl(x,ae,C,X,q):x.renderPass==="translucent"&&po(x,C,X,N,q))}j.viewport.set([0,0,x.width,x.height])}else x.renderPass==="offscreen"?(function(X,ae,ne,re){const le=X.context,ue=le.gl,ce=X.transform,me=Qt.disabled,ye=new Ii([ue.ONE,ue.ONE],l.bf.transparent,[!0,!0,!0,!0]);(function(he,Se,Oe){const Re=he.gl;he.activeTexture.set(Re.TEXTURE1),he.viewport.set([0,0,Se.width/4,Se.height/4]);let ke=Oe.heatmapFbos.get(l.c3);ke?(Re.bindTexture(Re.TEXTURE_2D,ke.colorAttachment.get()),he.bindFramebuffer.set(ke.framebuffer)):(ke=mn(he,Se.width/4,Se.height/4),Oe.heatmapFbos.set(l.c3,ke))})(le,X,ne),le.clear({color:l.bf.transparent});for(let he=0;he<re.length;he++){const Se=re[he];if(ae.hasRenderableParent(Se))continue;const Oe=ae.getTile(Se),Re=Oe.getBucket(ne);if(!Re)continue;const ke=Re.programConfigurations.get(ne.id),Le=X.useProgram("heatmap",ke),rt=ce.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),st=ce.getCircleRadiusCorrection();Le.draw(le,ue.TRIANGLES,Bt.disabled,me,ye,ai.backCCW,fh(Oe,ce.zoom,ne.paint.get("heatmap-intensity"),st),null,rt,ne.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,ne.paint,ce.zoom,ke)}le.viewport.set([0,0,X.width,X.height])})(x,T,C,k):x.renderPass==="translucent"&&(function(X,ae){const ne=X.context,re=ne.gl;ne.setColorMode(X.colorModeForRenderPass());const le=ae.heatmapFbos.get(l.c3);le&&(ne.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,le.colorAttachment.get()),ne.activeTexture.set(re.TEXTURE1),en(ne,ae).bind(re.LINEAR,re.CLAMP_TO_EDGE),X.useProgram("heatmapTexture").draw(ne,re.TRIANGLES,Bt.disabled,Qt.disabled,X.colorModeForRenderPass(),ai.disabled,_d(X,ae,0,1),null,null,ae.id,X.viewportBuffer,X.quadTriangleIndexBuffer,X.viewportSegments,ae.paint,X.transform.zoom))})(x,C)})(e,r,c,f,m):l.cf(c)?(function(x,T,C,k,L){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=L,N=C.paint.get("line-opacity"),q=C.paint.get("line-width");if(N.constantOr(1)===0||q.constantOr(1)===0)return;const X=x.getDepthModeForSublayer(0,Bt.ReadOnly),ae=x.colorModeForRenderPass(),ne=C.paint.get("line-dasharray"),re=ne.constantOr(1),le=C.paint.get("line-pattern"),ue=le.constantOr(1),ce=C.paint.get("line-gradient"),me=C.getCrossfadeParameters();let ye;ye=ue?"linePattern":re&&ce?"lineGradientSDF":re?"lineSDF":ce?"lineGradient":"line";const he=x.context,Se=he.gl,Oe=x.transform;let Re=!0;for(const ke of k){const Le=T.getTile(ke);if(ue&&!Le.patternsLoaded())continue;const rt=Le.getBucket(C);if(!rt)continue;const st=rt.programConfigurations.get(C.id),Qe=x.context.program.get(),wt=x.useProgram(ye,st),Ut=Re||wt.program!==Qe,pi=x.style.map.terrain&&x.style.map.terrain.getTerrainData(ke),Ai=le.constantOr(null),Ci=ne&&ne.constantOr(null);if(Ai&&Le.imageAtlas){const nn=Le.imageAtlas,va=nn.patternPositions[Ai.to.toString()],xa=nn.patternPositions[Ai.from.toString()];va&&xa&&st.setConstantPatternPositions(va,xa)}else if(Ci){const nn=C.layout.get("line-cap")==="round",va=x.lineAtlas.getDash(Ci.to,nn),xa=x.lineAtlas.getDash(Ci.from,nn);st.setConstantDashPositions(va,xa)}const Yi=Oe.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Ui=Oe.getPixelScale();let ni;ue?(ni=lo(x,Le,C,Ui,me),cs(he,Se,Le,st,me)):re&&ce?(ni=vu(x,Le,C,Ui,me,rt.lineClipsArray.length),Eh(x,T,he,Se,C,rt,ke,st,me)):re?(ni=mh(x,Le,C,Ui,me),Ln(x,he,Se,st,Ut,me)):ce?(ni=bc(x,Le,C,Ui,rt.lineClipsArray.length),Ds(x,T,he,Se,C,rt,ke)):ni=xc(x,Le,C,Ui);const ra=x.stencilModeForClipping(ke);wt.draw(he,Se.TRIANGLES,X,ra,ae,ai.disabled,ni,pi,Yi,C.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,C.paint,x.transform.zoom,st,rt.layoutVertexBuffer2),Re=!1}})(e,r,c,f,m):l.cg(c)?(function(x,T,C,k,L){const j=C.paint.get("fill-color"),N=C.paint.get("fill-opacity");if(N.constantOr(1)===0)return;const{isRenderingToTexture:q}=L,X=x.colorModeForRenderPass(),ae=C.paint.get("fill-pattern"),ne=x.opaquePassEnabledForLayer()&&!ae.constantOr(1)&&j.constantOr(l.bf.transparent).a===1&&N.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===ne){const re=x.getDepthModeForSublayer(1,x.renderPass==="opaque"?Bt.ReadWrite:Bt.ReadOnly);jl(x,T,C,k,re,X,!1,q)}if(x.renderPass==="translucent"&&C.paint.get("fill-antialias")){const re=x.getDepthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Bt.ReadOnly);jl(x,T,C,k,re,X,!0,q)}})(e,r,c,f,m):l.ch(c)?(function(x,T,C,k,L){const j=C.paint.get("fill-extrusion-opacity");if(j===0)return;const{isRenderingToTexture:N}=L;if(x.renderPass==="translucent"){const q=new Bt(x.context.gl.LEQUAL,Bt.ReadWrite,x.depthRangeFor3D);if(j!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))Ic(x,T,C,k,q,Qt.disabled,Ii.disabled,N),Ic(x,T,C,k,q,x.stencilModeFor3D(),x.colorModeForRenderPass(),N);else{const X=x.colorModeForRenderPass();Ic(x,T,C,k,q,Qt.disabled,X,N)}}})(e,r,c,f,m):l.ci(c)?(function(x,T,C,k,L){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=L,N=x.context,q=x.style.projection.useSubdivision,X=x.getDepthModeForSublayer(0,Bt.ReadOnly),ae=x.colorModeForRenderPass();if(x.renderPass==="offscreen")(function(ne,re,le,ue,ce,me,ye){const he=ne.context,Se=he.gl;for(const Oe of le){const Re=re.getTile(Oe),ke=Re.dem;if(!ke||!ke.data||!Re.needsHillshadePrepare)continue;const Le=ke.dim,rt=ke.stride,st=ke.getPixels();if(he.activeTexture.set(Se.TEXTURE1),he.pixelStoreUnpackPremultiplyAlpha.set(!1),Re.demTexture=Re.demTexture||ne.getTileTexture(rt),Re.demTexture){const wt=Re.demTexture;wt.update(st,{premultiply:!1}),wt.bind(Se.NEAREST,Se.CLAMP_TO_EDGE)}else Re.demTexture=new l.T(he,st,Se.RGBA,{premultiply:!1}),Re.demTexture.bind(Se.NEAREST,Se.CLAMP_TO_EDGE);he.activeTexture.set(Se.TEXTURE0);let Qe=Re.fbo;if(!Qe){const wt=new l.T(he,{width:Le,height:Le,data:null},Se.RGBA);wt.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),Qe=Re.fbo=he.createFramebuffer(Le,Le,!0,!1),Qe.colorAttachment.set(wt.texture)}he.bindFramebuffer.set(Qe.framebuffer),he.viewport.set([0,0,Le,Le]),ne.useProgram("hillshadePrepare").draw(he,Se.TRIANGLES,ce,me,ye,ai.disabled,yu(Re.tileID,ke),null,null,ue.id,ne.rasterBoundsBuffer,ne.quadTriangleIndexBuffer,ne.rasterBoundsSegments),Re.needsHillshadePrepare=!1}})(x,T,k,C,X,Qt.disabled,ae),N.viewport.set([0,0,x.width,x.height]);else if(x.renderPass==="translucent")if(q){const[ne,re,le]=x.stencilConfigForOverlapTwoPass(k);Ra(x,T,C,le,ne,X,ae,!1,j),Ra(x,T,C,le,re,X,ae,!0,j)}else{const[ne,re]=x.getStencilConfigForOverlapAndUpdateStencilID(k);Ra(x,T,C,re,ne,X,ae,!1,j)}})(e,r,c,f,m):l.cj(c)?(function(x,T,C,k,L){if(x.renderPass!=="translucent"||!k.length)return;const{isRenderingToTexture:j}=L,N=x.style.projection.useSubdivision,q=x.getDepthModeForSublayer(0,Bt.ReadOnly),X=x.colorModeForRenderPass();if(N){const[ae,ne,re]=x.stencilConfigForOverlapTwoPass(k);ki(x,T,C,re,ae,q,X,!1,j),ki(x,T,C,re,ne,q,X,!0,j)}else{const[ae,ne]=x.getStencilConfigForOverlapAndUpdateStencilID(k);ki(x,T,C,ne,ae,q,X,!1,j)}})(e,r,c,f,m):l.bK(c)?(function(x,T,C,k,L){if(x.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:j}=L,N=T.getSource(),q=x.style.projection.useSubdivision;if(N instanceof wn)Or(x,T,C,k,null,!1,!1,N.tileCoords,N.flippedWindingOrder,j);else if(q){const[X,ae,ne]=x.stencilConfigForOverlapTwoPass(k);Or(x,T,C,ne,X,!1,!0,ci,!1,j),Or(x,T,C,ne,ae,!0,!0,ci,!1,j)}else{const[X,ae]=x.getStencilConfigForOverlapAndUpdateStencilID(k);Or(x,T,C,ae,X,!1,!0,ci,!1,j)}})(e,r,c,f,m):l.ck(c)?(function(x,T,C,k,L){const j=C.paint.get("background-color"),N=C.paint.get("background-opacity");if(N===0)return;const{isRenderingToTexture:q}=L,X=x.context,ae=X.gl,ne=x.style.projection,re=x.transform,le=re.tileSize,ue=C.paint.get("background-pattern");if(x.isPatternMissing(ue))return;const ce=!ue&&j.a===1&&N===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==ce)return;const me=Qt.disabled,ye=x.getDepthModeForSublayer(0,ce==="opaque"?Bt.ReadWrite:Bt.ReadOnly),he=x.colorModeForRenderPass(),Se=x.useProgram(ue?"backgroundPattern":"background"),Oe=k||ii(re,{tileSize:le,terrain:x.style.map.terrain});ue&&(X.activeTexture.set(ae.TEXTURE0),x.imageManager.bind(x.context));const Re=C.getCrossfadeParameters();for(const ke of Oe){const Le=re.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),rt=ue?yh(N,x,ue,{tileID:ke,tileSize:le},Re):bd(N,j),st=x.style.map.terrain&&x.style.map.terrain.getTerrainData(ke),Qe=ne.getMeshFromTileID(X,ke.canonical,!1,!0,"raster");Se.draw(X,ae.TRIANGLES,ye,me,he,ai.backCCW,rt,st,Le,C.id,Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)}})(e,0,c,f,m):l.cl(c)&&(function(x,T,C,k){const{isRenderingGlobe:L}=k,j=x.context,N=C.implementation,q=x.style.projection,X=x.transform,ae=X.getProjectionDataForCustomLayer(L),ne={farZ:X.farZ,nearZ:X.nearZ,fov:X.fov*Math.PI/180,modelViewProjectionMatrix:X.modelViewProjectionMatrix,projectionMatrix:X.projectionMatrix,shaderData:{variantName:q.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${q.shaderPreludeCode.vertexSource}`,define:q.shaderDefine},defaultProjectionData:ae},re=N.renderingMode?N.renderingMode:"2d";if(x.renderPass==="offscreen"){const le=N.prerender;le&&(x.setCustomLayerDefaults(),j.setColorMode(x.colorModeForRenderPass()),le.call(N,j.gl,ne),j.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),j.setColorMode(x.colorModeForRenderPass()),j.setStencilMode(Qt.disabled);const le=re==="3d"?x.getDepthModeFor3D():x.getDepthModeForSublayer(0,Bt.ReadOnly);j.setDepthMode(le),N.render(j.gl,ne),j.setDirty(),x.setBaseState(),j.bindFramebuffer.set(null)}})(e,0,c,m))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!r||!c}useProgram(e,r,c=!1,f=[]){this.cache=this.cache||{};const m=!!this.style.map.terrain,x=this.style.projection,T=c?pn.projectionMercator:x.shaderPreludeCode,C=c?Fo:x.shaderDefine,k=e+(r?r.cacheKey:"")+`/${c?Jt:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(m?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[k]||(this.cache[k]=new hh(this.context,pn[e],r,co[e],this._showOverdrawInspector,m,T,C,f)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function Nr(p,e){let r,c=!1,f=null,m=null;const x=()=>{f=null,c&&(p.apply(m,r),f=setTimeout(x,e),c=!1)};return(...T)=>(c=!0,m=this,r=T,f||x(),f)}class Rc{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map((f=>f.split("="))).forEach((f=>{f[0]===this._hashName&&(c=f)})),(c&&c[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:c,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const c=r.join("/");let f=c;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${c}`);let m=window.location.hash.replace(f,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let x=window.location.href.replace(/(#.+)?$/,m);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=Nr(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,f),x=Math.round(r.lng*m)/m,T=Math.round(r.lat*m)/m,C=this._map.getBearing(),k=this._map.getPitch();let L="";if(L+=e?`/${x}/${T}/${c}`:`${c}/${T}/${x}`,(C||k)&&(L+="/"+Math.round(10*C)/10),k&&(L+=`/${Math.round(k)}`),this._hashName){const j=this._hashName;let N=!1;const q=window.location.hash.slice(1).split("&").map((X=>{const ae=X.split("=")[0];return ae===j?(N=!0,`${ae}=${L}`):X})).filter((X=>X));return N||q.push(`${j}=${L}`),`#${q.join("&")}`}return`#${L}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new l.S(+e[2],+e[1])}catch{return!1}const r=+e[0],c=+(e[3]||0),f=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&c>=-180&&c<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const mo={linearity:.3,easing:l.cm(0,0,.3,1)},vr=l.e({deceleration:2500,maxSpeed:1400},mo),Dc=l.e({deceleration:20,maxSpeed:1400},mo),go=l.e({deceleration:1e3,maxSpeed:360},mo),tn=l.e({deceleration:1e3,maxSpeed:90},mo),kc=l.e({deceleration:1e3,maxSpeed:360},mo);class Ah{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:W.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=W.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)r.zoom+=m.zoomDelta||0,r.bearing+=m.bearingDelta||0,r.pitch+=m.pitchDelta||0,r.roll+=m.rollDelta||0,m.panDelta&&r.pan._add(m.panDelta),m.around&&(r.around=m.around),m.pinchAround&&(r.pinchAround=m.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(r.pan.mag()){const m=Fl(r.pan.mag(),c,l.e({},vr,e||{})),x=r.pan.mult(m.amount/r.pan.mag()),T=this._map.cameraHelper.handlePanInertia(x,this._map.transform);f.center=T.easingCenter,f.offset=T.easingOffset,Gl(f,m)}if(r.zoom){const m=Fl(r.zoom,c,Dc);f.zoom=this._map.transform.zoom+m.amount,Gl(f,m)}if(r.bearing){const m=Fl(r.bearing,c,go);f.bearing=this._map.transform.bearing+l.ah(m.amount,-179,179),Gl(f,m)}if(r.pitch){const m=Fl(r.pitch,c,tn);f.pitch=this._map.transform.pitch+m.amount,Gl(f,m)}if(r.roll){const m=Fl(r.roll,c,kc);f.roll=this._map.transform.roll+l.ah(m.amount,-179,179),Gl(f,m)}if(f.zoom||f.bearing){const m=r.pinchAround===void 0?r.around:r.pinchAround;f.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),l.e(f,{noMoveStart:!0})}}function Gl(p,e){(!p.duration||p.duration<e.duration)&&(p.duration=e.duration,p.easing=e.easing)}function Fl(p,e,r){const{maxSpeed:c,linearity:f,deceleration:m}=r,x=l.ah(p*f/(e/1e3),-c,c),T=Math.abs(x)/(m*f);return{easing:r.easing,duration:1e3*T,amount:x*(T/2)}}class Bn extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,c,f={}){c=c instanceof MouseEvent?c:new MouseEvent(e,c);const m=K.mousePos(r.getCanvas(),c),x=r.unproject(m);super(e,l.e({point:m,lngLat:x,originalEvent:c},f)),this._defaultPrevented=!1,this.target=r}}class $i extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,c){const f=e==="touchend"?c.changedTouches:c.touches,m=K.touchPos(r.getCanvasContainer(),f),x=m.map((C=>r.unproject(C))),T=m.reduce(((C,k,L,j)=>C.add(k.div(j.length))),new l.P(0,0));super(e,{points:m,point:T,lngLats:x,lngLat:r.unproject(T),originalEvent:c}),this._defaultPrevented=!1}}class Lc extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class gn{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Lc(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Bn(e.type,this._map,e))}mouseup(e){this._map.fire(new Bn(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Bn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Bn(e.type,this._map,e))}mouseover(e){this._map.fire(new Bn(e.type,this._map,e))}mouseout(e){this._map.fire(new Bn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new $i(e.type,this._map,e))}touchmove(e){this._map.fire(new $i(e.type,this._map,e))}touchend(e){this._map.fire(new $i(e.type,this._map,e))}touchcancel(e){this._map.fire(new $i(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pn{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Bn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Bn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Bn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _o{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(l.P.convert(e),this._map.terrain)}}class cn{constructor(e,r){this._map=e,this._tr=new _o(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(K.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const c=r;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=c,this._box||(this._box=K.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(f.x,c.x),x=Math.max(f.x,c.x),T=Math.min(f.y,c.y),C=Math.max(f.y,c.y);K.setTransform(this._box,`translate(${m}px,${T}px)`),this._box.style.width=x-m+"px",this._box.style.height=C-T+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const c=this._startPos,f=r;if(this.reset(),K.suppressClick(),c.x!==f.x||c.y!==f.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(c,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(K.remove(this._box),this._box=null),K.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new l.l(e,{originalEvent:r}))}}function tr(p,e){if(p.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${e.length}`);const r={};for(let c=0;c<p.length;c++)r[p[c].identifier]=e[c];return r}class bf{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=(function(f){const m=new l.P(0,0);for(const x of f)m._add(x);return m.div(f.length)})(r),this.touches=tr(c,r)))}touchmove(e,r,c){if(this.aborted||!this.centroid)return;const f=tr(c,r);for(const m in this.touches){const x=f[m];(!x||x.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,r,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Cu{constructor(e){this.singleTap=new bf(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,c){this.singleTap.touchstart(e,r,c)}touchmove(e,r,c){this.singleTap.touchmove(e,r,c)}touchend(e,r,c){const f=this.singleTap.touchend(e,r,c);if(f){const m=e.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(f)<30;if(m&&x||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class wf{constructor(e){this._tr=new _o(e),this._zoomIn=new Cu({numTouches:1,numTaps:2}),this._zoomOut=new Cu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,c){this._zoomIn.touchstart(e,r,c),this._zoomOut.touchstart(e,r,c)}touchmove(e,r,c){this._zoomIn.touchmove(e,r,c),this._zoomOut.touchmove(e,r,c)}touchend(e,r,c){const f=this._zoomIn.touchend(e,r,c),m=this._zoomOut.touchend(e,r,c),x=this._tr;return f?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(f)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ul{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const f=Array.isArray(r)?r[0]:r;return!this._moved&&f.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(c,f))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&K.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const yo=0,nl=2,xr={[yo]:1,[nl]:2};class ft{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=K.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(r,c){const f=xr[c];return r.buttons===void 0||(r.buttons&f)!==f})(e,this._eventButton)}isValidEndEvent(e){return K.mouseButton(e)===this._eventButton}}class rl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Oc{constructor(e=new ft({checkCorrectEvent:()=>!0}),r=new rl){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,c){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?c(e):void 0}startMove(e){this._executeRelevantHandler(e,(r=>this.mouseMoveStateManager.startMove(r)),(r=>this.oneFingerTouchMoveStateManager.startMove(r)))}endMove(e){this._executeRelevantHandler(e,(r=>this.mouseMoveStateManager.endMove(r)),(r=>this.oneFingerTouchMoveStateManager.endMove(r)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(r=>this.mouseMoveStateManager.isValidStartEvent(r)),(r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(r=>this.mouseMoveStateManager.isValidMoveEvent(r)),(r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(r=>this.mouseMoveStateManager.isValidEndEvent(r)),(r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r)))}}const vo=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=e=>{e.preventDefault()}};class xo{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,c){return this._calculateTransform(e,r,c)}touchmove(e,r,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,r,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,c){this._calculateTransform(e,r,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,c){c.length>0&&(this._active=!0);const f=tr(c,r),m=new l.P(0,0),x=new l.P(0,0);let T=0;for(const k in f){const L=f[k],j=this._touches[k];j&&(m._add(L),x._add(L.sub(j)),T++,f[k]=L)}if(this._touches=f,this._shouldBePrevented(T)||!x.mag())return;const C=x.div(T);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(T),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,c){if(!this._firstTwoTouches)return;e.preventDefault();const[f,m]=this._firstTwoTouches,x=sl(c,r,f),T=sl(c,r,m);if(!x||!T)return;const C=this._aroundCenter?null:x.add(T).div(2);return this._move([x,T],C,e)}touchend(e,r,c){if(!this._firstTwoTouches)return;const[f,m]=this._firstTwoTouches,x=sl(c,r,f),T=sl(c,r,m);x&&T||(this._active&&K.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function sl(p,e,r){for(let c=0;c<p.length;c++)if(p[c].identifier===r)return e[c]}function Yt(p,e){return Math.log(p/e)/Math.LN2}class ds extends bo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Yt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yt(this._distance,c),pinchAround:r}}}function Ch(p,e){return 180*p.angleWith(e)/Math.PI}class Bc extends bo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,c){const f=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ch(this._vector,f),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,c=Ch(e,this._startVector);return Math.abs(c)<r}}function wo(p){return Math.abs(p.y)>Math.abs(p.x)}class Vl extends bo{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,c){super.touchstart(e,r,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,wo(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,m,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(f.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,c){if(this._valid!==void 0)return this._valid;const f=e.mag()>=2,m=r.mag()>=2;if(!f&&!m)return;if(!f||!m)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const x=e.y>0==r.y>0;return wo(e)&&wo(r)&&x}}const Nc={panStep:100,bearingStep:15,pitchStep:10};class So{constructor(e){this._tr=new _o(e);const r=Nc;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,c=0,f=0,m=0,x=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?f=1:(e.preventDefault(),x=-1);break;case 40:e.shiftKey?f=-1:(e.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(c=0,f=0),{cameraAnimation:T=>{const C=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:jc,zoom:r?Math.round(C.zoom)+r*(e.shiftKey?2:1):C.zoom,bearing:C.bearing+c*this._bearingStep,pitch:C.pitch+f*this._pitchStep,offset:[-m*this._panStep,-x*this._panStep],center:C.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function jc(p){return p*(2-p)}const Ph=4.000244140625,Mo=1/450;class zh{constructor(e,r){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new _o(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Mo}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=W.now(),f=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,r!==0&&r%Ph==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(f*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=K.mousePos(this._map.getCanvas(),e),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(l.S.convert(c.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const T=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=T),typeof this._targetZoom=="number"&&(this._targetZoom+=T)}if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>Ph?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&C!==0&&(C=1/C);const k=typeof this._targetZoom!="number"?e.scale:l.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),l.ak(k*C)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,c=this._startZoom,f=this._easing;let m,x=!1;if(this._type==="wheel"&&c&&f){const T=W.now()-this._lastWheelEventTime,C=Math.min((T+5)/200,1),k=f(C);m=l.C.number(c,r,k),C<1?this._frameId||(this._frameId=!0):x=!0}else m=r,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!x,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=l.co;if(this._prevEase){const c=this._prevEase,f=(W.now()-c.start)/c.duration,m=c.easing(f+.01)-c.easing(f),x=.27/Math.sqrt(m*m+1e-4)*.01,T=Math.sqrt(.0729-x*x);r=l.cm(x,T,.25,1)}return this._prevEase={start:W.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ns{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fs{constructor(e){this._tr=new _o(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Li{constructor(){this._tap=new Cu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,c){if(!this._swipePoint)if(this._tapTime){const f=r[0],m=e.timeStamp-this._tapTime<500,x=this._tapPoint.dist(f)<30;m&&x?c.length>0&&(this._swipePoint=f,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,r,c)}touchmove(e,r,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const f=r[0],m=f.y-this._swipePoint.y;return this._swipePoint=f,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,r,c)}touchend(e,r,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const f=this._tap.touchend(e,r,c);f&&(this._tapTime=e.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class js{constructor(e,r,c){this._el=e,this._mousePan=r,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class br{constructor(e,r,c,f){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=c,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class To{constructor(e,r,c,f){this._el=e,this._touchZoom=r,this._touchRotate=c,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Gc{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=K.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=r,this._container.appendChild(f);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=c,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(K.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const ol=p=>p.zoom||p.drag||p.roll||p.pitch||p.rotate;class ql extends l.l{}function ll(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta||p.rollDelta}class jr{constructor(e,r){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,m)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=f.type==="renderFrame"?void 0:f,T={needsRenderFrame:!1},C={},k={};for(const{handlerName:N,handler:q,allowed:X}of this._handlers){if(!q.isEnabled())continue;let ae;if(this._blockedByActive(k,X,N))q.reset();else if(q[m||f.type]){if(l.cp(f,m||f.type)){const ne=K.mousePos(this._map.getCanvas(),f);ae=q[m||f.type](f,ne)}else if(l.cq(f,m||f.type)){const ne=this._getMapTouches(f.touches),re=K.touchPos(this._map.getCanvas(),ne);ae=q[m||f.type](f,re,ne)}else l.cr(m||f.type)||(ae=q[m||f.type](f));this.mergeHandlerResult(T,C,ae,N,x),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()}(ae||q.isActive())&&(k[N]=q)}const L={};for(const N in this._previousActiveHandlers)k[N]||(L[N]=x);this._previousActiveHandlers=k,(Object.keys(L).length||ll(T))&&(this._changes.push([T,C,L]),this._triggerRenderFrame()),(Object.keys(k).length||ll(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=T;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ah(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,m,x]of this._listeners)K.addEventListener(f,m,f===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[e,r,c]of this._listeners)K.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const r=this._map,c=r.getCanvasContainer();this._add("mapEvent",new gn(r,e));const f=r.boxZoom=new cn(r,e);this._add("boxZoom",f),e.interactive&&e.boxZoom&&f.enable();const m=r.cooperativeGestures=new Gc(r,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const x=new wf(r),T=new fs(r);r.doubleClickZoom=new Ns(T,x),this._add("tapZoom",x),this._add("clickZoom",T),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const C=new Li;this._add("tapDragZoom",C);const k=r.touchPitch=new Vl(r);this._add("touchPitch",k),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const L=()=>r.project(r.getCenter()),j=(function({enable:ce,clickTolerance:me,aroundCenter:ye=!0,minPixelCenterThreshold:he=100,rotateDegreesPerPixelMoved:Se=.8},Oe){const Re=new ft({checkCorrectEvent:ke=>K.mouseButton(ke)===0&&ke.ctrlKey||K.mouseButton(ke)===2&&!ke.ctrlKey});return new Ul({clickTolerance:me,move:(ke,Le)=>{const rt=Oe();if(ye&&Math.abs(rt.y-ke.y)>he)return{bearingDelta:l.cn(new l.P(ke.x,Le.y),Le,rt)};let st=(Le.x-ke.x)*Se;return ye&&Le.y<rt.y&&(st=-st),{bearingDelta:st}},moveStateManager:Re,enable:ce,assignEvents:vo})})(e,L),N=(function({enable:ce,clickTolerance:me,pitchDegreesPerPixelMoved:ye=-.5}){const he=new ft({checkCorrectEvent:Se=>K.mouseButton(Se)===0&&Se.ctrlKey||K.mouseButton(Se)===2});return new Ul({clickTolerance:me,move:(Se,Oe)=>({pitchDelta:(Oe.y-Se.y)*ye}),moveStateManager:he,enable:ce,assignEvents:vo})})(e),q=(function({enable:ce,clickTolerance:me,rollDegreesPerPixelMoved:ye=.3},he){const Se=new ft({checkCorrectEvent:Oe=>K.mouseButton(Oe)===2&&Oe.ctrlKey});return new Ul({clickTolerance:me,move:(Oe,Re)=>{const ke=he();let Le=(Re.x-Oe.x)*ye;return Re.y<ke.y&&(Le=-Le),{rollDelta:Le}},moveStateManager:Se,enable:ce,assignEvents:vo})})(e,L);r.dragRotate=new br(e,j,N,q),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",N,["mouseRotate","mouseRoll"]),this._add("mouseRoll",q,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const X=(function({enable:ce,clickTolerance:me}){const ye=new ft({checkCorrectEvent:he=>K.mouseButton(he)===0&&!he.ctrlKey});return new Ul({clickTolerance:me,move:(he,Se)=>({around:Se,panDelta:Se.sub(he)}),activateOnStart:!0,moveStateManager:ye,enable:ce,assignEvents:vo})})(e),ae=new xo(e,r);r.dragPan=new js(c,X,ae),this._add("mousePan",X),this._add("touchPan",ae,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const ne=new Bc,re=new ds;r.touchZoomRotate=new To(c,re,ne,C),this._add("touchRotate",ne,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const le=r.scrollZoom=new zh(r,(()=>this._triggerRenderFrame()));this._add("scrollZoom",le,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const ue=r.keyboard=new So(r);this._add("keyboard",ue),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new Pn(r))}_add(e,r,c){this._handlers.push({handlerName:e,handler:r,allowed:c}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ol(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,c){for(const f in e)if(f!==c&&(!r||r.indexOf(f)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const c of e)this._el.contains(c.target)&&r.push(c);return r}mergeHandlerResult(e,r,c,f,m){if(!c)return;l.e(e,c);const x={handlerName:f,originalEvent:c.originalEvent||m};c.zoomDelta!==void 0&&(r.zoom=x),c.panDelta!==void 0&&(r.drag=x),c.rollDelta!==void 0&&(r.roll=x),c.pitchDelta!==void 0&&(r.pitch=x),c.bearingDelta!==void 0&&(r.rotate=x)}_applyChanges(){const e={},r={},c={};for(const[f,m,x]of this._changes)f.panDelta&&(e.panDelta=(e.panDelta||new l.P(0,0))._add(f.panDelta)),f.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(e.rollDelta=(e.rollDelta||0)+f.rollDelta),f.around!==void 0&&(e.around=f.around),f.pinchAround!==void 0&&(e.pinchAround=f.pinchAround),f.noInertia&&(e.noInertia=f.noInertia),l.e(r,m),l.e(c,x);this._updateMapTransform(e,r,c),this._changes=[]}_updateMapTransform(e,r,c){const f=this._map,m=f._getTransformForUpdate(),x=f.terrain;if(!(ll(e)||x&&this._terrainMovement))return this._fireEvents(r,c,!0);f._stop(!0);let{panDelta:T,zoomDelta:C,bearingDelta:k,pitchDelta:L,rollDelta:j,around:N,pinchAround:q}=e;q!==void 0&&(N=q),N=N||f.transform.centerPoint,x&&!m.isPointOnMapSurface(N)&&(N=m.centerPoint);const X={panDelta:T,zoomDelta:C,rollDelta:j,pitchDelta:L,bearingDelta:k,around:N};this._map.cameraHelper.useGlobeControls&&!m.isPointOnMapSurface(N)&&(N=m.centerPoint);const ae=N.distSqr(m.centerPoint)<.01?m.center:m.screenPointToLocation(T?N.sub(T):N);this._handleMapControls({terrain:x,tr:m,deltasForHelper:X,preZoomAroundLoc:ae,combinedEventsInProgress:r,panDelta:T}),f._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,c,!0)}_handleMapControls({terrain:e,tr:r,deltasForHelper:c,preZoomAroundLoc:f,combinedEventsInProgress:m,panDelta:x}){const T=this._map.cameraHelper;if(T.handleMapControlsRollPitchBearingZoom(c,r),e)return T.useGlobeControls?(this._terrainMovement||!m.drag&&!m.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void T.handleMapControlsPan(c,r,f)):this._terrainMovement||!m.drag&&!m.zoom?void(m.drag&&this._terrainMovement&&x?r.setCenter(r.screenPointToLocation(r.centerPoint.sub(x))):T.handleMapControlsPan(c,r,f)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void T.handleMapControlsPan(c,r,f));T.handleMapControlsPan(c,r,f)}_fireEvents(e,r,c){const f=ol(this._eventsInProgress),m=ol(e),x={};for(const j in e){const{originalEvent:N}=e[j];this._eventsInProgress[j]||(x[`${j}start`]=N),this._eventsInProgress[j]=e[j]}!f&&m&&this._fireEvent("movestart",m.originalEvent);for(const j in x)this._fireEvent(j,x[j]);m&&this._fireEvent("move",m.originalEvent);for(const j in e){const{originalEvent:N}=e[j];this._fireEvent(j,N)}const T={};let C;for(const j in this._eventsInProgress){const{handlerName:N,originalEvent:q}=this._eventsInProgress[j];this._handlersById[N].isActive()||(delete this._eventsInProgress[j],C=r[N]||q,T[`${j}end`]=C)}for(const j in T)this._fireEvent(j,T[j]);const k=ol(this._eventsInProgress),L=(f||m)&&!k;if(L&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const j=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&j.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(j)}if(c&&L){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=q=>q!==0&&-this._bearingSnap<q&&q<this._bearingSnap;!j||!j.essential&&W.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:C})),N(this._map.getBearing())&&this._map.resetNorth()):(N(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new l.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new ql("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Fc extends l.E{constructor(e,r,c){super(),this._renderFrameCallback=()=>{const f=Math.min((W.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=c.bearingSnap,this.cameraHelper=r,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new l.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,c){return e=l.P.convert(e).mult(-1),this.panTo(this.transform.center,l.e({offset:e},r),c)}panTo(e,r,c){return this.easeTo(l.e({center:e},r),c)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,c){return this.easeTo(l.e({zoom:e},r),c)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new l.l("movestart",r)).fire(new l.l("move",r)).fire(new l.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,c){return this.easeTo(l.e({bearing:e},r),c)}resetNorth(e,r){return this.rotateTo(0,l.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=fa.convert(e).adjustAntiMeridian();const c=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,r)}_cameraForBoxAndBearing(e,r,c,f){const m={top:0,bottom:0,right:0,left:0};if(typeof(f=l.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const k=f.padding;f.padding={top:k,bottom:k,right:k,left:k}}const x=l.e(m,f.padding);f.padding=x;const T=this.transform,C=new fa(e,r);return this.cameraHelper.cameraForBoxAndBearing(f,x,C,c,T)}fitBounds(e,r,c){return this._fitInternal(this.cameraForBounds(e,r),r,c)}fitScreenCoordinates(e,r,c,f,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(e)),this.transform.screenPointToLocation(l.P.convert(r)),c,f),f,m)}_fitInternal(e,r,c){return e?(delete(r=l.e(e,r)).padding,r.linear?this.easeTo(r,c):this.flyTo(r,c)):this}jumpTo(e,r){this.stop();const c=this._getTransformForUpdate();let f=!1,m=!1,x=!1;const T=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,e);const C=c.zoom!==T;return"elevation"in e&&c.elevation!==+e.elevation&&c.setElevation(+e.elevation),"bearing"in e&&c.bearing!==+e.bearing&&(f=!0,c.setBearing(+e.bearing)),"pitch"in e&&c.pitch!==+e.pitch&&(m=!0,c.setPitch(+e.pitch)),"roll"in e&&c.roll!==+e.roll&&(x=!0,c.setRoll(+e.roll)),e.padding==null||c.isPaddingEqual(e.padding)||c.setPadding(e.padding),this._applyUpdatedTransform(c),this.fire(new l.l("movestart",r)).fire(new l.l("move",r)),C&&this.fire(new l.l("zoomstart",r)).fire(new l.l("zoom",r)).fire(new l.l("zoomend",r)),f&&this.fire(new l.l("rotatestart",r)).fire(new l.l("rotate",r)).fire(new l.l("rotateend",r)),m&&this.fire(new l.l("pitchstart",r)).fire(new l.l("pitch",r)).fire(new l.l("pitchend",r)),x&&this.fire(new l.l("rollstart",r)).fire(new l.l("roll",r)).fire(new l.l("rollend",r)),this.fire(new l.l("moveend",r))}calculateCameraOptionsFromTo(e,r,c,f=0){const m=l.a1.fromLngLat(e,r),x=l.a1.fromLngLat(c,f),T=x.x-m.x,C=x.y-m.y,k=x.z-m.z,L=Math.hypot(T,C,k);if(L===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot(T,C),N=l.ak(this.transform.cameraToCenterDistance/L/this.transform.tileSize),q=180*Math.atan2(T,-C)/Math.PI;let X=180*Math.acos(j/L)/Math.PI;return X=k<0?90-X:90+X,{center:x.toLngLat(),elevation:f,zoom:N,pitch:X,bearing:q}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,c,f,m){const x=this.transform.calculateCenterFromCameraLngLatAlt(e,r,c,f);return{center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:c,pitch:f,roll:m}}easeTo(e,r){this._stop(!1,e.easeId),((e=l.e({offset:[0,0],duration:500,easing:l.co},e)).animate===!1||!e.essential&&W.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),f=this.getBearing(),m=c.pitch,x=c.roll,T="bearing"in e?this._normalizeBearing(e.bearing,f):f,C="pitch"in e?+e.pitch:m,k="roll"in e?this._normalizeBearing(e.roll,x):x,L="padding"in e?e.padding:c.padding,j=l.P.convert(e.offset);let N,q;e.around&&(N=l.S.convert(e.around),q=c.locationToScreenPoint(N));const X={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ae=this.cameraHelper.handleEaseTo(c,{bearing:T,pitch:C,roll:k,padding:L,around:N,aroundPoint:q,offsetAsPoint:j,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||f!==T,this._pitching=this._pitching||C!==m,this._rolling=this._rolling||k!==x,this._padding=!c.isPaddingEqual(L),this._zooming=this._zooming||ae.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,X),this.terrain&&this._prepareElevation(ae.elevationCenter),this._ease((ne=>{ae.easeFunc(ne),this.terrain&&!e.freezeElevation&&this._updateElevation(ne),this._applyUpdatedTransform(c),this._fireMoveEvents(r)}),(ne=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,ne)}),e),this}_prepareEase(e,r,c={}){this._moving=!0,r||c.moving||this.fire(new l.l("movestart",e)),this._zooming&&!c.zooming&&this.fire(new l.l("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new l.l("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new l.l("pitchstart",e)),this._rolling&&!c.rolling&&this.fire(new l.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(r-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(l.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),c=e.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(c<f){const m=this.calculateCameraOptionsFromTo(r,f,e.center,e.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push((f=>this._elevateCameraIfInsideTerrain(f))),this.transformCameraUpdate&&r.push((f=>this.transformCameraUpdate(f))),!r.length)return;const c=e.clone();for(const f of r){const m=c.clone(),{center:x,zoom:T,roll:C,pitch:k,bearing:L,elevation:j}=f(m);x&&m.setCenter(x),j!==void 0&&m.setElevation(j),T!==void 0&&m.setZoom(T),C!==void 0&&m.setRoll(C),k!==void 0&&m.setPitch(k),L!==void 0&&m.setBearing(L),c.apply(m)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new l.l("move",e)),this._zooming&&this.fire(new l.l("zoom",e)),this._rotating&&this.fire(new l.l("rotate",e)),this._pitching&&this.fire(new l.l("pitch",e)),this._rolling&&this.fire(new l.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const c=this._zooming,f=this._rotating,m=this._pitching,x=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new l.l("zoomend",e)),f&&this.fire(new l.l("rotateend",e)),m&&this.fire(new l.l("pitchend",e)),x&&this.fire(new l.l("rollend",e)),this.fire(new l.l("moveend",e))}flyTo(e,r){if(!e.essential&&W.prefersReducedMotion){const Le=l.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Le,r)}this.stop(),e=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.co},e);const c=this._getTransformForUpdate(),f=c.bearing,m=c.pitch,x=c.roll,T=c.padding,C="bearing"in e?this._normalizeBearing(e.bearing,f):f,k="pitch"in e?+e.pitch:m,L="roll"in e?this._normalizeBearing(e.roll,x):x,j="padding"in e?e.padding:c.padding,N=l.P.convert(e.offset);let q=c.centerPoint.add(N);const X=c.screenPointToLocation(q),ae=this.cameraHelper.handleFlyTo(c,{bearing:C,pitch:k,roll:L,padding:j,locationAtOffset:X,offsetAsPoint:N,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ne=e.curve;const re=Math.max(c.width,c.height),le=re/ae.scaleOfZoom,ue=ae.pixelPathLength;typeof ae.scaleOfMinZoom=="number"&&(ne=Math.sqrt(re/ae.scaleOfMinZoom/ue*2));const ce=ne*ne;function me(Le){const rt=(le*le-re*re+(Le?-1:1)*ce*ce*ue*ue)/(2*(Le?le:re)*ce*ue);return Math.log(Math.sqrt(rt*rt+1)-rt)}function ye(Le){return(Math.exp(Le)-Math.exp(-Le))/2}function he(Le){return(Math.exp(Le)+Math.exp(-Le))/2}const Se=me(!1);let Oe=function(Le){return he(Se)/he(Se+ne*Le)},Re=function(Le){return re*((he(Se)*(ye(rt=Se+ne*Le)/he(rt))-ye(Se))/ce)/ue;var rt},ke=(me(!0)-Se)/ne;if(Math.abs(ue)<2e-6||!isFinite(ke)){if(Math.abs(re-le)<1e-6)return this.easeTo(e,r);const Le=le<re?-1:1;ke=Math.abs(Math.log(le/re))/ne,Re=()=>0,Oe=rt=>Math.exp(Le*ne*rt)}return e.duration="duration"in e?+e.duration:1e3*ke/("screenSpeed"in e?+e.screenSpeed/ne:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=f!==C,this._pitching=k!==m,this._rolling=L!==x,this._padding=!c.isPaddingEqual(j),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(ae.targetCenter),this._ease((Le=>{const rt=Le*ke,st=1/Oe(rt),Qe=Re(rt);this._rotating&&c.setBearing(l.C.number(f,C,Le)),this._pitching&&c.setPitch(l.C.number(m,k,Le)),this._rolling&&c.setRoll(l.C.number(x,L,Le)),this._padding&&(c.interpolatePadding(T,j,Le),q=c.centerPoint.add(N)),ae.easeFunc(Le,st,Qe,q),this.terrain&&!e.freezeElevation&&this._updateElevation(Le),this._applyUpdatedTransform(c),this._fireMoveEvents(r)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,r)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,r,c){c.animate===!1||c.duration===0?(e(1),r()):(this._easeStart=W.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=l.aO(e,-180,180);const c=Math.abs(e-r);return Math.abs(e-360-r)<c&&(e-=360),Math.abs(e+360-r)<c&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(l.S.convert(e),this.transform.tileZoom):null}}const vt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Rt{constructor(e=vt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=K.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=K.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=K.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){K.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,r){const c=this._map._getUIString(`AttributionControl.${r}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((f=>typeof f!="string"?"":f))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const r=this._map.style.sourceCaches;for(const f in r){const m=r[f];if(m.used||m.usedForTerrain){const x=m.getSource();x.attribution&&e.indexOf(x.attribution)<0&&e.push(x.attribution)}}e=e.filter((f=>String(f).trim())),e.sort(((f,m)=>f.length-m.length)),e=e.filter(((f,m)=>{for(let x=m+1;x<e.length;x++)if(e[x].indexOf(f)>=0)return!1;return!0}));const c=e.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,e.length?(this._innerContainer.innerHTML=K.sanitize(c),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class cl{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=K.create("div","maplibregl-ctrl");const r=K.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){K.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Pu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,c=r?this._queue.concat(r):this._queue;for(const f of c)if(f.id===e)return void(f.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const c of r)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Zl=l.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Hi extends l.E{constructor(e){super(),this._lastTilesetChange=W.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const c={};for(const f of ii(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),l.bZ(f.terrainRttPosMatrix32f,0,l.$,l.$,0,0,1),this._tiles[f.key]=new $(f,this.tileSize),this._lastTilesetChange=W.now());for(const f in this._tiles)c[f]||delete this._tiles[f]}freeRtt(e){for(const r in this._tiles){const c=this._tiles[r];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,r){return r?this._getTerrainCoordsForTileRanges(e,r):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const r={};for(const c of this._renderableTilesKeys){const f=this._tiles[c].tileID,m=e.clone(),x=l.ba();if(f.canonical.equals(e.canonical))l.bZ(x,0,l.$,l.$,0,0,1);else if(f.canonical.isChildOf(e.canonical)){const T=f.canonical.z-e.canonical.z,C=f.canonical.x-(f.canonical.x>>T<<T),k=f.canonical.y-(f.canonical.y>>T<<T),L=l.$>>T;l.bZ(x,0,L,L,0,0,1),l.M(x,x,[-C*L,-k*L,0])}else{if(!e.canonical.isChildOf(f.canonical))continue;{const T=e.canonical.z-f.canonical.z,C=e.canonical.x-(e.canonical.x>>T<<T),k=e.canonical.y-(e.canonical.y>>T<<T),L=l.$>>T;l.bZ(x,0,l.$,l.$,0,0,1),l.M(x,x,[C*L,k*L,0]),l.N(x,x,[1/2**T,1/2**T,0])}}m.terrainRttPosMatrix32f=new Float32Array(x),r[c]=m}return r}_getTerrainCoordsForTileRanges(e,r){const c={};for(const f of this._renderableTilesKeys){const m=this._tiles[f].tileID;if(!this._isWithinTileRanges(m,r))continue;const x=e.clone(),T=l.ba();if(m.canonical.z===e.canonical.z){const C=e.canonical.x-m.canonical.x,k=e.canonical.y-m.canonical.y;l.bZ(T,0,l.$,l.$,0,0,1),l.M(T,T,[C*l.$,k*l.$,0])}else if(m.canonical.z>e.canonical.z){const C=m.canonical.z-e.canonical.z,k=m.canonical.x-(m.canonical.x>>C<<C),L=m.canonical.y-(m.canonical.y>>C<<C),j=e.canonical.x-(m.canonical.x>>C),N=e.canonical.y-(m.canonical.y>>C),q=l.$>>C;l.bZ(T,0,q,q,0,0,1),l.M(T,T,[-k*q+j*l.$,-L*q+N*l.$,0])}else{const C=e.canonical.z-m.canonical.z,k=e.canonical.x-(e.canonical.x>>C<<C),L=e.canonical.y-(e.canonical.y>>C<<C),j=(e.canonical.x>>C)-m.canonical.x,N=(e.canonical.y>>C)-m.canonical.y,q=l.$<<C;l.bZ(T,0,q,q,0,0,1),l.M(T,T,[k*l.$+j*q,L*l.$+N*q,0])}x.terrainRttPosMatrix32f=new Float32Array(T),c[f]=x}return c}getSourceTile(e,r){const c=this.sourceCache._source;let f=e.overscaledZ-this.deltaZoom;if(f>c.maxzoom&&(f=c.maxzoom),f<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(f).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&r)for(;f>=c.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(f--).key);return m}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,r){return r[e.canonical.z]&&e.canonical.x>=r[e.canonical.z].minTileX&&e.canonical.x<=r[e.canonical.z].maxTileX&&e.canonical.y>=r[e.canonical.z].minTileY&&e.canonical.y<=r[e.canonical.z].maxTileY}}class ir{constructor(e,r,c){this._meshCache={},this.painter=e,this.sourceCache=new Hi(r),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,c,f=l.$){var m;if(!(r>=0&&r<f&&c>=0&&c<f))return 0;const x=this.getTerrainData(e),T=(m=x.tile)===null||m===void 0?void 0:m.dem;if(!T)return 0;const C=l.cs([],[r/f*l.$,c/f*l.$],x.u_terrain_matrix),k=[C[0]*T.dim,C[1]*T.dim],L=Math.floor(k[0]),j=Math.floor(k[1]),N=k[0]-L,q=k[1]-j;return T.get(L,j)*(1-N)*(1-q)+T.get(L+1,j)*N*(1-q)+T.get(L,j+1)*(1-N)*q+T.get(L+1,j+1)*N*q}getElevationForLngLatZoom(e,r){if(!l.ct(r,e.wrap()))return 0;const{tileID:c,mercatorX:f,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(c,f%l.$,m%l.$,l.$)}getElevation(e,r,c,f=l.$){return this.getDEMElevation(e,r,c,f)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const f=this.painter.context,m=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l.T(f,m,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l.T(f,new l.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ag([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const f=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new l.T(f,r.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),r.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const c=r&&r+r.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const f=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=f?m=e.canonical.z-f:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=e.canonical.x-(e.canonical.x>>m<<m),T=e.canonical.y-(e.canonical.y>>m<<m),C=l.cu(new Float64Array(16),[1/(l.$<<m),1/(l.$<<m),0]);l.M(C,C,[x*l.$,T*l.$,0]),this._demMatrixCache[e.key]={matrix:C,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,c=r.width/devicePixelRatio,f=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l.T(r.context,{width:c,height:f,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l.T(r.context,{width:c,height:f,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(c,f,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,c,f))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,x=0;m<this._coordsTextureSize;m++)for(let T=0;T<this._coordsTextureSize;T++,x+=4)r[x+0]=255&T,r[x+1]=255&m,r[x+2]=T>>8<<4|m>>8,r[x+3]=0;const c=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),f=new l.T(e,c,e.gl.RGBA,{premultiply:!1});return f.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),c=this.painter.context,f=c.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(m,T-x-1,1,1,f.RGBA,f.UNSIGNED_BYTE,r),c.bindFramebuffer.set(null);const C=r[0]+(r[2]>>4<<8),k=r[1]+((15&r[2])<<8),L=this.coordsIndex[255-r[3]],j=L&&this.sourceCache.getTileByID(L);if(!j)return null;const N=this._coordsTextureSize,q=(1<<j.tileID.canonical.z)*N;return new l.a1((j.tileID.canonical.x*N+C)/q+j.tileID.wrap,(j.tileID.canonical.y*N+k)/q,this.getElevation(j.tileID,C,k,N))}depthAtPoint(e){const r=new Uint8Array(4),c=this.painter.context,f=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,r),c.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const c=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,f=c&&e.canonical.y===0,m=c&&e.canonical.y===(1<<e.canonical.z)-1,x=`m_${f?"n":""}_${m?"s":""}`;if(this._meshCache[x])return this._meshCache[x];const T=this.painter.context,C=new l.cv,k=new l.aN,L=this.meshSize,j=l.$/L,N=L*L;for(let he=0;he<=L;he++)for(let Se=0;Se<=L;Se++)C.emplaceBack(Se*j,he*j,0);for(let he=0;he<N;he+=L+1)for(let Se=0;Se<L;Se++)k.emplaceBack(Se+he,L+Se+he+1,L+Se+he+2),k.emplaceBack(Se+he,L+Se+he+2,Se+he+1);const q=C.length,X=q+(L+1),ae=(L+1)*L,ne=f?l.bh:0,re=f?0:1,le=m?l.bi:l.$,ue=m?0:1;for(let he=0;he<=L;he++)C.emplaceBack(he*j,ne,re);for(let he=0;he<=L;he++)C.emplaceBack(he*j,le,ue);for(let he=0;he<L;he++)k.emplaceBack(ae+he,X+he,X+he+1),k.emplaceBack(ae+he,X+he+1,ae+he+1),k.emplaceBack(0+he,q+he+1,q+he),k.emplaceBack(0+he,0+he+1,q+he+1);const ce=C.length,me=ce+2*(L+1);for(const he of[0,1])for(let Se=0;Se<=L;Se++)for(const Oe of[0,1])C.emplaceBack(he*l.$,Se*j,Oe);for(let he=0;he<2*L;he+=2)k.emplaceBack(ce+he,ce+he+1,ce+he+3),k.emplaceBack(ce+he,ce+he+3,ce+he+2),k.emplaceBack(me+he,me+he+3,me+he+1),k.emplaceBack(me+he,me+he+2,me+he+3);const ye=new no(T.createVertexBuffer(C,Zl.members),T.createIndexBuffer(k),l.aM.simpleSegment(0,0,C.length,k.length));return this._meshCache[x]=ye,ye}getMeshFrameDelta(e){return 2*Math.PI*l.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var c;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(c=this.getMinMaxElevation(f).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return r&&r.dem&&(c.minElevation=r.dem.min*this.exaggeration,c.maxElevation=r.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,r){const c=l.a1.fromLngLat(e.wrap()),f=(1<<r)*l.$,m=c.x*f,x=c.y*f,T=Math.floor(m/l.$),C=Math.floor(x/l.$);return{tileID:new l.Z(r,0,r,T,C),mercatorX:m,mercatorY:x}}}class an{constructor(e,r,c){this._context=e,this._size=r,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new l.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(c.texture),{id:e,fbo:r,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((r=>e.id!==r)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const Gs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Md{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new an(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((c=>!e._layers[c].isHidden(r))),this._coordsAscending={};for(const c in e.sourceCaches){this._coordsAscending[c]={};const f=e.sourceCaches[c].getVisibleCoordinates(),m=e.sourceCaches[c].getSource(),x=m instanceof wn?m.terrainTileRanges:null;for(const T of f){const C=this.terrain.sourceCache.getTerrainCoords(T,x);for(const k in C)this._coordsAscending[c][k]||(this._coordsAscending[c][k]=[]),this._coordsAscending[c][k].push(C[k])}}this._coordsAscendingStr={};for(const c of e._order){const f=e._layers[c],m=f.source;if(Gs[f.type]&&!this._coordsAscendingStr[m]){this._coordsAscendingStr[m]={};for(const x in this._coordsAscending[m])this._coordsAscendingStr[m][x]=this._coordsAscending[m][x].map((T=>T.key)).sort().join()}}for(const c of this._renderableTiles)for(const f in this._coordsAscendingStr){const m=this._coordsAscendingStr[f][c.tileID.key];m&&m!==c.rttCoords[f]&&(c.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),f=e.type,m=this.painter,x=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Gs[f]&&(this._prevType&&Gs[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(e.id),!x))return!0;if(Gs[this._prevType]||Gs[f]&&x){this._prevType=f;const T=this._stacks.length-1,C=this._stacks[T]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(hs(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[T]){const j=this.pool.getObjectForId(k.rtt[T].id);if(j.stamp===k.rtt[T].stamp){this.pool.useObject(j);continue}}const L=this.pool.getOrCreateFreeObject();this.pool.useObject(L),this.pool.stampObject(L),k.rtt[T]={id:L.id,stamp:L.stamp},m.context.bindFramebuffer.set(L.fbo.framebuffer),m.context.clear({color:l.bf.transparent,stencil:0}),m.currentStencilSource=void 0;for(let j=0;j<C.length;j++){const N=m.style._layers[C[j]],q=N.source?this._coordsAscending[N.source][k.tileID.key]:[k.tileID];m.context.viewport.set([0,0,L.fbo.width,L.fbo.height]),m._renderTileClippingMasks(N,q,!0),m.renderLayer(m,m.style.sourceCaches[N.source],N,q,c),N.source&&(k.rttCoords[N.source]=this._coordsAscendingStr[N.source][k.tileID.key])}}return hs(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),Gs[f]}return!1}}const Eo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ar=B,Ji={hash:!1,interactive:!0,bearingSnap:7,attributionControl:vt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Xi={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Oi{constructor(e,r,c=!1){this.mousedown=m=>{this.startMove(m,K.mousePos(this.element,m)),K.addEventListener(window,"mousemove",this.mousemove),K.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=m=>{this.move(m,K.mousePos(this.element,m))},this.mouseup=m=>{this._rotatePitchHandler.dragEnd(m),this.offTemp()},this.touchstart=m=>{m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=K.touchPos(this.element,m.targetTouches)[0],this.startMove(m,this._startPos),K.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),K.addEventListener(window,"touchend",this.touchend))},this.touchmove=m=>{m.targetTouches.length!==1?this.reset():(this._lastPos=K.touchPos(this.element,m.targetTouches)[0],this.move(m,this._lastPos))},this.touchend=m=>{m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const f=new Oc;this._rotatePitchHandler=new Ul({clickTolerance:3,move:(m,x)=>{const T=r.getBoundingClientRect(),C=new l.P((T.bottom-T.top)/2,(T.right-T.left)/2);return{bearingDelta:l.cn(new l.P(m.x,x.y),x,C),pitchDelta:c?-.5*(x.y-m.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=e,K.addEventListener(r,"mousedown",this.mousedown),K.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),K.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHandler.dragStart(e,r),K.disableDrag()}move(e,r){const c=this.map,{bearingDelta:f,pitchDelta:m}=this._rotatePitchHandler.dragMove(e,r)||{};f&&c.setBearing(c.getBearing()+f),m&&c.setPitch(c.getPitch()+m)}off(){const e=this.element;K.removeEventListener(e,"mousedown",this.mousedown),K.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),K.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),K.removeEventListener(window,"touchend",this.touchend),K.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){K.enableDrag(),K.removeEventListener(window,"mousemove",this.mousemove),K.removeEventListener(window,"mouseup",this.mouseup),K.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),K.removeEventListener(window,"touchend",this.touchend)}}let qt;function Ti(p,e,r,c=!1){if(c||!r.getCoveringTilesDetailsProvider().allowWorldCopies())return p?.wrap();const f=new l.S(p.lng,p.lat);if(p=new l.S(p.lng,p.lat),e){const m=new l.S(p.lng-360,p.lat),x=new l.S(p.lng+360,p.lat),T=r.locationToScreenPoint(p).distSqr(e);r.locationToScreenPoint(m).distSqr(e)<T?p=m:r.locationToScreenPoint(x).distSqr(e)<T&&(p=x)}for(;Math.abs(p.lng-r.center.lng)>180;){const m=r.locationToScreenPoint(p);if(m.x>=0&&m.y>=0&&m.x<=r.width&&m.y<=r.height)break;p.lng>r.center.lng?p.lng-=360:p.lng+=360}return p.lng!==f.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(p))?p:f}const na={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ul(p,e,r){const c=p.classList;for(const f in na)c.remove(`maplibregl-${r}-anchor-${f}`);c.add(`maplibregl-${r}-anchor-${e}`)}class ps extends l.E{constructor(e){if(super(),this._onKeyPress=r=>{const c=r.code,f=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=r=>{const c=r.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()},this._update=r=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();(r?.type==="terrain"||r?.type==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=Ti(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),K.setTransform(this._element,`${na[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${f}`),W.frameAsync(new AbortController).then((()=>{this._updateOpacity(r&&r.type==="moveend")})).catch((()=>{}))},this._onMove=r=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=l.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=K.create("div");const r=K.createNS("http://www.w3.org/2000/svg","svg"),c=41,f=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${c}px`),r.setAttributeNS(null,"width",`${f}px`),r.setAttributeNS(null,"viewBox",`0 0 ${f} ${c}`);const m=K.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const x=K.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const T=K.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const re of C){const le=K.createNS("http://www.w3.org/2000/svg","ellipse");le.setAttributeNS(null,"opacity","0.04"),le.setAttributeNS(null,"cx","10.5"),le.setAttributeNS(null,"cy","5.80029008"),le.setAttributeNS(null,"rx",re.rx),le.setAttributeNS(null,"ry",re.ry),T.appendChild(le)}const k=K.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const L=K.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(L);const j=K.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const N=K.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(N);const q=K.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const X=K.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ae=K.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#000000"),ae.setAttributeNS(null,"opacity","0.25"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962");const ne=K.createNS("http://www.w3.org/2000/svg","circle");ne.setAttributeNS(null,"fill","#FFFFFF"),ne.setAttributeNS(null,"cx","5.5"),ne.setAttributeNS(null,"cy","5.5"),ne.setAttributeNS(null,"r","5.4999962"),X.appendChild(ae),X.appendChild(ne),x.appendChild(T),x.appendChild(k),x.appendChild(j),x.appendChild(q),x.appendChild(X),r.appendChild(x),r.setAttributeNS(null,"height",c*this._scale+"px"),r.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(r),this._offset=l.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(r=>{r.preventDefault()})),this._element.addEventListener("mousedown",(r=>{r.preventDefault()})),ul(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),K.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=l.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const f=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,c;const f=(r=this._map)===null||r===void 0?void 0:r.terrain,m=this._map.transform.isLocationOccluded(this._lngLat);if(!f||m){const q=m?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==q&&(this._element.style.opacity=q))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const x=this._map,T=x.terrain.depthAtPoint(this._pos),C=x.terrain.getElevationForLngLatZoom(this._lngLat,x.transform.tileZoom);if(x.transform.lngLatToCameraDepth(this._lngLat,C)-T<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/x.transform.pixelsPerMeter,L=Math.sin(x.getPitch()*Math.PI/180)*k,j=x.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),N=x.transform.lngLatToCameraDepth(this._lngLat,C+L)-j>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&N&&this._popup.remove(),this._element.style.opacity=N?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=l.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const Fs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Gr=0,Fr=!1;const Ao={maxWidth:100,unit:"metric"};function zu(p,e,r){const c=r&&r.maxWidth||100,f=p._container.clientHeight/2,m=p._container.clientWidth/2,x=p.unproject([m-c/2,f]),T=p.unproject([m+c/2,f]),C=Math.round(p.project(T).x-p.project(x).x),k=Math.min(c,C,p._container.clientWidth),L=x.distanceTo(T);if(r&&r.unit==="imperial"){const j=3.2808*L;j>5280?Fi(e,k,j/5280,p._getUIString("ScaleControl.Miles")):Fi(e,k,j,p._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?Fi(e,k,L/1852,p._getUIString("ScaleControl.NauticalMiles")):L>=1e3?Fi(e,k,L/1e3,p._getUIString("ScaleControl.Kilometers")):Fi(e,k,L,p._getUIString("ScaleControl.Meters"))}function Fi(p,e,r,c){const f=(function(m){const x=Math.pow(10,`${Math.floor(m)}`.length-1);let T=m/x;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(function(C){const k=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*k)/k})(T),x*T})(r);p.style.width=e*(f/r)+"px",p.innerHTML=`${f}&nbsp;${c}`}const Uc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Vc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qc(p){if(p){if(typeof p=="number"){const e=Math.round(Math.abs(p)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,p),"top-left":new l.P(e,e),"top-right":new l.P(-e,e),bottom:new l.P(0,-p),"bottom-left":new l.P(e,-e),"bottom-right":new l.P(-e,-e),left:new l.P(p,0),right:new l.P(-p,0)}}if(p instanceof l.P||Array.isArray(p)){const e=l.P.convert(p);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:l.P.convert(p.center||[0,0]),top:l.P.convert(p.top||[0,0]),"top-left":l.P.convert(p["top-left"]||[0,0]),"top-right":l.P.convert(p["top-right"]||[0,0]),bottom:l.P.convert(p.bottom||[0,0]),"bottom-left":l.P.convert(p["bottom-left"]||[0,0]),"bottom-right":l.P.convert(p["bottom-right"]||[0,0]),left:l.P.convert(p.left||[0,0]),right:l.P.convert(p.right||[0,0])}}return qc(new l.P(0,0))}const Iu=B;E.AJAXError=l.cz,E.Event=l.l,E.Evented=l.E,E.LngLat=l.S,E.MercatorCoordinate=l.a1,E.Point=l.P,E.addProtocol=l.cA,E.config=l.a,E.removeProtocol=l.cB,E.AttributionControl=Rt,E.BoxZoomHandler=cn,E.CanvasSource=Go,E.CooperativeGesturesHandler=Gc,E.DoubleClickZoomHandler=Ns,E.DragPanHandler=js,E.DragRotateHandler=br,E.EdgeInsets=Uo,E.FullscreenControl=class extends l.E{constructor(p={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){K.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=K.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);K.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Ks,E.GeolocateControl=class extends l.E{constructor(p){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new l.S(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,f=this._map.getBearing(),m=l.e({bearing:f},this.options.fitBoundsOptions),x=fa.fromLngLat(r,c);this._map.fitBounds(x,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new l.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Fr)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=K.create("button","maplibregl-ctrl-geolocate",this._container),K.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ps({element:this._dotElement}),this._circleElement=K.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ps({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(r=>{const c=r?.[0]instanceof ResizeObserverEntry;r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))}))}},this.options=l.e({},Fs,p)}onAdd(p){return this._map=p,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return l._(this,arguments,void 0,(function*(e=!1){if(qt!==void 0&&!e)return qt;if(window.navigator.permissions===void 0)return qt=!!window.navigator.geolocation,qt;try{qt=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{qt=!!window.navigator.geolocation}return qt}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),K.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Gr=0,Fr=!1}_isOutOfMapMaxBounds(p){const e=this._map.getMaxBounds(),r=p.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const p=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&p))return;const e=this._map.project(p),r=this._map.unproject([e.x+100,e.y]),c=p.distanceTo(r)/100,f=2*this._accuracy/c;this._circleElement.style.width=`${f.toFixed(2)}px`,this._circleElement.style.height=`${f.toFixed(2)}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Gr--,Fr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Gr++,Gr>1?(p={maximumAge:6e5,timeout:0},Fr=!0):(p=this.options.positionOptions,Fr=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var p;const e=(p=this._map.getProjection())===null||p===void 0?void 0:p.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var p;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((p=this._map.getProjection())===null||p===void 0?void 0:p.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(p){return this._map=p,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=K.create("button","maplibregl-ctrl-globe",this._container),K.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){K.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=Rc,E.ImageSource=wn,E.KeyboardHandler=So,E.LngLatBounds=fa,E.LogoControl=cl,E.Map=class extends Fc{constructor(p){var e,r;l.cw.mark(l.cx.create);const c=Object.assign(Object.assign(Object.assign({},Ji),p),{canvasContextAttributes:Object.assign(Object.assign({},Ji.canvasContextAttributes),p.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new ns,m=new mr;if(c.minZoom!==void 0&&f.setMinZoom(c.minZoom),c.maxZoom!==void 0&&f.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&f.setMinPitch(c.minPitch),c.maxPitch!==void 0&&f.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&f.setRenderWorldCopies(c.renderWorldCopies),super(f,m,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Pu,this._controls=[],this._mapId=l.a7(),this._contextLost=T=>{T.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new l.l("webglcontextlost",{originalEvent:T}))},this._contextRestored=T=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.l("webglcontextrestored",{originalEvent:T}))},this._onMapScroll=T=>{if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Eo),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=mt.addThrottleControl((()=>this.isMoving())),this._requestManager=new Mt(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let T=!1;const C=Nr((k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())}),50);this._resizeObserver=new ResizeObserver((k=>{T?C(k):T=!0})),this._resizeObserver.observe(this._container)}this.handlers=new jr(this,c),this._hash=c.hash&&new Rc(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,l.e({},c.fitBoundsOptions,{duration:0}))));const x=typeof c.style=="string"||((r=(e=c.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,x),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Rt(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new cl,c.logoPosition),this.on("style.load",(()=>{if(x||this._resizeTransform(),this.transform.unmodified){const T=l.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(T)}})),this.on("data",(T=>{this._update(T.dataType==="style"),this.fire(new l.l(`${T.dataType}data`,T))})),this.on("dataloading",(T=>{this.fire(new l.l(`${T.dataType}dataloading`,T))})),this.on("dataabort",(T=>{this.fire(new l.l("sourcedataabort",T))}))}_getMapId(){return this._mapId}setGlobalStateProperty(p,e){return this.style.setGlobalStateProperty(p,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(p,e){if(e===void 0&&(e=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=p.onAdd(this);this._controls.push(p);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(r,c.firstChild):c.appendChild(r),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(p);return e>-1&&this._controls.splice(e,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}coveringTiles(p){return ii(this.transform,p)}calculateCameraOptionsFromTo(p,e,r,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,e,r,c)}resize(p,e=!0){const[r,c]=this._containerDimensions(),f=this._getClampedPixelRatio(r,c);if(this._resizeCanvas(r,c,f),this.painter.resize(r,c,f),this.painter.overLimit()){const x=this.painter.context.gl;this._maxCanvasSize=[x.drawingBufferWidth,x.drawingBufferHeight];const T=this._getClampedPixelRatio(r,c);this._resizeCanvas(r,c,T),this.painter.resize(r,c,T)}this._resizeTransform(e);const m=!this._moving;return m&&(this.stop(),this.fire(new l.l("movestart",p)).fire(new l.l("move",p))),this.fire(new l.l("resize",p)),m&&this.fire(new l.l("moveend",p)),this}_resizeTransform(p=!0){var e;const[r,c]=this._containerDimensions();this.transform.resize(r,c,p),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,c,p)}_getClampedPixelRatio(p,e){const{0:r,1:c}=this._maxCanvasSize,f=this.getPixelRatio(),m=p*f,x=e*f;return Math.min(m>r?r/m:1,x>c?c/x:1)*f}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(fa.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.setMinZoom(p),this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.setMaxZoom(p),this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.setMinPitch(p),this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(p>=this.transform.minPitch)return this.transform.setMaxPitch(p),this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.setRenderWorldCopies(p),this._update()}project(p){return this.transform.locationToScreenPoint(l.S.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.screenPointToLocation(l.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,e,r){if(p==="mouseenter"||p==="mouseover"){let c=!1;return{layers:e,listener:r,delegates:{mousemove:m=>{const x=e.filter((C=>this.getLayer(C))),T=x.length!==0?this.queryRenderedFeatures(m.point,{layers:x}):[];T.length?c||(c=!0,r.call(this,new Bn(p,this,m.originalEvent,{features:T}))):c=!1},mouseout:()=>{c=!1}}}}if(p==="mouseleave"||p==="mouseout"){let c=!1;return{layers:e,listener:r,delegates:{mousemove:x=>{const T=e.filter((C=>this.getLayer(C)));(T.length!==0?this.queryRenderedFeatures(x.point,{layers:T}):[]).length?c=!0:c&&(c=!1,r.call(this,new Bn(p,this,x.originalEvent)))},mouseout:x=>{c&&(c=!1,r.call(this,new Bn(p,this,x.originalEvent)))}}}}{const c=f=>{const m=e.filter((T=>this.getLayer(T))),x=m.length!==0?this.queryRenderedFeatures(f.point,{layers:m}):[];x.length&&(f.features=x,r.call(this,f),delete f.features)};return{layers:e,listener:r,delegates:{[p]:c}}}}_saveDelegatedListener(p,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(e)}_removeDelegatedListener(p,e,r){if(!this._delegatedListeners||!this._delegatedListeners[p])return;const c=this._delegatedListeners[p];for(let f=0;f<c.length;f++){const m=c[f];if(m.listener===r&&m.layers.length===e.length&&m.layers.every((x=>e.includes(x)))){for(const x in m.delegates)this.off(x,m.delegates[x]);return void c.splice(f,1)}}}on(p,e,r){if(r===void 0)return super.on(p,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(p,c,r);this._saveDelegatedListener(p,f);for(const m in f.delegates)this.on(m,f.delegates[m]);return{unsubscribe:()=>{this._removeDelegatedListener(p,c,r)}}}once(p,e,r){if(r===void 0)return super.once(p,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(p,c,r);for(const m in f.delegates){const x=f.delegates[m];f.delegates[m]=(...T)=>{this._removeDelegatedListener(p,c,r),x(...T)}}this._saveDelegatedListener(p,f);for(const m in f.delegates)this.once(m,f.delegates[m]);return this}off(p,e,r){return r===void 0?super.off(p,e):(this._removeDelegatedListener(p,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(p,e){if(!this.style)return[];let r;const c=p instanceof l.P||Array.isArray(p),f=c?p:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:p)||{},f instanceof l.P||typeof f[0]=="number")r=[l.P.convert(f)];else{const m=l.P.convert(f[0]),x=l.P.convert(f[1]);r=[m,new l.P(x.x,m.y),x,new l.P(m.x,x.y),m]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(p,e){return this.style.querySourceFeatures(p,e)}setStyle(p,e){return(e=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(p,e))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const e=this._locale[p];if(e==null)throw new Error(`Missing UI string '${p}'`);return e}_updateStyle(p,e){var r,c;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(p,e)));const f=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new ch(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,e,f):this.style.loadJSON(p,e,f),this):((c=(r=this.style)===null||r===void 0?void 0:r.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ch(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,e){if(typeof p=="string"){const r=this._requestManager.transformRequest(p,"Style");l.j(r,new AbortController).then((c=>{this._updateDiff(c.data,e)})).catch((c=>{c&&this.fire(new l.k(c))}))}else typeof p=="object"&&this._updateDiff(p,e)}_updateDiff(p,e){try{this.style.setState(p,e)&&this._update(!0)}catch(r){l.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(p,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(p,e){return this._lazyInitEmptyStyle(),this.style.addSource(p,e),this._update(!0)}isSourceLoaded(p){const e=this.style&&this.style.sourceCaches[p];if(e!==void 0)return e.loaded();this.fire(new l.k(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const e=this.style.sourceCaches[p.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const c=this.style._layers[r];c.type==="hillshade"&&c.source===p.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),c.type==="color-relief"&&c.source===p.source&&l.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ir(this.painter,e,p),this.painter.renderToTexture=new Md(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{var c;r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==p.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((c=r.source)===null||c===void 0?void 0:c.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:p})),this}getTerrain(){var p,e;return(e=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const e in p){const r=p[e]._tiles;for(const c in r){const f=r[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}setSourceTileLodParams(p,e,r){if(r){const c=this.getSource(r);if(!c)throw new Error(`There is no source with ID "${r}", cannot set LOD parameters`);c.calculateTileZoom=xt(Math.max(1,p),Math.max(1,e))}else for(const c in this.style.sourceCaches)this.style.sourceCaches[c].getSource().calculateTileZoom=xt(Math.max(1,p),Math.max(1,e));return this._update(!0),this}refreshTiles(p,e){const r=this.style.sourceCaches[p];if(!r)throw new Error(`There is no source cache with ID "${p}", cannot refresh tile`);e===void 0?r.reload(!0):r.refreshTiles(e.map((c=>new l.a4(c.z,c.x,c.y))))}addImage(p,e,r={}){const{pixelRatio:c=1,sdf:f=!1,stretchX:m,stretchY:x,content:T,textFitWidth:C,textFitHeight:k}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||l.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:L,height:j,data:N}=e,q=e;return this.style.addImage(p,{data:new l.R({width:L,height:j},new Uint8Array(N)),pixelRatio:c,stretchX:m,stretchY:x,content:T,textFitWidth:C,textFitHeight:k,sdf:f,version:0,userImage:q}),q.onAdd&&q.onAdd(this,p),this}}{const{width:L,height:j,data:N}=W.getImageData(e);this.style.addImage(p,{data:new l.R({width:L,height:j},N),pixelRatio:c,stretchX:m,stretchY:x,content:T,textFitWidth:C,textFitHeight:k,sdf:f,version:0})}}updateImage(p,e){const r=this.style.getImage(p);if(!r)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||l.b(e)?W.getImageData(e):e,{width:f,height:m,data:x}=c;if(f===void 0||m===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==r.data.width||m!==r.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(e instanceof HTMLImageElement||l.b(e));return r.data.replace(x,T),this.style.updateImage(p,r),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p){return mt.getImage(this._requestManager.transformRequest(p,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(p,e){return this._lazyInitEmptyStyle(),this.style.addLayer(p,e),this._update(!0)}moveLayer(p,e){return this.style.moveLayer(p,e),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,e,r){return this.style.setLayerZoomRange(p,e,r),this._update(!0)}setFilter(p,e,r={}){return this.style.setFilter(p,e,r),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,e,r,c={}){return this.style.setPaintProperty(p,e,r,c),this._update(!0)}getPaintProperty(p,e){return this.style.getPaintProperty(p,e)}setLayoutProperty(p,e,r,c={}){return this.style.setLayoutProperty(p,e,r,c),this._update(!0)}getLayoutProperty(p,e){return this.style.getLayoutProperty(p,e)}setGlyphs(p,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,e,r,(c=>{c||this._update(!0)})),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,e,(r=>{r||this._update(!0)})),this}setLight(p,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(p,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(p,e){return this.style.setFeatureState(p,e),this._update()}removeFeatureState(p,e){return this.style.removeFeatureState(p,e),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,e=0;return this._container&&(p=this._container.clientWidth||400,e=this._container.clientHeight||300),[p,e]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const e=this._canvasContainer=K.create("div","maplibregl-canvas-container",p);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=K.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),c=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],c);const f=this._controlContainer=K.create("div","maplibregl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((x=>{m[x]=K.create("div",`maplibregl-ctrl-${x} `,f)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,e,r){this._canvas.width=Math.floor(r*p),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const p=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",(c=>{e={requestedAttributes:p},c&&(e.statusMessage=c.statusMessage,e.type=c.type)}),{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,p):this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p),!r){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new Bs(r,this.transform),ve.testSupport(r)}migrateProjection(p,e){super.migrateProjection(p,e),this.painter.transform=p,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){var e,r,c,f,m;const x=this._idleTriggered?this._fadeDuration:0,T=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,N=W.now();this.style.zoomHistory.update(j,N);const q=new l.F(j,{now:N,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),X=q.crossFadingFactor();X===1&&X===this._crossFadingFactor||(C=!0,this._crossFadingFactor=X),this.style.update(q)}const k=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==T;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(m=this.style.projection)===null||m===void 0?void 0:m.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cw.mark(l.cx.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const L=this._sourcesDirty||this._styleDirty||this._placementDirty;return L||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,l.cw.mark(l.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),mt.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),K.remove(this._canvasContainer),K.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cw.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,W.frame(this._frameRequest,(p=>{l.cw.frame(p),this._frameRequest=null;try{this._render(p)}catch(e){if(!l.cy(e)&&!(function(r){return r.message===Pc})(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return ar}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(p){return this._lazyInitEmptyStyle(),this.style.setProjection(p),this._update(!0)}},E.MapMouseEvent=Bn,E.MapTouchEvent=$i,E.MapWheelEvent=Lc,E.Marker=ps,E.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const c=this._map._getUIString(`NavigationControl.${r}`);e.title=c,e.setAttribute("aria-label",c)},this.options=l.e({},Xi,p),this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),K.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),K.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=K.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Oi(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){K.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,e){const r=K.create("button",p,this._container);return r.type="button",r.addEventListener("click",e),r}},E.Popup=class extends l.E{constructor(p){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&K.remove(this._content),this._container&&(K.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=K.create("div","maplibregl-popup",this._map.getContainer()),this._tip=K.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Ti(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const r=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let c=this.options.anchor;const f=qc(this.options.offset);if(!c){const x=this._container.offsetWidth,T=this._container.offsetHeight;let C;C=r.y+f.bottom.y<T?["top"]:r.y>this._map.transform.height-T?["bottom"]:[],r.x<x/2?C.push("left"):r.x>this._map.transform.width-x/2&&C.push("right"),c=C.length===0?"bottom":C.join("-")}let m=r.add(f[c]);this.options.subpixelPositioning||(m=m.round()),K.setTransform(this._container,`${na[c]} translate(${m.x}px,${m.y}px)`),ul(this._container,c,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(Uc),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=l.S.convert(p),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const e=document.createDocumentFragment(),r=document.createElement("body");let c;for(r.innerHTML=p;c=r.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=K.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){return this._container&&this._container.classList.add(p),this}removeClassName(p){return this._container&&this._container.classList.remove(p),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}setSubpixelPositioning(p){this.options.subpixelPositioning=p}_createCloseButton(){this.options.closeButton&&(this._closeButton=K.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Vc);p&&p.focus()}},E.RasterDEMTileSource=jo,E.RasterTileSource=fr,E.ScaleControl=class{constructor(p){this._onMove=()=>{zu(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,zu(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ao),p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){K.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=zh,E.Style=ch,E.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=p}onAdd(p){return this._map=p,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=K.create("button","maplibregl-ctrl-terrain",this._container),K.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){K.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=Vl,E.TwoFingersTouchRotateHandler=Bc,E.TwoFingersTouchZoomHandler=ds,E.TwoFingersTouchZoomRotateHandler=To,E.VectorTileSource=qn,E.VideoSource=Js,E.addSourceType=(p,e)=>l._(void 0,void 0,void 0,(function*(){if(Kr(p))throw new Error(`A source type called "${p}" already exists.`);((r,c)=>{eo[r]=c})(p,e)})),E.clearPrewarmedResources=function(){const p=pt;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(Si),pt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=gc,E.getMaxParallelImageRequests=function(){return l.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return ws().getRTLTextPluginStatus()},E.getVersion=function(){return Iu},E.getWorkerCount=function(){return be.workerCount},E.getWorkerUrl=function(){return l.a.WORKER_URL},E.importScriptInWorkers=function(p){return gi().broadcast("IS",p)},E.prewarm=function(){$t().acquire(Si)},E.setMaxParallelImageRequests=function(p){l.a.MAX_PARALLEL_IMAGE_REQUESTS=p},E.setRTLTextPlugin=function(p,e){return ws().setRTLTextPlugin(p,e)},E.setWorkerCount=function(p){be.workerCount=p},E.setWorkerUrl=function(p){l.a.WORKER_URL=p}}));var D=w;return D}))})(Bm)),Bm.exports}var lv=ov();const Vg=Ey(lv),cv={"nueima-solar-fields":{id:"nueima-solar-fields",name:"Nu'eima Solar Fields",pointGeoJson:"/data/geojson/Nueima Solar Fields.geojson",tableCsv:null},nueima:{id:"nueima",name:"Nu'eima",pointGeoJson:"/data/geojson/Nueima.geojson",tableCsv:null},naama:{id:"naama",name:"Na'ama",pointGeoJson:"data/geojson/Naama.geojson",tableCsv:null},"naama-solar-fields":{id:"naama-solar-fields",name:"Na'ama Solar Fields",pointGeoJson:"/data/geojson/Naama Solar Fields.geojson",tableCsv:null},"shdemot-mehola-solar":{id:"shdemot-mehola-solar",name:"Shdemot Mehola Solar Field",pointGeoJson:"/data/geojson/Shdemot Mehola Solar.geojson",tableCsv:null},"shdemot-mehola":{id:"shdemot-mehola",name:"Shdemot Mehola",pointGeoJson:"/data/geojson/Shdemot Mehola.geojson",tableCsv:null},rotem:{id:"rotem",name:"Rotem",pointGeoJson:"/data/geojson/Rotem.geojson",tableCsv:null},farsia:{id:"farsia",name:"Al-Farsia",pointGeoJson:"/data/geojson/A-Farsia.geojson",tableCsv:null},"noam-s-office":{id:"noam-s-office",name:"Noam's Office",pointGeoJson:"/data/geojson/Noam's Office.geojson",tableCsv:null},"jericho-governate":{id:"jericho-governate",name:"Jericho Governate",pointGeoJson:"/data/geojson/Jericho-Governate.geojson",tableCsv:null},"beit-al-ajdad":{id:"beit-al-ajdad",name:"Beit Al-Ajdad Elderly Care Home",pointGeoJson:"/data/geojson/Beit-Al-Ajdad.geojson",tableCsv:null}};function uv(h){h("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),h("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),h("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var y=1;y<=60;++y)h("EPSG:"+(32600+y),"+proj=utm +zone="+y+" +datum=WGS84 +units=m"),h("EPSG:"+(32700+y),"+proj=utm +zone="+y+" +south +datum=WGS84 +units=m");h.WGS84=h["EPSG:4326"],h["EPSG:3785"]=h["EPSG:3857"],h.GOOGLE=h["EPSG:3857"],h["EPSG:900913"]=h["EPSG:3857"],h["EPSG:102113"]=h["EPSG:3857"]}var od=1,ld=2,df=3,hv=4,Cg=5,g_=6378137,dv=6356752314e-3,__=.0066943799901413165,Tp=484813681109536e-20,lt=Math.PI/2,fv=.16666666666666666,pv=.04722222222222222,mv=.022156084656084655,bt=1e-10,dr=.017453292519943295,lc=57.29577951308232,ia=Math.PI/4,Ip=Math.PI*2,fn=3.14159265359,xs={};xs.greenwich=0;xs.lisbon=-9.131906111111;xs.paris=2.337229166667;xs.bogota=-74.080916666667;xs.madrid=-3.687938888889;xs.rome=12.452333333333;xs.bern=7.439583333333;xs.jakarta=106.807719444444;xs.ferro=-17.666666666667;xs.brussels=4.367975;xs.stockholm=18.058277777778;xs.athens=23.7163375;xs.oslo=10.722916666667;const gv={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var y_=/[\s_\-\/\(\)]/g;function eh(h,y){if(h[y])return h[y];for(var w=Object.keys(h),A=y.toLowerCase().replace(y_,""),P=-1,D,E;++P<w.length;)if(D=w[P],E=D.toLowerCase().replace(y_,""),E===A)return h[D]}function Pg(h){var y={},w=h.split("+").map(function(l){return l.trim()}).filter(function(l){return l}).reduce(function(l,B){var U=B.split("=");return U.push(!0),l[U[0].toLowerCase()]=U[1],l},{}),A,P,D,E={proj:"projName",datum:"datumCode",rf:function(l){y.rf=parseFloat(l)},lat_0:function(l){y.lat0=l*dr},lat_1:function(l){y.lat1=l*dr},lat_2:function(l){y.lat2=l*dr},lat_ts:function(l){y.lat_ts=l*dr},lon_0:function(l){y.long0=l*dr},lon_1:function(l){y.long1=l*dr},lon_2:function(l){y.long2=l*dr},alpha:function(l){y.alpha=parseFloat(l)*dr},gamma:function(l){y.rectified_grid_angle=parseFloat(l)*dr},lonc:function(l){y.longc=l*dr},x_0:function(l){y.x0=parseFloat(l)},y_0:function(l){y.y0=parseFloat(l)},k_0:function(l){y.k0=parseFloat(l)},k:function(l){y.k0=parseFloat(l)},a:function(l){y.a=parseFloat(l)},b:function(l){y.b=parseFloat(l)},r:function(l){y.a=y.b=parseFloat(l)},r_a:function(){y.R_A=!0},zone:function(l){y.zone=parseInt(l,10)},south:function(){y.utmSouth=!0},towgs84:function(l){y.datum_params=l.split(",").map(function(B){return parseFloat(B)})},to_meter:function(l){y.to_meter=parseFloat(l)},units:function(l){y.units=l;var B=eh(gv,l);B&&(y.to_meter=B.to_meter)},from_greenwich:function(l){y.from_greenwich=l*dr},pm:function(l){var B=eh(xs,l);y.from_greenwich=(B||parseFloat(l))*dr},nadgrids:function(l){l==="@null"?y.datumCode="none":y.nadgrids=l},axis:function(l){var B="ewnsud";l.length===3&&B.indexOf(l.substr(0,1))!==-1&&B.indexOf(l.substr(1,1))!==-1&&B.indexOf(l.substr(2,1))!==-1&&(y.axis=l)},approx:function(){y.approx=!0}};for(A in w)P=w[A],A in E?(D=E[A],typeof D=="function"?D(P):y[D]=P):y[A]=P;return typeof y.datumCode=="string"&&y.datumCode!=="WGS84"&&(y.datumCode=y.datumCode.toLowerCase()),y}class ty{static getId(y){const w=y.find(A=>Array.isArray(A)&&A[0]==="ID");return w&&w.length>=3?{authority:w[1],code:parseInt(w[2],10)}:null}static convertUnit(y,w="unit"){if(!y||y.length<3)return{type:w,name:"unknown",conversion_factor:null};const A=y[1],P=parseFloat(y[2])||null,D=y.find(l=>Array.isArray(l)&&l[0]==="ID"),E=D?{authority:D[1],code:parseInt(D[2],10)}:null;return{type:w,name:A,conversion_factor:P,id:E}}static convertAxis(y){const w=y[1]||"Unknown";let A;const P=w.match(/^\((.)\)$/);if(P){const U=P[1].toUpperCase();if(U==="E")A="east";else if(U==="N")A="north";else if(U==="U")A="up";else throw new Error(`Unknown axis abbreviation: ${U}`)}else A=y[2]?y[2].toLowerCase():"unknown";const D=y.find(U=>Array.isArray(U)&&U[0]==="ORDER"),E=D?parseInt(D[1],10):null,l=y.find(U=>Array.isArray(U)&&(U[0]==="LENGTHUNIT"||U[0]==="ANGLEUNIT"||U[0]==="SCALEUNIT")),B=this.convertUnit(l);return{name:w,direction:A,unit:B,order:E}}static extractAxes(y){return y.filter(w=>Array.isArray(w)&&w[0]==="AXIS").map(w=>this.convertAxis(w)).sort((w,A)=>(w.order||0)-(A.order||0))}static convert(y,w={}){switch(y[0]){case"PROJCRS":w.type="ProjectedCRS",w.name=y[1],w.base_crs=y.find(W=>Array.isArray(W)&&W[0]==="BASEGEOGCRS")?this.convert(y.find(W=>Array.isArray(W)&&W[0]==="BASEGEOGCRS")):null,w.conversion=y.find(W=>Array.isArray(W)&&W[0]==="CONVERSION")?this.convert(y.find(W=>Array.isArray(W)&&W[0]==="CONVERSION")):null;const A=y.find(W=>Array.isArray(W)&&W[0]==="CS");A&&(w.coordinate_system={type:A[1],axis:this.extractAxes(y)});const P=y.find(W=>Array.isArray(W)&&W[0]==="LENGTHUNIT");if(P){const W=this.convertUnit(P);w.coordinate_system.unit=W}w.id=this.getId(y);break;case"BASEGEOGCRS":case"GEOGCRS":w.type="GeographicCRS",w.name=y[1];const D=y.find(W=>Array.isArray(W)&&(W[0]==="DATUM"||W[0]==="ENSEMBLE"));if(D){const W=this.convert(D);D[0]==="ENSEMBLE"?w.datum_ensemble=W:w.datum=W;const K=y.find(ve=>Array.isArray(ve)&&ve[0]==="PRIMEM");K&&K[1]!=="Greenwich"&&(W.prime_meridian={name:K[1],longitude:parseFloat(K[2])})}w.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(y)},w.id=this.getId(y);break;case"DATUM":w.type="GeodeticReferenceFrame",w.name=y[1],w.ellipsoid=y.find(W=>Array.isArray(W)&&W[0]==="ELLIPSOID")?this.convert(y.find(W=>Array.isArray(W)&&W[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":w.type="DatumEnsemble",w.name=y[1],w.members=y.filter(W=>Array.isArray(W)&&W[0]==="MEMBER").map(W=>({type:"DatumEnsembleMember",name:W[1],id:this.getId(W)}));const E=y.find(W=>Array.isArray(W)&&W[0]==="ENSEMBLEACCURACY");E&&(w.accuracy=parseFloat(E[1]));const l=y.find(W=>Array.isArray(W)&&W[0]==="ELLIPSOID");l&&(w.ellipsoid=this.convert(l)),w.id=this.getId(y);break;case"ELLIPSOID":w.type="Ellipsoid",w.name=y[1],w.semi_major_axis=parseFloat(y[2]),w.inverse_flattening=parseFloat(y[3]),y.find(W=>Array.isArray(W)&&W[0]==="LENGTHUNIT")&&this.convert(y.find(W=>Array.isArray(W)&&W[0]==="LENGTHUNIT"),w);break;case"CONVERSION":w.type="Conversion",w.name=y[1],w.method=y.find(W=>Array.isArray(W)&&W[0]==="METHOD")?this.convert(y.find(W=>Array.isArray(W)&&W[0]==="METHOD")):null,w.parameters=y.filter(W=>Array.isArray(W)&&W[0]==="PARAMETER").map(W=>this.convert(W));break;case"METHOD":w.type="Method",w.name=y[1],w.id=this.getId(y);break;case"PARAMETER":w.type="Parameter",w.name=y[1],w.value=parseFloat(y[2]),w.unit=this.convertUnit(y.find(W=>Array.isArray(W)&&(W[0]==="LENGTHUNIT"||W[0]==="ANGLEUNIT"||W[0]==="SCALEUNIT"))),w.id=this.getId(y);break;case"BOUNDCRS":w.type="BoundCRS";const B=y.find(W=>Array.isArray(W)&&W[0]==="SOURCECRS");if(B){const W=B.find(K=>Array.isArray(K));w.source_crs=W?this.convert(W):null}const U=y.find(W=>Array.isArray(W)&&W[0]==="TARGETCRS");if(U){const W=U.find(K=>Array.isArray(K));w.target_crs=W?this.convert(W):null}const ee=y.find(W=>Array.isArray(W)&&W[0]==="ABRIDGEDTRANSFORMATION");ee?w.transformation=this.convert(ee):w.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(w.type="Transformation",w.name=y[1],w.method=y.find(W=>Array.isArray(W)&&W[0]==="METHOD")?this.convert(y.find(W=>Array.isArray(W)&&W[0]==="METHOD")):null,w.parameters=y.filter(W=>Array.isArray(W)&&(W[0]==="PARAMETER"||W[0]==="PARAMETERFILE")).map(W=>{if(W[0]==="PARAMETER")return this.convert(W);if(W[0]==="PARAMETERFILE")return{name:W[1],value:W[2],id:{authority:"EPSG",code:8656}}}),w.parameters.length===7){const W=w.parameters[6];W.name==="Scale difference"&&(W.value=Math.round((W.value-1)*1e12)/1e6)}w.id=this.getId(y);break;case"AXIS":w.coordinate_system||(w.coordinate_system={type:"unspecified",axis:[]}),w.coordinate_system.axis.push(this.convertAxis(y));break;case"LENGTHUNIT":const J=this.convertUnit(y,"LinearUnit");w.coordinate_system&&w.coordinate_system.axis&&w.coordinate_system.axis.forEach(W=>{W.unit||(W.unit=J)}),J.conversion_factor&&J.conversion_factor!==1&&w.semi_major_axis&&(w.semi_major_axis={value:w.semi_major_axis,unit:J});break;default:w.keyword=y[0];break}return w}}class _v extends ty{static convert(y,w={}){return super.convert(y,w),w.coordinate_system&&w.coordinate_system.subtype==="Cartesian"&&delete w.coordinate_system,w.usage&&delete w.usage,w}}class yv extends ty{static convert(y,w={}){super.convert(y,w);const A=y.find(D=>Array.isArray(D)&&D[0]==="CS");A&&(w.coordinate_system={subtype:A[1],axis:this.extractAxes(y)});const P=y.find(D=>Array.isArray(D)&&D[0]==="USAGE");if(P){const D=P.find(B=>Array.isArray(B)&&B[0]==="SCOPE"),E=P.find(B=>Array.isArray(B)&&B[0]==="AREA"),l=P.find(B=>Array.isArray(B)&&B[0]==="BBOX");w.usage={},D&&(w.usage.scope=D[1]),E&&(w.usage.area=E[1]),l&&(w.usage.bbox=l.slice(1))}return w}}function vv(h){return h.find(y=>Array.isArray(y)&&y[0]==="USAGE")?"2019":(h.find(y=>Array.isArray(y)&&y[0]==="CS")||h[0]==="BOUNDCRS"||h[0]==="PROJCRS"||h[0]==="GEOGCRS","2015")}function xv(h){return(vv(h)==="2019"?yv:_v).convert(h)}function bv(h){const y=h.toUpperCase();return y.includes("PROJCRS")||y.includes("GEOGCRS")||y.includes("BOUNDCRS")||y.includes("VERTCRS")||y.includes("LENGTHUNIT")||y.includes("ANGLEUNIT")||y.includes("SCALEUNIT")?"WKT2":(y.includes("PROJCS")||y.includes("GEOGCS")||y.includes("LOCAL_CS")||y.includes("VERT_CS")||y.includes("UNIT"),"WKT1")}var Rp=1,iy=2,ay=3,Vm=4,ny=5,qg=-1,wv=/\s/,Sv=/[A-Za-z]/,Mv=/[A-Za-z84_]/,Qm=/[,\]]/,ry=/[\d\.E\-\+]/;function uu(h){if(typeof h!="string")throw new Error("not a string");this.text=h.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Rp}uu.prototype.readCharicter=function(){var h=this.text[this.place++];if(this.state!==Vm)for(;wv.test(h);){if(this.place>=this.text.length)return;h=this.text[this.place++]}switch(this.state){case Rp:return this.neutral(h);case iy:return this.keyword(h);case Vm:return this.quoted(h);case ny:return this.afterquote(h);case ay:return this.number(h);case qg:return}};uu.prototype.afterquote=function(h){if(h==='"'){this.word+='"',this.state=Vm;return}if(Qm.test(h)){this.word=this.word.trim(),this.afterItem(h);return}throw new Error(`havn't handled "`+h+'" in afterquote yet, index '+this.place)};uu.prototype.afterItem=function(h){if(h===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Rp;return}if(h==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Rp,this.currentObject=this.stack.pop(),this.currentObject||(this.state=qg);return}};uu.prototype.number=function(h){if(ry.test(h)){this.word+=h;return}if(Qm.test(h)){this.word=parseFloat(this.word),this.afterItem(h);return}throw new Error(`havn't handled "`+h+'" in number yet, index '+this.place)};uu.prototype.quoted=function(h){if(h==='"'){this.state=ny;return}this.word+=h};uu.prototype.keyword=function(h){if(Mv.test(h)){this.word+=h;return}if(h==="["){var y=[];y.push(this.word),this.level++,this.root===null?this.root=y:this.currentObject.push(y),this.stack.push(this.currentObject),this.currentObject=y,this.state=Rp;return}if(Qm.test(h)){this.afterItem(h);return}throw new Error(`havn't handled "`+h+'" in keyword yet, index '+this.place)};uu.prototype.neutral=function(h){if(Sv.test(h)){this.word=h,this.state=iy;return}if(h==='"'){this.word="",this.state=Vm;return}if(ry.test(h)){this.word=h,this.state=ay;return}if(Qm.test(h)){this.afterItem(h);return}throw new Error(`havn't handled "`+h+'" in neutral yet, index '+this.place)};uu.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===qg)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Tv(h){var y=new uu(h);return y.output()}function wg(h,y,w){Array.isArray(y)&&(w.unshift(y),y=null);var A=y?{}:h,P=w.reduce(function(D,E){return lf(E,D),D},A);y&&(h[y]=P)}function lf(h,y){if(!Array.isArray(h)){y[h]=!0;return}var w=h.shift();if(w==="PARAMETER"&&(w=h.shift()),h.length===1){if(Array.isArray(h[0])){y[w]={},lf(h[0],y[w]);return}y[w]=h[0];return}if(!h.length){y[w]=!0;return}if(w==="TOWGS84"){y[w]=h;return}if(w==="AXIS"){w in y||(y[w]=[]),y[w].push(h);return}Array.isArray(w)||(y[w]={});var A;switch(w){case"UNIT":case"PRIMEM":case"VERT_DATUM":y[w]={name:h[0].toLowerCase(),convert:h[1]},h.length===3&&lf(h[2],y[w]);return;case"SPHEROID":case"ELLIPSOID":y[w]={name:h[0],a:h[1],rf:h[2]},h.length===4&&lf(h[3],y[w]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":h[0]=["name",h[0]],wg(y,w,h);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":h[0]=["name",h[0]],wg(y,w,h),y[w].type=w;return;default:for(A=-1;++A<h.length;)if(!Array.isArray(h[A]))return lf(h,y[w]);return wg(y,w,h)}}var Ev=.017453292519943295;function Sl(h){return h*Ev}function sy(h){const y=(h.projName||"").toLowerCase().replace(/_/g," ");!h.long0&&h.longc&&(y==="albers conic equal area"||y==="lambert azimuthal equal area")&&(h.long0=h.longc),!h.lat_ts&&h.lat1&&(y==="stereographic south pole"||y==="polar stereographic (variant b)")?(h.lat0=Sl(h.lat1>0?90:-90),h.lat_ts=h.lat1,delete h.lat1):!h.lat_ts&&h.lat0&&(y==="polar stereographic"||y==="polar stereographic (variant a)")&&(h.lat_ts=h.lat0,h.lat0=Sl(h.lat0>0?90:-90),delete h.lat1)}function v_(h){let y={units:null,to_meter:void 0};return typeof h=="string"?(y.units=h.toLowerCase(),y.units==="metre"&&(y.units="meter"),y.units==="meter"&&(y.to_meter=1)):h&&h.name&&(y.units=h.name.toLowerCase(),y.units==="metre"&&(y.units="meter"),y.to_meter=h.conversion_factor),y}function x_(h){return typeof h=="object"?h.value*h.unit.conversion_factor:h}function b_(h,y){h.ellipsoid.radius?(y.a=h.ellipsoid.radius,y.rf=0):(y.a=x_(h.ellipsoid.semi_major_axis),h.ellipsoid.inverse_flattening!==void 0?y.rf=h.ellipsoid.inverse_flattening:h.ellipsoid.semi_major_axis!==void 0&&h.ellipsoid.semi_minor_axis!==void 0&&(y.rf=y.a/(y.a-x_(h.ellipsoid.semi_minor_axis))))}function qm(h,y={}){return!h||typeof h!="object"?h:h.type==="BoundCRS"?(qm(h.source_crs,y),h.transformation&&(h.transformation.method&&h.transformation.method.name==="NTv2"?y.nadgrids=h.transformation.parameters[0].value:y.datum_params=h.transformation.parameters.map(w=>w.value)),y):(Object.keys(h).forEach(w=>{const A=h[w];if(A!==null)switch(w){case"name":if(y.srsCode)break;y.name=A,y.srsCode=A;break;case"type":A==="GeographicCRS"?y.projName="longlat":A==="ProjectedCRS"&&h.conversion&&h.conversion.method&&(y.projName=h.conversion.method.name);break;case"datum":case"datum_ensemble":A.ellipsoid&&(y.ellps=A.ellipsoid.name,b_(A,y)),A.prime_meridian&&(y.from_greenwich=A.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":y.ellps=A.name,b_(A,y);break;case"prime_meridian":y.long0=(A.longitude||0)*Math.PI/180;break;case"coordinate_system":if(A.axis){if(y.axis=A.axis.map(P=>{const D=P.direction;if(D==="east")return"e";if(D==="north")return"n";if(D==="west")return"w";if(D==="south")return"s";throw new Error(`Unknown axis direction: ${D}`)}).join("")+"u",A.unit){const{units:P,to_meter:D}=v_(A.unit);y.units=P,y.to_meter=D}else if(A.axis[0]&&A.axis[0].unit){const{units:P,to_meter:D}=v_(A.axis[0].unit);y.units=P,y.to_meter=D}}break;case"id":A.authority&&A.code&&(y.title=A.authority+":"+A.code);break;case"conversion":A.method&&A.method.name&&(y.projName=A.method.name),A.parameters&&A.parameters.forEach(P=>{const D=P.name.toLowerCase().replace(/\s+/g,"_"),E=P.value;P.unit&&P.unit.conversion_factor?y[D]=E*P.unit.conversion_factor:P.unit==="degree"?y[D]=E*Math.PI/180:y[D]=E});break;case"unit":A.name&&(y.units=A.name.toLowerCase(),y.units==="metre"&&(y.units="meter")),A.conversion_factor&&(y.to_meter=A.conversion_factor);break;case"base_crs":qm(A,y),y.datumCode=A.id?A.id.authority+"_"+A.id.code:A.name;break}}),y.latitude_of_false_origin!==void 0&&(y.lat0=y.latitude_of_false_origin),y.longitude_of_false_origin!==void 0&&(y.long0=y.longitude_of_false_origin),y.latitude_of_standard_parallel!==void 0&&(y.lat0=y.latitude_of_standard_parallel,y.lat1=y.latitude_of_standard_parallel),y.latitude_of_1st_standard_parallel!==void 0&&(y.lat1=y.latitude_of_1st_standard_parallel),y.latitude_of_2nd_standard_parallel!==void 0&&(y.lat2=y.latitude_of_2nd_standard_parallel),y.latitude_of_projection_centre!==void 0&&(y.lat0=y.latitude_of_projection_centre),y.longitude_of_projection_centre!==void 0&&(y.longc=y.longitude_of_projection_centre),y.easting_at_false_origin!==void 0&&(y.x0=y.easting_at_false_origin),y.northing_at_false_origin!==void 0&&(y.y0=y.northing_at_false_origin),y.latitude_of_natural_origin!==void 0&&(y.lat0=y.latitude_of_natural_origin),y.longitude_of_natural_origin!==void 0&&(y.long0=y.longitude_of_natural_origin),y.longitude_of_origin!==void 0&&(y.long0=y.longitude_of_origin),y.false_easting!==void 0&&(y.x0=y.false_easting),y.easting_at_projection_centre&&(y.x0=y.easting_at_projection_centre),y.false_northing!==void 0&&(y.y0=y.false_northing),y.northing_at_projection_centre&&(y.y0=y.northing_at_projection_centre),y.standard_parallel_1!==void 0&&(y.lat1=y.standard_parallel_1),y.standard_parallel_2!==void 0&&(y.lat2=y.standard_parallel_2),y.scale_factor_at_natural_origin!==void 0&&(y.k0=y.scale_factor_at_natural_origin),y.scale_factor_at_projection_centre!==void 0&&(y.k0=y.scale_factor_at_projection_centre),y.scale_factor_on_pseudo_standard_parallel!==void 0&&(y.k0=y.scale_factor_on_pseudo_standard_parallel),y.azimuth!==void 0&&(y.alpha=y.azimuth),y.azimuth_at_projection_centre!==void 0&&(y.alpha=y.azimuth_at_projection_centre),y.angle_from_rectified_to_skew_grid&&(y.rectified_grid_angle=y.angle_from_rectified_to_skew_grid),sy(y),y)}var Av=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Cv(h,y){var w=y[0],A=y[1];!(w in h)&&A in h&&(h[w]=h[A],y.length===3&&(h[w]=y[2](h[w])))}function oy(h){for(var y=Object.keys(h),w=0,A=y.length;w<A;++w){var P=y[w];Av.indexOf(P)!==-1&&Pv(h[P]),typeof h[P]=="object"&&oy(h[P])}}function Pv(h){if(h.AUTHORITY){var y=Object.keys(h.AUTHORITY)[0];y&&y in h.AUTHORITY&&(h.title=y+":"+h.AUTHORITY[y])}if(h.type==="GEOGCS"?h.projName="longlat":h.type==="LOCAL_CS"?(h.projName="identity",h.local=!0):typeof h.PROJECTION=="object"?h.projName=Object.keys(h.PROJECTION)[0]:h.projName=h.PROJECTION,h.AXIS){for(var w="",A=0,P=h.AXIS.length;A<P;++A){var D=[h.AXIS[A][0].toLowerCase(),h.AXIS[A][1].toLowerCase()];D[0].indexOf("north")!==-1||(D[0]==="y"||D[0]==="lat")&&D[1]==="north"?w+="n":D[0].indexOf("south")!==-1||(D[0]==="y"||D[0]==="lat")&&D[1]==="south"?w+="s":D[0].indexOf("east")!==-1||(D[0]==="x"||D[0]==="lon")&&D[1]==="east"?w+="e":(D[0].indexOf("west")!==-1||(D[0]==="x"||D[0]==="lon")&&D[1]==="west")&&(w+="w")}w.length===2&&(w+="u"),w.length===3&&(h.axis=w)}h.UNIT&&(h.units=h.UNIT.name.toLowerCase(),h.units==="metre"&&(h.units="meter"),h.UNIT.convert&&(h.type==="GEOGCS"?h.DATUM&&h.DATUM.SPHEROID&&(h.to_meter=h.UNIT.convert*h.DATUM.SPHEROID.a):h.to_meter=h.UNIT.convert));var E=h.GEOGCS;h.type==="GEOGCS"&&(E=h),E&&(E.DATUM?h.datumCode=E.DATUM.name.toLowerCase():h.datumCode=E.name.toLowerCase(),h.datumCode.slice(0,2)==="d_"&&(h.datumCode=h.datumCode.slice(2)),h.datumCode==="new_zealand_1949"&&(h.datumCode="nzgd49"),(h.datumCode==="wgs_1984"||h.datumCode==="world_geodetic_system_1984")&&(h.PROJECTION==="Mercator_Auxiliary_Sphere"&&(h.sphere=!0),h.datumCode="wgs84"),h.datumCode==="belge_1972"&&(h.datumCode="rnb72"),E.DATUM&&E.DATUM.SPHEROID&&(h.ellps=E.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),h.ellps.toLowerCase().slice(0,13)==="international"&&(h.ellps="intl"),h.a=E.DATUM.SPHEROID.a,h.rf=parseFloat(E.DATUM.SPHEROID.rf,10)),E.DATUM&&E.DATUM.TOWGS84&&(h.datum_params=E.DATUM.TOWGS84),~h.datumCode.indexOf("osgb_1936")&&(h.datumCode="osgb36"),~h.datumCode.indexOf("osni_1952")&&(h.datumCode="osni52"),(~h.datumCode.indexOf("tm65")||~h.datumCode.indexOf("geodetic_datum_of_1965"))&&(h.datumCode="ire65"),h.datumCode==="ch1903+"&&(h.datumCode="ch1903"),~h.datumCode.indexOf("israel")&&(h.datumCode="isr93")),h.b&&!isFinite(h.b)&&(h.b=h.a),h.rectified_grid_angle&&(h.rectified_grid_angle=Sl(h.rectified_grid_angle));function l(ee){var J=h.to_meter||1;return ee*J}var B=function(ee){return Cv(h,ee)},U=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Sl],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Sl],["x0","false_easting",l],["y0","false_northing",l],["long0","central_meridian",Sl],["lat0","latitude_of_origin",Sl],["lat0","standard_parallel_1",Sl],["lat1","standard_parallel_1",Sl],["lat2","standard_parallel_2",Sl],["azimuth","Azimuth"],["alpha","azimuth",Sl],["srsCode","name"]];U.forEach(B),sy(h)}function zg(h){if(typeof h=="object")return qm(h);const y=bv(h);var w=Tv(h);if(y==="WKT2"){const D=xv(w);return qm(D)}var A=w[0],P={};return lf(w,P),oy(P),P[A]}function Yr(h){var y=this;if(arguments.length===2){var w=arguments[1];typeof w=="string"?w.charAt(0)==="+"?Yr[h]=Pg(arguments[1]):Yr[h]=zg(arguments[1]):Yr[h]=w}else if(arguments.length===1){if(Array.isArray(h))return h.map(function(A){return Array.isArray(A)?Yr.apply(y,A):Yr(A)});if(typeof h=="string"){if(h in Yr)return Yr[h]}else"EPSG"in h?Yr["EPSG:"+h.EPSG]=h:"ESRI"in h?Yr["ESRI:"+h.ESRI]=h:"IAU2000"in h?Yr["IAU2000:"+h.IAU2000]=h:console.log(h);return}}uv(Yr);function zv(h){return typeof h=="string"}function Iv(h){return h in Yr}function Rv(h){return h.indexOf("+")!==0&&h.indexOf("[")!==-1||typeof h=="object"&&!("srsCode"in h)}var Dv=["3857","900913","3785","102113"];function kv(h){var y=eh(h,"authority");if(y){var w=eh(y,"epsg");return w&&Dv.indexOf(w)>-1}}function Lv(h){var y=eh(h,"extension");if(y)return eh(y,"proj4")}function Ov(h){return h[0]==="+"}function Bv(h){if(zv(h)){if(Iv(h))return Yr[h];if(Rv(h)){var y=zg(h);if(kv(y))return Yr["EPSG:3857"];var w=Lv(y);return w?Pg(w):y}if(Ov(h))return Pg(h)}else return"projName"in h?h:zg(h)}function w_(h,y){h=h||{};var w,A;if(!y)return h;for(A in y)w=y[A],w!==void 0&&(h[A]=w);return h}function uc(h,y,w){var A=h*y;return w/Math.sqrt(1-A*A)}function Np(h){return h<0?-1:1}function At(h){return Math.abs(h)<=fn?h:h-Np(h)*Ip}function Ml(h,y,w){var A=h*w,P=.5*h;return A=Math.pow((1-A)/(1+A),P),Math.tan(.5*(lt-y))/A}function Dp(h,y){for(var w=.5*h,A,P,D=lt-2*Math.atan(y),E=0;E<=15;E++)if(A=h*Math.sin(D),P=lt-2*Math.atan(y*Math.pow((1-A)/(1+A),w))-D,D+=P,Math.abs(P)<=1e-10)return D;return-9999}function Nv(){var h=this.b/this.a;this.es=1-h*h,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=uc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function jv(h){var y=h.x,w=h.y;if(w*lc>90&&w*lc<-90&&y*lc>180&&y*lc<-180)return null;var A,P;if(Math.abs(Math.abs(w)-lt)<=bt)return null;if(this.sphere)A=this.x0+this.a*this.k0*At(y-this.long0),P=this.y0+this.a*this.k0*Math.log(Math.tan(ia+.5*w));else{var D=Math.sin(w),E=Ml(this.e,w,D);A=this.x0+this.a*this.k0*At(y-this.long0),P=this.y0-this.a*this.k0*Math.log(E)}return h.x=A,h.y=P,h}function Gv(h){var y=h.x-this.x0,w=h.y-this.y0,A,P;if(this.sphere)P=lt-2*Math.atan(Math.exp(-w/(this.a*this.k0)));else{var D=Math.exp(-w/(this.a*this.k0));if(P=Dp(this.e,D),P===-9999)return null}return A=At(this.long0+y/(this.a*this.k0)),h.x=A,h.y=P,h}var Fv=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Uv={init:Nv,forward:jv,inverse:Gv,names:Fv};function Vv(){}function S_(h){return h}var qv=["longlat","identity"];const Zv={init:Vv,forward:S_,inverse:S_,names:qv};var $v=[Uv,Zv],sd={},cf=[];function ly(h,y){var w=cf.length;return h.names?(cf[w]=h,h.names.forEach(function(A){sd[A.toLowerCase()]=w}),this):(console.log(y),!0)}function cy(h){return h.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function Hv(h){if(!h)return!1;var y=h.toLowerCase();if(typeof sd[y]<"u"&&cf[sd[y]]||(y=cy(y),y in sd&&cf[sd[y]]))return cf[sd[y]]}function Xv(){$v.forEach(ly)}const Yv={start:Xv,add:ly,get:Hv};var uy={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const Wv=uy.WGS84;function Qv(h,y,w,A){var P=h*h,D=y*y,E=(P-D)/P,l=0;A?(h*=1-E*(fv+E*(pv+E*mv)),P=h*h,E=0):l=Math.sqrt(E);var B=(P-D)/D;return{es:E,e:l,ep2:B}}function Kv(h,y,w,A,P){if(!h){var D=eh(uy,A);D||(D=Wv),h=D.a,y=D.b,w=D.rf}return w&&!y&&(y=(1-1/w)*h),(w===0||Math.abs(h-y)<bt)&&(P=!0,y=h),{a:h,b:y,rf:w,sphere:P}}var Nm={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Jv in Nm){var Sg=Nm[Jv];Sg.datumName&&(Nm[Sg.datumName]=Sg)}function e1(h,y,w,A,P,D,E){var l={};return h===void 0||h==="none"?l.datum_type=Cg:l.datum_type=hv,y&&(l.datum_params=y.map(parseFloat),(l.datum_params[0]!==0||l.datum_params[1]!==0||l.datum_params[2]!==0)&&(l.datum_type=od),l.datum_params.length>3&&(l.datum_params[3]!==0||l.datum_params[4]!==0||l.datum_params[5]!==0||l.datum_params[6]!==0)&&(l.datum_type=ld,l.datum_params[3]*=Tp,l.datum_params[4]*=Tp,l.datum_params[5]*=Tp,l.datum_params[6]=l.datum_params[6]/1e6+1)),E&&(l.datum_type=df,l.grids=E),l.a=w,l.b=A,l.es=P,l.ep2=D,l}var Zg={};function t1(h,y,w){return y instanceof ArrayBuffer?i1(h,y,w):{ready:a1(h,y)}}function i1(h,y,w){var A=!0;w!==void 0&&w.includeErrorFields===!1&&(A=!1);var P=new DataView(y),D=s1(P),E=o1(P,D),l=l1(P,E,D,A),B={header:E,subgrids:l};return Zg[h]=B,B}async function a1(h,y){for(var w=[],A=await y.getImageCount(),P=A-1;P>=0;P--){var D=await y.getImage(P),E=await D.readRasters(),l=E,B=[D.getWidth(),D.getHeight()],U=D.getBoundingBox().map(M_),ee=[D.fileDirectory.ModelPixelScale[0],D.fileDirectory.ModelPixelScale[1]].map(M_),J=U[0]+(B[0]-1)*ee[0],W=U[3]-(B[1]-1)*ee[1],K=l[0],ve=l[1],Ce=[];for(let Ue=B[1]-1;Ue>=0;Ue--)for(let He=B[0]-1;He>=0;He--){var Pe=Ue*B[0]+He;Ce.push([-Ku(ve[Pe]),Ku(K[Pe])])}w.push({del:ee,lim:B,ll:[-J,W],cvs:Ce})}var Fe={header:{nSubgrids:A},subgrids:w};return Zg[h]=Fe,Fe}function n1(h){if(h===void 0)return null;var y=h.split(",");return y.map(r1)}function r1(h){if(h.length===0)return null;var y=h[0]==="@";return y&&(h=h.slice(1)),h==="null"?{name:"null",mandatory:!y,grid:null,isNull:!0}:{name:h,mandatory:!y,grid:Zg[h]||null,isNull:!1}}function M_(h){return h*Math.PI/180}function Ku(h){return h/3600*Math.PI/180}function s1(h){var y=h.getInt32(8,!1);return y===11?!1:(y=h.getInt32(8,!0),y!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function o1(h,y){return{nFields:h.getInt32(8,y),nSubgridFields:h.getInt32(24,y),nSubgrids:h.getInt32(40,y),shiftType:Ig(h,56,64).trim(),fromSemiMajorAxis:h.getFloat64(120,y),fromSemiMinorAxis:h.getFloat64(136,y),toSemiMajorAxis:h.getFloat64(152,y),toSemiMinorAxis:h.getFloat64(168,y)}}function Ig(h,y,w){return String.fromCharCode.apply(null,new Uint8Array(h.buffer.slice(y,w)))}function l1(h,y,w,A){for(var P=176,D=[],E=0;E<y.nSubgrids;E++){var l=u1(h,P,w),B=h1(h,P,l,w,A),U=Math.round(1+(l.upperLongitude-l.lowerLongitude)/l.longitudeInterval),ee=Math.round(1+(l.upperLatitude-l.lowerLatitude)/l.latitudeInterval);D.push({ll:[Ku(l.lowerLongitude),Ku(l.lowerLatitude)],del:[Ku(l.longitudeInterval),Ku(l.latitudeInterval)],lim:[U,ee],count:l.gridNodeCount,cvs:c1(B)});var J=16;A===!1&&(J=8),P+=176+l.gridNodeCount*J}return D}function c1(h){return h.map(function(y){return[Ku(y.longitudeShift),Ku(y.latitudeShift)]})}function u1(h,y,w){return{name:Ig(h,y+8,y+16).trim(),parent:Ig(h,y+24,y+24+8).trim(),lowerLatitude:h.getFloat64(y+72,w),upperLatitude:h.getFloat64(y+88,w),lowerLongitude:h.getFloat64(y+104,w),upperLongitude:h.getFloat64(y+120,w),latitudeInterval:h.getFloat64(y+136,w),longitudeInterval:h.getFloat64(y+152,w),gridNodeCount:h.getInt32(y+168,w)}}function h1(h,y,w,A,P){var D=y+176,E=16;P===!1&&(E=8);for(var l=[],B=0;B<w.gridNodeCount;B++){var U={latitudeShift:h.getFloat32(D+B*E,A),longitudeShift:h.getFloat32(D+B*E+4,A)};P!==!1&&(U.latitudeAccuracy=h.getFloat32(D+B*E+8,A),U.longitudeAccuracy=h.getFloat32(D+B*E+12,A)),l.push(U)}return l}function Tl(h,y){if(!(this instanceof Tl))return new Tl(h);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,y=y||function(U){if(U)throw U};var w=Bv(h);if(typeof w!="object"){y("Could not parse to valid json: "+h);return}var A=Tl.projections.get(w.projName);if(!A){y("Could not get projection name from: "+h);return}if(w.datumCode&&w.datumCode!=="none"){var P=eh(Nm,w.datumCode);P&&(w.datum_params=w.datum_params||(P.towgs84?P.towgs84.split(","):null),w.ellps=P.ellipse,w.datumName=P.datumName?P.datumName:w.datumCode)}w.k0=w.k0||1,w.axis=w.axis||"enu",w.ellps=w.ellps||"wgs84",w.lat1=w.lat1||w.lat0;var D=Kv(w.a,w.b,w.rf,w.ellps,w.sphere),E=Qv(D.a,D.b,D.rf,w.R_A),l=n1(w.nadgrids),B=w.datum||e1(w.datumCode,w.datum_params,D.a,D.b,E.es,E.ep2,l);w_(this,w),w_(this,A),this.a=D.a,this.b=D.b,this.rf=D.rf,this.sphere=D.sphere,this.es=E.es,this.e=E.e,this.ep2=E.ep2,this.datum=B,"init"in this&&typeof this.init=="function"&&this.init(),y(null,this)}Tl.projections=Yv;Tl.projections.start();function d1(h,y){return h.datum_type!==y.datum_type||h.a!==y.a||Math.abs(h.es-y.es)>5e-11?!1:h.datum_type===od?h.datum_params[0]===y.datum_params[0]&&h.datum_params[1]===y.datum_params[1]&&h.datum_params[2]===y.datum_params[2]:h.datum_type===ld?h.datum_params[0]===y.datum_params[0]&&h.datum_params[1]===y.datum_params[1]&&h.datum_params[2]===y.datum_params[2]&&h.datum_params[3]===y.datum_params[3]&&h.datum_params[4]===y.datum_params[4]&&h.datum_params[5]===y.datum_params[5]&&h.datum_params[6]===y.datum_params[6]:!0}function hy(h,y,w){var A=h.x,P=h.y,D=h.z?h.z:0,E,l,B,U;if(P<-lt&&P>-1.001*lt)P=-lt;else if(P>lt&&P<1.001*lt)P=lt;else{if(P<-lt)return{x:-1/0,y:-1/0,z:h.z};if(P>lt)return{x:1/0,y:1/0,z:h.z}}return A>Math.PI&&(A-=2*Math.PI),l=Math.sin(P),U=Math.cos(P),B=l*l,E=w/Math.sqrt(1-y*B),{x:(E+D)*U*Math.cos(A),y:(E+D)*U*Math.sin(A),z:(E*(1-y)+D)*l}}function dy(h,y,w,A){var P=1e-12,D=P*P,E=30,l,B,U,ee,J,W,K,ve,Ce,Pe,Fe,Ue,He,mt=h.x,Mt=h.y,Pt=h.z?h.z:0,_t,ei,Vt;if(l=Math.sqrt(mt*mt+Mt*Mt),B=Math.sqrt(mt*mt+Mt*Mt+Pt*Pt),l/w<P){if(_t=0,B/w<P)return ei=lt,Vt=-A,{x:h.x,y:h.y,z:h.z}}else _t=Math.atan2(Mt,mt);U=Pt/B,ee=l/B,J=1/Math.sqrt(1-y*(2-y)*ee*ee),ve=ee*(1-y)*J,Ce=U*J,He=0;do He++,K=w/Math.sqrt(1-y*Ce*Ce),Vt=l*ve+Pt*Ce-K*(1-y*Ce*Ce),W=y*K/(K+Vt),J=1/Math.sqrt(1-W*(2-W)*ee*ee),Pe=ee*(1-W)*J,Fe=U*J,Ue=Fe*ve-Pe*Ce,ve=Pe,Ce=Fe;while(Ue*Ue>D&&He<E);return ei=Math.atan(Fe/Math.abs(Pe)),{x:_t,y:ei,z:Vt}}function f1(h,y,w){if(y===od)return{x:h.x+w[0],y:h.y+w[1],z:h.z+w[2]};if(y===ld){var A=w[0],P=w[1],D=w[2],E=w[3],l=w[4],B=w[5],U=w[6];return{x:U*(h.x-B*h.y+l*h.z)+A,y:U*(B*h.x+h.y-E*h.z)+P,z:U*(-l*h.x+E*h.y+h.z)+D}}}function p1(h,y,w){if(y===od)return{x:h.x-w[0],y:h.y-w[1],z:h.z-w[2]};if(y===ld){var A=w[0],P=w[1],D=w[2],E=w[3],l=w[4],B=w[5],U=w[6],ee=(h.x-A)/U,J=(h.y-P)/U,W=(h.z-D)/U;return{x:ee+B*J-l*W,y:-B*ee+J+E*W,z:l*ee-E*J+W}}}function Im(h){return h===od||h===ld}function m1(h,y,w){if(d1(h,y)||h.datum_type===Cg||y.datum_type===Cg)return w;var A=h.a,P=h.es;if(h.datum_type===df){var D=T_(h,!1,w);if(D!==0)return;A=g_,P=__}var E=y.a,l=y.b,B=y.es;if(y.datum_type===df&&(E=g_,l=dv,B=__),P===B&&A===E&&!Im(h.datum_type)&&!Im(y.datum_type))return w;if(w=hy(w,P,A),Im(h.datum_type)&&(w=f1(w,h.datum_type,h.datum_params)),Im(y.datum_type)&&(w=p1(w,y.datum_type,y.datum_params)),w=dy(w,B,E,l),y.datum_type===df){var U=T_(y,!0,w);if(U!==0)return}return w}function T_(h,y,w){if(h.grids===null||h.grids.length===0)return console.log("Grid shift grids not found"),-1;var A={x:-w.x,y:w.y},P={x:Number.NaN,y:Number.NaN},D=[];e:for(var E=0;E<h.grids.length;E++){var l=h.grids[E];if(D.push(l.name),l.isNull){P=A;break}if(l.grid===null){if(l.mandatory)return console.log("Unable to find mandatory grid '"+l.name+"'"),-1;continue}for(var B=l.grid.subgrids,U=0,ee=B.length;U<ee;U++){var J=B[U],W=(Math.abs(J.del[1])+Math.abs(J.del[0]))/1e4,K=J.ll[0]-W,ve=J.ll[1]-W,Ce=J.ll[0]+(J.lim[0]-1)*J.del[0]+W,Pe=J.ll[1]+(J.lim[1]-1)*J.del[1]+W;if(!(ve>A.y||K>A.x||Pe<A.y||Ce<A.x)&&(P=g1(A,y,J),!isNaN(P.x)))break e}}return isNaN(P.x)?(console.log("Failed to find a grid shift table for location '"+-A.x*lc+" "+A.y*lc+" tried: '"+D+"'"),-1):(w.x=-P.x,w.y=P.y,0)}function g1(h,y,w){var A={x:Number.NaN,y:Number.NaN};if(isNaN(h.x))return A;var P={x:h.x,y:h.y};P.x-=w.ll[0],P.y-=w.ll[1],P.x=At(P.x-Math.PI)+Math.PI;var D=E_(P,w);if(y){if(isNaN(D.x))return A;D.x=P.x-D.x,D.y=P.y-D.y;var E=9,l=1e-12,B,U;do{if(U=E_(D,w),isNaN(U.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}B={x:P.x-(U.x+D.x),y:P.y-(U.y+D.y)},D.x+=B.x,D.y+=B.y}while(E--&&Math.abs(B.x)>l&&Math.abs(B.y)>l);if(E<0)return console.log("Inverse grid shift iterator failed to converge."),A;A.x=At(D.x+w.ll[0]),A.y=D.y+w.ll[1]}else isNaN(D.x)||(A.x=h.x+D.x,A.y=h.y+D.y);return A}function E_(h,y){var w={x:h.x/y.del[0],y:h.y/y.del[1]},A={x:Math.floor(w.x),y:Math.floor(w.y)},P={x:w.x-1*A.x,y:w.y-1*A.y},D={x:Number.NaN,y:Number.NaN},E;if(A.x<0||A.x>=y.lim[0]||A.y<0||A.y>=y.lim[1])return D;E=A.y*y.lim[0]+A.x;var l={x:y.cvs[E][0],y:y.cvs[E][1]};E++;var B={x:y.cvs[E][0],y:y.cvs[E][1]};E+=y.lim[0];var U={x:y.cvs[E][0],y:y.cvs[E][1]};E--;var ee={x:y.cvs[E][0],y:y.cvs[E][1]},J=P.x*P.y,W=P.x*(1-P.y),K=(1-P.x)*(1-P.y),ve=(1-P.x)*P.y;return D.x=K*l.x+W*B.x+ve*ee.x+J*U.x,D.y=K*l.y+W*B.y+ve*ee.y+J*U.y,D}function A_(h,y,w){var A=w.x,P=w.y,D=w.z||0,E,l,B,U={};for(B=0;B<3;B++)if(!(y&&B===2&&w.z===void 0))switch(B===0?(E=A,"ew".indexOf(h.axis[B])!==-1?l="x":l="y"):B===1?(E=P,"ns".indexOf(h.axis[B])!==-1?l="y":l="x"):(E=D,l="z"),h.axis[B]){case"e":U[l]=E;break;case"w":U[l]=-E;break;case"n":U[l]=E;break;case"s":U[l]=-E;break;case"u":w[l]!==void 0&&(U.z=E);break;case"d":w[l]!==void 0&&(U.z=-E);break;default:return null}return U}function fy(h){var y={x:h[0],y:h[1]};return h.length>2&&(y.z=h[2]),h.length>3&&(y.m=h[3]),y}function _1(h){C_(h.x),C_(h.y)}function C_(h){if(typeof Number.isFinite=="function"){if(Number.isFinite(h))return;throw new TypeError("coordinates must be finite numbers")}if(typeof h!="number"||h!==h||!isFinite(h))throw new TypeError("coordinates must be finite numbers")}function y1(h,y){return(h.datum.datum_type===od||h.datum.datum_type===ld||h.datum.datum_type===df)&&y.datumCode!=="WGS84"||(y.datum.datum_type===od||y.datum.datum_type===ld||y.datum.datum_type===df)&&h.datumCode!=="WGS84"}function Zm(h,y,w,A){var P;Array.isArray(w)?w=fy(w):w={x:w.x,y:w.y,z:w.z,m:w.m};var D=w.z!==void 0;if(_1(w),h.datum&&y.datum&&y1(h,y)&&(P=new Tl("WGS84"),w=Zm(h,P,w,A),h=P),A&&h.axis!=="enu"&&(w=A_(h,!1,w)),h.projName==="longlat")w={x:w.x*dr,y:w.y*dr,z:w.z||0};else if(h.to_meter&&(w={x:w.x*h.to_meter,y:w.y*h.to_meter,z:w.z||0}),w=h.inverse(w),!w)return;if(h.from_greenwich&&(w.x+=h.from_greenwich),w=m1(h.datum,y.datum,w),!!w)return w=w,y.from_greenwich&&(w={x:w.x-y.from_greenwich,y:w.y,z:w.z||0}),y.projName==="longlat"?w={x:w.x*lc,y:w.y*lc,z:w.z||0}:(w=y.forward(w),y.to_meter&&(w={x:w.x/y.to_meter,y:w.y/y.to_meter,z:w.z||0})),A&&y.axis!=="enu"?A_(y,!0,w):(w&&!D&&delete w.z,w)}var P_=Tl("WGS84");function Mg(h,y,w,A){var P,D,E;return Array.isArray(w)?(P=Zm(h,y,w,A)||{x:NaN,y:NaN},w.length>2?typeof h.name<"u"&&h.name==="geocent"||typeof y.name<"u"&&y.name==="geocent"?typeof P.z=="number"?[P.x,P.y,P.z].concat(w.slice(3)):[P.x,P.y,w[2]].concat(w.slice(3)):[P.x,P.y].concat(w.slice(2)):[P.x,P.y]):(D=Zm(h,y,w,A),E=Object.keys(w),E.length===2||E.forEach(function(l){if(typeof h.name<"u"&&h.name==="geocent"||typeof y.name<"u"&&y.name==="geocent"){if(l==="x"||l==="y"||l==="z")return}else if(l==="x"||l==="y")return;D[l]=w[l]}),D)}function Rm(h){return h instanceof Tl?h:typeof h=="object"&&"oProj"in h?h.oProj:Tl(h)}function v1(h,y,w){var A,P,D=!1,E;return typeof y>"u"?(P=Rm(h),A=P_,D=!0):(typeof y.x<"u"||Array.isArray(y))&&(w=y,P=Rm(h),A=P_,D=!0),A||(A=Rm(h)),P||(P=Rm(y)),w?Mg(A,P,w):(E={forward:function(l,B){return Mg(A,P,l,B)},inverse:function(l,B){return Mg(P,A,l,B)}},D&&(E.oProj=P),E)}var z_=6,py="AJSAJS",my="AFAFAF",uf=65,ys=73,No=79,wp=86,Sp=90;const x1={forward:gy,inverse:b1,toPoint:_y};function gy(h,y){return y=y||5,M1(w1({lat:h[1],lon:h[0]}),y)}function b1(h){var y=$g(vy(h.toUpperCase()));return y.lat&&y.lon?[y.lon,y.lat,y.lon,y.lat]:[y.left,y.bottom,y.right,y.top]}function _y(h){var y=$g(vy(h.toUpperCase()));return y.lat&&y.lon?[y.lon,y.lat]:[(y.left+y.right)/2,(y.top+y.bottom)/2]}function Tg(h){return h*(Math.PI/180)}function I_(h){return 180*(h/Math.PI)}function w1(h){var y=h.lat,w=h.lon,A=6378137,P=.00669438,D=.9996,E,l,B,U,ee,J,W,K=Tg(y),ve=Tg(w),Ce,Pe;Pe=Math.floor((w+180)/6)+1,w===180&&(Pe=60),y>=56&&y<64&&w>=3&&w<12&&(Pe=32),y>=72&&y<84&&(w>=0&&w<9?Pe=31:w>=9&&w<21?Pe=33:w>=21&&w<33?Pe=35:w>=33&&w<42&&(Pe=37)),E=(Pe-1)*6-180+3,Ce=Tg(E),l=P/(1-P),B=A/Math.sqrt(1-P*Math.sin(K)*Math.sin(K)),U=Math.tan(K)*Math.tan(K),ee=l*Math.cos(K)*Math.cos(K),J=Math.cos(K)*(ve-Ce),W=A*((1-P/4-3*P*P/64-5*P*P*P/256)*K-(3*P/8+3*P*P/32+45*P*P*P/1024)*Math.sin(2*K)+(15*P*P/256+45*P*P*P/1024)*Math.sin(4*K)-35*P*P*P/3072*Math.sin(6*K));var Fe=D*B*(J+(1-U+ee)*J*J*J/6+(5-18*U+U*U+72*ee-58*l)*J*J*J*J*J/120)+5e5,Ue=D*(W+B*Math.tan(K)*(J*J/2+(5-U+9*ee+4*ee*ee)*J*J*J*J/24+(61-58*U+U*U+600*ee-330*l)*J*J*J*J*J*J/720));return y<0&&(Ue+=1e7),{northing:Math.round(Ue),easting:Math.round(Fe),zoneNumber:Pe,zoneLetter:S1(y)}}function $g(h){var y=h.northing,w=h.easting,A=h.zoneLetter,P=h.zoneNumber;if(P<0||P>60)return null;var D=.9996,E=6378137,l=.00669438,B,U=(1-Math.sqrt(1-l))/(1+Math.sqrt(1-l)),ee,J,W,K,ve,Ce,Pe,Fe,Ue,He=w-5e5,mt=y;A<"N"&&(mt-=1e7),Pe=(P-1)*6-180+3,B=l/(1-l),Ce=mt/D,Fe=Ce/(E*(1-l/4-3*l*l/64-5*l*l*l/256)),Ue=Fe+(3*U/2-27*U*U*U/32)*Math.sin(2*Fe)+(21*U*U/16-55*U*U*U*U/32)*Math.sin(4*Fe)+151*U*U*U/96*Math.sin(6*Fe),ee=E/Math.sqrt(1-l*Math.sin(Ue)*Math.sin(Ue)),J=Math.tan(Ue)*Math.tan(Ue),W=B*Math.cos(Ue)*Math.cos(Ue),K=E*(1-l)/Math.pow(1-l*Math.sin(Ue)*Math.sin(Ue),1.5),ve=He/(ee*D);var Mt=Ue-ee*Math.tan(Ue)/K*(ve*ve/2-(5+3*J+10*W-4*W*W-9*B)*ve*ve*ve*ve/24+(61+90*J+298*W+45*J*J-252*B-3*W*W)*ve*ve*ve*ve*ve*ve/720);Mt=I_(Mt);var Pt=(ve-(1+2*J+W)*ve*ve*ve/6+(5-2*W+28*J-3*W*W+8*B+24*J*J)*ve*ve*ve*ve*ve/120)/Math.cos(Ue);Pt=Pe+I_(Pt);var _t;if(h.accuracy){var ei=$g({northing:h.northing+h.accuracy,easting:h.easting+h.accuracy,zoneLetter:h.zoneLetter,zoneNumber:h.zoneNumber});_t={top:ei.lat,right:ei.lon,bottom:Mt,left:Pt}}else _t={lat:Mt,lon:Pt};return _t}function S1(h){var y="Z";return 84>=h&&h>=72?y="X":72>h&&h>=64?y="W":64>h&&h>=56?y="V":56>h&&h>=48?y="U":48>h&&h>=40?y="T":40>h&&h>=32?y="S":32>h&&h>=24?y="R":24>h&&h>=16?y="Q":16>h&&h>=8?y="P":8>h&&h>=0?y="N":0>h&&h>=-8?y="M":-8>h&&h>=-16?y="L":-16>h&&h>=-24?y="K":-24>h&&h>=-32?y="J":-32>h&&h>=-40?y="H":-40>h&&h>=-48?y="G":-48>h&&h>=-56?y="F":-56>h&&h>=-64?y="E":-64>h&&h>=-72?y="D":-72>h&&h>=-80&&(y="C"),y}function M1(h,y){var w="00000"+h.easting,A="00000"+h.northing;return h.zoneNumber+h.zoneLetter+T1(h.easting,h.northing,h.zoneNumber)+w.substr(w.length-5,y)+A.substr(A.length-5,y)}function T1(h,y,w){var A=yy(w),P=Math.floor(h/1e5),D=Math.floor(y/1e5)%20;return E1(P,D,A)}function yy(h){var y=h%z_;return y===0&&(y=z_),y}function E1(h,y,w){var A=w-1,P=py.charCodeAt(A),D=my.charCodeAt(A),E=P+h-1,l=D+y,B=!1;E>Sp&&(E=E-Sp+uf-1,B=!0),(E===ys||P<ys&&E>ys||(E>ys||P<ys)&&B)&&E++,(E===No||P<No&&E>No||(E>No||P<No)&&B)&&(E++,E===ys&&E++),E>Sp&&(E=E-Sp+uf-1),l>wp?(l=l-wp+uf-1,B=!0):B=!1,(l===ys||D<ys&&l>ys||(l>ys||D<ys)&&B)&&l++,(l===No||D<No&&l>No||(l>No||D<No)&&B)&&(l++,l===ys&&l++),l>wp&&(l=l-wp+uf-1);var U=String.fromCharCode(E)+String.fromCharCode(l);return U}function vy(h){if(h&&h.length===0)throw"MGRSPoint coverting from nothing";for(var y=h.length,w=null,A="",P,D=0;!/[A-Z]/.test(P=h.charAt(D));){if(D>=2)throw"MGRSPoint bad conversion from: "+h;A+=P,D++}var E=parseInt(A,10);if(D===0||D+3>y)throw"MGRSPoint bad conversion from: "+h;var l=h.charAt(D++);if(l<="A"||l==="B"||l==="Y"||l>="Z"||l==="I"||l==="O")throw"MGRSPoint zone letter "+l+" not handled: "+h;w=h.substring(D,D+=2);for(var B=yy(E),U=A1(w.charAt(0),B),ee=C1(w.charAt(1),B);ee<P1(l);)ee+=2e6;var J=y-D;if(J%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+h;var W=J/2,K=0,ve=0,Ce,Pe,Fe,Ue,He;return W>0&&(Ce=1e5/Math.pow(10,W),Pe=h.substring(D,D+W),K=parseFloat(Pe)*Ce,Fe=h.substring(D+W),ve=parseFloat(Fe)*Ce),Ue=K+U,He=ve+ee,{easting:Ue,northing:He,zoneLetter:l,zoneNumber:E,accuracy:Ce}}function A1(h,y){for(var w=py.charCodeAt(y-1),A=1e5,P=!1;w!==h.charCodeAt(0);){if(w++,w===ys&&w++,w===No&&w++,w>Sp){if(P)throw"Bad character: "+h;w=uf,P=!0}A+=1e5}return A}function C1(h,y){if(h>"V")throw"MGRSPoint given invalid Northing "+h;for(var w=my.charCodeAt(y-1),A=0,P=!1;w!==h.charCodeAt(0);){if(w++,w===ys&&w++,w===No&&w++,w>wp){if(P)throw"Bad character: "+h;w=uf,P=!0}A+=1e5}return A}function P1(h){var y;switch(h){case"C":y=11e5;break;case"D":y=2e6;break;case"E":y=28e5;break;case"F":y=37e5;break;case"G":y=46e5;break;case"H":y=55e5;break;case"J":y=64e5;break;case"K":y=73e5;break;case"L":y=82e5;break;case"M":y=91e5;break;case"N":y=0;break;case"P":y=8e5;break;case"Q":y=17e5;break;case"R":y=26e5;break;case"S":y=35e5;break;case"T":y=44e5;break;case"U":y=53e5;break;case"V":y=62e5;break;case"W":y=7e6;break;case"X":y=79e5;break;default:y=-1}if(y>=0)return y;throw"Invalid zone letter: "+h}function pf(h,y,w){if(!(this instanceof pf))return new pf(h,y,w);if(Array.isArray(h))this.x=h[0],this.y=h[1],this.z=h[2]||0;else if(typeof h=="object")this.x=h.x,this.y=h.y,this.z=h.z||0;else if(typeof h=="string"&&typeof y>"u"){var A=h.split(",");this.x=parseFloat(A[0]),this.y=parseFloat(A[1]),this.z=parseFloat(A[2])||0}else this.x=h,this.y=y,this.z=w||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}pf.fromMGRS=function(h){return new pf(_y(h))};pf.prototype.toMGRS=function(h){return gy([this.x,this.y],h)};var z1=1,I1=.25,R_=.046875,D_=.01953125,k_=.01068115234375,R1=.75,D1=.46875,k1=.013020833333333334,L1=.007120768229166667,O1=.3645833333333333,B1=.005696614583333333,N1=.3076171875;function Hg(h){var y=[];y[0]=z1-h*(I1+h*(R_+h*(D_+h*k_))),y[1]=h*(R1-h*(R_+h*(D_+h*k_)));var w=h*h;return y[2]=w*(D1-h*(k1+h*L1)),w*=h,y[3]=w*(O1-h*B1),y[4]=w*h*N1,y}function _f(h,y,w,A){return w*=y,y*=y,A[0]*h-w*(A[1]+y*(A[2]+y*(A[3]+y*A[4])))}var j1=20;function Xg(h,y,w){for(var A=1/(1-y),P=h,D=j1;D;--D){var E=Math.sin(P),l=1-y*E*E;if(l=(_f(P,E,Math.cos(P),w)-h)*(l*Math.sqrt(l))*A,P-=l,Math.abs(l)<bt)return P}return P}function G1(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=Hg(this.es),this.ml0=_f(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function F1(h){var y=h.x,w=h.y,A=At(y-this.long0),P,D,E,l=Math.sin(w),B=Math.cos(w);if(this.es){var ee=B*A,J=Math.pow(ee,2),W=this.ep2*Math.pow(B,2),K=Math.pow(W,2),ve=Math.abs(B)>bt?Math.tan(w):0,Ce=Math.pow(ve,2),Pe=Math.pow(Ce,2);P=1-this.es*Math.pow(l,2),ee=ee/Math.sqrt(P);var Fe=_f(w,l,B,this.en);D=this.a*(this.k0*ee*(1+J/6*(1-Ce+W+J/20*(5-18*Ce+Pe+14*W-58*Ce*W+J/42*(61+179*Pe-Pe*Ce-479*Ce)))))+this.x0,E=this.a*(this.k0*(Fe-this.ml0+l*A*ee/2*(1+J/12*(5-Ce+9*W+4*K+J/30*(61+Pe-58*Ce+270*W-330*Ce*W+J/56*(1385+543*Pe-Pe*Ce-3111*Ce))))))+this.y0}else{var U=B*Math.sin(A);if(Math.abs(Math.abs(U)-1)<bt)return 93;if(D=.5*this.a*this.k0*Math.log((1+U)/(1-U))+this.x0,E=B*Math.cos(A)/Math.sqrt(1-Math.pow(U,2)),U=Math.abs(E),U>=1){if(U-1>bt)return 93;E=0}else E=Math.acos(E);w<0&&(E=-E),E=this.a*this.k0*(E-this.lat0)+this.y0}return h.x=D,h.y=E,h}function U1(h){var y,w,A,P,D=(h.x-this.x0)*(1/this.a),E=(h.y-this.y0)*(1/this.a);if(this.es)if(y=this.ml0+E/this.k0,w=Xg(y,this.es,this.en),Math.abs(w)<lt){var J=Math.sin(w),W=Math.cos(w),K=Math.abs(W)>bt?Math.tan(w):0,ve=this.ep2*Math.pow(W,2),Ce=Math.pow(ve,2),Pe=Math.pow(K,2),Fe=Math.pow(Pe,2);y=1-this.es*Math.pow(J,2);var Ue=D*Math.sqrt(y)/this.k0,He=Math.pow(Ue,2);y=y*K,A=w-y*He/(1-this.es)*.5*(1-He/12*(5+3*Pe-9*ve*Pe+ve-4*Ce-He/30*(61+90*Pe-252*ve*Pe+45*Fe+46*ve-He/56*(1385+3633*Pe+4095*Fe+1574*Fe*Pe)))),P=At(this.long0+Ue*(1-He/6*(1+2*Pe+ve-He/20*(5+28*Pe+24*Fe+8*ve*Pe+6*ve-He/42*(61+662*Pe+1320*Fe+720*Fe*Pe))))/W)}else A=lt*Np(E),P=0;else{var l=Math.exp(D/this.k0),B=.5*(l-1/l),U=this.lat0+E/this.k0,ee=Math.cos(U);y=Math.sqrt((1-Math.pow(ee,2))/(1+Math.pow(B,2))),A=Math.asin(y),E<0&&(A=-A),B===0&&ee===0?P=0:P=At(Math.atan2(B,ee)+this.long0)}return h.x=P,h.y=A,h}var V1=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const jm={init:G1,forward:F1,inverse:U1,names:V1};function xy(h){var y=Math.exp(h);return y=(y-1/y)/2,y}function vs(h,y){h=Math.abs(h),y=Math.abs(y);var w=Math.max(h,y),A=Math.min(h,y)/(w||1);return w*Math.sqrt(1+Math.pow(A,2))}function q1(h){var y=1+h,w=y-1;return w===0?h:h*Math.log(y)/w}function Z1(h){var y=Math.abs(h);return y=q1(y*(1+y/(vs(1,y)+1))),h<0?-y:y}function Yg(h,y){for(var w=2*Math.cos(2*y),A=h.length-1,P=h[A],D=0,E;--A>=0;)E=-D+w*P+h[A],D=P,P=E;return y+E*Math.sin(2*y)}function $1(h,y){for(var w=2*Math.cos(y),A=h.length-1,P=h[A],D=0,E;--A>=0;)E=-D+w*P+h[A],D=P,P=E;return Math.sin(y)*E}function H1(h){var y=Math.exp(h);return y=(y+1/y)/2,y}function by(h,y,w){for(var A=Math.sin(y),P=Math.cos(y),D=xy(w),E=H1(w),l=2*P*E,B=-2*A*D,U=h.length-1,ee=h[U],J=0,W=0,K=0,ve,Ce;--U>=0;)ve=W,Ce=J,W=ee,J=K,ee=-ve+l*W-B*J+h[U],K=-Ce+B*W+l*J;return l=A*E,B=P*D,[l*ee-B*K,l*K+B*ee]}function X1(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(jm.init.apply(this),this.forward=jm.forward,this.inverse=jm.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var h=this.es/(1+Math.sqrt(1-this.es)),y=h/(2-h),w=y;this.cgb[0]=y*(2+y*(-2/3+y*(-2+y*(116/45+y*(26/45+y*(-2854/675)))))),this.cbg[0]=y*(-2+y*(2/3+y*(4/3+y*(-82/45+y*(32/45+y*(4642/4725)))))),w=w*y,this.cgb[1]=w*(7/3+y*(-8/5+y*(-227/45+y*(2704/315+y*(2323/945))))),this.cbg[1]=w*(5/3+y*(-16/15+y*(-13/9+y*(904/315+y*(-1522/945))))),w=w*y,this.cgb[2]=w*(56/15+y*(-136/35+y*(-1262/105+y*(73814/2835)))),this.cbg[2]=w*(-26/15+y*(34/21+y*(8/5+y*(-12686/2835)))),w=w*y,this.cgb[3]=w*(4279/630+y*(-332/35+y*(-399572/14175))),this.cbg[3]=w*(1237/630+y*(-12/5+y*(-24832/14175))),w=w*y,this.cgb[4]=w*(4174/315+y*(-144838/6237)),this.cbg[4]=w*(-734/315+y*(109598/31185)),w=w*y,this.cgb[5]=w*(601676/22275),this.cbg[5]=w*(444337/155925),w=Math.pow(y,2),this.Qn=this.k0/(1+y)*(1+w*(1/4+w*(1/64+w/256))),this.utg[0]=y*(-.5+y*(2/3+y*(-37/96+y*(1/360+y*(81/512+y*(-96199/604800)))))),this.gtu[0]=y*(.5+y*(-2/3+y*(5/16+y*(41/180+y*(-127/288+y*(7891/37800)))))),this.utg[1]=w*(-1/48+y*(-1/15+y*(437/1440+y*(-46/105+y*(1118711/3870720))))),this.gtu[1]=w*(13/48+y*(-3/5+y*(557/1440+y*(281/630+y*(-1983433/1935360))))),w=w*y,this.utg[2]=w*(-17/480+y*(37/840+y*(209/4480+y*(-5569/90720)))),this.gtu[2]=w*(61/240+y*(-103/140+y*(15061/26880+y*(167603/181440)))),w=w*y,this.utg[3]=w*(-4397/161280+y*(11/504+y*(830251/7257600))),this.gtu[3]=w*(49561/161280+y*(-179/168+y*(6601661/7257600))),w=w*y,this.utg[4]=w*(-4583/161280+y*(108847/3991680)),this.gtu[4]=w*(34729/80640+y*(-3418889/1995840)),w=w*y,this.utg[5]=w*(-20648693/638668800),this.gtu[5]=w*(212378941/319334400);var A=Yg(this.cbg,this.lat0);this.Zb=-this.Qn*(A+$1(this.gtu,2*A))}function Y1(h){var y=At(h.x-this.long0),w=h.y;w=Yg(this.cbg,w);var A=Math.sin(w),P=Math.cos(w),D=Math.sin(y),E=Math.cos(y);w=Math.atan2(A,E*P),y=Math.atan2(D*P,vs(A,P*E)),y=Z1(Math.tan(y));var l=by(this.gtu,2*w,2*y);w=w+l[0],y=y+l[1];var B,U;return Math.abs(y)<=2.623395162778?(B=this.a*(this.Qn*y)+this.x0,U=this.a*(this.Qn*w+this.Zb)+this.y0):(B=1/0,U=1/0),h.x=B,h.y=U,h}function W1(h){var y=(h.x-this.x0)*(1/this.a),w=(h.y-this.y0)*(1/this.a);w=(w-this.Zb)/this.Qn,y=y/this.Qn;var A,P;if(Math.abs(y)<=2.623395162778){var D=by(this.utg,2*w,2*y);w=w+D[0],y=y+D[1],y=Math.atan(xy(y));var E=Math.sin(w),l=Math.cos(w),B=Math.sin(y),U=Math.cos(y);w=Math.atan2(E*U,vs(B,U*l)),y=Math.atan2(B,U*l),A=At(y+this.long0),P=Yg(this.cgb,w)}else A=1/0,P=1/0;return h.x=A,h.y=P,h}var Q1=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Gm={init:X1,forward:Y1,inverse:W1,names:Q1};function K1(h,y){if(h===void 0){if(h=Math.floor((At(y)+Math.PI)*30/Math.PI)+1,h<0)return 0;if(h>60)return 60}return h}var J1="etmerc";function ex(){var h=K1(this.zone,this.long0);if(h===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(h)-183)*dr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Gm.init.apply(this),this.forward=Gm.forward,this.inverse=Gm.inverse}var tx=["Universal Transverse Mercator System","utm"];const ix={init:ex,names:tx,dependsOn:J1};function Wg(h,y){return Math.pow((1-h)/(1+h),y)}var ax=20;function nx(){var h=Math.sin(this.lat0),y=Math.cos(this.lat0);y*=y,this.rc=Math.sqrt(1-this.es)/(1-this.es*h*h),this.C=Math.sqrt(1+this.es*y*y/(1-this.es)),this.phic0=Math.asin(h/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ia)/(Math.pow(Math.tan(.5*this.lat0+ia),this.C)*Wg(this.e*h,this.ratexp))}function rx(h){var y=h.x,w=h.y;return h.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*w+ia),this.C)*Wg(this.e*Math.sin(w),this.ratexp))-lt,h.x=this.C*y,h}function sx(h){for(var y=1e-14,w=h.x/this.C,A=h.y,P=Math.pow(Math.tan(.5*A+ia)/this.K,1/this.C),D=ax;D>0&&(A=2*Math.atan(P*Wg(this.e*Math.sin(h.y),-.5*this.e))-lt,!(Math.abs(A-h.y)<y));--D)h.y=A;return D?(h.x=w,h.y=A,h):null}const Qg={init:nx,forward:rx,inverse:sx};function ox(){Qg.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function lx(h){var y,w,A,P;return h.x=At(h.x-this.long0),Qg.forward.apply(this,[h]),y=Math.sin(h.y),w=Math.cos(h.y),A=Math.cos(h.x),P=this.k0*this.R2/(1+this.sinc0*y+this.cosc0*w*A),h.x=P*w*Math.sin(h.x),h.y=P*(this.cosc0*y-this.sinc0*w*A),h.x=this.a*h.x+this.x0,h.y=this.a*h.y+this.y0,h}function cx(h){var y,w,A,P,D;if(h.x=(h.x-this.x0)/this.a,h.y=(h.y-this.y0)/this.a,h.x/=this.k0,h.y/=this.k0,D=vs(h.x,h.y)){var E=2*Math.atan2(D,this.R2);y=Math.sin(E),w=Math.cos(E),P=Math.asin(w*this.sinc0+h.y*y*this.cosc0/D),A=Math.atan2(h.x*y,D*this.cosc0*w-h.y*this.sinc0*y)}else P=this.phic0,A=0;return h.x=A,h.y=P,Qg.inverse.apply(this,[h]),h.x=At(h.x+this.long0),h}var ux=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const hx={init:ox,forward:lx,inverse:cx,names:ux};function Kg(h,y,w){return y*=w,Math.tan(.5*(lt+h))*Math.pow((1-y)/(1+y),.5*w)}function dx(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=bt&&(this.k0=.5*(1+Np(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=bt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=bt&&Math.abs(Math.cos(this.lat_ts))>bt&&(this.k0=.5*this.cons*uc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Ml(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=uc(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(Kg(this.lat0,this.sinlat0,this.e))-lt,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function fx(h){var y=h.x,w=h.y,A=Math.sin(w),P=Math.cos(w),D,E,l,B,U,ee,J=At(y-this.long0);return Math.abs(Math.abs(y-this.long0)-Math.PI)<=bt&&Math.abs(w+this.lat0)<=bt?(h.x=NaN,h.y=NaN,h):this.sphere?(D=2*this.k0/(1+this.sinlat0*A+this.coslat0*P*Math.cos(J)),h.x=this.a*D*P*Math.sin(J)+this.x0,h.y=this.a*D*(this.coslat0*A-this.sinlat0*P*Math.cos(J))+this.y0,h):(E=2*Math.atan(Kg(w,A,this.e))-lt,B=Math.cos(E),l=Math.sin(E),Math.abs(this.coslat0)<=bt?(U=Ml(this.e,w*this.con,this.con*A),ee=2*this.a*this.k0*U/this.cons,h.x=this.x0+ee*Math.sin(y-this.long0),h.y=this.y0-this.con*ee*Math.cos(y-this.long0),h):(Math.abs(this.sinlat0)<bt?(D=2*this.a*this.k0/(1+B*Math.cos(J)),h.y=D*l):(D=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*l+this.cosX0*B*Math.cos(J))),h.y=D*(this.cosX0*l-this.sinX0*B*Math.cos(J))+this.y0),h.x=D*B*Math.sin(J)+this.x0,h))}function px(h){h.x-=this.x0,h.y-=this.y0;var y,w,A,P,D,E=Math.sqrt(h.x*h.x+h.y*h.y);if(this.sphere){var l=2*Math.atan(E/(2*this.a*this.k0));return y=this.long0,w=this.lat0,E<=bt?(h.x=y,h.y=w,h):(w=Math.asin(Math.cos(l)*this.sinlat0+h.y*Math.sin(l)*this.coslat0/E),Math.abs(this.coslat0)<bt?this.lat0>0?y=At(this.long0+Math.atan2(h.x,-1*h.y)):y=At(this.long0+Math.atan2(h.x,h.y)):y=At(this.long0+Math.atan2(h.x*Math.sin(l),E*this.coslat0*Math.cos(l)-h.y*this.sinlat0*Math.sin(l))),h.x=y,h.y=w,h)}else if(Math.abs(this.coslat0)<=bt){if(E<=bt)return w=this.lat0,y=this.long0,h.x=y,h.y=w,h;h.x*=this.con,h.y*=this.con,A=E*this.cons/(2*this.a*this.k0),w=this.con*Dp(this.e,A),y=this.con*At(this.con*this.long0+Math.atan2(h.x,-1*h.y))}else P=2*Math.atan(E*this.cosX0/(2*this.a*this.k0*this.ms1)),y=this.long0,E<=bt?D=this.X0:(D=Math.asin(Math.cos(P)*this.sinX0+h.y*Math.sin(P)*this.cosX0/E),y=At(this.long0+Math.atan2(h.x*Math.sin(P),E*this.cosX0*Math.cos(P)-h.y*this.sinX0*Math.sin(P)))),w=-1*Dp(this.e,Math.tan(.5*(lt+D)));return h.x=y,h.y=w,h}var mx=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const gx={init:dx,forward:fx,inverse:px,names:mx,ssfn_:Kg};function _x(){var h=this.lat0;this.lambda0=this.long0;var y=Math.sin(h),w=this.a,A=this.rf,P=1/A,D=2*P-Math.pow(P,2),E=this.e=Math.sqrt(D);this.R=this.k0*w*Math.sqrt(1-D)/(1-D*Math.pow(y,2)),this.alpha=Math.sqrt(1+D/(1-D)*Math.pow(Math.cos(h),4)),this.b0=Math.asin(y/this.alpha);var l=Math.log(Math.tan(Math.PI/4+this.b0/2)),B=Math.log(Math.tan(Math.PI/4+h/2)),U=Math.log((1+E*y)/(1-E*y));this.K=l-this.alpha*B+this.alpha*E/2*U}function yx(h){var y=Math.log(Math.tan(Math.PI/4-h.y/2)),w=this.e/2*Math.log((1+this.e*Math.sin(h.y))/(1-this.e*Math.sin(h.y))),A=-this.alpha*(y+w)+this.K,P=2*(Math.atan(Math.exp(A))-Math.PI/4),D=this.alpha*(h.x-this.lambda0),E=Math.atan(Math.sin(D)/(Math.sin(this.b0)*Math.tan(P)+Math.cos(this.b0)*Math.cos(D))),l=Math.asin(Math.cos(this.b0)*Math.sin(P)-Math.sin(this.b0)*Math.cos(P)*Math.cos(D));return h.y=this.R/2*Math.log((1+Math.sin(l))/(1-Math.sin(l)))+this.y0,h.x=this.R*E+this.x0,h}function vx(h){for(var y=h.x-this.x0,w=h.y-this.y0,A=y/this.R,P=2*(Math.atan(Math.exp(w/this.R))-Math.PI/4),D=Math.asin(Math.cos(this.b0)*Math.sin(P)+Math.sin(this.b0)*Math.cos(P)*Math.cos(A)),E=Math.atan(Math.sin(A)/(Math.cos(this.b0)*Math.cos(A)-Math.sin(this.b0)*Math.tan(P))),l=this.lambda0+E/this.alpha,B=0,U=D,ee=-1e3,J=0;Math.abs(U-ee)>1e-7;){if(++J>20)return;B=1/this.alpha*(Math.log(Math.tan(Math.PI/4+D/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(U))/2)),ee=U,U=2*Math.atan(Math.exp(B))-Math.PI/2}return h.x=l,h.y=U,h}var xx=["somerc"];const bx={init:_x,forward:yx,inverse:vx,names:xx};var of=1e-7;function wx(h){var y=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],w=typeof h.projName=="object"?Object.keys(h.projName)[0]:h.projName;return"no_uoff"in h||"no_off"in h||y.indexOf(w)!==-1||y.indexOf(cy(w))!==-1}function Sx(){var h,y,w,A,P,D,E,l,B,U,ee=0,J,W=0,K=0,ve=0,Ce=0,Pe=0,Fe=0;this.no_off=wx(this),this.no_rot="no_rot"in this;var Ue=!1;"alpha"in this&&(Ue=!0);var He=!1;if("rectified_grid_angle"in this&&(He=!0),Ue&&(Fe=this.alpha),He&&(ee=this.rectified_grid_angle),Ue||He)W=this.longc;else if(K=this.long1,Ce=this.lat1,ve=this.long2,Pe=this.lat2,Math.abs(Ce-Pe)<=of||(h=Math.abs(Ce))<=of||Math.abs(h-lt)<=of||Math.abs(Math.abs(this.lat0)-lt)<=of||Math.abs(Math.abs(Pe)-lt)<=of)throw new Error;var mt=1-this.es;y=Math.sqrt(mt),Math.abs(this.lat0)>bt?(l=Math.sin(this.lat0),w=Math.cos(this.lat0),h=1-this.es*l*l,this.B=w*w,this.B=Math.sqrt(1+this.es*this.B*this.B/mt),this.A=this.B*this.k0*y/h,A=this.B*y/(w*Math.sqrt(h)),P=A*A-1,P<=0?P=0:(P=Math.sqrt(P),this.lat0<0&&(P=-P)),this.E=P+=A,this.E*=Math.pow(Ml(this.e,this.lat0,l),this.B)):(this.B=1/y,this.A=this.k0,this.E=A=P=1),Ue||He?(Ue?(J=Math.asin(Math.sin(Fe)/A),He||(ee=Fe)):(J=ee,Fe=Math.asin(A*Math.sin(J))),this.lam0=W-Math.asin(.5*(P-1/P)*Math.tan(J))/this.B):(D=Math.pow(Ml(this.e,Ce,Math.sin(Ce)),this.B),E=Math.pow(Ml(this.e,Pe,Math.sin(Pe)),this.B),P=this.E/D,B=(E-D)/(E+D),U=this.E*this.E,U=(U-E*D)/(U+E*D),h=K-ve,h<-Math.PI?ve-=Ip:h>Math.PI&&(ve+=Ip),this.lam0=At(.5*(K+ve)-Math.atan(U*Math.tan(.5*this.B*(K-ve))/B)/this.B),J=Math.atan(2*Math.sin(this.B*At(K-this.lam0))/(P-1/P)),ee=Fe=Math.asin(A*Math.sin(J))),this.singam=Math.sin(J),this.cosgam=Math.cos(J),this.sinrot=Math.sin(ee),this.cosrot=Math.cos(ee),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(A*A-1)/Math.cos(Fe))),this.lat0<0&&(this.u_0=-this.u_0)),P=.5*J,this.v_pole_n=this.ArB*Math.log(Math.tan(ia-P)),this.v_pole_s=this.ArB*Math.log(Math.tan(ia+P))}function Mx(h){var y={},w,A,P,D,E,l,B,U;if(h.x=h.x-this.lam0,Math.abs(Math.abs(h.y)-lt)>bt){if(E=this.E/Math.pow(Ml(this.e,h.y,Math.sin(h.y)),this.B),l=1/E,w=.5*(E-l),A=.5*(E+l),D=Math.sin(this.B*h.x),P=(w*this.singam-D*this.cosgam)/A,Math.abs(Math.abs(P)-1)<bt)throw new Error;U=.5*this.ArB*Math.log((1-P)/(1+P)),l=Math.cos(this.B*h.x),Math.abs(l)<of?B=this.A*h.x:B=this.ArB*Math.atan2(w*this.cosgam+D*this.singam,l)}else U=h.y>0?this.v_pole_n:this.v_pole_s,B=this.ArB*h.y;return this.no_rot?(y.x=B,y.y=U):(B-=this.u_0,y.x=U*this.cosrot+B*this.sinrot,y.y=B*this.cosrot-U*this.sinrot),y.x=this.a*y.x+this.x0,y.y=this.a*y.y+this.y0,y}function Tx(h){var y,w,A,P,D,E,l,B={};if(h.x=(h.x-this.x0)*(1/this.a),h.y=(h.y-this.y0)*(1/this.a),this.no_rot?(w=h.y,y=h.x):(w=h.x*this.cosrot-h.y*this.sinrot,y=h.y*this.cosrot+h.x*this.sinrot+this.u_0),A=Math.exp(-this.BrA*w),P=.5*(A-1/A),D=.5*(A+1/A),E=Math.sin(this.BrA*y),l=(E*this.cosgam+P*this.singam)/D,Math.abs(Math.abs(l)-1)<bt)B.x=0,B.y=l<0?-lt:lt;else{if(B.y=this.E/Math.sqrt((1+l)/(1-l)),B.y=Dp(this.e,Math.pow(B.y,1/this.B)),B.y===1/0)throw new Error;B.x=-this.rB*Math.atan2(P*this.cosgam-E*this.singam,Math.cos(this.BrA*y))}return B.x+=this.lam0,B}var Ex=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Ax={init:Sx,forward:Mx,inverse:Tx,names:Ex};function Cx(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<bt)){var h=this.b/this.a;this.e=Math.sqrt(1-h*h);var y=Math.sin(this.lat1),w=Math.cos(this.lat1),A=uc(this.e,y,w),P=Ml(this.e,this.lat1,y),D=Math.sin(this.lat2),E=Math.cos(this.lat2),l=uc(this.e,D,E),B=Ml(this.e,this.lat2,D),U=Math.abs(Math.abs(this.lat0)-lt)<bt?0:Ml(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>bt?this.ns=Math.log(A/l)/Math.log(P/B):this.ns=y,isNaN(this.ns)&&(this.ns=y),this.f0=A/(this.ns*Math.pow(P,this.ns)),this.rh=this.a*this.f0*Math.pow(U,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Px(h){var y=h.x,w=h.y;Math.abs(2*Math.abs(w)-Math.PI)<=bt&&(w=Np(w)*(lt-2*bt));var A=Math.abs(Math.abs(w)-lt),P,D;if(A>bt)P=Ml(this.e,w,Math.sin(w)),D=this.a*this.f0*Math.pow(P,this.ns);else{if(A=w*this.ns,A<=0)return null;D=0}var E=this.ns*At(y-this.long0);return h.x=this.k0*(D*Math.sin(E))+this.x0,h.y=this.k0*(this.rh-D*Math.cos(E))+this.y0,h}function zx(h){var y,w,A,P,D,E=(h.x-this.x0)/this.k0,l=this.rh-(h.y-this.y0)/this.k0;this.ns>0?(y=Math.sqrt(E*E+l*l),w=1):(y=-Math.sqrt(E*E+l*l),w=-1);var B=0;if(y!==0&&(B=Math.atan2(w*E,w*l)),y!==0||this.ns>0){if(w=1/this.ns,A=Math.pow(y/(this.a*this.f0),w),P=Dp(this.e,A),P===-9999)return null}else P=-lt;return D=At(B/this.ns+this.long0),h.x=D,h.y=P,h}var Ix=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Rx={init:Cx,forward:Px,inverse:zx,names:Ix};function Dx(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function kx(h){var y,w,A,P,D,E,l,B=h.x,U=h.y,ee=At(B-this.long0);return y=Math.pow((1+this.e*Math.sin(U))/(1-this.e*Math.sin(U)),this.alfa*this.e/2),w=2*(Math.atan(this.k*Math.pow(Math.tan(U/2+this.s45),this.alfa)/y)-this.s45),A=-ee*this.alfa,P=Math.asin(Math.cos(this.ad)*Math.sin(w)+Math.sin(this.ad)*Math.cos(w)*Math.cos(A)),D=Math.asin(Math.cos(w)*Math.sin(A)/Math.cos(P)),E=this.n*D,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(P/2+this.s45),this.n),h.y=l*Math.cos(E)/1,h.x=l*Math.sin(E)/1,this.czech||(h.y*=-1,h.x*=-1),h}function Lx(h){var y,w,A,P,D,E,l,B,U=h.x;h.x=h.y,h.y=U,this.czech||(h.y*=-1,h.x*=-1),E=Math.sqrt(h.x*h.x+h.y*h.y),D=Math.atan2(h.y,h.x),P=D/Math.sin(this.s0),A=2*(Math.atan(Math.pow(this.ro0/E,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),y=Math.asin(Math.cos(this.ad)*Math.sin(A)-Math.sin(this.ad)*Math.cos(A)*Math.cos(P)),w=Math.asin(Math.cos(A)*Math.sin(P)/Math.cos(y)),h.x=this.long0-w/this.alfa,l=y,B=0;var ee=0;do h.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(y/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.e/2))-this.s45),Math.abs(l-h.y)<1e-10&&(B=1),l=h.y,ee+=1;while(B===0&&ee<15);return ee>=15?null:h}var Ox=["Krovak","krovak"];const Bx={init:Dx,forward:kx,inverse:Lx,names:Ox};function Wr(h,y,w,A,P){return h*P-y*Math.sin(2*P)+w*Math.sin(4*P)-A*Math.sin(6*P)}function jp(h){return 1-.25*h*(1+h/16*(3+1.25*h))}function Gp(h){return .375*h*(1+.25*h*(1+.46875*h))}function Fp(h){return .05859375*h*h*(1+.75*h)}function Up(h){return h*h*h*(35/3072)}function Jg(h,y,w){var A=y*w;return h/Math.sqrt(1-A*A)}function ih(h){return Math.abs(h)<lt?h:h-Np(h)*Math.PI}function $m(h,y,w,A,P){var D,E;D=h/y;for(var l=0;l<15;l++)if(E=(h-(y*D-w*Math.sin(2*D)+A*Math.sin(4*D)-P*Math.sin(6*D)))/(y-2*w*Math.cos(2*D)+4*A*Math.cos(4*D)-6*P*Math.cos(6*D)),D+=E,Math.abs(E)<=1e-10)return D;return NaN}function Nx(){this.sphere||(this.e0=jp(this.es),this.e1=Gp(this.es),this.e2=Fp(this.es),this.e3=Up(this.es),this.ml0=this.a*Wr(this.e0,this.e1,this.e2,this.e3,this.lat0))}function jx(h){var y,w,A=h.x,P=h.y;if(A=At(A-this.long0),this.sphere)y=this.a*Math.asin(Math.cos(P)*Math.sin(A)),w=this.a*(Math.atan2(Math.tan(P),Math.cos(A))-this.lat0);else{var D=Math.sin(P),E=Math.cos(P),l=Jg(this.a,this.e,D),B=Math.tan(P)*Math.tan(P),U=A*Math.cos(P),ee=U*U,J=this.es*E*E/(1-this.es),W=this.a*Wr(this.e0,this.e1,this.e2,this.e3,P);y=l*U*(1-ee*B*(1/6-(8-B+8*J)*ee/120)),w=W-this.ml0+l*D/E*ee*(.5+(5-B+6*J)*ee/24)}return h.x=y+this.x0,h.y=w+this.y0,h}function Gx(h){h.x-=this.x0,h.y-=this.y0;var y=h.x/this.a,w=h.y/this.a,A,P;if(this.sphere){var D=w+this.lat0;A=Math.asin(Math.sin(D)*Math.cos(y)),P=Math.atan2(Math.tan(y),Math.cos(D))}else{var E=this.ml0/this.a+w,l=$m(E,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(l)-lt)<=bt)return h.x=this.long0,h.y=lt,w<0&&(h.y*=-1),h;var B=Jg(this.a,this.e,Math.sin(l)),U=B*B*B/this.a/this.a*(1-this.es),ee=Math.pow(Math.tan(l),2),J=y*this.a/B,W=J*J;A=l-B*Math.tan(l)/U*J*J*(.5-(1+3*ee)*J*J/24),P=J*(1-W*(ee/3+(1+3*ee)*ee*W/15))/Math.cos(l)}return h.x=At(P+this.long0),h.y=ih(A),h}var Fx=["Cassini","Cassini_Soldner","cass"];const Ux={init:Nx,forward:jx,inverse:Gx,names:Fx};function Ju(h,y){var w;return h>1e-7?(w=h*y,(1-h*h)*(y/(1-w*w)-.5/h*Math.log((1-w)/(1+w)))):2*y}var Rg=1,Dg=2,kg=3,Fm=4;function Vx(){var h=Math.abs(this.lat0);if(Math.abs(h-lt)<bt?this.mode=this.lat0<0?Rg:Dg:Math.abs(h)<bt?this.mode=kg:this.mode=Fm,this.es>0){var y;switch(this.qp=Ju(this.e,1),this.mmf=.5/(1-this.es),this.apa=Kx(this.es),this.mode){case Dg:this.dd=1;break;case Rg:this.dd=1;break;case kg:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case Fm:this.rq=Math.sqrt(.5*this.qp),y=Math.sin(this.lat0),this.sinb1=Ju(this.e,y)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*y*y)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===Fm&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function qx(h){var y,w,A,P,D,E,l,B,U,ee,J=h.x,W=h.y;if(J=At(J-this.long0),this.sphere){if(D=Math.sin(W),ee=Math.cos(W),A=Math.cos(J),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(w=this.mode===this.EQUIT?1+ee*A:1+this.sinph0*D+this.cosph0*ee*A,w<=bt)return null;w=Math.sqrt(2/w),y=w*ee*Math.sin(J),w*=this.mode===this.EQUIT?D:this.cosph0*D-this.sinph0*ee*A}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(A=-A),Math.abs(W+this.lat0)<bt)return null;w=ia-W*.5,w=2*(this.mode===this.S_POLE?Math.cos(w):Math.sin(w)),y=w*Math.sin(J),w*=A}}else{switch(l=0,B=0,U=0,A=Math.cos(J),P=Math.sin(J),D=Math.sin(W),E=Ju(this.e,D),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(l=E/this.qp,B=Math.sqrt(1-l*l)),this.mode){case this.OBLIQ:U=1+this.sinb1*l+this.cosb1*B*A;break;case this.EQUIT:U=1+B*A;break;case this.N_POLE:U=lt+W,E=this.qp-E;break;case this.S_POLE:U=W-lt,E=this.qp+E;break}if(Math.abs(U)<bt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:U=Math.sqrt(2/U),this.mode===this.OBLIQ?w=this.ymf*U*(this.cosb1*l-this.sinb1*B*A):w=(U=Math.sqrt(2/(1+B*A)))*l*this.ymf,y=this.xmf*U*B*P;break;case this.N_POLE:case this.S_POLE:E>=0?(y=(U=Math.sqrt(E))*P,w=A*(this.mode===this.S_POLE?U:-U)):y=w=0;break}}return h.x=this.a*y+this.x0,h.y=this.a*w+this.y0,h}function Zx(h){h.x-=this.x0,h.y-=this.y0;var y=h.x/this.a,w=h.y/this.a,A,P,D,E,l,B,U;if(this.sphere){var ee=0,J,W=0;if(J=Math.sqrt(y*y+w*w),P=J*.5,P>1)return null;switch(P=2*Math.asin(P),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(W=Math.sin(P),ee=Math.cos(P)),this.mode){case this.EQUIT:P=Math.abs(J)<=bt?0:Math.asin(w*W/J),y*=W,w=ee*J;break;case this.OBLIQ:P=Math.abs(J)<=bt?this.lat0:Math.asin(ee*this.sinph0+w*W*this.cosph0/J),y*=W*this.cosph0,w=(ee-Math.sin(P)*this.sinph0)*J;break;case this.N_POLE:w=-w,P=lt-P;break;case this.S_POLE:P-=lt;break}A=w===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(y,w)}else{if(U=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(y/=this.dd,w*=this.dd,B=Math.sqrt(y*y+w*w),B<bt)return h.x=this.long0,h.y=this.lat0,h;E=2*Math.asin(.5*B/this.rq),D=Math.cos(E),y*=E=Math.sin(E),this.mode===this.OBLIQ?(U=D*this.sinb1+w*E*this.cosb1/B,l=this.qp*U,w=B*this.cosb1*D-w*this.sinb1*E):(U=w*E/B,l=this.qp*U,w=B*D)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(w=-w),l=y*y+w*w,!l)return h.x=this.long0,h.y=this.lat0,h;U=1-l/this.qp,this.mode===this.S_POLE&&(U=-U)}A=Math.atan2(y,w),P=Jx(Math.asin(U),this.apa)}return h.x=At(this.long0+A),h.y=P,h}var $x=.3333333333333333,Hx=.17222222222222222,Xx=.10257936507936508,Yx=.06388888888888888,Wx=.0664021164021164,Qx=.016415012942191543;function Kx(h){var y,w=[];return w[0]=h*$x,y=h*h,w[0]+=y*Hx,w[1]=y*Yx,y*=h,w[0]+=y*Xx,w[1]+=y*Wx,w[2]=y*Qx,w}function Jx(h,y){var w=h+h;return h+y[0]*Math.sin(w)+y[1]*Math.sin(w+w)+y[2]*Math.sin(w+w+w)}var eb=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const tb={init:Vx,forward:qx,inverse:Zx,names:eb,S_POLE:Rg,N_POLE:Dg,EQUIT:kg,OBLIQ:Fm};function th(h){return Math.abs(h)>1&&(h=h>1?1:-1),Math.asin(h)}function ib(){Math.abs(this.lat1+this.lat2)<bt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=uc(this.e3,this.sin_po,this.cos_po),this.qs1=Ju(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=uc(this.e3,this.sin_po,this.cos_po),this.qs2=Ju(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ju(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>bt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function ab(h){var y=h.x,w=h.y;this.sin_phi=Math.sin(w),this.cos_phi=Math.cos(w);var A=Ju(this.e3,this.sin_phi),P=this.a*Math.sqrt(this.c-this.ns0*A)/this.ns0,D=this.ns0*At(y-this.long0),E=P*Math.sin(D)+this.x0,l=this.rh-P*Math.cos(D)+this.y0;return h.x=E,h.y=l,h}function nb(h){var y,w,A,P,D,E;return h.x-=this.x0,h.y=this.rh-h.y+this.y0,this.ns0>=0?(y=Math.sqrt(h.x*h.x+h.y*h.y),A=1):(y=-Math.sqrt(h.x*h.x+h.y*h.y),A=-1),P=0,y!==0&&(P=Math.atan2(A*h.x,A*h.y)),A=y*this.ns0/this.a,this.sphere?E=Math.asin((this.c-A*A)/(2*this.ns0)):(w=(this.c-A*A)/this.ns0,E=this.phi1z(this.e3,w)),D=At(P/this.ns0+this.long0),h.x=D,h.y=E,h}function rb(h,y){var w,A,P,D,E,l=th(.5*y);if(h<bt)return l;for(var B=h*h,U=1;U<=25;U++)if(w=Math.sin(l),A=Math.cos(l),P=h*w,D=1-P*P,E=.5*D*D/A*(y/(1-B)-w/D+.5/h*Math.log((1-P)/(1+P))),l=l+E,Math.abs(E)<=1e-7)return l;return null}var sb=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const ob={init:ib,forward:ab,inverse:nb,names:sb,phi1z:rb};function lb(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function cb(h){var y,w,A,P,D,E,l,B,U=h.x,ee=h.y;return A=At(U-this.long0),y=Math.sin(ee),w=Math.cos(ee),P=Math.cos(A),E=this.sin_p14*y+this.cos_p14*w*P,D=1,E>0||Math.abs(E)<=bt?(l=this.x0+this.a*D*w*Math.sin(A)/E,B=this.y0+this.a*D*(this.cos_p14*y-this.sin_p14*w*P)/E):(l=this.x0+this.infinity_dist*w*Math.sin(A),B=this.y0+this.infinity_dist*(this.cos_p14*y-this.sin_p14*w*P)),h.x=l,h.y=B,h}function ub(h){var y,w,A,P,D,E;return h.x=(h.x-this.x0)/this.a,h.y=(h.y-this.y0)/this.a,h.x/=this.k0,h.y/=this.k0,(y=Math.sqrt(h.x*h.x+h.y*h.y))?(P=Math.atan2(y,this.rc),w=Math.sin(P),A=Math.cos(P),E=th(A*this.sin_p14+h.y*w*this.cos_p14/y),D=Math.atan2(h.x*w,y*this.cos_p14*A-h.y*this.sin_p14*w),D=At(this.long0+D)):(E=this.phic0,D=0),h.x=D,h.y=E,h}var hb=["gnom"];const db={init:lb,forward:cb,inverse:ub,names:hb};function fb(h,y){var w=1-(1-h*h)/(2*h)*Math.log((1-h)/(1+h));if(Math.abs(Math.abs(y)-w)<1e-6)return y<0?-1*lt:lt;for(var A=Math.asin(.5*y),P,D,E,l,B=0;B<30;B++)if(D=Math.sin(A),E=Math.cos(A),l=h*D,P=Math.pow(1-l*l,2)/(2*E)*(y/(1-h*h)-D/(1-l*l)+.5/h*Math.log((1-l)/(1+l))),A+=P,Math.abs(P)<=1e-10)return A;return NaN}function pb(){this.sphere||(this.k0=uc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function mb(h){var y=h.x,w=h.y,A,P,D=At(y-this.long0);if(this.sphere)A=this.x0+this.a*D*Math.cos(this.lat_ts),P=this.y0+this.a*Math.sin(w)/Math.cos(this.lat_ts);else{var E=Ju(this.e,Math.sin(w));A=this.x0+this.a*this.k0*D,P=this.y0+this.a*E*.5/this.k0}return h.x=A,h.y=P,h}function gb(h){h.x-=this.x0,h.y-=this.y0;var y,w;return this.sphere?(y=At(this.long0+h.x/this.a/Math.cos(this.lat_ts)),w=Math.asin(h.y/this.a*Math.cos(this.lat_ts))):(w=fb(this.e,2*h.y*this.k0/this.a),y=At(this.long0+h.x/(this.a*this.k0))),h.x=y,h.y=w,h}var _b=["cea"];const yb={init:pb,forward:mb,inverse:gb,names:_b};function vb(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function xb(h){var y=h.x,w=h.y,A=At(y-this.long0),P=ih(w-this.lat0);return h.x=this.x0+this.a*A*this.rc,h.y=this.y0+this.a*P,h}function bb(h){var y=h.x,w=h.y;return h.x=At(this.long0+(y-this.x0)/(this.a*this.rc)),h.y=ih(this.lat0+(w-this.y0)/this.a),h}var wb=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Sb={init:vb,forward:xb,inverse:bb,names:wb};var L_=20;function Mb(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=jp(this.es),this.e1=Gp(this.es),this.e2=Fp(this.es),this.e3=Up(this.es),this.ml0=this.a*Wr(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Tb(h){var y=h.x,w=h.y,A,P,D,E=At(y-this.long0);if(D=E*Math.sin(w),this.sphere)Math.abs(w)<=bt?(A=this.a*E,P=-1*this.a*this.lat0):(A=this.a*Math.sin(D)/Math.tan(w),P=this.a*(ih(w-this.lat0)+(1-Math.cos(D))/Math.tan(w)));else if(Math.abs(w)<=bt)A=this.a*E,P=-1*this.ml0;else{var l=Jg(this.a,this.e,Math.sin(w))/Math.tan(w);A=l*Math.sin(D),P=this.a*Wr(this.e0,this.e1,this.e2,this.e3,w)-this.ml0+l*(1-Math.cos(D))}return h.x=A+this.x0,h.y=P+this.y0,h}function Eb(h){var y,w,A,P,D,E,l,B,U;if(A=h.x-this.x0,P=h.y-this.y0,this.sphere)if(Math.abs(P+this.a*this.lat0)<=bt)y=At(A/this.a+this.long0),w=0;else{E=this.lat0+P/this.a,l=A*A/this.a/this.a+E*E,B=E;var ee;for(D=L_;D;--D)if(ee=Math.tan(B),U=-1*(E*(B*ee+1)-B-.5*(B*B+l)*ee)/((B-E)/ee-1),B+=U,Math.abs(U)<=bt){w=B;break}y=At(this.long0+Math.asin(A*Math.tan(B)/this.a)/Math.sin(w))}else if(Math.abs(P+this.ml0)<=bt)w=0,y=At(this.long0+A/this.a);else{E=(this.ml0+P)/this.a,l=A*A/this.a/this.a+E*E,B=E;var J,W,K,ve,Ce;for(D=L_;D;--D)if(Ce=this.e*Math.sin(B),J=Math.sqrt(1-Ce*Ce)*Math.tan(B),W=this.a*Wr(this.e0,this.e1,this.e2,this.e3,B),K=this.e0-2*this.e1*Math.cos(2*B)+4*this.e2*Math.cos(4*B)-6*this.e3*Math.cos(6*B),ve=W/this.a,U=(E*(J*ve+1)-ve-.5*J*(ve*ve+l))/(this.es*Math.sin(2*B)*(ve*ve+l-2*E*ve)/(4*J)+(E-ve)*(J*K-2/Math.sin(2*B))-K),B-=U,Math.abs(U)<=bt){w=B;break}J=Math.sqrt(1-this.es*Math.pow(Math.sin(w),2))*Math.tan(w),y=At(this.long0+Math.asin(A*J/this.a)/Math.sin(w))}return h.x=y,h.y=w,h}var Ab=["Polyconic","American_Polyconic","poly"];const Cb={init:Mb,forward:Tb,inverse:Eb,names:Ab};function Pb(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function zb(h){var y,w=h.x,A=h.y,P=A-this.lat0,D=w-this.long0,E=P/Tp*1e-5,l=D,B=1,U=0;for(y=1;y<=10;y++)B=B*E,U=U+this.A[y]*B;var ee=U,J=l,W=1,K=0,ve,Ce,Pe=0,Fe=0;for(y=1;y<=6;y++)ve=W*ee-K*J,Ce=K*ee+W*J,W=ve,K=Ce,Pe=Pe+this.B_re[y]*W-this.B_im[y]*K,Fe=Fe+this.B_im[y]*W+this.B_re[y]*K;return h.x=Fe*this.a+this.x0,h.y=Pe*this.a+this.y0,h}function Ib(h){var y,w=h.x,A=h.y,P=w-this.x0,D=A-this.y0,E=D/this.a,l=P/this.a,B=1,U=0,ee,J,W=0,K=0;for(y=1;y<=6;y++)ee=B*E-U*l,J=U*E+B*l,B=ee,U=J,W=W+this.C_re[y]*B-this.C_im[y]*U,K=K+this.C_im[y]*B+this.C_re[y]*U;for(var ve=0;ve<this.iterations;ve++){var Ce=W,Pe=K,Fe,Ue,He=E,mt=l;for(y=2;y<=6;y++)Fe=Ce*W-Pe*K,Ue=Pe*W+Ce*K,Ce=Fe,Pe=Ue,He=He+(y-1)*(this.B_re[y]*Ce-this.B_im[y]*Pe),mt=mt+(y-1)*(this.B_im[y]*Ce+this.B_re[y]*Pe);Ce=1,Pe=0;var Mt=this.B_re[1],Pt=this.B_im[1];for(y=2;y<=6;y++)Fe=Ce*W-Pe*K,Ue=Pe*W+Ce*K,Ce=Fe,Pe=Ue,Mt=Mt+y*(this.B_re[y]*Ce-this.B_im[y]*Pe),Pt=Pt+y*(this.B_im[y]*Ce+this.B_re[y]*Pe);var _t=Mt*Mt+Pt*Pt;W=(He*Mt+mt*Pt)/_t,K=(mt*Mt-He*Pt)/_t}var ei=W,Vt=K,mi=1,wi=0;for(y=1;y<=9;y++)mi=mi*ei,wi=wi+this.D[y]*mi;var Di=this.lat0+wi*Tp*1e5,Ma=this.long0+Vt;return h.x=Ma,h.y=Di,h}var Rb=["New_Zealand_Map_Grid","nzmg"];const Db={init:Pb,forward:zb,inverse:Ib,names:Rb};function kb(){}function Lb(h){var y=h.x,w=h.y,A=At(y-this.long0),P=this.x0+this.a*A,D=this.y0+this.a*Math.log(Math.tan(Math.PI/4+w/2.5))*1.25;return h.x=P,h.y=D,h}function Ob(h){h.x-=this.x0,h.y-=this.y0;var y=At(this.long0+h.x/this.a),w=2.5*(Math.atan(Math.exp(.8*h.y/this.a))-Math.PI/4);return h.x=y,h.y=w,h}var Bb=["Miller_Cylindrical","mill"];const Nb={init:kb,forward:Lb,inverse:Ob,names:Bb};var jb=20;function Gb(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Hg(this.es)}function Fb(h){var y,w,A=h.x,P=h.y;if(A=At(A-this.long0),this.sphere){if(!this.m)P=this.n!==1?Math.asin(this.n*Math.sin(P)):P;else for(var D=this.n*Math.sin(P),E=jb;E;--E){var l=(this.m*P+Math.sin(P)-D)/(this.m+Math.cos(P));if(P-=l,Math.abs(l)<bt)break}y=this.a*this.C_x*A*(this.m+Math.cos(P)),w=this.a*this.C_y*P}else{var B=Math.sin(P),U=Math.cos(P);w=this.a*_f(P,B,U,this.en),y=this.a*A*U/Math.sqrt(1-this.es*B*B)}return h.x=y,h.y=w,h}function Ub(h){var y,w,A,P;return h.x-=this.x0,A=h.x/this.a,h.y-=this.y0,y=h.y/this.a,this.sphere?(y/=this.C_y,A=A/(this.C_x*(this.m+Math.cos(y))),this.m?y=th((this.m*y+Math.sin(y))/this.n):this.n!==1&&(y=th(Math.sin(y)/this.n)),A=At(A+this.long0),y=ih(y)):(y=Xg(h.y/this.a,this.es,this.en),P=Math.abs(y),P<lt?(P=Math.sin(y),w=this.long0+h.x*Math.sqrt(1-this.es*P*P)/(this.a*Math.cos(y)),A=At(w)):P-bt<lt&&(A=this.long0)),h.x=A,h.y=y,h}var Vb=["Sinusoidal","sinu"];const qb={init:Gb,forward:Fb,inverse:Ub,names:Vb};function Zb(){}function $b(h){for(var y=h.x,w=h.y,A=At(y-this.long0),P=w,D=Math.PI*Math.sin(w);;){var E=-(P+Math.sin(P)-D)/(1+Math.cos(P));if(P+=E,Math.abs(E)<bt)break}P/=2,Math.PI/2-Math.abs(w)<bt&&(A=0);var l=.900316316158*this.a*A*Math.cos(P)+this.x0,B=1.4142135623731*this.a*Math.sin(P)+this.y0;return h.x=l,h.y=B,h}function Hb(h){var y,w;h.x-=this.x0,h.y-=this.y0,w=h.y/(1.4142135623731*this.a),Math.abs(w)>.999999999999&&(w=.999999999999),y=Math.asin(w);var A=At(this.long0+h.x/(.900316316158*this.a*Math.cos(y)));A<-Math.PI&&(A=-Math.PI),A>Math.PI&&(A=Math.PI),w=(2*y+Math.sin(2*y))/Math.PI,Math.abs(w)>1&&(w=1);var P=Math.asin(w);return h.x=A,h.y=P,h}var Xb=["Mollweide","moll"];const Yb={init:Zb,forward:$b,inverse:Hb,names:Xb};function Wb(){Math.abs(this.lat1+this.lat2)<bt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=jp(this.es),this.e1=Gp(this.es),this.e2=Fp(this.es),this.e3=Up(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=uc(this.e,this.sin_phi,this.cos_phi),this.ml1=Wr(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<bt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=uc(this.e,this.sin_phi,this.cos_phi),this.ml2=Wr(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Wr(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Qb(h){var y=h.x,w=h.y,A;if(this.sphere)A=this.a*(this.g-w);else{var P=Wr(this.e0,this.e1,this.e2,this.e3,w);A=this.a*(this.g-P)}var D=this.ns*At(y-this.long0),E=this.x0+A*Math.sin(D),l=this.y0+this.rh-A*Math.cos(D);return h.x=E,h.y=l,h}function Kb(h){h.x-=this.x0,h.y=this.rh-h.y+this.y0;var y,w,A,P;this.ns>=0?(w=Math.sqrt(h.x*h.x+h.y*h.y),y=1):(w=-Math.sqrt(h.x*h.x+h.y*h.y),y=-1);var D=0;if(w!==0&&(D=Math.atan2(y*h.x,y*h.y)),this.sphere)return P=At(this.long0+D/this.ns),A=ih(this.g-w/this.a),h.x=P,h.y=A,h;var E=this.g-w/this.a;return A=$m(E,this.e0,this.e1,this.e2,this.e3),P=At(this.long0+D/this.ns),h.x=P,h.y=A,h}var Jb=["Equidistant_Conic","eqdc"];const e2={init:Wb,forward:Qb,inverse:Kb,names:Jb};function t2(){this.R=this.a}function i2(h){var y=h.x,w=h.y,A=At(y-this.long0),P,D;Math.abs(w)<=bt&&(P=this.x0+this.R*A,D=this.y0);var E=th(2*Math.abs(w/Math.PI));(Math.abs(A)<=bt||Math.abs(Math.abs(w)-lt)<=bt)&&(P=this.x0,w>=0?D=this.y0+Math.PI*this.R*Math.tan(.5*E):D=this.y0+Math.PI*this.R*-Math.tan(.5*E));var l=.5*Math.abs(Math.PI/A-A/Math.PI),B=l*l,U=Math.sin(E),ee=Math.cos(E),J=ee/(U+ee-1),W=J*J,K=J*(2/U-1),ve=K*K,Ce=Math.PI*this.R*(l*(J-ve)+Math.sqrt(B*(J-ve)*(J-ve)-(ve+B)*(W-ve)))/(ve+B);A<0&&(Ce=-Ce),P=this.x0+Ce;var Pe=B+J;return Ce=Math.PI*this.R*(K*Pe-l*Math.sqrt((ve+B)*(B+1)-Pe*Pe))/(ve+B),w>=0?D=this.y0+Ce:D=this.y0-Ce,h.x=P,h.y=D,h}function a2(h){var y,w,A,P,D,E,l,B,U,ee,J,W,K;return h.x-=this.x0,h.y-=this.y0,J=Math.PI*this.R,A=h.x/J,P=h.y/J,D=A*A+P*P,E=-Math.abs(P)*(1+D),l=E-2*P*P+A*A,B=-2*E+1+2*P*P+D*D,K=P*P/B+(2*l*l*l/B/B/B-9*E*l/B/B)/27,U=(E-l*l/3/B)/B,ee=2*Math.sqrt(-U/3),J=3*K/U/ee,Math.abs(J)>1&&(J>=0?J=1:J=-1),W=Math.acos(J)/3,h.y>=0?w=(-ee*Math.cos(W+Math.PI/3)-l/3/B)*Math.PI:w=-(-ee*Math.cos(W+Math.PI/3)-l/3/B)*Math.PI,Math.abs(A)<bt?y=this.long0:y=At(this.long0+Math.PI*(D-1+Math.sqrt(1+2*(A*A-P*P)+D*D))/2/A),h.x=y,h.y=w,h}var n2=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const r2={init:t2,forward:i2,inverse:a2,names:n2};function s2(h,y,w,A,P,D){const E=A-y,l=Math.atan((1-D)*Math.tan(h)),B=Math.atan((1-D)*Math.tan(w)),U=Math.sin(l),ee=Math.cos(l),J=Math.sin(B),W=Math.cos(B);let K=E,ve,Ce=100,Pe,Fe,Ue,He,mt,Mt,Pt,_t,ei,Vt,mi,wi,Di,Ma;do{if(Pe=Math.sin(K),Fe=Math.cos(K),Ue=Math.sqrt(W*Pe*(W*Pe)+(ee*J-U*W*Fe)*(ee*J-U*W*Fe)),Ue===0)return{azi1:0,s12:0};He=U*J+ee*W*Fe,mt=Math.atan2(Ue,He),Mt=ee*W*Pe/Ue,Pt=1-Mt*Mt,_t=Pt!==0?He-2*U*J/Pt:0,ei=D/16*Pt*(4+D*(4-3*Pt)),ve=K,K=E+(1-ei)*D*Mt*(mt+ei*Ue*(_t+ei*He*(-1+2*_t*_t)))}while(Math.abs(K-ve)>1e-12&&--Ce>0);return Ce===0?{azi1:NaN,s12:NaN}:(Vt=Pt*(P*P-P*(1-D)*(P*(1-D)))/(P*(1-D)*(P*(1-D))),mi=1+Vt/16384*(4096+Vt*(-768+Vt*(320-175*Vt))),wi=Vt/1024*(256+Vt*(-128+Vt*(74-47*Vt))),Di=wi*Ue*(_t+wi/4*(He*(-1+2*_t*_t)-wi/6*_t*(-3+4*Ue*Ue)*(-3+4*_t*_t))),Ma=P*(1-D)*mi*(mt-Di),{azi1:Math.atan2(W*Pe,ee*J-U*W*Fe),s12:Ma})}function o2(h,y,w,A,P,D){const E=Math.atan((1-D)*Math.tan(h)),l=Math.sin(E),B=Math.cos(E),U=Math.sin(w),ee=Math.cos(w),J=Math.atan2(l,B*ee),W=B*U,K=1-W*W,ve=K*(P*P-P*(1-D)*(P*(1-D)))/(P*(1-D)*(P*(1-D))),Ce=1+ve/16384*(4096+ve*(-768+ve*(320-175*ve))),Pe=ve/1024*(256+ve*(-128+ve*(74-47*ve)));let Fe=A/(P*(1-D)*Ce),Ue,He=100,mt,Mt,Pt,_t;do mt=Math.cos(2*J+Fe),Mt=Math.sin(Fe),Pt=Math.cos(Fe),_t=Pe*Mt*(mt+Pe/4*(Pt*(-1+2*mt*mt)-Pe/6*mt*(-3+4*Mt*Mt)*(-3+4*mt*mt))),Ue=Fe,Fe=A/(P*(1-D)*Ce)+_t;while(Math.abs(Fe-Ue)>1e-12&&--He>0);if(He===0)return{lat2:NaN,lon2:NaN};const ei=l*Mt-B*Pt*ee,Vt=Math.atan2(l*Pt+B*Mt*ee,(1-D)*Math.sqrt(W*W+ei*ei)),mi=Math.atan2(Mt*U,B*Pt-l*Mt*ee),wi=D/16*K*(4+D*(4-3*K)),Di=mi-(1-wi)*D*W*(Fe+wi*Mt*(mt+wi*Pt*(-1+2*mt*mt))),Ma=y+Di;return{lat2:Vt,lon2:Ma}}function l2(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function c2(h){var y=h.x,w=h.y,A=Math.sin(h.y),P=Math.cos(h.y),D=At(y-this.long0),E,l,B,U,ee,J,W,K,ve,Ce,Pe;return this.sphere?Math.abs(this.sin_p12-1)<=bt?(h.x=this.x0+this.a*(lt-w)*Math.sin(D),h.y=this.y0-this.a*(lt-w)*Math.cos(D),h):Math.abs(this.sin_p12+1)<=bt?(h.x=this.x0+this.a*(lt+w)*Math.sin(D),h.y=this.y0+this.a*(lt+w)*Math.cos(D),h):(ve=this.sin_p12*A+this.cos_p12*P*Math.cos(D),W=Math.acos(ve),K=W?W/Math.sin(W):1,h.x=this.x0+this.a*K*P*Math.sin(D),h.y=this.y0+this.a*K*(this.cos_p12*A-this.sin_p12*P*Math.cos(D)),h):(E=jp(this.es),l=Gp(this.es),B=Fp(this.es),U=Up(this.es),Math.abs(this.sin_p12-1)<=bt?(ee=this.a*Wr(E,l,B,U,lt),J=this.a*Wr(E,l,B,U,w),h.x=this.x0+(ee-J)*Math.sin(D),h.y=this.y0-(ee-J)*Math.cos(D),h):Math.abs(this.sin_p12+1)<=bt?(ee=this.a*Wr(E,l,B,U,lt),J=this.a*Wr(E,l,B,U,w),h.x=this.x0+(ee+J)*Math.sin(D),h.y=this.y0+(ee+J)*Math.cos(D),h):Math.abs(y)<bt&&Math.abs(w-this.lat0)<bt?(h.x=h.y=0,h):(Ce=s2(this.lat0,this.long0,w,y,this.a,this.f),Pe=Ce.azi1,h.x=Ce.s12*Math.sin(Pe),h.y=Ce.s12*Math.cos(Pe),h))}function u2(h){h.x-=this.x0,h.y-=this.y0;var y,w,A,P,D,E,l,B,U,ee,J,W,K,ve,Ce,Pe;return this.sphere?(y=Math.sqrt(h.x*h.x+h.y*h.y),y>2*lt*this.a?void 0:(w=y/this.a,A=Math.sin(w),P=Math.cos(w),D=this.long0,Math.abs(y)<=bt?E=this.lat0:(E=th(P*this.sin_p12+h.y*A*this.cos_p12/y),l=Math.abs(this.lat0)-lt,Math.abs(l)<=bt?this.lat0>=0?D=At(this.long0+Math.atan2(h.x,-h.y)):D=At(this.long0-Math.atan2(-h.x,h.y)):D=At(this.long0+Math.atan2(h.x*A,y*this.cos_p12*P-h.y*this.sin_p12*A))),h.x=D,h.y=E,h)):(B=jp(this.es),U=Gp(this.es),ee=Fp(this.es),J=Up(this.es),Math.abs(this.sin_p12-1)<=bt?(W=this.a*Wr(B,U,ee,J,lt),y=Math.sqrt(h.x*h.x+h.y*h.y),K=W-y,E=$m(K/this.a,B,U,ee,J),D=At(this.long0+Math.atan2(h.x,-1*h.y)),h.x=D,h.y=E,h):Math.abs(this.sin_p12+1)<=bt?(W=this.a*Wr(B,U,ee,J,lt),y=Math.sqrt(h.x*h.x+h.y*h.y),K=y-W,E=$m(K/this.a,B,U,ee,J),D=At(this.long0+Math.atan2(h.x,h.y)),h.x=D,h.y=E,h):(ve=Math.atan2(h.x,h.y),Ce=Math.sqrt(h.x*h.x+h.y*h.y),Pe=o2(this.lat0,this.long0,ve,Ce,this.a,this.f),h.x=Pe.lon2,h.y=Pe.lat2,h))}var h2=["Azimuthal_Equidistant","aeqd"];const d2={init:l2,forward:c2,inverse:u2,names:h2};function f2(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function p2(h){var y,w,A,P,D,E,l,B,U=h.x,ee=h.y;return A=At(U-this.long0),y=Math.sin(ee),w=Math.cos(ee),P=Math.cos(A),E=this.sin_p14*y+this.cos_p14*w*P,D=1,(E>0||Math.abs(E)<=bt)&&(l=this.a*D*w*Math.sin(A),B=this.y0+this.a*D*(this.cos_p14*y-this.sin_p14*w*P)),h.x=l,h.y=B,h}function m2(h){var y,w,A,P,D,E,l;return h.x-=this.x0,h.y-=this.y0,y=Math.sqrt(h.x*h.x+h.y*h.y),w=th(y/this.a),A=Math.sin(w),P=Math.cos(w),E=this.long0,Math.abs(y)<=bt?(l=this.lat0,h.x=E,h.y=l,h):(l=th(P*this.sin_p14+h.y*A*this.cos_p14/y),D=Math.abs(this.lat0)-lt,Math.abs(D)<=bt?(this.lat0>=0?E=At(this.long0+Math.atan2(h.x,-h.y)):E=At(this.long0-Math.atan2(-h.x,h.y)),h.x=E,h.y=l,h):(E=At(this.long0+Math.atan2(h.x*A,y*this.cos_p14*P-h.y*this.sin_p14*A)),h.x=E,h.y=l,h))}var g2=["ortho"];const _2={init:f2,forward:p2,inverse:m2,names:g2};var Ha={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},aa={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function y2(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=lt-ia/2?this.face=Ha.TOP:this.lat0<=-(lt-ia/2)?this.face=Ha.BOTTOM:Math.abs(this.long0)<=ia?this.face=Ha.FRONT:Math.abs(this.long0)<=lt+ia?this.face=this.long0>0?Ha.RIGHT:Ha.LEFT:this.face=Ha.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function v2(h){var y={x:0,y:0},w,A,P,D,E,l,B={value:0};if(h.x-=this.long0,this.es!==0?w=Math.atan(this.one_minus_f_squared*Math.tan(h.y)):w=h.y,A=h.x,this.face===Ha.TOP)D=lt-w,A>=ia&&A<=lt+ia?(B.value=aa.AREA_0,P=A-lt):A>lt+ia||A<=-(lt+ia)?(B.value=aa.AREA_1,P=A>0?A-fn:A+fn):A>-(lt+ia)&&A<=-ia?(B.value=aa.AREA_2,P=A+lt):(B.value=aa.AREA_3,P=A);else if(this.face===Ha.BOTTOM)D=lt+w,A>=ia&&A<=lt+ia?(B.value=aa.AREA_0,P=-A+lt):A<ia&&A>=-ia?(B.value=aa.AREA_1,P=-A):A<-ia&&A>=-(lt+ia)?(B.value=aa.AREA_2,P=-A-lt):(B.value=aa.AREA_3,P=A>0?-A+fn:-A-fn);else{var U,ee,J,W,K,ve,Ce;this.face===Ha.RIGHT?A=ff(A,+lt):this.face===Ha.BACK?A=ff(A,+fn):this.face===Ha.LEFT&&(A=ff(A,-lt)),W=Math.sin(w),K=Math.cos(w),ve=Math.sin(A),Ce=Math.cos(A),U=K*Ce,ee=K*ve,J=W,this.face===Ha.FRONT?(D=Math.acos(U),P=Dm(D,J,ee,B)):this.face===Ha.RIGHT?(D=Math.acos(ee),P=Dm(D,J,-U,B)):this.face===Ha.BACK?(D=Math.acos(-U),P=Dm(D,J,-ee,B)):this.face===Ha.LEFT?(D=Math.acos(-ee),P=Dm(D,J,U,B)):(D=P=0,B.value=aa.AREA_0)}return l=Math.atan(12/fn*(P+Math.acos(Math.sin(P)*Math.cos(ia))-lt)),E=Math.sqrt((1-Math.cos(D))/(Math.cos(l)*Math.cos(l))/(1-Math.cos(Math.atan(1/Math.cos(P))))),B.value===aa.AREA_1?l+=lt:B.value===aa.AREA_2?l+=fn:B.value===aa.AREA_3&&(l+=1.5*fn),y.x=E*Math.cos(l),y.y=E*Math.sin(l),y.x=y.x*this.a+this.x0,y.y=y.y*this.a+this.y0,h.x=y.x,h.y=y.y,h}function x2(h){var y={lam:0,phi:0},w,A,P,D,E,l,B,U,ee,J={value:0};if(h.x=(h.x-this.x0)/this.a,h.y=(h.y-this.y0)/this.a,A=Math.atan(Math.sqrt(h.x*h.x+h.y*h.y)),w=Math.atan2(h.y,h.x),h.x>=0&&h.x>=Math.abs(h.y)?J.value=aa.AREA_0:h.y>=0&&h.y>=Math.abs(h.x)?(J.value=aa.AREA_1,w-=lt):h.x<0&&-h.x>=Math.abs(h.y)?(J.value=aa.AREA_2,w=w<0?w+fn:w-fn):(J.value=aa.AREA_3,w+=lt),ee=fn/12*Math.tan(w),E=Math.sin(ee)/(Math.cos(ee)-1/Math.sqrt(2)),l=Math.atan(E),P=Math.cos(w),D=Math.tan(A),B=1-P*P*D*D*(1-Math.cos(Math.atan(1/Math.cos(l)))),B<-1?B=-1:B>1&&(B=1),this.face===Ha.TOP)U=Math.acos(B),y.phi=lt-U,J.value===aa.AREA_0?y.lam=l+lt:J.value===aa.AREA_1?y.lam=l<0?l+fn:l-fn:J.value===aa.AREA_2?y.lam=l-lt:y.lam=l;else if(this.face===Ha.BOTTOM)U=Math.acos(B),y.phi=U-lt,J.value===aa.AREA_0?y.lam=-l+lt:J.value===aa.AREA_1?y.lam=-l:J.value===aa.AREA_2?y.lam=-l-lt:y.lam=l<0?-l-fn:-l+fn;else{var W,K,ve;W=B,ee=W*W,ee>=1?ve=0:ve=Math.sqrt(1-ee)*Math.sin(l),ee+=ve*ve,ee>=1?K=0:K=Math.sqrt(1-ee),J.value===aa.AREA_1?(ee=K,K=-ve,ve=ee):J.value===aa.AREA_2?(K=-K,ve=-ve):J.value===aa.AREA_3&&(ee=K,K=ve,ve=-ee),this.face===Ha.RIGHT?(ee=W,W=-K,K=ee):this.face===Ha.BACK?(W=-W,K=-K):this.face===Ha.LEFT&&(ee=W,W=K,K=-ee),y.phi=Math.acos(-ve)-lt,y.lam=Math.atan2(K,W),this.face===Ha.RIGHT?y.lam=ff(y.lam,-lt):this.face===Ha.BACK?y.lam=ff(y.lam,-fn):this.face===Ha.LEFT&&(y.lam=ff(y.lam,+lt))}if(this.es!==0){var Ce,Pe,Fe;Ce=y.phi<0?1:0,Pe=Math.tan(y.phi),Fe=this.b/Math.sqrt(Pe*Pe+this.one_minus_f_squared),y.phi=Math.atan(Math.sqrt(this.a*this.a-Fe*Fe)/(this.one_minus_f*Fe)),Ce&&(y.phi=-y.phi)}return y.lam+=this.long0,h.x=y.lam,h.y=y.phi,h}function Dm(h,y,w,A){var P;return h<bt?(A.value=aa.AREA_0,P=0):(P=Math.atan2(y,w),Math.abs(P)<=ia?A.value=aa.AREA_0:P>ia&&P<=lt+ia?(A.value=aa.AREA_1,P-=lt):P>lt+ia||P<=-(lt+ia)?(A.value=aa.AREA_2,P=P>=0?P-fn:P+fn):(A.value=aa.AREA_3,P+=lt)),P}function ff(h,y){var w=h+y;return w<-fn?w+=Ip:w>+fn&&(w-=Ip),w}var b2=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const w2={init:y2,forward:v2,inverse:x2,names:b2};var Lg=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Mp=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],wy=.8487,Sy=1.3523,My=lc/5,S2=1/My,hf=18,Hm=function(h,y){return h[0]+y*(h[1]+y*(h[2]+y*h[3]))},M2=function(h,y){return h[1]+y*(2*h[2]+y*3*h[3])};function T2(h,y,w,A){for(var P=y;A;--A){var D=h(P);if(P-=D,Math.abs(D)<w)break}return P}function E2(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function A2(h){var y=At(h.x-this.long0),w=Math.abs(h.y),A=Math.floor(w*My);A<0?A=0:A>=hf&&(A=hf-1),w=lc*(w-S2*A);var P={x:Hm(Lg[A],w)*y,y:Hm(Mp[A],w)};return h.y<0&&(P.y=-P.y),P.x=P.x*this.a*wy+this.x0,P.y=P.y*this.a*Sy+this.y0,P}function C2(h){var y={x:(h.x-this.x0)/(this.a*wy),y:Math.abs(h.y-this.y0)/(this.a*Sy)};if(y.y>=1)y.x/=Lg[hf][0],y.y=h.y<0?-lt:lt;else{var w=Math.floor(y.y*hf);for(w<0?w=0:w>=hf&&(w=hf-1);;)if(Mp[w][0]>y.y)--w;else if(Mp[w+1][0]<=y.y)++w;else break;var A=Mp[w],P=5*(y.y-A[0])/(Mp[w+1][0]-A[0]);P=T2(function(D){return(Hm(A,D)-y.y)/M2(A,D)},P,bt,100),y.x/=Hm(Lg[w],P),y.y=(5*w+P)*dr,h.y<0&&(y.y=-y.y)}return y.x=At(y.x+this.long0),y}var P2=["Robinson","robin"];const z2={init:E2,forward:A2,inverse:C2,names:P2};function I2(){this.name="geocent"}function R2(h){var y=hy(h,this.es,this.a);return y}function D2(h){var y=dy(h,this.es,this.a,this.b);return y}var k2=["Geocentric","geocentric","geocent","Geocent"];const L2={init:I2,forward:R2,inverse:D2,names:k2};var zr={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},bp={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function O2(){if(Object.keys(bp).forEach((function(w){if(typeof this[w]>"u")this[w]=bp[w].def;else{if(bp[w].num&&isNaN(this[w]))throw new Error("Invalid parameter value, must be numeric "+w+" = "+this[w]);bp[w].num&&(this[w]=parseFloat(this[w]))}bp[w].degrees&&(this[w]=this[w]*dr)}).bind(this)),Math.abs(Math.abs(this.lat0)-lt)<bt?this.mode=this.lat0<0?zr.S_POLE:zr.N_POLE:Math.abs(this.lat0)<bt?this.mode=zr.EQUIT:(this.mode=zr.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var h=this.tilt,y=this.azi;this.cg=Math.cos(y),this.sg=Math.sin(y),this.cw=Math.cos(h),this.sw=Math.sin(h)}function B2(h){h.x-=this.long0;var y=Math.sin(h.y),w=Math.cos(h.y),A=Math.cos(h.x),P,D;switch(this.mode){case zr.OBLIQ:D=this.sinph0*y+this.cosph0*w*A;break;case zr.EQUIT:D=w*A;break;case zr.S_POLE:D=-y;break;case zr.N_POLE:D=y;break}switch(D=this.pn1/(this.p-D),P=D*w*Math.sin(h.x),this.mode){case zr.OBLIQ:D*=this.cosph0*y-this.sinph0*w*A;break;case zr.EQUIT:D*=y;break;case zr.N_POLE:D*=-(w*A);break;case zr.S_POLE:D*=w*A;break}var E,l;return E=D*this.cg+P*this.sg,l=1/(E*this.sw*this.h1+this.cw),P=(P*this.cg-D*this.sg)*this.cw*l,D=E*l,h.x=P*this.a,h.y=D*this.a,h}function N2(h){h.x/=this.a,h.y/=this.a;var y={x:h.x,y:h.y},w,A,P;P=1/(this.pn1-h.y*this.sw),w=this.pn1*h.x*P,A=this.pn1*h.y*this.cw*P,h.x=w*this.cg+A*this.sg,h.y=A*this.cg-w*this.sg;var D=vs(h.x,h.y);if(Math.abs(D)<bt)y.x=0,y.y=h.y;else{var E,l;switch(l=1-D*D*this.pfact,l=(this.p-Math.sqrt(l))/(this.pn1/D+D/this.pn1),E=Math.sqrt(1-l*l),this.mode){case zr.OBLIQ:y.y=Math.asin(E*this.sinph0+h.y*l*this.cosph0/D),h.y=(E-this.sinph0*Math.sin(y.y))*D,h.x*=l*this.cosph0;break;case zr.EQUIT:y.y=Math.asin(h.y*l/D),h.y=E*D,h.x*=l;break;case zr.N_POLE:y.y=Math.asin(E),h.y=-h.y;break;case zr.S_POLE:y.y=-Math.asin(E);break}y.x=Math.atan2(h.x,h.y)}return h.x=y.x+this.long0,h.y=y.y,h}var j2=["Tilted_Perspective","tpers"];const G2={init:O2,forward:B2,inverse:N2,names:j2};function F2(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var h=1-this.es,y=1/h;this.radius_p=Math.sqrt(h),this.radius_p2=h,this.radius_p_inv2=y,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function U2(h){var y=h.x,w=h.y,A,P,D,E;if(y=y-this.long0,this.shape==="ellipse"){w=Math.atan(this.radius_p2*Math.tan(w));var l=this.radius_p/vs(this.radius_p*Math.cos(w),Math.sin(w));if(P=l*Math.cos(y)*Math.cos(w),D=l*Math.sin(y)*Math.cos(w),E=l*Math.sin(w),(this.radius_g-P)*P-D*D-E*E*this.radius_p_inv2<0)return h.x=Number.NaN,h.y=Number.NaN,h;A=this.radius_g-P,this.flip_axis?(h.x=this.radius_g_1*Math.atan(D/vs(E,A)),h.y=this.radius_g_1*Math.atan(E/A)):(h.x=this.radius_g_1*Math.atan(D/A),h.y=this.radius_g_1*Math.atan(E/vs(D,A)))}else this.shape==="sphere"&&(A=Math.cos(w),P=Math.cos(y)*A,D=Math.sin(y)*A,E=Math.sin(w),A=this.radius_g-P,this.flip_axis?(h.x=this.radius_g_1*Math.atan(D/vs(E,A)),h.y=this.radius_g_1*Math.atan(E/A)):(h.x=this.radius_g_1*Math.atan(D/A),h.y=this.radius_g_1*Math.atan(E/vs(D,A))));return h.x=h.x*this.a,h.y=h.y*this.a,h}function V2(h){var y=-1,w=0,A=0,P,D,E,l;if(h.x=h.x/this.a,h.y=h.y/this.a,this.shape==="ellipse"){this.flip_axis?(A=Math.tan(h.y/this.radius_g_1),w=Math.tan(h.x/this.radius_g_1)*vs(1,A)):(w=Math.tan(h.x/this.radius_g_1),A=Math.tan(h.y/this.radius_g_1)*vs(1,w));var B=A/this.radius_p;if(P=w*w+B*B+y*y,D=2*this.radius_g*y,E=D*D-4*P*this.C,E<0)return h.x=Number.NaN,h.y=Number.NaN,h;l=(-D-Math.sqrt(E))/(2*P),y=this.radius_g+l*y,w*=l,A*=l,h.x=Math.atan2(w,y),h.y=Math.atan(A*Math.cos(h.x)/y),h.y=Math.atan(this.radius_p_inv2*Math.tan(h.y))}else if(this.shape==="sphere"){if(this.flip_axis?(A=Math.tan(h.y/this.radius_g_1),w=Math.tan(h.x/this.radius_g_1)*Math.sqrt(1+A*A)):(w=Math.tan(h.x/this.radius_g_1),A=Math.tan(h.y/this.radius_g_1)*Math.sqrt(1+w*w)),P=w*w+A*A+y*y,D=2*this.radius_g*y,E=D*D-4*P*this.C,E<0)return h.x=Number.NaN,h.y=Number.NaN,h;l=(-D-Math.sqrt(E))/(2*P),y=this.radius_g+l*y,w*=l,A*=l,h.x=Math.atan2(w,y),h.y=Math.atan(A*Math.cos(h.x)/y)}return h.x=h.x+this.long0,h}var q2=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Z2={init:F2,forward:U2,inverse:V2,names:q2};var Ep=1.340264,Ap=-.081106,Cp=893e-6,Pp=.003796,Xm=Math.sqrt(3)/2;function $2(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function H2(h){var y=At(h.x-this.long0),w=h.y,A=Math.asin(Xm*Math.sin(w)),P=A*A,D=P*P*P;return h.x=y*Math.cos(A)/(Xm*(Ep+3*Ap*P+D*(7*Cp+9*Pp*P))),h.y=A*(Ep+Ap*P+D*(Cp+Pp*P)),h.x=this.a*h.x+this.x0,h.y=this.a*h.y+this.y0,h}function X2(h){h.x=(h.x-this.x0)/this.a,h.y=(h.y-this.y0)/this.a;var y=1e-9,w=12,A=h.y,P,D,E,l,B,U;for(U=0;U<w&&(P=A*A,D=P*P*P,E=A*(Ep+Ap*P+D*(Cp+Pp*P))-h.y,l=Ep+3*Ap*P+D*(7*Cp+9*Pp*P),A-=B=E/l,!(Math.abs(B)<y));++U);return P=A*A,D=P*P*P,h.x=Xm*h.x*(Ep+3*Ap*P+D*(7*Cp+9*Pp*P))/Math.cos(A),h.y=Math.asin(Math.sin(A)/Xm),h.x=At(h.x+this.long0),h}var Y2=["eqearth","Equal Earth","Equal_Earth"];const W2={init:$2,forward:H2,inverse:X2,names:Y2};var kp=1e-10;function Q2(){var h;if(this.phi1=this.lat1,Math.abs(this.phi1)<kp)throw new Error;this.es?(this.en=Hg(this.es),this.m1=_f(this.phi1,this.am1=Math.sin(this.phi1),h=Math.cos(this.phi1),this.en),this.am1=h/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=J2,this.forward=K2):(Math.abs(this.phi1)+kp>=lt?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=tw,this.forward=ew)}function K2(h){var y=At(h.x-(this.long0||0)),w=h.y,A,P,D;return A=this.am1+this.m1-_f(w,P=Math.sin(w),D=Math.cos(w),this.en),P=D*y/(A*Math.sqrt(1-this.es*P*P)),h.x=A*Math.sin(P),h.y=this.am1-A*Math.cos(P),h.x=this.a*h.x+(this.x0||0),h.y=this.a*h.y+(this.y0||0),h}function J2(h){h.x=(h.x-(this.x0||0))/this.a,h.y=(h.y-(this.y0||0))/this.a;var y,w,A,P;if(w=vs(h.x,h.y=this.am1-h.y),P=Xg(this.am1+this.m1-w,this.es,this.en),(y=Math.abs(P))<lt)y=Math.sin(P),A=w*Math.atan2(h.x,h.y)*Math.sqrt(1-this.es*y*y)/Math.cos(P);else if(Math.abs(y-lt)<=kp)A=0;else throw new Error;return h.x=At(A+(this.long0||0)),h.y=ih(P),h}function ew(h){var y=At(h.x-(this.long0||0)),w=h.y,A,P;return P=this.cphi1+this.phi1-w,Math.abs(P)>kp?(h.x=P*Math.sin(A=y*Math.cos(w)/P),h.y=this.cphi1-P*Math.cos(A)):h.x=h.y=0,h.x=this.a*h.x+(this.x0||0),h.y=this.a*h.y+(this.y0||0),h}function tw(h){h.x=(h.x-(this.x0||0))/this.a,h.y=(h.y-(this.y0||0))/this.a;var y,w,A=vs(h.x,h.y=this.cphi1-h.y);if(w=this.cphi1+this.phi1-A,Math.abs(w)>lt)throw new Error;return Math.abs(Math.abs(w)-lt)<=kp?y=0:y=A*Math.atan2(h.x,h.y)/Math.cos(w),h.x=At(y+(this.long0||0)),h.y=ih(w),h}var iw=["bonne","Bonne (Werner lat_1=90)"];const aw={init:Q2,names:iw};function nw(h){h.Proj.projections.add(jm),h.Proj.projections.add(Gm),h.Proj.projections.add(ix),h.Proj.projections.add(hx),h.Proj.projections.add(gx),h.Proj.projections.add(bx),h.Proj.projections.add(Ax),h.Proj.projections.add(Rx),h.Proj.projections.add(Bx),h.Proj.projections.add(Ux),h.Proj.projections.add(tb),h.Proj.projections.add(ob),h.Proj.projections.add(db),h.Proj.projections.add(yb),h.Proj.projections.add(Sb),h.Proj.projections.add(Cb),h.Proj.projections.add(Db),h.Proj.projections.add(Nb),h.Proj.projections.add(qb),h.Proj.projections.add(Yb),h.Proj.projections.add(e2),h.Proj.projections.add(r2),h.Proj.projections.add(d2),h.Proj.projections.add(_2),h.Proj.projections.add(w2),h.Proj.projections.add(z2),h.Proj.projections.add(L2),h.Proj.projections.add(G2),h.Proj.projections.add(Z2),h.Proj.projections.add(W2),h.Proj.projections.add(aw)}const Ty=Object.assign(v1,{defaultDatum:"WGS84",Proj:Tl,WGS84:new Tl("WGS84"),Point:pf,toPoint:fy,defs:Yr,nadgrid:t1,transform:Zm,mgrs:x1,version:"__VERSION__"});nw(Ty);const rw="+proj=utm +zone=36 +datum=WGS84 +units=m +no_defs",sw="+proj=longlat +datum=WGS84 +no_defs",ow="/occupation-of-the-sun/assets/Map Pin.svg";async function lw(h,y,w="sites",A="site-points",P=!0,D=32){const E=[],l=[];console.log("loadSitePoints: loading",Object.keys(y).length,"sites for",w,"pinSize:",D);for(const[U,ee]of Object.entries(y)){const J=ee.pointGeoJson.startsWith("/")?`/occupation-of-the-sun/${ee.pointGeoJson.slice(1)}`:`/occupation-of-the-sun/${ee.pointGeoJson}`;console.log(`loadSitePoints: fetching ${U} from ${J}`);const W=await fetch(J).then(He=>He.json()),K=W.features?.[0]||W,ve=K.geometry.coordinates;console.log(`loadSitePoints: ${U} raw coords:`,ve);let Ce=ve;if(Array.isArray(ve)&&Math.abs(ve[0])>180){const[He,mt]=ve;Ce=Ty(rw,sw,[He,mt]),console.log(`loadSitePoints: ${U} reprojected to:`,Ce),console.log(` IMPORTANT: ${U} is at longitude ${Ce[0]}, latitude ${Ce[1]}`)}const Pe={type:"Feature",geometry:{type:"Point",coordinates:Ce},properties:{...K.properties||{},siteId:U,name:ee.name}};E.push(Pe);const Fe=document.createElement("div");Fe.className="map-pin-marker",Fe.innerHTML=`<img src="${ow}" alt="pin" style="width:${D}px;height:auto;display:block;" />`,Fe.style.cursor="pointer",Fe.dataset.siteId=U,Fe.dataset.name=ee.name;const Ue=new Vg.Marker({element:Fe,anchor:"bottom"}).setLngLat(Ce).addTo(h);l.push({marker:Ue,siteId:U,name:ee.name,meta:ee})}console.log("loadSitePoints: total features:",E.length);const B={type:"FeatureCollection",features:E};if(h.getSource(w)?h.getSource(w).setData(B):(h.addSource(w,{type:"geojson",data:B}),console.log("loadSitePoints: source added:",w)),h.getLayer(A)||(h.addLayer({id:A,source:w,type:"circle",paint:{"circle-color":"#ff0000","circle-radius":8,"circle-stroke-color":"#ffffff","circle-stroke-width":2,"circle-opacity":0,"circle-stroke-opacity":0}}),console.log("loadSitePoints: layer added (invisible):",A)),P&&E.length){const U=E.map(W=>W.geometry.coordinates[0]),ee=E.map(W=>W.geometry.coordinates[1]),J=[[Math.min(...U),Math.min(...ee)],[Math.max(...U),Math.max(...ee)]];console.log("loadSitePoints: fitting bounds:",J),h.fitBounds(J,{padding:80,duration:1200})}return l}function cw({x:h,y,text:w,visible:A}){if(!A)return null;const P={position:"absolute",left:h+8,top:y+8,background:"rgba(0,0,0,0.8)",color:"#fff",padding:"6px 8px",borderRadius:4,pointerEvents:"none",fontSize:12,zIndex:10};return oe.jsx("div",{style:P,children:w})}let O_=!1;O_||(Vg.setRTLTextPlugin("https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.min.js",h=>{h?console.error("RTL plugin failed to load:",h):console.log("RTL plugin loaded successfully")},!0),O_=!0);function uw({onReady:h,grayscale:y=!1,showVideoPoints:w=!1,scrollContainer:A=null,visibleSiteIds:P=[]}){const D=Ze.useRef(null),E=Ze.useRef(null),l=Ze.useRef([]),B=Ze.useRef(P),[U,ee]=Ze.useState(!1),[J,W]=Ze.useState({visible:!1,x:0,y:0,text:""});return Ze.useEffect(()=>{const K="JEADPH6EaF6ncO48MUFJ";if(console.log("MapCanvas: initializing, key present:",!0,"container:",!!D.current,"existing map:",!!E.current),!D.current){console.error("MapCanvas: container ref not available");return}if(E.current){console.log("MapCanvas: map already exists, skipping");return}const ve=`https://api.maptiler.com/maps/satellite/style.json?key=${K}`;console.log("MapCanvas: using style URL:",ve.replace(K,"XXXX")),console.log("MapCanvas: creating map instance...");const Ce=new Vg.Map({container:D.current,style:ve,center:[35.35,31.8],zoom:8,pitch:45,bearing:-10,hash:!0,scrollZoom:!1});return E.current=Ce,console.log("MapCanvas: map instance created"),Ce.on("error",Pe=>{console.error("MapLibre error:",Pe.error)}),Ce.on("load",async()=>{console.log("MapCanvas: map loaded");try{Ce.addSource("terrain",{type:"raster-dem",url:`https://api.maptiler.com/tiles/terrain-rgb/tiles.json?key=${K}`,tileSize:256}),Ce.setTerrain({source:"terrain",exaggeration:1.3}),console.log("MapCanvas: terrain added")}catch(Pe){console.error("MapCanvas: terrain setup error:",Pe)}try{const Pe=[[34.737255684304955,32.56348699254539],[35.57650523264138,32.56348699254539],[35.57650523264138,31.31355578154553],[34.737255684304955,31.31355578154553]];Ce.addSource("west-bank-overlay",{type:"image",url:"/occupation-of-the-sun/assets/west-bank-4.png",coordinates:Pe}),Ce.addLayer({id:"west-bank-overlay-layer",type:"raster",source:"west-bank-overlay",layout:{visibility:"none"},paint:{"raster-opacity":1}}),console.log("MapCanvas: West Bank overlay added (hidden)")}catch(Pe){console.error("MapCanvas: West Bank overlay setup error:",Pe)}try{const Pe=y?16:23;console.log("MapCanvas: loading site points with pinSize:",Pe,"grayscale:",y);const Fe=await lw(Ce,cv,"sites","site-points",!0,Pe);l.current=Fe,console.log("MapCanvas: site points loaded"),Fe.forEach(({marker:He,siteId:mt,name:Mt,meta:Pt})=>{const _t=He.getElement();_t.style.pointerEvents="auto",_t.addEventListener("mouseenter",ei=>{const Vt=_t.getBoundingClientRect(),mi=D.current.getBoundingClientRect();W({visible:!0,x:Vt.left-mi.left+Vt.width/2,y:Vt.top-mi.top,text:Mt})}),_t.addEventListener("mouseleave",()=>{W(ei=>({...ei,visible:!1}))})});const Ue=B.current;console.log("MapCanvas: applying initial visibility, visibleSiteIds:",Ue),Fe.forEach(({marker:He,siteId:mt})=>{const Mt=He.getElement();Ue.includes(mt)?Mt.style.display="":Mt.style.display="none"}),ee(!0),h?.({map:Ce,showWestBankOverlay:He=>{Ce.getLayer("west-bank-overlay-layer")&&(Ce.setLayoutProperty("west-bank-overlay-layer","visibility",He?"visible":"none"),console.log("MapCanvas: West Bank overlay visibility:",He?"visible":"none"))}})}catch(Pe){console.error("MapCanvas: site points error:",Pe)}}),()=>{Ce.remove()}},[]),Ze.useEffect(()=>{if(!A)return;const K=ve=>{if(Math.abs(ve.deltaY)>50){ve.preventDefault();const Ce=ve.deltaY*.9;A.scrollBy({top:Ce,behavior:"smooth"})}};return A.addEventListener("wheel",K,{passive:!1}),()=>{A.removeEventListener("wheel",K)}},[A]),Ze.useEffect(()=>{if(!E.current)return;const K=E.current.getCanvas();y?K.style.filter="grayscale(100%) contrast(0.9)":K.style.filter="";const ve=y?16:23;l.current.forEach(({marker:Ce})=>{const Pe=Ce.getElement().querySelector("img");Pe&&(Pe.style.width=`${ve}px`)})},[y]),Ze.useEffect(()=>{B.current=P},[P]),Ze.useEffect(()=>{U&&(console.log("MapCanvas: updating visibility, visibleSiteIds:",P),l.current.forEach(({marker:K,siteId:ve})=>{const Ce=K.getElement();P.includes(ve)?Ce.style.display="":Ce.style.display="none"}))},[P,U]),oe.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[oe.jsx("div",{ref:D,style:{width:"100%",height:"100%"}}),oe.jsx(cw,{...J})]})}const hw=JSON.parse(`[{"id":"intro","camera":{"center":[34.761,32.312],"zoom":8,"pitch":59,"bearing":35.3,"duration":2000}},{"id":"sub-intro","camera":{"center":[34.6855,32.1554],"zoom":8.5,"pitch":0,"bearing":9.8,"duration":2000}},{"id":"farsia-village","siteId":"farsia","camera":{"center":[35.51246,32.34591],"zoom":14.3,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"Al - Farsia Story","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"farsia-video","siteId":"farsia-video","camera":{"center":[35.509386,32.343125],"zoom":17,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"Life in Al-Farsia","text":"They own a few hundred sheep, and a small patch of agricultural land, where they grow barley to feed the sheep. This is the economic backbone of the tiny community, they sell the lamb and sheep cheese, buy everything else they need from the markets. Both agriculture and grazing have become increasingly difficult because of pressure from Israeli settlers living nearby, who have cut Farsiya off its grazing land, and frequently damage the agricultural fields by grazing their own sheep flocks there."}},{"id":"farsia-village-2","siteId":"farsia-village-2","camera":{"center":[35.509386,32.343125],"zoom":17,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"Al - Farsia Story","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"rotem","siteId":"rotem","camera":{"center":[35.510981,32.340291],"zoom":15.4,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"rotem","text":"Rotem is a settlement in the Jordan Valley, built in 1983. It is home to around 1000 people, most of whom are Jewish. The settlement is home to a number of Israeli military bases, and is a major center of Israeli military activity in the Jordan Valley."}},{"id":"rotem-video","siteId":"rotem-video","camera":{"center":[35.510981,32.340291],"zoom":15.4,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"rotem-video","text":"Rotem is a settlement in the Jordan Valley, built in 1983. It is home to around 1000 people, most of whom are Jewish. The settlement is home to a number of Israeli military bases, and is a major center of Israeli military activity in the Jordan Valley."}},{"id":"settlements","siteId":"settlements","camera":{"center":[35.51224,32.34475],"zoom":14.2,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"settlements","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"shdemot-mehola","siteId":"shdemot-mehola","camera":{"center":[35.529608,32.346104],"zoom":15.4,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"shdemot-mehola","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"shdemot-mehola-zoom","siteId":"shdemot-mehola-zoom","camera":{"center":[35.528826,32.348095],"zoom":16.11,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"shdemot-mehola-zoom","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"shdemot-mehola-zoom-2","siteId":"shdemot-mehola-zoom-2","camera":{"center":[35.528826,32.348095],"zoom":16.11,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"shdemot-mehola-zoom","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"shdemot-mehola-video","siteId":"shdemot-mehola-video","camera":{"center":[35.528826,32.348095],"zoom":16.11,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"shdemot-mehola-video","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"shdemot-mehola-out","siteId":"shdemot-mehola-out","camera":{"center":[35.529608,32.346104],"zoom":15.4,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"shdemot-mehola","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"shdemot-mehola-solar-field","siteId":"shdemot-mehola-solar-field","camera":{"center":[35.532462,32.342895],"zoom":16.33,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"shdemot-mehola","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"shdemot-mehola-solar-video","siteId":"shdemot-mehola-solar-video","camera":{"center":[35.532462,32.342895],"zoom":16.33,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"shdemot-mehola","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"settlements-2","siteId":"settlements","camera":{"center":[35.51224,32.34475],"zoom":14.2,"pitch":1,"bearing":7.5,"duration":2500},"content":{"title":"settlements","text":"The word \\"village\\" may be an overstatement. Farj'a Nabaa al-Ghazzal is a Bedouin community, where a group of Palestinian families settled around 20 people, all belonging to the Harashina family. According to Ahmed, they have lived in this location for 47 years - they settled in this area because it was a good place for agricultural lands and find better pastures, sometimes as a consequence of forced displacement by Israeli settlers and the army. Most of these communities in the occupied West Bank also face an extremely difficult reality and are under the standing."}},{"id":"sub-intro-2","camera":{"center":[35.3354,32.1942],"zoom":9.5,"pitch":0,"bearing":17,"duration":2000}},{"id":"naama-nueima","camera":{"center":[35.4318,31.91065],"zoom":13.48,"pitch":0,"bearing":17,"duration":2000}},{"id":"naama","camera":{"center":[35.45707,31.91369],"zoom":15.03,"pitch":0,"bearing":17,"duration":2000}},{"id":"naama-zoom","camera":{"center":[35.463699,31.907352],"zoom":16,"pitch":0,"bearing":17,"duration":2000}},{"id":"naama-2","camera":{"center":[35.45707,31.91369],"zoom":15.03,"pitch":0,"bearing":17,"duration":2000}},{"id":"naama-solar","camera":{"center":[35.454599,31.917922],"zoom":16.03,"pitch":0,"bearing":17,"duration":2000}},{"id":"naama-nueima-2","camera":{"center":[35.4318,31.91065],"zoom":13.48,"pitch":0,"bearing":17,"duration":2000}},{"id":"nueima-zoom","camera":{"center":[35.43352,31.88695],"zoom":13.59,"pitch":0,"bearing":17,"duration":2000}},{"id":"nueima-solar","camera":{"center":[35.439212,31.912765],"zoom":16.3,"pitch":0,"bearing":17,"duration":2000}},{"id":"nueima-solar-video","camera":{"center":[35.439212,31.912765],"zoom":16.3,"pitch":0,"bearing":17,"duration":2000}},{"id":"nueima-zoom-2","camera":{"center":[35.43352,31.88695],"zoom":13.59,"pitch":0,"bearing":17,"duration":2000}},{"id":"beit-al-ajdad","camera":{"center":[35.455309,31.868562],"zoom":15.5,"pitch":0,"bearing":17,"duration":2000}},{"id":"beit-al-ajdad-video","camera":{"center":[35.455309,31.868562],"zoom":15.5,"pitch":0,"bearing":17,"duration":2000}},{"id":"west-bank","camera":{"center":[34.6855,32.1554],"zoom":8.5,"pitch":0,"bearing":9.8,"duration":2000}},{"id":"globe-scene","camera":{"center":[-8.8,32.9],"zoom":1.5,"pitch":0,"bearing":2.2,"duration":2000}},{"id":"intro-2","camera":{"center":[34.761,32.312],"zoom":8,"pitch":59,"bearing":35.3,"duration":2000}}]`);function dw(h,y,w,A={}){const{root:P=null}=A,D=y.map(l=>{const B=document.querySelector(`[data-scene-id="${l.id}"]`);return B||console.warn(` Scene element not found: ${l.id}`),{step:l,el:B}}),E=new IntersectionObserver(l=>{l.forEach(B=>{if(B.isIntersecting&&B.intersectionRatio>=.5){const U=B.target.getAttribute("data-scene-id"),ee=y.find(J=>J.id===U);console.log(` Scene changed to: ${U}`,ee?.camera),ee?.camera&&h.easeTo({...ee.camera}),w&&w(U)}})},{root:P,threshold:.5});return D.forEach(({el:l})=>l&&E.observe(l)),console.log(` Observing ${D.filter(l=>l.el).length} scenes`),()=>E.disconnect()}const fw={intro:{reset:!0,show:["farsia","naama","nueima","shdemot-mehola"],hide:["naama-solar-fields","nueima-solar-fields","rotem"]},"farsia-village":{hide:["naama-solar-fields","nueima-solar-fields"],show:["farsia","shdemot-mehola-solar"]},"farsia-video":{hide:["naama-solar-fields","nueima-solar-fields"],show:[]},rotem:{show:["rotem"]},settlements:{hide:["naama-solar-fields","nueima-solar-fields"],show:[]},"sub-intro-2":{hide:["naama-solar-fields","nueima-solar-fields","rotem","shdemot-mehola-solar"],show:[]},"naama-nueima":{hide:[],show:["naama-solar-fields","nueima-solar-fields"]},"nueima-zoom":{show:["nueima","beit-al-ajdad","jericho-governate"]},"west-bank":{hide:["naama-solar-fields","nueima-solar-fields","jericho-governate","beit-al-ajdad"]}};function pw({children:h}){return oe.jsx("div",{className:"app",children:h})}function B_(){const[h,y]=Ze.useState(null),[w,A]=Ze.useState("intro"),[P,D]=Ze.useState(!1),[E,l]=Ze.useState(!0),[B,U]=Ze.useState([]),[ee,J]=Ze.useState(!1),W=Ze.useRef(null),K=Ze.useRef(!1),ve=Ze.useRef(null),Ce=He=>{He==="intro"?l(!0):(K.current=!0,l(!1),D(!0)),document.querySelector(`[data-scene-id="${He}"]`)?.scrollIntoView({behavior:"smooth"})};Ze.useEffect(()=>{if(!h?.map)return;const He=dw(h.map,hw,mt=>{console.log(" Scene changed:",mt,"storyStarted:",P),A(mt),mt==="farsia-village"&&!P&&(console.log(" Auto-starting story!"),D(!0)),mt==="intro"&&(K.current?K.current=!1:l(!0))},{root:W.current||null});return()=>He?.()},[h,P]),Ze.useEffect(()=>{if(!h?.showWestBankOverlay)return;const He=w==="sub-intro"||w==="west-bank";h.showWestBankOverlay(He)},[w,h]),Ze.useEffect(()=>{console.log(" State update - storyStarted:",P,"currentScene:",w)},[P,w]),Ze.useEffect(()=>{w!=="farsia-video"&&ve.current&&(ve.current.pause(),J(!1))},[w]);const Pe=()=>{ve.current&&(ve.current.play(),J(!0))},Fe=()=>J(!0),Ue=()=>J(!1);return Ze.useEffect(()=>{const He=fw[w];He&&U(mt=>{let Mt=He.reset?[]:[...mt];if(He.hide?.length&&(Mt=Mt.filter(Pt=>!He.hide.includes(Pt))),He.show?.length)for(const Pt of He.show)Mt.includes(Pt)||Mt.push(Pt);return Mt})},[w]),oe.jsxs("div",{className:"landing",ref:W,children:[oe.jsxs("header",{className:"landing-header",children:[oe.jsx("div",{className:"logo",children:oe.jsx("img",{src:"/occupation-of-the-sun/assets/Camel.png",alt:"Camel logo"})}),oe.jsxs("div",{className:"chapter-nav",children:[oe.jsx("button",{style:{fontFamily:"El Messiri"},onClick:()=>Ce("intro"),className:"start-button",children:"Start"}),oe.jsx("button",{style:{fontFamily:"El Messiri"},onClick:()=>Ce("farsia-village"),className:"start-button",children:"Al-Farsia"}),oe.jsx("button",{style:{fontFamily:"El Messiri"},onClick:()=>Ce("naama-nueima"),className:"start-button",children:"Nu'eima"}),oe.jsx("button",{style:{fontFamily:"El Messiri"},onClick:()=>Ce("west-bank"),className:"start-button",children:"Energy Apartheid"}),oe.jsx("button",{style:{fontFamily:"El Messiri"},onClick:()=>Ce("globe-scene"),className:"start-button",children:"Global Complicity"})]}),oe.jsx("nav",{className:"landing-nav",children:oe.jsxs(Ug,{target:"_blank",to:"https://caravancollective.org/",children:[oe.jsx("span",{style:{fontFamily:"El Messiri"},children:"Caravan"})," ",oe.jsx("span",{style:{fontFamily:"Suisse Intl"},children:"Collective"})]})})]}),oe.jsx("div",{className:"landing-map",children:oe.jsx(uw,{onReady:y,grayscale:w==="intro"||w==="intro-2"||w==="globe-scene",scrollContainer:W.current,visibleSiteIds:B})}),oe.jsxs("div",{className:"scroll-container",children:[oe.jsx("div",{"data-scene-id":"intro",className:"scroll-section",children:E&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"The Occupation of the Sun"}),oe.jsx("h2",{className:"hero-subtitle",children:"Research Project Investigating the Energy Industry in the Israeli-Occupied West Bank"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"sub-intro",className:"scroll-section"}),oe.jsx("div",{"data-scene-id":"farsia-village",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Al - Farsia"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"Barely a couple of kilometres apart, the Palestinian village of Al Farsiya Nabaa Al-Ghazzal and the Israeli settlement of Shadmot Mehola face two starkly different everyday realities."}),oe.jsx("p",{children:"By examining the disparity in access to solar energy use and production, The Occupation of the Sun narrates how Palestinians' efforts for energy self-reliance are suppressed by industrial projects supporting Israeli settlements, funded by international stakeholders. This project reveals only a part of the complex and deeply rooted systems of oppression and apartheid that characterise Israel's occupation of Palestine."}),oe.jsx("p",{children:"The destruction of these Palestinian communities livelihoods occurs through economic, infrastructural, and outwardly violent actions by settlers and military forces. Yet, the indigenous resilience remains unbroken, as Palestinians refuse to abandon their lands."})]})]})}),oe.jsx("div",{"data-scene-id":"farsia-village-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Al - Farsia"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"In the northern edge of the Jordan Valley, is the village of Al-Farsiya Nabaa Al-Ghazzal."}),oe.jsx("p",{children:"For 47 years, the tiny hamlet, home to roughly 20 members of the Daraghme family, has survived in the Israeli-occupied West Bank. "}),oe.jsx("p",{children:"All of its electricity comes from a handful of solar panels. The community once had a generator, but it was destroyed during one of several settler attacks in April 2024."}),oe.jsx("p",{children:"Al-Farsiya is one of the last remaining Palestinian shepherding communities in the Jordan Valley. Most others have already been displaced. The Daraghme family counts a few hundred sheep and a small strip of barley fields, an economy steadily strangled by nearby settlers who block access to grazing land and routinely damage crops by running their own flocks through the fields. Tubas, the closest Palestinian town, used to be a half-hour drive away; now, with the Israeli militarys closure of the Al-Hamra checkpoint for nearly two years, every trip requires a multi-hour detour."})]})]})}),oe.jsx("div",{"data-scene-id":"farsia-video",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Life in Al-Farsia"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Naama-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"rotem",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Al - Farsia"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"Across Area C, which makes up more than 60 per cent of the West Bank and is under full Israeli military control, solar power is often the only available source of electricity for Palestinian herding communities -- like Al-Farsiya. Israel has refused to connect these communities to the grid, despite its obligation under international humanitarian law to provide basic services to the population under occupation."}),oe.jsx("p",{children:"Al-Farsiyas solar panels were installed by Comet-ME, an Israeli-Palestinian NGO that provides basic water and energy infrastructure to vulnerable villages. But these installations are frequent targets."}),oe.jsx("p",{children:"There's the settlers, and theres the army, said 32-year-old Ahmad Daraghme, the hamlets informal leader. Every other day they come to attack us. In September 2023, nine masked settlers from Rotem settlement assaulted him on his traditional grazing lands, breaking his hand with an iron bar, leaving him in a cast for weeks; Israeli police declined to investigate."}),oe.jsx("p",{children:"The violence escalated in April 2024, when dozens of settlers stormed Al-Farsiya at night, attacking residents, burning a car and smashing nearly every solar panel. Police again refused to open a case."}),oe.jsx("p",{children:"Today, the shattered panels serve as makeshift fencing around the homes."})]})]})}),oe.jsx("div",{"data-scene-id":"rotem-video",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Al-Farsia Energy"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Naama-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"settlements",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Settlement"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"Israel has set ambitious targets to expand its solar energy capacity by 2030. The government aims to generate 30% of the nation's electricity from renewable sources by that year, with solar energy playing a central role. To achieve this goal, Israel plans to increase its installed solar capacity to approximately 17 gigawatts (GW) by 2030. This expansion will involve the development of large-scale solar farms, integration of energy storage solutions, and the promotion of rooftop solar installations across the country."}),oe.jsx("p",{children:"The irony is impossible to miss: just a few dozen meters away, Israel has laid water pipes and an electricity line, but only to serve the nearby settlements. While Israel promotes its green energy initiatives and environmental policies, it systematically exploits Palestinian land, water, and natural resources."})]})]})}),oe.jsx("div",{"data-scene-id":"shdemot-mehola",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Settlement"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"The rapid expansion of solar energy in the occupied West Bank has become a tool of colonisation, land seizure, and resource extraction, packaged as green development. This greenwashing masks the systematic transfer of  Palestinian land and resources to Israeli and international corporations through lucrative renewable energy investments."}),oe.jsx("p",{children:"Settlements are increasingly powered by large, internationally funded solar farms, while Palestinian communities in the same areas struggle simply to keep the lights on. Small, improvised systems are routinely demolished or vandalised by settlers or the military.  The result is two starkly different energy realities in one territory  what some call Energy apartheid."})]})]})}),oe.jsx("div",{"data-scene-id":"shdemot-mehola-zoom",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Settlement"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"Just a 10-minute drive from Al-Farsiya, set in a parallel, luxurious, dystopian reality, is the settlement of Shadmot Mehola. While Al-Farsiya struggles to keep a few fragile solar panels standing, international companies are profiting from the Israeli settlements around it. "}),oe.jsx("p",{children:"Founded in 1979 as part of a broader effort to create Israeli military infrastructure along the Jordanian border, Shadmot Mehola became a civilian settlement in 1984 and is now home to roughly 650 residents  farmers, teachers, lawyers and other professionals. Four soldiers guard the settlements large electric gate. Beyond the fence, the Jordan Valleys desert topography seems to disappear: flourishing - albeit foreign - trees line the sidewalks, manicured lawns surround neat, tiled-roofed houses, and even the air seems clearer inside the enclosure."})]})]})}),oe.jsx("div",{"data-scene-id":"shdemot-mehola-zoom-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Settlement"}),oe.jsx("div",{className:"hero-body",children:oe.jsx("p",{children:"Noam Bigon, the settlements administrator, welcomed us into his air-conditioned office, offering tea and coffee in front of a large map of the settlement. He traced the locations of synagogues, community centers, schools, swimming pools, and a wide zoned area for 120 prefabricated housing units  single-family homes that, he said proudly, could be assembled in just two weeks. Families from all over the country want to live here, he said. Theres a calm environment."})})]})}),oe.jsx("div",{"data-scene-id":"shdemot-mehola-video",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Settlement"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Shdemot-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"shdemot-mehola-out",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Solar Field"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"The dirt track leading out of Al-Farsiya gives way to a smooth, paved route that rises toward a half-kilometer stretch of gleaming solar panels. These panels, Bigon explained, are connected directly to the Israel Electric Corporation (IEC), the national grid."}),oe.jsx("p",{children:"Sliding his finger toward the road we had driven on, Bigon pointed to the Shadmot Mehola Solar Field. Built in 2016, the installation covered more than 50,000 square meters and produced five megawatts of electricity, financed by a 40-million-shekel private Israeli investment. The land beneath the solar field had been taken in 1997 from the Palestinian Tubas governorate and transferred to the settlement through the World Zionist Organisation."})]})]})}),oe.jsx("div",{"data-scene-id":"shdemot-mehola-solar-field",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Solar Field"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"A newer project was also underway. In 2023, the Civil Administration outlined plans for a solar gate that would encircle the entire settlement. We are doing an innovative project, Bigon explained. The settlement's gate itself will be made out of solar panels. It will produce its own security lighting. Come back in two years, and you will see."}),oe.jsx("p",{children:"The solar field operated under a special arrangement approved by the Ministry of Energy and the Electricity Authority for entrepreneurs in the occupied West Bank. Through this scheme, the Israeli state guaranteed it would buy electricity from the field for at least 20 years at an unusually high rate of NIS 0.510.54 (.16 -.17 USD) per kilowatt."}),oe.jsx("p",{children:"When asked if the residents of Shadmot Mehola cared about the environmental significance of the panels, Bigon emphasized that, above all, they were a source of profit for the community. On the panels, you can draw a dollar sign, he said. That is their significance."})]})]})}),oe.jsx("div",{"data-scene-id":"shdemot-mehola-solar-video",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola Solar Field"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Shdemot-solar-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"settlements-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola & Al-Farsiya"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"The relationship between Shadmot Mehola and Al-Farsiya runs far deeper than energy disparity and land seizure. According to evidence collected by the human rights group Jordan Valley Activists (JVA), settlers from Shadmot Mehola have for years been involved in violent attacks targeting Al-Farsiya."}),oe.jsx("p",{children:"In September 2023, the settlers who broke Ahmads hand with an iron bar came from Shadmot Mehola. Among them were the Rosenberg brothers  the grandsons of the rabbi who founded the settlements religious school. The settlements security coordinator watched the attack without intervening."}),oe.jsx("p",{children:"On June 9, 2025 two settlers walked down from Shadmot Mehola to begin constructing a 150-meter fence just two meters away from Al-Farsiyas homes, cutting off the village from its remaining land."})]})]})}),oe.jsx("div",{"data-scene-id":"sub-intro-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Shadmot Mehola & Al-Farsiya"}),oe.jsx("div",{className:"hero-body",children:oe.jsx("p",{children:"The brutal violence inflicted on Ahmad and his family is not separate from the settlements glossy green energy projects. They are two sides of the same effort: a system designed to remove Palestinian communities from the Jordan Valley and replace them with Israeli settlers. The men who engineered the solar panels and the men who attacked Ahmad live in the same houses, and work towards the same end."})})]})}),oe.jsx("div",{"data-scene-id":"naama-nueima",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Na'ama Settlement"}),oe.jsx("div",{className:"hero-body",children:oe.jsx("p",{children:"The Israeli settlement of Na'ama was established in 1982 in the Jordan Valley, occupied West Bank.Na'ama was established on land confiscated from the Palestinian village of An Nuweima. According to ARIJs GIS Unit (2011), the Israeli government seized 5,048 dunums  roughly 10.4% of the villages total area  to build what was then called Naomi."})})]})}),oe.jsx("div",{"data-scene-id":"naama",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Na'ama Settlement"}),oe.jsxs("div",{className:"hero-body",children:[oe.jsx("p",{children:"As of 2022, Naamas population stood at 247 residents, following a communal secular lifestyle. For several years, the settlement was formally renamed Na'omi before the original name, Na'ama, was reinstated. "}),oe.jsx("p",{children:"The name Na'ama is an acronym for Hebrew Youth Settling the West Bank. The residents of Naama are mainly engaged in agriculture, growing dates, green herbs, orchards, and vegetables. The agriculture production exports goods both locally and internationally."})]})]})}),oe.jsx("div",{"data-scene-id":"naama-zoom",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Na'ama Settlement"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"naama-video",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Na'ama Video"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Shdemot-solar-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"naama-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Na'ama Settlement"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"naama-solar",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Na'ama Solar"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Shdemot-solar-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"naama-nueima-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Na'ama Settlement"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"nueima-zoom",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Nu'eima"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"nueima-solar",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Nu'eima Solar"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"nueima-solar-video",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Nu'eima Solar"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Shdemot-solar-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"nueima-zoom-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Nu'eima"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"beit-al-ajdad",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Beit Al-Ajdad Elderly Care Home"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"beit-al-ajdad-video",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card-video",children:[oe.jsx("h1",{className:"hero-title",children:"Beit Al-Ajdad Elderly Care Home"}),oe.jsx("div",{className:"hero-body",children:oe.jsxs("div",{className:"video-container",children:[oe.jsxs("video",{ref:ve,className:"scene-video",controls:!0,playsInline:!0,preload:"metadata",onPlay:Fe,onPause:Ue,children:[oe.jsx("source",{src:"/occupation-of-the-sun/assets/videos/Shdemot-solar-video.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),!ee&&oe.jsx("button",{className:"video-play-button",onClick:Pe,"aria-label":"Play video",children:oe.jsx("svg",{viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:oe.jsx("path",{d:"M8 5v14l11-7z"})})})]})})]})}),oe.jsx("div",{"data-scene-id":"west-bank",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Back Again"}),oe.jsx("div",{className:"hero-body"}),oe.jsx("p",{children:"The need for sustainable energy systems is undeniable. But Israels self-portrait as a sustainable state also serves a political purpose, obscuring the extent to which its renewable-energy simultaneously fuels and relies on the seizure of Palestinian land."}),oe.jsx("p",{children:"The structural imbalance stretches back decades. Since 1992, following the Oslo Accords, Palestinian areas A and B have been forced to purchase all electricity from the Israel Electric Corporation. The IEC, for its part, sources power from industrial zones in settlements across the West Bank and in the Naqab/Negev  areas, where dozens of Palestinian villages and Bedouin communities have been displaced to make way for solar fields and related infrastructure."})]})}),oe.jsx("div",{"data-scene-id":"west-bank",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Back Again"}),oe.jsx("div",{className:"hero-body"}),oe.jsx("p",{children:"Israel has invested heavily in branding itself as a green pioneer since the early 2010s. In a 2015 speech to the United Nations, Israels ambassador boasted that the country had become a hub for renewable energy research and development."}),oe.jsx("p",{children:"The same sun that shines equally on all of us, is owned by none of us, and can supply energy in abundance, inherently promotes peace, he continued."}),oe.jsx("p",{children:"But this self-branding became much more aggressive after 2020, when Israel announced its 2030 renewable energy targets."})]})}),oe.jsx("div",{"data-scene-id":"west-bank",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Back Again"}),oe.jsx("div",{className:"hero-body"}),oe.jsx("p",{children:"Israels solar electricity generation grew from virtually nothing in 2008 to 7,540 gigawatts by 2023  making up 86% of its renewable output."}),oe.jsx("p",{children:"This rapid buildup hasnt happened in a vacuum. It has been driven by an aggressive set of economic incentives designed to facilitate private investment into the solar market. Subsidies, long-term feed-in tariffs, guaranteed grid access, and streamlined permitting have turned renewable energy into a highly profitable venture."}),oe.jsx("p",{children:"As reported by Who Profits in 2024, between 2017 and 2022, the Israel Land Authority profited over 184.5 million NIS from solar field projects, approving 68 new transactions with a total capacity of 750 megawatts."})]})}),oe.jsx("div",{"data-scene-id":"west-bank",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Back Again"}),oe.jsx("div",{className:"hero-body"}),oe.jsx("p",{children:"Contrary to the ambassadors words, in the occupied West Bank, the sun does not shine equally on all."}),oe.jsx("p",{children:"International corporations are deeply embedded in the solar infrastructure that underpins Israels occupation. Across Area C of the West Bank and Naqab/Negev, dozens of foreign companies manufacture, sell, and maintain solar systems that power settlements and industrial zones  either directly or through joint partnerships with Israeli firms. The most commercially entangled countries are the United States, Germany, China, France, and Italy."})]})}),oe.jsx("div",{"data-scene-id":"globe-scene",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Globe"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"globe-scene",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Globe"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"globe-scene",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Globe"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"globe-scene",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Globe"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"globe-scene",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Globe"}),oe.jsx("div",{className:"hero-body"})]})}),oe.jsx("div",{"data-scene-id":"intro-2",className:"scroll-section",children:P&&oe.jsxs("div",{className:"hero-card",children:[oe.jsx("h1",{className:"hero-title",children:"Introduction"}),oe.jsx("div",{className:"hero-body"})]})})]})]})}function mw(){return oe.jsxs("div",{className:"content",children:[oe.jsx("h1",{children:"About"}),oe.jsx("p",{children:"This project investigates the energy industry in the Israeli-occupied West Bank."})]})}function gw(){return oe.jsx(W0,{basename:"/occupation-of-the-sun/",children:oe.jsx(pw,{children:oe.jsxs(A0,{children:[oe.jsx(km,{path:"/",element:oe.jsx(B_,{})}),oe.jsx(km,{path:"/about",element:oe.jsx(mw,{})}),oe.jsx(km,{path:"*",element:oe.jsx(B_,{})})]})})})}Oy.createRoot(document.getElementById("root")).render(oe.jsx(gw,{}));
